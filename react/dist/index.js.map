{"version":3,"file":"index.js","sources":["../node_modules/@scure/base/lib/esm/index.js","../node_modules/@scure/bip39/esm/index.js","../node_modules/@scure/bip39/esm/wordlists/english.js","../src/crypto/bip39.ts","../src/components/LoginButton.tsx","../src/hooks/usePasswordReset.ts","../src/components/email/ForgotPasswordForm.tsx","../src/hooks/useAppleAuth.ts","../src/utils/deviceDetection.ts","../src/components/apple/AppleLoginButton.tsx","../src/utils/webauthnJson.ts","../src/hooks/useWebAuthn.ts","../src/components/webauthn/PasskeyLoginButton.tsx","../src/components/LoginForm.tsx","../src/components/shared/ErrorBoundary.tsx","../src/components/LoginModal.tsx","../src/components/email/ResetPasswordForm.tsx","../src/components/org/OrgAvatar.tsx","../src/components/org/OrgSelector.tsx","../src/components/org/icons.tsx","../src/components/org/OrgListView.tsx","../src/components/org/CreateOrgForm.tsx","../src/components/org/OrgSwitcher.tsx","../src/components/sessions/SessionList.tsx","../src/components/wallet/RecoveryPhraseDisplay.tsx","../src/components/wallet/RecoveryPhraseInput.tsx","../src/components/wallet/CapabilityWarning.tsx","../src/hooks/useWalletDiscovery.ts","../src/hooks/useWalletEnrollment.ts","../src/components/wallet/WalletEnrollment.tsx","../src/hooks/useWalletSigning.ts","../src/components/wallet/PasskeyPrompt.tsx","../src/components/wallet/WalletUnlock.tsx","../src/hooks/useWalletRecovery.ts","../src/components/wallet/WalletRecovery.tsx","../src/components/wallet/WalletAddressRow.tsx","../src/components/wallet/WalletStatus.tsx","../src/components/wallet/WalletManager.tsx","../src/components/admin/SystemSettings.tsx","../src/utils/setupApi.ts","../src/hooks/useSetup.ts","../src/components/admin/SetupWizard.tsx","../src/components/admin/settings/SecuritySettings.tsx","../src/components/admin/settings/MessagingSettings.tsx","../src/components/admin/CedrosAdminDashboard.tsx","../node_modules/qrcode/lib/can-promise.js","../node_modules/qrcode/lib/core/utils.js","../node_modules/qrcode/lib/core/error-correction-level.js","../node_modules/qrcode/lib/core/bit-buffer.js","../node_modules/qrcode/lib/core/bit-matrix.js","../node_modules/qrcode/lib/core/alignment-pattern.js","../node_modules/qrcode/lib/core/finder-pattern.js","../node_modules/qrcode/lib/core/mask-pattern.js","../node_modules/qrcode/lib/core/error-correction-code.js","../node_modules/qrcode/lib/core/galois-field.js","../node_modules/qrcode/lib/core/polynomial.js","../node_modules/qrcode/lib/core/reed-solomon-encoder.js","../node_modules/qrcode/lib/core/version-check.js","../node_modules/qrcode/lib/core/regex.js","../node_modules/qrcode/lib/core/mode.js","../node_modules/qrcode/lib/core/version.js","../node_modules/qrcode/lib/core/format-info.js","../node_modules/qrcode/lib/core/numeric-data.js","../node_modules/qrcode/lib/core/alphanumeric-data.js","../node_modules/qrcode/lib/core/byte-data.js","../node_modules/qrcode/lib/core/kanji-data.js","../node_modules/dijkstrajs/dijkstra.js","../node_modules/qrcode/lib/core/segments.js","../node_modules/qrcode/lib/core/qrcode.js","../node_modules/qrcode/lib/renderer/utils.js","../node_modules/qrcode/lib/renderer/canvas.js","../node_modules/qrcode/lib/renderer/svg-tag.js","../node_modules/qrcode/lib/browser.js","../src/components/totp/QrCode.tsx","../src/hooks/useTotp.ts","../src/components/totp/TotpSetup.tsx","../src/components/totp/TotpSettings.tsx","../src/utils/profileApi.ts","../src/hooks/useProfile.ts","../src/components/profile/UserProfileSettings.tsx","../src/hooks/useDeposit.ts","../src/components/deposit/TokenSelector.tsx","../src/components/deposit/tierUtils.ts","../src/assets/tokens/sol.webp","../src/components/deposit/TieredAmountSlider.tsx","../src/components/deposit/DepositFlow.tsx","../src/assets/tokens/bonk.webp","../src/assets/tokens/cash.webp","../src/assets/tokens/eurc.webp","../src/assets/tokens/ore.webp","../src/assets/tokens/pyusd.webp","../src/assets/tokens/usdc.webp","../src/assets/tokens/usdh.svg","../src/assets/tokens/usd1.webp","../src/assets/tokens/usdt.svg","../src/components/deposit/tokens.ts","../src/hooks/useCredits.ts","../src/components/deposit/CreditBalance.tsx","../src/components/deposit/History.tsx","../src/hooks/useWithdrawal.ts","../src/components/withdrawal/WithdrawalFlow.tsx","../src/components/withdrawal/WithdrawalHistory.tsx","../src/components/templates/FullPageLayout.tsx","../src/components/templates/SplitPageLayout.tsx","../src/utils/sessionApi.ts","../src/hooks/useSessions.ts","../src/hooks/useAuthorize.ts","../src/hooks/useWallets.ts","../src/hooks/usePendingRecovery.ts","../src/hooks/useTransactionSigning.ts","../src/i18n/context.ts","../src/i18n/translations.ts","../src/i18n/I18nProvider.tsx","../src/i18n/useI18n.ts"],"sourcesContent":["/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nfunction isBytes(a) {\n    return a instanceof Uint8Array || (ArrayBuffer.isView(a) && a.constructor.name === 'Uint8Array');\n}\n/** Asserts something is Uint8Array. */\nfunction abytes(b, ...lengths) {\n    if (!isBytes(b))\n        throw new Error('Uint8Array expected');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error('Uint8Array expected of length ' + lengths + ', got length=' + b.length);\n}\nfunction isArrayOf(isString, arr) {\n    if (!Array.isArray(arr))\n        return false;\n    if (arr.length === 0)\n        return true;\n    if (isString) {\n        return arr.every((item) => typeof item === 'string');\n    }\n    else {\n        return arr.every((item) => Number.isSafeInteger(item));\n    }\n}\n// no abytes: seems to have 10% slowdown. Why?!\nfunction afn(input) {\n    if (typeof input !== 'function')\n        throw new Error('function expected');\n    return true;\n}\nfunction astr(label, input) {\n    if (typeof input !== 'string')\n        throw new Error(`${label}: string expected`);\n    return true;\n}\nfunction anumber(n) {\n    if (!Number.isSafeInteger(n))\n        throw new Error(`invalid integer: ${n}`);\n}\nfunction aArr(input) {\n    if (!Array.isArray(input))\n        throw new Error('array expected');\n}\nfunction astrArr(label, input) {\n    if (!isArrayOf(true, input))\n        throw new Error(`${label}: array of strings expected`);\n}\nfunction anumArr(label, input) {\n    if (!isArrayOf(false, input))\n        throw new Error(`${label}: array of numbers expected`);\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction chain(...args) {\n    const id = (a) => a;\n    // Wrap call in closure so JIT can inline calls\n    const wrap = (a, b) => (c) => a(b(c));\n    // Construct chain of args[-1].encode(args[-2].encode([...]))\n    const encode = args.map((x) => x.encode).reduceRight(wrap, id);\n    // Construct chain of args[0].decode(args[1].decode(...))\n    const decode = args.map((x) => x.decode).reduce(wrap, id);\n    return { encode, decode };\n}\n/**\n * Encodes integer radix representation to array of strings using alphabet and back.\n * Could also be array of strings.\n * @__NO_SIDE_EFFECTS__\n */\nfunction alphabet(letters) {\n    // mapping 1 to \"b\"\n    const lettersA = typeof letters === 'string' ? letters.split('') : letters;\n    const len = lettersA.length;\n    astrArr('alphabet', lettersA);\n    // mapping \"b\" to 1\n    const indexes = new Map(lettersA.map((l, i) => [l, i]));\n    return {\n        encode: (digits) => {\n            aArr(digits);\n            return digits.map((i) => {\n                if (!Number.isSafeInteger(i) || i < 0 || i >= len)\n                    throw new Error(`alphabet.encode: digit index outside alphabet \"${i}\". Allowed: ${letters}`);\n                return lettersA[i];\n            });\n        },\n        decode: (input) => {\n            aArr(input);\n            return input.map((letter) => {\n                astr('alphabet.decode', letter);\n                const i = indexes.get(letter);\n                if (i === undefined)\n                    throw new Error(`Unknown letter: \"${letter}\". Allowed: ${letters}`);\n                return i;\n            });\n        },\n    };\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction join(separator = '') {\n    astr('join', separator);\n    return {\n        encode: (from) => {\n            astrArr('join.decode', from);\n            return from.join(separator);\n        },\n        decode: (to) => {\n            astr('join.decode', to);\n            return to.split(separator);\n        },\n    };\n}\n/**\n * Pad strings array so it has integer number of bits\n * @__NO_SIDE_EFFECTS__\n */\nfunction padding(bits, chr = '=') {\n    anumber(bits);\n    astr('padding', chr);\n    return {\n        encode(data) {\n            astrArr('padding.encode', data);\n            while ((data.length * bits) % 8)\n                data.push(chr);\n            return data;\n        },\n        decode(input) {\n            astrArr('padding.decode', input);\n            let end = input.length;\n            if ((end * bits) % 8)\n                throw new Error('padding: invalid, string should have whole number of bytes');\n            for (; end > 0 && input[end - 1] === chr; end--) {\n                const last = end - 1;\n                const byte = last * bits;\n                if (byte % 8 === 0)\n                    throw new Error('padding: invalid, string has too much padding');\n            }\n            return input.slice(0, end);\n        },\n    };\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction normalize(fn) {\n    afn(fn);\n    return { encode: (from) => from, decode: (to) => fn(to) };\n}\n/**\n * Slow: O(n^2) time complexity\n */\nfunction convertRadix(data, from, to) {\n    // base 1 is impossible\n    if (from < 2)\n        throw new Error(`convertRadix: invalid from=${from}, base cannot be less than 2`);\n    if (to < 2)\n        throw new Error(`convertRadix: invalid to=${to}, base cannot be less than 2`);\n    aArr(data);\n    if (!data.length)\n        return [];\n    let pos = 0;\n    const res = [];\n    const digits = Array.from(data, (d) => {\n        anumber(d);\n        if (d < 0 || d >= from)\n            throw new Error(`invalid integer: ${d}`);\n        return d;\n    });\n    const dlen = digits.length;\n    while (true) {\n        let carry = 0;\n        let done = true;\n        for (let i = pos; i < dlen; i++) {\n            const digit = digits[i];\n            const fromCarry = from * carry;\n            const digitBase = fromCarry + digit;\n            if (!Number.isSafeInteger(digitBase) ||\n                fromCarry / from !== carry ||\n                digitBase - digit !== fromCarry) {\n                throw new Error('convertRadix: carry overflow');\n            }\n            const div = digitBase / to;\n            carry = digitBase % to;\n            const rounded = Math.floor(div);\n            digits[i] = rounded;\n            if (!Number.isSafeInteger(rounded) || rounded * to + carry !== digitBase)\n                throw new Error('convertRadix: carry overflow');\n            if (!done)\n                continue;\n            else if (!rounded)\n                pos = i;\n            else\n                done = false;\n        }\n        res.push(carry);\n        if (done)\n            break;\n    }\n    for (let i = 0; i < data.length - 1 && data[i] === 0; i++)\n        res.push(0);\n    return res.reverse();\n}\nconst gcd = (a, b) => (b === 0 ? a : gcd(b, a % b));\nconst radix2carry = /* @__NO_SIDE_EFFECTS__ */ (from, to) => from + (to - gcd(from, to));\nconst powers = /* @__PURE__ */ (() => {\n    let res = [];\n    for (let i = 0; i < 40; i++)\n        res.push(2 ** i);\n    return res;\n})();\n/**\n * Implemented with numbers, because BigInt is 5x slower\n */\nfunction convertRadix2(data, from, to, padding) {\n    aArr(data);\n    if (from <= 0 || from > 32)\n        throw new Error(`convertRadix2: wrong from=${from}`);\n    if (to <= 0 || to > 32)\n        throw new Error(`convertRadix2: wrong to=${to}`);\n    if (radix2carry(from, to) > 32) {\n        throw new Error(`convertRadix2: carry overflow from=${from} to=${to} carryBits=${radix2carry(from, to)}`);\n    }\n    let carry = 0;\n    let pos = 0; // bitwise position in current element\n    const max = powers[from];\n    const mask = powers[to] - 1;\n    const res = [];\n    for (const n of data) {\n        anumber(n);\n        if (n >= max)\n            throw new Error(`convertRadix2: invalid data word=${n} from=${from}`);\n        carry = (carry << from) | n;\n        if (pos + from > 32)\n            throw new Error(`convertRadix2: carry overflow pos=${pos} from=${from}`);\n        pos += from;\n        for (; pos >= to; pos -= to)\n            res.push(((carry >> (pos - to)) & mask) >>> 0);\n        const pow = powers[pos];\n        if (pow === undefined)\n            throw new Error('invalid carry');\n        carry &= pow - 1; // clean carry, otherwise it will cause overflow\n    }\n    carry = (carry << (to - pos)) & mask;\n    if (!padding && pos >= from)\n        throw new Error('Excess padding');\n    if (!padding && carry > 0)\n        throw new Error(`Non-zero padding: ${carry}`);\n    if (padding && pos > 0)\n        res.push(carry >>> 0);\n    return res;\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction radix(num) {\n    anumber(num);\n    const _256 = 2 ** 8;\n    return {\n        encode: (bytes) => {\n            if (!isBytes(bytes))\n                throw new Error('radix.encode input should be Uint8Array');\n            return convertRadix(Array.from(bytes), _256, num);\n        },\n        decode: (digits) => {\n            anumArr('radix.decode', digits);\n            return Uint8Array.from(convertRadix(digits, num, _256));\n        },\n    };\n}\n/**\n * If both bases are power of same number (like `2**8 <-> 2**64`),\n * there is a linear algorithm. For now we have implementation for power-of-two bases only.\n * @__NO_SIDE_EFFECTS__\n */\nfunction radix2(bits, revPadding = false) {\n    anumber(bits);\n    if (bits <= 0 || bits > 32)\n        throw new Error('radix2: bits should be in (0..32]');\n    if (radix2carry(8, bits) > 32 || radix2carry(bits, 8) > 32)\n        throw new Error('radix2: carry overflow');\n    return {\n        encode: (bytes) => {\n            if (!isBytes(bytes))\n                throw new Error('radix2.encode input should be Uint8Array');\n            return convertRadix2(Array.from(bytes), 8, bits, !revPadding);\n        },\n        decode: (digits) => {\n            anumArr('radix2.decode', digits);\n            return Uint8Array.from(convertRadix2(digits, bits, 8, revPadding));\n        },\n    };\n}\nfunction unsafeWrapper(fn) {\n    afn(fn);\n    return function (...args) {\n        try {\n            return fn.apply(null, args);\n        }\n        catch (e) { }\n    };\n}\nfunction checksum(len, fn) {\n    anumber(len);\n    afn(fn);\n    return {\n        encode(data) {\n            if (!isBytes(data))\n                throw new Error('checksum.encode: input should be Uint8Array');\n            const sum = fn(data).slice(0, len);\n            const res = new Uint8Array(data.length + len);\n            res.set(data);\n            res.set(sum, data.length);\n            return res;\n        },\n        decode(data) {\n            if (!isBytes(data))\n                throw new Error('checksum.decode: input should be Uint8Array');\n            const payload = data.slice(0, -len);\n            const oldChecksum = data.slice(-len);\n            const newChecksum = fn(payload).slice(0, len);\n            for (let i = 0; i < len; i++)\n                if (newChecksum[i] !== oldChecksum[i])\n                    throw new Error('Invalid checksum');\n            return payload;\n        },\n    };\n}\n// prettier-ignore\nexport const utils = {\n    alphabet, chain, checksum, convertRadix, convertRadix2, radix, radix2, join, padding,\n};\n// RFC 4648 aka RFC 3548\n// ---------------------\n/**\n * base16 encoding from RFC 4648.\n * @example\n * ```js\n * base16.encode(Uint8Array.from([0x12, 0xab]));\n * // => '12AB'\n * ```\n */\nexport const base16 = chain(radix2(4), alphabet('0123456789ABCDEF'), join(''));\n/**\n * base32 encoding from RFC 4648. Has padding.\n * Use `base32nopad` for unpadded version.\n * Also check out `base32hex`, `base32hexnopad`, `base32crockford`.\n * @example\n * ```js\n * base32.encode(Uint8Array.from([0x12, 0xab]));\n * // => 'CKVQ===='\n * base32.decode('CKVQ====');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\nexport const base32 = chain(radix2(5), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'), padding(5), join(''));\n/**\n * base32 encoding from RFC 4648. No padding.\n * Use `base32` for padded version.\n * Also check out `base32hex`, `base32hexnopad`, `base32crockford`.\n * @example\n * ```js\n * base32nopad.encode(Uint8Array.from([0x12, 0xab]));\n * // => 'CKVQ'\n * base32nopad.decode('CKVQ');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\nexport const base32nopad = chain(radix2(5), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'), join(''));\n/**\n * base32 encoding from RFC 4648. Padded. Compared to ordinary `base32`, slightly different alphabet.\n * Use `base32hexnopad` for unpadded version.\n * @example\n * ```js\n * base32hex.encode(Uint8Array.from([0x12, 0xab]));\n * // => '2ALG===='\n * base32hex.decode('2ALG====');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\nexport const base32hex = chain(radix2(5), alphabet('0123456789ABCDEFGHIJKLMNOPQRSTUV'), padding(5), join(''));\n/**\n * base32 encoding from RFC 4648. No padding. Compared to ordinary `base32`, slightly different alphabet.\n * Use `base32hex` for padded version.\n * @example\n * ```js\n * base32hexnopad.encode(Uint8Array.from([0x12, 0xab]));\n * // => '2ALG'\n * base32hexnopad.decode('2ALG');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\nexport const base32hexnopad = chain(radix2(5), alphabet('0123456789ABCDEFGHIJKLMNOPQRSTUV'), join(''));\n/**\n * base32 encoding from RFC 4648. Doug Crockford's version.\n * https://www.crockford.com/base32.html\n * @example\n * ```js\n * base32crockford.encode(Uint8Array.from([0x12, 0xab]));\n * // => '2ANG'\n * base32crockford.decode('2ANG');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\nexport const base32crockford = chain(radix2(5), alphabet('0123456789ABCDEFGHJKMNPQRSTVWXYZ'), join(''), normalize((s) => s.toUpperCase().replace(/O/g, '0').replace(/[IL]/g, '1')));\n// Built-in base64 conversion https://caniuse.com/mdn-javascript_builtins_uint8array_frombase64\n// prettier-ignore\nconst hasBase64Builtin = /* @__PURE__ */ (() => typeof Uint8Array.from([]).toBase64 === 'function' &&\n    typeof Uint8Array.fromBase64 === 'function')();\nconst decodeBase64Builtin = (s, isUrl) => {\n    astr('base64', s);\n    const re = isUrl ? /^[A-Za-z0-9=_-]+$/ : /^[A-Za-z0-9=+/]+$/;\n    const alphabet = isUrl ? 'base64url' : 'base64';\n    if (s.length > 0 && !re.test(s))\n        throw new Error('invalid base64');\n    return Uint8Array.fromBase64(s, { alphabet, lastChunkHandling: 'strict' });\n};\n/**\n * base64 from RFC 4648. Padded.\n * Use `base64nopad` for unpadded version.\n * Also check out `base64url`, `base64urlnopad`.\n * Falls back to built-in function, when available.\n * @example\n * ```js\n * base64.encode(Uint8Array.from([0x12, 0xab]));\n * // => 'Eqs='\n * base64.decode('Eqs=');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\n// prettier-ignore\nexport const base64 = hasBase64Builtin ? {\n    encode(b) { abytes(b); return b.toBase64(); },\n    decode(s) { return decodeBase64Builtin(s, false); },\n} : chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'), padding(6), join(''));\n/**\n * base64 from RFC 4648. No padding.\n * Use `base64` for padded version.\n * @example\n * ```js\n * base64nopad.encode(Uint8Array.from([0x12, 0xab]));\n * // => 'Eqs'\n * base64nopad.decode('Eqs');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\nexport const base64nopad = chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'), join(''));\n/**\n * base64 from RFC 4648, using URL-safe alphabet. Padded.\n * Use `base64urlnopad` for unpadded version.\n * Falls back to built-in function, when available.\n * @example\n * ```js\n * base64url.encode(Uint8Array.from([0x12, 0xab]));\n * // => 'Eqs='\n * base64url.decode('Eqs=');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\n// prettier-ignore\nexport const base64url = hasBase64Builtin ? {\n    encode(b) { abytes(b); return b.toBase64({ alphabet: 'base64url' }); },\n    decode(s) { return decodeBase64Builtin(s, true); },\n} : chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'), padding(6), join(''));\n/**\n * base64 from RFC 4648, using URL-safe alphabet. No padding.\n * Use `base64url` for padded version.\n * @example\n * ```js\n * base64urlnopad.encode(Uint8Array.from([0x12, 0xab]));\n * // => 'Eqs'\n * base64urlnopad.decode('Eqs');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\nexport const base64urlnopad = chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'), join(''));\n// base58 code\n// -----------\nconst genBase58 = /* @__NO_SIDE_EFFECTS__ */ (abc) => chain(radix(58), alphabet(abc), join(''));\n/**\n * base58: base64 without ambigous characters +, /, 0, O, I, l.\n * Quadratic (O(n^2)) - so, can't be used on large inputs.\n * @example\n * ```js\n * base58.decode('01abcdef');\n * // => '3UhJW'\n * ```\n */\nexport const base58 = genBase58('123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz');\n/**\n * base58: flickr version. Check out `base58`.\n */\nexport const base58flickr = genBase58('123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ');\n/**\n * base58: XRP version. Check out `base58`.\n */\nexport const base58xrp = genBase58('rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz');\n// Data len (index) -> encoded block len\nconst XMR_BLOCK_LEN = [0, 2, 3, 5, 6, 7, 9, 10, 11];\n/**\n * base58: XMR version. Check out `base58`.\n * Done in 8-byte blocks (which equals 11 chars in decoding). Last (non-full) block padded with '1' to size in XMR_BLOCK_LEN.\n * Block encoding significantly reduces quadratic complexity of base58.\n */\nexport const base58xmr = {\n    encode(data) {\n        let res = '';\n        for (let i = 0; i < data.length; i += 8) {\n            const block = data.subarray(i, i + 8);\n            res += base58.encode(block).padStart(XMR_BLOCK_LEN[block.length], '1');\n        }\n        return res;\n    },\n    decode(str) {\n        let res = [];\n        for (let i = 0; i < str.length; i += 11) {\n            const slice = str.slice(i, i + 11);\n            const blockLen = XMR_BLOCK_LEN.indexOf(slice.length);\n            const block = base58.decode(slice);\n            for (let j = 0; j < block.length - blockLen; j++) {\n                if (block[j] !== 0)\n                    throw new Error('base58xmr: wrong padding');\n            }\n            res = res.concat(Array.from(block.slice(block.length - blockLen)));\n        }\n        return Uint8Array.from(res);\n    },\n};\n/**\n * Method, which creates base58check encoder.\n * Requires function, calculating sha256.\n */\nexport const createBase58check = (sha256) => chain(checksum(4, (data) => sha256(sha256(data))), base58);\n/**\n * Use `createBase58check` instead.\n * @deprecated\n */\nexport const base58check = createBase58check;\nconst BECH_ALPHABET = chain(alphabet('qpzry9x8gf2tvdw0s3jn54khce6mua7l'), join(''));\nconst POLYMOD_GENERATORS = [0x3b6a57b2, 0x26508e6d, 0x1ea119fa, 0x3d4233dd, 0x2a1462b3];\nfunction bech32Polymod(pre) {\n    const b = pre >> 25;\n    let chk = (pre & 0x1ffffff) << 5;\n    for (let i = 0; i < POLYMOD_GENERATORS.length; i++) {\n        if (((b >> i) & 1) === 1)\n            chk ^= POLYMOD_GENERATORS[i];\n    }\n    return chk;\n}\nfunction bechChecksum(prefix, words, encodingConst = 1) {\n    const len = prefix.length;\n    let chk = 1;\n    for (let i = 0; i < len; i++) {\n        const c = prefix.charCodeAt(i);\n        if (c < 33 || c > 126)\n            throw new Error(`Invalid prefix (${prefix})`);\n        chk = bech32Polymod(chk) ^ (c >> 5);\n    }\n    chk = bech32Polymod(chk);\n    for (let i = 0; i < len; i++)\n        chk = bech32Polymod(chk) ^ (prefix.charCodeAt(i) & 0x1f);\n    for (let v of words)\n        chk = bech32Polymod(chk) ^ v;\n    for (let i = 0; i < 6; i++)\n        chk = bech32Polymod(chk);\n    chk ^= encodingConst;\n    return BECH_ALPHABET.encode(convertRadix2([chk % powers[30]], 30, 5, false));\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction genBech32(encoding) {\n    const ENCODING_CONST = encoding === 'bech32' ? 1 : 0x2bc830a3;\n    const _words = radix2(5);\n    const fromWords = _words.decode;\n    const toWords = _words.encode;\n    const fromWordsUnsafe = unsafeWrapper(fromWords);\n    function encode(prefix, words, limit = 90) {\n        astr('bech32.encode prefix', prefix);\n        if (isBytes(words))\n            words = Array.from(words);\n        anumArr('bech32.encode', words);\n        const plen = prefix.length;\n        if (plen === 0)\n            throw new TypeError(`Invalid prefix length ${plen}`);\n        const actualLength = plen + 7 + words.length;\n        if (limit !== false && actualLength > limit)\n            throw new TypeError(`Length ${actualLength} exceeds limit ${limit}`);\n        const lowered = prefix.toLowerCase();\n        const sum = bechChecksum(lowered, words, ENCODING_CONST);\n        return `${lowered}1${BECH_ALPHABET.encode(words)}${sum}`;\n    }\n    function decode(str, limit = 90) {\n        astr('bech32.decode input', str);\n        const slen = str.length;\n        if (slen < 8 || (limit !== false && slen > limit))\n            throw new TypeError(`invalid string length: ${slen} (${str}). Expected (8..${limit})`);\n        // don't allow mixed case\n        const lowered = str.toLowerCase();\n        if (str !== lowered && str !== str.toUpperCase())\n            throw new Error(`String must be lowercase or uppercase`);\n        const sepIndex = lowered.lastIndexOf('1');\n        if (sepIndex === 0 || sepIndex === -1)\n            throw new Error(`Letter \"1\" must be present between prefix and data only`);\n        const prefix = lowered.slice(0, sepIndex);\n        const data = lowered.slice(sepIndex + 1);\n        if (data.length < 6)\n            throw new Error('Data must be at least 6 characters long');\n        const words = BECH_ALPHABET.decode(data).slice(0, -6);\n        const sum = bechChecksum(prefix, words, ENCODING_CONST);\n        if (!data.endsWith(sum))\n            throw new Error(`Invalid checksum in ${str}: expected \"${sum}\"`);\n        return { prefix, words };\n    }\n    const decodeUnsafe = unsafeWrapper(decode);\n    function decodeToBytes(str) {\n        const { prefix, words } = decode(str, false);\n        return { prefix, words, bytes: fromWords(words) };\n    }\n    function encodeFromBytes(prefix, bytes) {\n        return encode(prefix, toWords(bytes));\n    }\n    return {\n        encode,\n        decode,\n        encodeFromBytes,\n        decodeToBytes,\n        decodeUnsafe,\n        fromWords,\n        fromWordsUnsafe,\n        toWords,\n    };\n}\n/**\n * bech32 from BIP 173. Operates on words.\n * For high-level, check out scure-btc-signer:\n * https://github.com/paulmillr/scure-btc-signer.\n */\nexport const bech32 = genBech32('bech32');\n/**\n * bech32m from BIP 350. Operates on words.\n * It was to mitigate `bech32` weaknesses.\n * For high-level, check out scure-btc-signer:\n * https://github.com/paulmillr/scure-btc-signer.\n */\nexport const bech32m = genBech32('bech32m');\n/**\n * UTF-8-to-byte decoder. Uses built-in TextDecoder / TextEncoder.\n * @example\n * ```js\n * const b = utf8.decode(\"hey\"); // => new Uint8Array([ 104, 101, 121 ])\n * const str = utf8.encode(b); // \"hey\"\n * ```\n */\nexport const utf8 = {\n    encode: (data) => new TextDecoder().decode(data),\n    decode: (str) => new TextEncoder().encode(str),\n};\n// Built-in hex conversion https://caniuse.com/mdn-javascript_builtins_uint8array_fromhex\n// prettier-ignore\nconst hasHexBuiltin = /* @__PURE__ */ (() => typeof Uint8Array.from([]).toHex === 'function' &&\n    typeof Uint8Array.fromHex === 'function')();\n// prettier-ignore\nconst hexBuiltin = {\n    encode(data) { abytes(data); return data.toHex(); },\n    decode(s) { astr('hex', s); return Uint8Array.fromHex(s); },\n};\n/**\n * hex string decoder. Uses built-in function, when available.\n * @example\n * ```js\n * const b = hex.decode(\"0102ff\"); // => new Uint8Array([ 1, 2, 255 ])\n * const str = hex.encode(b); // \"0102ff\"\n * ```\n */\nexport const hex = hasHexBuiltin\n    ? hexBuiltin\n    : chain(radix2(4), alphabet('0123456789abcdef'), join(''), normalize((s) => {\n        if (typeof s !== 'string' || s.length % 2 !== 0)\n            throw new TypeError(`hex.decode: expected string, got ${typeof s} with length ${s.length}`);\n        return s.toLowerCase();\n    }));\n// prettier-ignore\nconst CODERS = {\n    utf8, hex, base16, base32, base64, base64url, base58, base58xmr\n};\nconst coderTypeError = 'Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr';\n/** @deprecated */\nexport const bytesToString = (type, bytes) => {\n    if (typeof type !== 'string' || !CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (!isBytes(bytes))\n        throw new TypeError('bytesToString() expects Uint8Array');\n    return CODERS[type].encode(bytes);\n};\n/** @deprecated */\nexport const str = bytesToString; // as in python, but for bytes only\n/** @deprecated */\nexport const stringToBytes = (type, str) => {\n    if (!CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (typeof str !== 'string')\n        throw new TypeError('stringToBytes() expects string');\n    return CODERS[type].decode(str);\n};\n/** @deprecated */\nexport const bytes = stringToBytes;\n//# sourceMappingURL=index.js.map","/**\n * Audited & minimal JS implementation of\n * [BIP39 mnemonic phrases](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki).\n * @module\n * @example\n```js\nimport * as bip39 from '@scure/bip39';\nimport { wordlist } from '@scure/bip39/wordlists/english';\nconst mn = bip39.generateMnemonic(wordlist);\nconsole.log(mn);\nconst ent = bip39.mnemonicToEntropy(mn, wordlist)\nbip39.entropyToMnemonic(ent, wordlist);\nbip39.validateMnemonic(mn, wordlist);\nawait bip39.mnemonicToSeed(mn, 'password');\nbip39.mnemonicToSeedSync(mn, 'password');\n\n// Wordlists\nimport { wordlist as czech } from '@scure/bip39/wordlists/czech';\nimport { wordlist as english } from '@scure/bip39/wordlists/english';\nimport { wordlist as french } from '@scure/bip39/wordlists/french';\nimport { wordlist as italian } from '@scure/bip39/wordlists/italian';\nimport { wordlist as japanese } from '@scure/bip39/wordlists/japanese';\nimport { wordlist as korean } from '@scure/bip39/wordlists/korean';\nimport { wordlist as portuguese } from '@scure/bip39/wordlists/portuguese';\nimport { wordlist as simplifiedChinese } from '@scure/bip39/wordlists/simplified-chinese';\nimport { wordlist as spanish } from '@scure/bip39/wordlists/spanish';\nimport { wordlist as traditionalChinese } from '@scure/bip39/wordlists/traditional-chinese';\n```\n */\n/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */\nimport { pbkdf2, pbkdf2Async } from '@noble/hashes/pbkdf2';\nimport { sha256, sha512 } from '@noble/hashes/sha2';\nimport { abytes, anumber, randomBytes } from '@noble/hashes/utils';\nimport { utils as baseUtils } from '@scure/base';\n// Japanese wordlist\nconst isJapanese = (wordlist) => wordlist[0] === '\\u3042\\u3044\\u3053\\u304f\\u3057\\u3093';\n// Normalization replaces equivalent sequences of characters\n// so that any two texts that are equivalent will be reduced\n// to the same sequence of code points, called the normal form of the original text.\n// https://tonsky.me/blog/unicode/#why-is-a----\nfunction nfkd(str) {\n    if (typeof str !== 'string')\n        throw new TypeError('invalid mnemonic type: ' + typeof str);\n    return str.normalize('NFKD');\n}\nfunction normalize(str) {\n    const norm = nfkd(str);\n    const words = norm.split(' ');\n    if (![12, 15, 18, 21, 24].includes(words.length))\n        throw new Error('Invalid mnemonic');\n    return { nfkd: norm, words };\n}\nfunction aentropy(ent) {\n    abytes(ent, 16, 20, 24, 28, 32);\n}\n/**\n * Generate x random words. Uses Cryptographically-Secure Random Number Generator.\n * @param wordlist imported wordlist for specific language\n * @param strength mnemonic strength 128-256 bits\n * @example\n * generateMnemonic(wordlist, 128)\n * // 'legal winner thank year wave sausage worth useful legal winner thank yellow'\n */\nexport function generateMnemonic(wordlist, strength = 128) {\n    anumber(strength);\n    if (strength % 32 !== 0 || strength > 256)\n        throw new TypeError('Invalid entropy');\n    return entropyToMnemonic(randomBytes(strength / 8), wordlist);\n}\nconst calcChecksum = (entropy) => {\n    // Checksum is ent.length/4 bits long\n    const bitsLeft = 8 - entropy.length / 4;\n    // Zero rightmost \"bitsLeft\" bits in byte\n    // For example: bitsLeft=4 val=10111101 -> 10110000\n    return new Uint8Array([(sha256(entropy)[0] >> bitsLeft) << bitsLeft]);\n};\nfunction getCoder(wordlist) {\n    if (!Array.isArray(wordlist) || wordlist.length !== 2048 || typeof wordlist[0] !== 'string')\n        throw new Error('Wordlist: expected array of 2048 strings');\n    wordlist.forEach((i) => {\n        if (typeof i !== 'string')\n            throw new Error('wordlist: non-string element: ' + i);\n    });\n    return baseUtils.chain(baseUtils.checksum(1, calcChecksum), baseUtils.radix2(11, true), baseUtils.alphabet(wordlist));\n}\n/**\n * Reversible: Converts mnemonic string to raw entropy in form of byte array.\n * @param mnemonic 12-24 words\n * @param wordlist imported wordlist for specific language\n * @example\n * const mnem = 'legal winner thank year wave sausage worth useful legal winner thank yellow';\n * mnemonicToEntropy(mnem, wordlist)\n * // Produces\n * new Uint8Array([\n *   0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f,\n *   0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f\n * ])\n */\nexport function mnemonicToEntropy(mnemonic, wordlist) {\n    const { words } = normalize(mnemonic);\n    const entropy = getCoder(wordlist).decode(words);\n    aentropy(entropy);\n    return entropy;\n}\n/**\n * Reversible: Converts raw entropy in form of byte array to mnemonic string.\n * @param entropy byte array\n * @param wordlist imported wordlist for specific language\n * @returns 12-24 words\n * @example\n * const ent = new Uint8Array([\n *   0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f,\n *   0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f\n * ]);\n * entropyToMnemonic(ent, wordlist);\n * // 'legal winner thank year wave sausage worth useful legal winner thank yellow'\n */\nexport function entropyToMnemonic(entropy, wordlist) {\n    aentropy(entropy);\n    const words = getCoder(wordlist).encode(entropy);\n    return words.join(isJapanese(wordlist) ? '\\u3000' : ' ');\n}\n/**\n * Validates mnemonic for being 12-24 words contained in `wordlist`.\n */\nexport function validateMnemonic(mnemonic, wordlist) {\n    try {\n        mnemonicToEntropy(mnemonic, wordlist);\n    }\n    catch (e) {\n        return false;\n    }\n    return true;\n}\nconst psalt = (passphrase) => nfkd('mnemonic' + passphrase);\n/**\n * Irreversible: Uses KDF to derive 64 bytes of key data from mnemonic + optional password.\n * @param mnemonic 12-24 words\n * @param passphrase string that will additionally protect the key\n * @returns 64 bytes of key data\n * @example\n * const mnem = 'legal winner thank year wave sausage worth useful legal winner thank yellow';\n * await mnemonicToSeed(mnem, 'password');\n * // new Uint8Array([...64 bytes])\n */\nexport function mnemonicToSeed(mnemonic, passphrase = '') {\n    return pbkdf2Async(sha512, normalize(mnemonic).nfkd, psalt(passphrase), { c: 2048, dkLen: 64 });\n}\n/**\n * Irreversible: Uses KDF to derive 64 bytes of key data from mnemonic + optional password.\n * @param mnemonic 12-24 words\n * @param passphrase string that will additionally protect the key\n * @returns 64 bytes of key data\n * @example\n * const mnem = 'legal winner thank year wave sausage worth useful legal winner thank yellow';\n * mnemonicToSeedSync(mnem, 'password');\n * // new Uint8Array([...64 bytes])\n */\nexport function mnemonicToSeedSync(mnemonic, passphrase = '') {\n    return pbkdf2(sha512, normalize(mnemonic).nfkd, psalt(passphrase), { c: 2048, dkLen: 64 });\n}\n","export const wordlist = `abandon\nability\nable\nabout\nabove\nabsent\nabsorb\nabstract\nabsurd\nabuse\naccess\naccident\naccount\naccuse\nachieve\nacid\nacoustic\nacquire\nacross\nact\naction\nactor\nactress\nactual\nadapt\nadd\naddict\naddress\nadjust\nadmit\nadult\nadvance\nadvice\naerobic\naffair\nafford\nafraid\nagain\nage\nagent\nagree\nahead\naim\nair\nairport\naisle\nalarm\nalbum\nalcohol\nalert\nalien\nall\nalley\nallow\nalmost\nalone\nalpha\nalready\nalso\nalter\nalways\namateur\namazing\namong\namount\namused\nanalyst\nanchor\nancient\nanger\nangle\nangry\nanimal\nankle\nannounce\nannual\nanother\nanswer\nantenna\nantique\nanxiety\nany\napart\napology\nappear\napple\napprove\napril\narch\narctic\narea\narena\nargue\narm\narmed\narmor\narmy\naround\narrange\narrest\narrive\narrow\nart\nartefact\nartist\nartwork\nask\naspect\nassault\nasset\nassist\nassume\nasthma\nathlete\natom\nattack\nattend\nattitude\nattract\nauction\naudit\naugust\naunt\nauthor\nauto\nautumn\naverage\navocado\navoid\nawake\naware\naway\nawesome\nawful\nawkward\naxis\nbaby\nbachelor\nbacon\nbadge\nbag\nbalance\nbalcony\nball\nbamboo\nbanana\nbanner\nbar\nbarely\nbargain\nbarrel\nbase\nbasic\nbasket\nbattle\nbeach\nbean\nbeauty\nbecause\nbecome\nbeef\nbefore\nbegin\nbehave\nbehind\nbelieve\nbelow\nbelt\nbench\nbenefit\nbest\nbetray\nbetter\nbetween\nbeyond\nbicycle\nbid\nbike\nbind\nbiology\nbird\nbirth\nbitter\nblack\nblade\nblame\nblanket\nblast\nbleak\nbless\nblind\nblood\nblossom\nblouse\nblue\nblur\nblush\nboard\nboat\nbody\nboil\nbomb\nbone\nbonus\nbook\nboost\nborder\nboring\nborrow\nboss\nbottom\nbounce\nbox\nboy\nbracket\nbrain\nbrand\nbrass\nbrave\nbread\nbreeze\nbrick\nbridge\nbrief\nbright\nbring\nbrisk\nbroccoli\nbroken\nbronze\nbroom\nbrother\nbrown\nbrush\nbubble\nbuddy\nbudget\nbuffalo\nbuild\nbulb\nbulk\nbullet\nbundle\nbunker\nburden\nburger\nburst\nbus\nbusiness\nbusy\nbutter\nbuyer\nbuzz\ncabbage\ncabin\ncable\ncactus\ncage\ncake\ncall\ncalm\ncamera\ncamp\ncan\ncanal\ncancel\ncandy\ncannon\ncanoe\ncanvas\ncanyon\ncapable\ncapital\ncaptain\ncar\ncarbon\ncard\ncargo\ncarpet\ncarry\ncart\ncase\ncash\ncasino\ncastle\ncasual\ncat\ncatalog\ncatch\ncategory\ncattle\ncaught\ncause\ncaution\ncave\nceiling\ncelery\ncement\ncensus\ncentury\ncereal\ncertain\nchair\nchalk\nchampion\nchange\nchaos\nchapter\ncharge\nchase\nchat\ncheap\ncheck\ncheese\nchef\ncherry\nchest\nchicken\nchief\nchild\nchimney\nchoice\nchoose\nchronic\nchuckle\nchunk\nchurn\ncigar\ncinnamon\ncircle\ncitizen\ncity\ncivil\nclaim\nclap\nclarify\nclaw\nclay\nclean\nclerk\nclever\nclick\nclient\ncliff\nclimb\nclinic\nclip\nclock\nclog\nclose\ncloth\ncloud\nclown\nclub\nclump\ncluster\nclutch\ncoach\ncoast\ncoconut\ncode\ncoffee\ncoil\ncoin\ncollect\ncolor\ncolumn\ncombine\ncome\ncomfort\ncomic\ncommon\ncompany\nconcert\nconduct\nconfirm\ncongress\nconnect\nconsider\ncontrol\nconvince\ncook\ncool\ncopper\ncopy\ncoral\ncore\ncorn\ncorrect\ncost\ncotton\ncouch\ncountry\ncouple\ncourse\ncousin\ncover\ncoyote\ncrack\ncradle\ncraft\ncram\ncrane\ncrash\ncrater\ncrawl\ncrazy\ncream\ncredit\ncreek\ncrew\ncricket\ncrime\ncrisp\ncritic\ncrop\ncross\ncrouch\ncrowd\ncrucial\ncruel\ncruise\ncrumble\ncrunch\ncrush\ncry\ncrystal\ncube\nculture\ncup\ncupboard\ncurious\ncurrent\ncurtain\ncurve\ncushion\ncustom\ncute\ncycle\ndad\ndamage\ndamp\ndance\ndanger\ndaring\ndash\ndaughter\ndawn\nday\ndeal\ndebate\ndebris\ndecade\ndecember\ndecide\ndecline\ndecorate\ndecrease\ndeer\ndefense\ndefine\ndefy\ndegree\ndelay\ndeliver\ndemand\ndemise\ndenial\ndentist\ndeny\ndepart\ndepend\ndeposit\ndepth\ndeputy\nderive\ndescribe\ndesert\ndesign\ndesk\ndespair\ndestroy\ndetail\ndetect\ndevelop\ndevice\ndevote\ndiagram\ndial\ndiamond\ndiary\ndice\ndiesel\ndiet\ndiffer\ndigital\ndignity\ndilemma\ndinner\ndinosaur\ndirect\ndirt\ndisagree\ndiscover\ndisease\ndish\ndismiss\ndisorder\ndisplay\ndistance\ndivert\ndivide\ndivorce\ndizzy\ndoctor\ndocument\ndog\ndoll\ndolphin\ndomain\ndonate\ndonkey\ndonor\ndoor\ndose\ndouble\ndove\ndraft\ndragon\ndrama\ndrastic\ndraw\ndream\ndress\ndrift\ndrill\ndrink\ndrip\ndrive\ndrop\ndrum\ndry\nduck\ndumb\ndune\nduring\ndust\ndutch\nduty\ndwarf\ndynamic\neager\neagle\nearly\nearn\nearth\neasily\neast\neasy\necho\necology\neconomy\nedge\nedit\neducate\neffort\negg\neight\neither\nelbow\nelder\nelectric\nelegant\nelement\nelephant\nelevator\nelite\nelse\nembark\nembody\nembrace\nemerge\nemotion\nemploy\nempower\nempty\nenable\nenact\nend\nendless\nendorse\nenemy\nenergy\nenforce\nengage\nengine\nenhance\nenjoy\nenlist\nenough\nenrich\nenroll\nensure\nenter\nentire\nentry\nenvelope\nepisode\nequal\nequip\nera\nerase\nerode\nerosion\nerror\nerupt\nescape\nessay\nessence\nestate\neternal\nethics\nevidence\nevil\nevoke\nevolve\nexact\nexample\nexcess\nexchange\nexcite\nexclude\nexcuse\nexecute\nexercise\nexhaust\nexhibit\nexile\nexist\nexit\nexotic\nexpand\nexpect\nexpire\nexplain\nexpose\nexpress\nextend\nextra\neye\neyebrow\nfabric\nface\nfaculty\nfade\nfaint\nfaith\nfall\nfalse\nfame\nfamily\nfamous\nfan\nfancy\nfantasy\nfarm\nfashion\nfat\nfatal\nfather\nfatigue\nfault\nfavorite\nfeature\nfebruary\nfederal\nfee\nfeed\nfeel\nfemale\nfence\nfestival\nfetch\nfever\nfew\nfiber\nfiction\nfield\nfigure\nfile\nfilm\nfilter\nfinal\nfind\nfine\nfinger\nfinish\nfire\nfirm\nfirst\nfiscal\nfish\nfit\nfitness\nfix\nflag\nflame\nflash\nflat\nflavor\nflee\nflight\nflip\nfloat\nflock\nfloor\nflower\nfluid\nflush\nfly\nfoam\nfocus\nfog\nfoil\nfold\nfollow\nfood\nfoot\nforce\nforest\nforget\nfork\nfortune\nforum\nforward\nfossil\nfoster\nfound\nfox\nfragile\nframe\nfrequent\nfresh\nfriend\nfringe\nfrog\nfront\nfrost\nfrown\nfrozen\nfruit\nfuel\nfun\nfunny\nfurnace\nfury\nfuture\ngadget\ngain\ngalaxy\ngallery\ngame\ngap\ngarage\ngarbage\ngarden\ngarlic\ngarment\ngas\ngasp\ngate\ngather\ngauge\ngaze\ngeneral\ngenius\ngenre\ngentle\ngenuine\ngesture\nghost\ngiant\ngift\ngiggle\nginger\ngiraffe\ngirl\ngive\nglad\nglance\nglare\nglass\nglide\nglimpse\nglobe\ngloom\nglory\nglove\nglow\nglue\ngoat\ngoddess\ngold\ngood\ngoose\ngorilla\ngospel\ngossip\ngovern\ngown\ngrab\ngrace\ngrain\ngrant\ngrape\ngrass\ngravity\ngreat\ngreen\ngrid\ngrief\ngrit\ngrocery\ngroup\ngrow\ngrunt\nguard\nguess\nguide\nguilt\nguitar\ngun\ngym\nhabit\nhair\nhalf\nhammer\nhamster\nhand\nhappy\nharbor\nhard\nharsh\nharvest\nhat\nhave\nhawk\nhazard\nhead\nhealth\nheart\nheavy\nhedgehog\nheight\nhello\nhelmet\nhelp\nhen\nhero\nhidden\nhigh\nhill\nhint\nhip\nhire\nhistory\nhobby\nhockey\nhold\nhole\nholiday\nhollow\nhome\nhoney\nhood\nhope\nhorn\nhorror\nhorse\nhospital\nhost\nhotel\nhour\nhover\nhub\nhuge\nhuman\nhumble\nhumor\nhundred\nhungry\nhunt\nhurdle\nhurry\nhurt\nhusband\nhybrid\nice\nicon\nidea\nidentify\nidle\nignore\nill\nillegal\nillness\nimage\nimitate\nimmense\nimmune\nimpact\nimpose\nimprove\nimpulse\ninch\ninclude\nincome\nincrease\nindex\nindicate\nindoor\nindustry\ninfant\ninflict\ninform\ninhale\ninherit\ninitial\ninject\ninjury\ninmate\ninner\ninnocent\ninput\ninquiry\ninsane\ninsect\ninside\ninspire\ninstall\nintact\ninterest\ninto\ninvest\ninvite\ninvolve\niron\nisland\nisolate\nissue\nitem\nivory\njacket\njaguar\njar\njazz\njealous\njeans\njelly\njewel\njob\njoin\njoke\njourney\njoy\njudge\njuice\njump\njungle\njunior\njunk\njust\nkangaroo\nkeen\nkeep\nketchup\nkey\nkick\nkid\nkidney\nkind\nkingdom\nkiss\nkit\nkitchen\nkite\nkitten\nkiwi\nknee\nknife\nknock\nknow\nlab\nlabel\nlabor\nladder\nlady\nlake\nlamp\nlanguage\nlaptop\nlarge\nlater\nlatin\nlaugh\nlaundry\nlava\nlaw\nlawn\nlawsuit\nlayer\nlazy\nleader\nleaf\nlearn\nleave\nlecture\nleft\nleg\nlegal\nlegend\nleisure\nlemon\nlend\nlength\nlens\nleopard\nlesson\nletter\nlevel\nliar\nliberty\nlibrary\nlicense\nlife\nlift\nlight\nlike\nlimb\nlimit\nlink\nlion\nliquid\nlist\nlittle\nlive\nlizard\nload\nloan\nlobster\nlocal\nlock\nlogic\nlonely\nlong\nloop\nlottery\nloud\nlounge\nlove\nloyal\nlucky\nluggage\nlumber\nlunar\nlunch\nluxury\nlyrics\nmachine\nmad\nmagic\nmagnet\nmaid\nmail\nmain\nmajor\nmake\nmammal\nman\nmanage\nmandate\nmango\nmansion\nmanual\nmaple\nmarble\nmarch\nmargin\nmarine\nmarket\nmarriage\nmask\nmass\nmaster\nmatch\nmaterial\nmath\nmatrix\nmatter\nmaximum\nmaze\nmeadow\nmean\nmeasure\nmeat\nmechanic\nmedal\nmedia\nmelody\nmelt\nmember\nmemory\nmention\nmenu\nmercy\nmerge\nmerit\nmerry\nmesh\nmessage\nmetal\nmethod\nmiddle\nmidnight\nmilk\nmillion\nmimic\nmind\nminimum\nminor\nminute\nmiracle\nmirror\nmisery\nmiss\nmistake\nmix\nmixed\nmixture\nmobile\nmodel\nmodify\nmom\nmoment\nmonitor\nmonkey\nmonster\nmonth\nmoon\nmoral\nmore\nmorning\nmosquito\nmother\nmotion\nmotor\nmountain\nmouse\nmove\nmovie\nmuch\nmuffin\nmule\nmultiply\nmuscle\nmuseum\nmushroom\nmusic\nmust\nmutual\nmyself\nmystery\nmyth\nnaive\nname\nnapkin\nnarrow\nnasty\nnation\nnature\nnear\nneck\nneed\nnegative\nneglect\nneither\nnephew\nnerve\nnest\nnet\nnetwork\nneutral\nnever\nnews\nnext\nnice\nnight\nnoble\nnoise\nnominee\nnoodle\nnormal\nnorth\nnose\nnotable\nnote\nnothing\nnotice\nnovel\nnow\nnuclear\nnumber\nnurse\nnut\noak\nobey\nobject\noblige\nobscure\nobserve\nobtain\nobvious\noccur\nocean\noctober\nodor\noff\noffer\noffice\noften\noil\nokay\nold\nolive\nolympic\nomit\nonce\none\nonion\nonline\nonly\nopen\nopera\nopinion\noppose\noption\norange\norbit\norchard\norder\nordinary\norgan\norient\noriginal\norphan\nostrich\nother\noutdoor\nouter\noutput\noutside\noval\noven\nover\nown\nowner\noxygen\noyster\nozone\npact\npaddle\npage\npair\npalace\npalm\npanda\npanel\npanic\npanther\npaper\nparade\nparent\npark\nparrot\nparty\npass\npatch\npath\npatient\npatrol\npattern\npause\npave\npayment\npeace\npeanut\npear\npeasant\npelican\npen\npenalty\npencil\npeople\npepper\nperfect\npermit\nperson\npet\nphone\nphoto\nphrase\nphysical\npiano\npicnic\npicture\npiece\npig\npigeon\npill\npilot\npink\npioneer\npipe\npistol\npitch\npizza\nplace\nplanet\nplastic\nplate\nplay\nplease\npledge\npluck\nplug\nplunge\npoem\npoet\npoint\npolar\npole\npolice\npond\npony\npool\npopular\nportion\nposition\npossible\npost\npotato\npottery\npoverty\npowder\npower\npractice\npraise\npredict\nprefer\nprepare\npresent\npretty\nprevent\nprice\npride\nprimary\nprint\npriority\nprison\nprivate\nprize\nproblem\nprocess\nproduce\nprofit\nprogram\nproject\npromote\nproof\nproperty\nprosper\nprotect\nproud\nprovide\npublic\npudding\npull\npulp\npulse\npumpkin\npunch\npupil\npuppy\npurchase\npurity\npurpose\npurse\npush\nput\npuzzle\npyramid\nquality\nquantum\nquarter\nquestion\nquick\nquit\nquiz\nquote\nrabbit\nraccoon\nrace\nrack\nradar\nradio\nrail\nrain\nraise\nrally\nramp\nranch\nrandom\nrange\nrapid\nrare\nrate\nrather\nraven\nraw\nrazor\nready\nreal\nreason\nrebel\nrebuild\nrecall\nreceive\nrecipe\nrecord\nrecycle\nreduce\nreflect\nreform\nrefuse\nregion\nregret\nregular\nreject\nrelax\nrelease\nrelief\nrely\nremain\nremember\nremind\nremove\nrender\nrenew\nrent\nreopen\nrepair\nrepeat\nreplace\nreport\nrequire\nrescue\nresemble\nresist\nresource\nresponse\nresult\nretire\nretreat\nreturn\nreunion\nreveal\nreview\nreward\nrhythm\nrib\nribbon\nrice\nrich\nride\nridge\nrifle\nright\nrigid\nring\nriot\nripple\nrisk\nritual\nrival\nriver\nroad\nroast\nrobot\nrobust\nrocket\nromance\nroof\nrookie\nroom\nrose\nrotate\nrough\nround\nroute\nroyal\nrubber\nrude\nrug\nrule\nrun\nrunway\nrural\nsad\nsaddle\nsadness\nsafe\nsail\nsalad\nsalmon\nsalon\nsalt\nsalute\nsame\nsample\nsand\nsatisfy\nsatoshi\nsauce\nsausage\nsave\nsay\nscale\nscan\nscare\nscatter\nscene\nscheme\nschool\nscience\nscissors\nscorpion\nscout\nscrap\nscreen\nscript\nscrub\nsea\nsearch\nseason\nseat\nsecond\nsecret\nsection\nsecurity\nseed\nseek\nsegment\nselect\nsell\nseminar\nsenior\nsense\nsentence\nseries\nservice\nsession\nsettle\nsetup\nseven\nshadow\nshaft\nshallow\nshare\nshed\nshell\nsheriff\nshield\nshift\nshine\nship\nshiver\nshock\nshoe\nshoot\nshop\nshort\nshoulder\nshove\nshrimp\nshrug\nshuffle\nshy\nsibling\nsick\nside\nsiege\nsight\nsign\nsilent\nsilk\nsilly\nsilver\nsimilar\nsimple\nsince\nsing\nsiren\nsister\nsituate\nsix\nsize\nskate\nsketch\nski\nskill\nskin\nskirt\nskull\nslab\nslam\nsleep\nslender\nslice\nslide\nslight\nslim\nslogan\nslot\nslow\nslush\nsmall\nsmart\nsmile\nsmoke\nsmooth\nsnack\nsnake\nsnap\nsniff\nsnow\nsoap\nsoccer\nsocial\nsock\nsoda\nsoft\nsolar\nsoldier\nsolid\nsolution\nsolve\nsomeone\nsong\nsoon\nsorry\nsort\nsoul\nsound\nsoup\nsource\nsouth\nspace\nspare\nspatial\nspawn\nspeak\nspecial\nspeed\nspell\nspend\nsphere\nspice\nspider\nspike\nspin\nspirit\nsplit\nspoil\nsponsor\nspoon\nsport\nspot\nspray\nspread\nspring\nspy\nsquare\nsqueeze\nsquirrel\nstable\nstadium\nstaff\nstage\nstairs\nstamp\nstand\nstart\nstate\nstay\nsteak\nsteel\nstem\nstep\nstereo\nstick\nstill\nsting\nstock\nstomach\nstone\nstool\nstory\nstove\nstrategy\nstreet\nstrike\nstrong\nstruggle\nstudent\nstuff\nstumble\nstyle\nsubject\nsubmit\nsubway\nsuccess\nsuch\nsudden\nsuffer\nsugar\nsuggest\nsuit\nsummer\nsun\nsunny\nsunset\nsuper\nsupply\nsupreme\nsure\nsurface\nsurge\nsurprise\nsurround\nsurvey\nsuspect\nsustain\nswallow\nswamp\nswap\nswarm\nswear\nsweet\nswift\nswim\nswing\nswitch\nsword\nsymbol\nsymptom\nsyrup\nsystem\ntable\ntackle\ntag\ntail\ntalent\ntalk\ntank\ntape\ntarget\ntask\ntaste\ntattoo\ntaxi\nteach\nteam\ntell\nten\ntenant\ntennis\ntent\nterm\ntest\ntext\nthank\nthat\ntheme\nthen\ntheory\nthere\nthey\nthing\nthis\nthought\nthree\nthrive\nthrow\nthumb\nthunder\nticket\ntide\ntiger\ntilt\ntimber\ntime\ntiny\ntip\ntired\ntissue\ntitle\ntoast\ntobacco\ntoday\ntoddler\ntoe\ntogether\ntoilet\ntoken\ntomato\ntomorrow\ntone\ntongue\ntonight\ntool\ntooth\ntop\ntopic\ntopple\ntorch\ntornado\ntortoise\ntoss\ntotal\ntourist\ntoward\ntower\ntown\ntoy\ntrack\ntrade\ntraffic\ntragic\ntrain\ntransfer\ntrap\ntrash\ntravel\ntray\ntreat\ntree\ntrend\ntrial\ntribe\ntrick\ntrigger\ntrim\ntrip\ntrophy\ntrouble\ntruck\ntrue\ntruly\ntrumpet\ntrust\ntruth\ntry\ntube\ntuition\ntumble\ntuna\ntunnel\nturkey\nturn\nturtle\ntwelve\ntwenty\ntwice\ntwin\ntwist\ntwo\ntype\ntypical\nugly\numbrella\nunable\nunaware\nuncle\nuncover\nunder\nundo\nunfair\nunfold\nunhappy\nuniform\nunique\nunit\nuniverse\nunknown\nunlock\nuntil\nunusual\nunveil\nupdate\nupgrade\nuphold\nupon\nupper\nupset\nurban\nurge\nusage\nuse\nused\nuseful\nuseless\nusual\nutility\nvacant\nvacuum\nvague\nvalid\nvalley\nvalve\nvan\nvanish\nvapor\nvarious\nvast\nvault\nvehicle\nvelvet\nvendor\nventure\nvenue\nverb\nverify\nversion\nvery\nvessel\nveteran\nviable\nvibrant\nvicious\nvictory\nvideo\nview\nvillage\nvintage\nviolin\nvirtual\nvirus\nvisa\nvisit\nvisual\nvital\nvivid\nvocal\nvoice\nvoid\nvolcano\nvolume\nvote\nvoyage\nwage\nwagon\nwait\nwalk\nwall\nwalnut\nwant\nwarfare\nwarm\nwarrior\nwash\nwasp\nwaste\nwater\nwave\nway\nwealth\nweapon\nwear\nweasel\nweather\nweb\nwedding\nweekend\nweird\nwelcome\nwest\nwet\nwhale\nwhat\nwheat\nwheel\nwhen\nwhere\nwhip\nwhisper\nwide\nwidth\nwife\nwild\nwill\nwin\nwindow\nwine\nwing\nwink\nwinner\nwinter\nwire\nwisdom\nwise\nwish\nwitness\nwolf\nwoman\nwonder\nwood\nwool\nword\nwork\nworld\nworry\nworth\nwrap\nwreck\nwrestle\nwrist\nwrite\nwrong\nyard\nyear\nyellow\nyou\nyoung\nyouth\nzebra\nzero\nzone\nzoo`.split('\\n');\n","/**\n * BIP-39 mnemonic encoding/decoding using @scure/bip39\n *\n * Used to encode Share C as a human-readable recovery phrase.\n *\n * Security:\n * - Uses the official BIP-39 English wordlist\n * - 12 words = 128 bits of entropy (16 bytes)\n * - Matches standard Solana wallet format (Phantom, Solflare, etc.)\n * - Includes checksum for error detection\n */\n\nimport {\n  generateMnemonic,\n  mnemonicToEntropy,\n  entropyToMnemonic,\n  validateMnemonic,\n} from '@scure/bip39';\nimport { wordlist } from '@scure/bip39/wordlists/english';\nimport type { Seed, ShamirShare } from './types';\nimport { toSeed, toShamirShare } from './types';\n\n/** Number of words in recovery phrase (12 = 128 bits, standard Solana format) */\nexport const MNEMONIC_WORD_COUNT = 12;\n\n/**\n * Encode a Shamir share as a BIP-39 mnemonic phrase.\n *\n * S-9: Only accepts 16-byte shares (raw entropy without secrets.js metadata).\n * The `ShamirShare` brand type also accepts >16-byte shares with metadata,\n * but those cannot be encoded as mnemonics  the runtime check enforces this.\n *\n * @param share - 16-byte share to encode (raw entropy only)\n * @returns Array of 12 mnemonic words\n * @throws Error if share is not exactly 16 bytes\n */\nexport function shareToMnemonic(share: ShamirShare): string[] {\n  if (share.length !== 16) {\n    throw new Error(`Invalid share length: expected 16, got ${share.length}`);\n  }\n\n  // entropyToMnemonic expects Uint8Array\n  const mnemonic = entropyToMnemonic(share, wordlist);\n  const words = mnemonic.split(' ');\n\n  if (words.length !== MNEMONIC_WORD_COUNT) {\n    throw new Error(`Unexpected word count: expected ${MNEMONIC_WORD_COUNT}, got ${words.length}`);\n  }\n\n  return words;\n}\n\n/**\n * Decode a BIP-39 mnemonic phrase back to a Shamir share\n *\n * @param words - Array of 12 mnemonic words\n * @returns 16-byte share\n * @throws Error if mnemonic is invalid\n */\nexport function mnemonicToShare(words: string[]): ShamirShare {\n  if (words.length !== MNEMONIC_WORD_COUNT) {\n    throw new Error(`Invalid word count: expected ${MNEMONIC_WORD_COUNT}, got ${words.length}`);\n  }\n\n  const mnemonic = words.join(' ').toLowerCase().trim();\n\n  // Validate mnemonic checksum\n  if (!validateMnemonic(mnemonic, wordlist)) {\n    throw new Error('Invalid recovery phrase: checksum mismatch');\n  }\n\n  // Convert back to entropy (our share)\n  const entropy = mnemonicToEntropy(mnemonic, wordlist);\n\n  if (entropy.length !== 16) {\n    throw new Error(`Invalid entropy length: expected 16, got ${entropy.length}`);\n  }\n\n  return toShamirShare(entropy);\n}\n\n/**\n * Encode a 16-byte seed as a BIP-39 mnemonic phrase\n *\n * This is used for the recovery phrase which encodes the FULL SEED\n * (not a Shamir share) to allow complete wallet recovery.\n *\n * @param seed - 16-byte seed to encode\n * @returns Array of 12 mnemonic words\n */\nexport function seedToMnemonic(seed: Seed): string[] {\n  if (seed.length !== 16) {\n    throw new Error(`Invalid seed length: expected 16, got ${seed.length}`);\n  }\n\n  const mnemonic = entropyToMnemonic(seed, wordlist);\n  const words = mnemonic.split(' ');\n\n  if (words.length !== MNEMONIC_WORD_COUNT) {\n    throw new Error(`Unexpected word count: expected ${MNEMONIC_WORD_COUNT}, got ${words.length}`);\n  }\n\n  return words;\n}\n\n/**\n * Decode a BIP-39 mnemonic phrase back to a seed\n *\n * This is used during recovery to restore the full wallet seed.\n *\n * @param words - Array of 12 mnemonic words\n * @returns 16-byte seed\n * @throws Error if mnemonic is invalid\n */\nexport function mnemonicToSeed(words: string[]): Seed {\n  if (words.length !== MNEMONIC_WORD_COUNT) {\n    throw new Error(`Invalid word count: expected ${MNEMONIC_WORD_COUNT}, got ${words.length}`);\n  }\n\n  const mnemonic = words.join(' ').toLowerCase().trim();\n\n  if (!validateMnemonic(mnemonic, wordlist)) {\n    throw new Error('Invalid recovery phrase: checksum mismatch');\n  }\n\n  const entropy = mnemonicToEntropy(mnemonic, wordlist);\n\n  if (entropy.length !== 16) {\n    throw new Error(`Invalid entropy length: expected 16, got ${entropy.length}`);\n  }\n\n  return toSeed(entropy);\n}\n\n/**\n * Validate a mnemonic phrase without decoding\n *\n * @param words - Array of words to validate\n * @returns true if valid BIP-39 mnemonic\n */\nexport function isValidMnemonic(words: string[]): boolean {\n  if (words.length !== MNEMONIC_WORD_COUNT) {\n    return false;\n  }\n\n  const mnemonic = words.join(' ').toLowerCase().trim();\n  return validateMnemonic(mnemonic, wordlist);\n}\n\n/**\n * Check if a single word is in the BIP-39 wordlist\n *\n * @param word - Word to check\n * @returns true if word is in the wordlist\n */\nexport function isValidWord(word: string): boolean {\n  return wordlist.includes(word.toLowerCase().trim());\n}\n\n/**\n * Get word suggestions for autocomplete\n *\n * @param prefix - Partial word input\n * @param limit - Maximum number of suggestions\n * @returns Array of matching words from wordlist\n */\nexport function getWordSuggestions(prefix: string, limit: number = 5): string[] {\n  const normalizedPrefix = prefix.toLowerCase().trim();\n\n  if (normalizedPrefix.length === 0) {\n    return [];\n  }\n\n  return wordlist.filter((word) => word.startsWith(normalizedPrefix)).slice(0, limit);\n}\n\n/**\n * Generate a random mnemonic for testing purposes\n *\n * WARNING: Do not use this for actual wallet generation.\n * Use the proper enrollment flow which generates a seed and splits it.\n *\n * @returns Array of 12 random words\n */\nexport function generateRandomMnemonic(): string[] {\n  const mnemonic = generateMnemonic(wordlist, 128);\n  return mnemonic.split(' ');\n}\n\n/**\n * Format mnemonic words for display (groups of 4)\n *\n * @param words - Array of mnemonic words\n * @returns Array of word groups\n */\nexport function formatMnemonicForDisplay(words: string[]): string[][] {\n  const groups: string[][] = [];\n  for (let i = 0; i < words.length; i += 4) {\n    groups.push(words.slice(i, i + 4));\n  }\n  return groups;\n}\n\n/**\n * Parse user input into word array, handling various formats\n *\n * @param input - User input (space/comma/newline separated)\n * @returns Array of normalized words\n */\nexport function parseMnemonicInput(input: string): string[] {\n  return input\n    .toLowerCase()\n    .replace(/[,\\n\\r\\t]+/g, ' ') // Replace separators with space\n    .split(/\\s+/) // Split on whitespace\n    .map((w) => w.trim())\n    .filter((w) => w.length > 0);\n}\n\n/**\n * Clear all references held in the mnemonic words array.\n *\n * @security UI-04 / CRYPTO-2: JavaScript strings are immutable values; this\n * function CANNOT overwrite the underlying string data in memory. The original\n * word strings will remain in the JS heap until the garbage collector reclaims\n * them. What this function DOES do is drop every element reference from the\n * array so the array itself no longer keeps those strings alive, which may\n * allow earlier GC. Do NOT rely on this as a guarantee of secure erasure.\n *\n * @param words - Mnemonic word array to clear\n */\nexport function clearMnemonicReferences(words: string[]): void {\n  // Drop each element reference (best-effort  see UI-04 / CRYPTO-2)\n  for (let i = 0; i < words.length; i++) {\n    words[i] = '';\n  }\n  words.length = 0;\n}\n\n/**\n * Get the BIP-39 wordlist for UI purposes (e.g., validation indicators)\n *\n * @returns Copy of the wordlist\n */\nexport function getWordlist(): readonly string[] {\n  return wordlist;\n}\n\n/**\n * Calculate the index of a word in the wordlist\n *\n * @param word - Word to look up\n * @returns Index (0-2047) or -1 if not found\n */\nexport function getWordIndex(word: string): number {\n  return wordlist.indexOf(word.toLowerCase().trim());\n}\n","import { useState, useCallback, useRef, useEffect, useMemo } from 'react';\nimport { useAuth } from '../hooks/useAuth';\nimport { LoadingSpinner } from './shared/LoadingSpinner';\nimport { sanitizeImageUrl } from '../utils/sanitization';\n\nexport interface MenuItemConfig {\n  /** Label to display */\n  label: string;\n  /** Click handler */\n  onClick: () => void;\n  /** Optional icon element */\n  icon?: React.ReactNode;\n}\n\nexport interface LoginButtonProps {\n  className?: string;\n  variant?: 'default' | 'outline' | 'ghost';\n  size?: 'sm' | 'md' | 'lg';\n  children?: React.ReactNode;\n  /** Custom menu items to show above \"Sign out\" */\n  menuItems?: MenuItemConfig[];\n  /** Hide the default \"Sign out\" item (default: false) */\n  hideSignOut?: boolean;\n}\n\n/**\n * Login button that opens the login modal when clicked.\n * Shows user info when authenticated.\n */\nexport function LoginButton({\n  className = '',\n  variant = 'default',\n  size = 'md',\n  children,\n  menuItems = [],\n  hideSignOut = false,\n}: LoginButtonProps) {\n  const { user, isAuthenticated, isLoading, openLoginModal, logout } = useAuth();\n  // L-08: State for keyboard-accessible dropdown\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\n  const [focusedIndex, setFocusedIndex] = useState(-1);\n  const menuRef = useRef<HTMLDivElement>(null);\n  const buttonRef = useRef<HTMLButtonElement>(null);\n\n  // Build list of all menu items (custom items + sign out)\n  // Memoize to avoid recreating array on every render (fixes react-hooks/exhaustive-deps warning)\n  const allMenuItems = useMemo(\n    () => [...menuItems, ...(hideSignOut ? [] : [{ label: 'Sign out', onClick: logout }])],\n    [menuItems, hideSignOut, logout]\n  );\n\n  // L-08: Close menu on outside click or Escape\n  useEffect(() => {\n    if (!isMenuOpen) return;\n\n    const handleClickOutside = (e: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(e.target as Node)) {\n        setIsMenuOpen(false);\n        setFocusedIndex(-1);\n      }\n    };\n\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        setIsMenuOpen(false);\n        setFocusedIndex(-1);\n        buttonRef.current?.focus();\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    document.addEventListener('keydown', handleEscape);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n      document.removeEventListener('keydown', handleEscape);\n    };\n  }, [isMenuOpen]);\n\n  // L-08: Keyboard navigation for menu\n  const handleMenuKeyDown = useCallback(\n    (e: React.KeyboardEvent) => {\n      if (!isMenuOpen || allMenuItems.length === 0) return;\n\n      switch (e.key) {\n        case 'ArrowDown':\n          e.preventDefault();\n          setFocusedIndex((i) => (i + 1) % allMenuItems.length);\n          break;\n        case 'ArrowUp':\n          e.preventDefault();\n          setFocusedIndex((i) => (i - 1 + allMenuItems.length) % allMenuItems.length);\n          break;\n        case 'Home':\n          e.preventDefault();\n          setFocusedIndex(0);\n          break;\n        case 'End':\n          e.preventDefault();\n          setFocusedIndex(allMenuItems.length - 1);\n          break;\n        case 'Enter':\n        case ' ':\n          if (focusedIndex >= 0) {\n            e.preventDefault();\n            allMenuItems[focusedIndex].onClick();\n            setIsMenuOpen(false);\n            setFocusedIndex(-1);\n          }\n          break;\n      }\n    },\n    [isMenuOpen, focusedIndex, allMenuItems]\n  );\n\n  const toggleMenu = useCallback(() => {\n    if (allMenuItems.length === 0) return;\n    setIsMenuOpen((open) => !open);\n    setFocusedIndex(-1);\n  }, [allMenuItems.length]);\n\n  const sizeClasses = {\n    sm: 'cedros-button-sm',\n    md: 'cedros-button-md',\n    lg: 'cedros-button-lg',\n  };\n\n  const variantClasses = {\n    default: 'cedros-button-primary',\n    outline: 'cedros-button-outline',\n    ghost: 'cedros-button-ghost',\n  };\n\n  if (isLoading) {\n    return (\n      <button\n        type=\"button\"\n        className={`cedros-button ${variantClasses[variant]} ${sizeClasses[size]} ${className}`}\n        disabled\n      >\n        <LoadingSpinner size=\"sm\" />\n      </button>\n    );\n  }\n\n  if (isAuthenticated && user) {\n    const displayName = user.name || user.email || 'User';\n    // COMP-07: Cache sanitized URL to avoid double-call and ensure consistent validation\n    const sanitizedPicture = sanitizeImageUrl(user.picture);\n    return (\n      // L-08: Added keyboard handler and ref for accessibility\n      <div className=\"cedros-user-menu\" ref={menuRef} onKeyDown={handleMenuKeyDown}>\n        {/* M-13: Added ARIA attributes for accessibility */}\n        <button\n          ref={buttonRef}\n          type=\"button\"\n          className={`cedros-button cedros-user-button ${sizeClasses[size]} ${className}`}\n          aria-haspopup=\"menu\"\n          aria-expanded={isMenuOpen}\n          aria-label={`User menu for ${displayName}`}\n          onClick={toggleMenu}\n        >\n          {sanitizedPicture ? (\n            <img\n              src={sanitizedPicture}\n              alt={displayName}\n              className=\"cedros-user-avatar\"\n              referrerPolicy=\"no-referrer\"\n              crossOrigin=\"anonymous\"\n            />\n          ) : (\n            <div className=\"cedros-user-avatar-placeholder\">\n              {(displayName[0] || '?').toUpperCase()}\n            </div>\n          )}\n          <span className=\"cedros-user-name\">{displayName}</span>\n        </button>\n        {/* M-13: Added role=\"menu\" for ARIA menu pattern */}\n        {/* L-08: Show/hide controlled by state, keyboard navigable */}\n        {isMenuOpen && (\n          <div className=\"cedros-dropdown cedros-dropdown-open\" role=\"menu\">\n            {menuItems.map((item, index) => (\n              <button\n                key={index}\n                type=\"button\"\n                className={`cedros-dropdown-item ${focusedIndex === index ? 'cedros-dropdown-item-focused' : ''}`}\n                role=\"menuitem\"\n                tabIndex={focusedIndex === index ? 0 : -1}\n                onClick={() => {\n                  item.onClick();\n                  setIsMenuOpen(false);\n                }}\n              >\n                {item.icon && <span className=\"cedros-dropdown-icon\">{item.icon}</span>}\n                {item.label}\n              </button>\n            ))}\n            {menuItems.length > 0 && !hideSignOut && (\n              <div className=\"cedros-dropdown-divider\" role=\"separator\" />\n            )}\n            {!hideSignOut && (\n              <button\n                type=\"button\"\n                className={`cedros-dropdown-item cedros-dropdown-item-danger ${focusedIndex === menuItems.length ? 'cedros-dropdown-item-focused' : ''}`}\n                role=\"menuitem\"\n                tabIndex={focusedIndex === menuItems.length ? 0 : -1}\n                onClick={() => {\n                  logout();\n                  setIsMenuOpen(false);\n                }}\n              >\n                Sign out\n              </button>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <button\n      type=\"button\"\n      className={`cedros-button ${variantClasses[variant]} ${sizeClasses[size]} ${className}`}\n      onClick={openLoginModal}\n    >\n      {children || 'Sign in'}\n    </button>\n  );\n}\n","import { useState, useCallback, useMemo } from 'react';\nimport { useCedrosLogin } from '../context/useCedrosLogin';\nimport { validateEmail } from '../utils/validation';\nimport { useRateLimiter } from './useRateLimiter';\nimport { ApiClient, handleApiError } from '../utils/apiClient';\nimport type { AuthError } from '../types';\n\nexport interface UsePasswordResetReturn {\n  forgotPassword: (email: string) => Promise<void>;\n  resetPassword: (token: string, newPassword: string) => Promise<void>;\n  isLoading: boolean;\n  isSuccess: boolean;\n  error: AuthError | null;\n  clearError: () => void;\n  reset: () => void;\n  /** Number of remaining attempts before rate limiting */\n  remainingAttempts: number;\n}\n\n/**\n * Hook for password reset functionality.\n *\n * @example\n * ```tsx\n * function ForgotPasswordForm() {\n *   const { forgotPassword, isLoading, isSuccess, error } = usePasswordReset();\n *\n *   const handleSubmit = async (e) => {\n *     e.preventDefault();\n *     await forgotPassword(email);\n *   };\n *\n *   if (isSuccess) {\n *     return <p>Check your email for reset instructions</p>;\n *   }\n * }\n * ```\n */\nexport function usePasswordReset(): UsePasswordResetReturn {\n  const { config } = useCedrosLogin();\n  const [isLoading, setIsLoading] = useState(false);\n  const [isSuccess, setIsSuccess] = useState(false);\n  const [error, setError] = useState<AuthError | null>(null);\n\n  // M-08: Use ApiClient for consistent error handling and timeout/retry\n  const apiClient = useMemo(\n    () =>\n      new ApiClient({\n        baseUrl: config.serverUrl,\n        timeoutMs: config.requestTimeout,\n        retryAttempts: config.retryAttempts,\n      }),\n    [config.serverUrl, config.requestTimeout, config.retryAttempts]\n  );\n\n  // Rate limiter for password reset attempts (3 attempts per 5 minutes)\n  const { checkLimit, getRemainingAttempts } = useRateLimiter({\n    maxAttempts: 3,\n    windowMs: 300000,\n  });\n\n  const forgotPassword = useCallback(\n    async (email: string): Promise<void> => {\n      // Validate email format before API call\n      if (!validateEmail(email)) {\n        const validationError: AuthError = {\n          code: 'VALIDATION_ERROR',\n          message: 'Please enter a valid email address',\n        };\n        setError(validationError);\n        throw validationError;\n      }\n\n      // Check rate limit before API call\n      try {\n        checkLimit();\n      } catch (err) {\n        const rateLimitError: AuthError = {\n          code: 'RATE_LIMITED',\n          message: err instanceof Error ? err.message : 'Too many attempts',\n        };\n        setError(rateLimitError);\n        throw rateLimitError;\n      }\n\n      setIsLoading(true);\n      setError(null);\n      setIsSuccess(false);\n\n      try {\n        // M-08: Use ApiClient for consistent error handling\n        await apiClient.post('/forgot-password', { email });\n        setIsSuccess(true);\n      } catch (err) {\n        const authError = handleApiError(err, 'Failed to send reset email');\n        setError(authError);\n        throw authError;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [apiClient, checkLimit]\n  );\n\n  const resetPassword = useCallback(\n    async (token: string, newPassword: string): Promise<void> => {\n      setIsLoading(true);\n      setError(null);\n      setIsSuccess(false);\n\n      try {\n        // M-08: Use ApiClient for consistent error handling\n        await apiClient.post('/reset-password', { token, newPassword });\n        setIsSuccess(true);\n      } catch (err) {\n        const authError = handleApiError(err, 'Failed to reset password');\n        setError(authError);\n        throw authError;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [apiClient]\n  );\n\n  const clearError = useCallback(() => setError(null), []);\n\n  const reset = useCallback(() => {\n    setError(null);\n    setIsSuccess(false);\n    setIsLoading(false);\n  }, []);\n\n  return {\n    forgotPassword,\n    resetPassword,\n    isLoading,\n    isSuccess,\n    error,\n    clearError,\n    reset,\n    remainingAttempts: getRemainingAttempts(),\n  };\n}\n","import { useState, useId, type FormEvent } from 'react';\nimport { usePasswordReset } from '../../hooks/usePasswordReset';\nimport { ErrorMessage } from '../shared/ErrorMessage';\nimport { LoadingSpinner } from '../shared/LoadingSpinner';\n\nexport interface ForgotPasswordFormProps {\n  onSuccess?: () => void;\n  onCancel?: () => void;\n  className?: string;\n}\n\n/**\n * Form for requesting a password reset email.\n *\n * @example\n * ```tsx\n * <ForgotPasswordForm\n *   onSuccess={() => console.log('Email sent!')}\n *   onCancel={() => setShowForgotPassword(false)}\n * />\n * ```\n */\nexport function ForgotPasswordForm({\n  onSuccess,\n  onCancel,\n  className = '',\n}: ForgotPasswordFormProps) {\n  const [email, setEmail] = useState('');\n  const { forgotPassword, isLoading, isSuccess, error, clearError } = usePasswordReset();\n  const emailId = useId();\n\n  const handleSubmit = async (e: FormEvent) => {\n    e.preventDefault();\n    try {\n      await forgotPassword(email);\n      onSuccess?.();\n    } catch {\n      // Error is already set in the hook\n    }\n  };\n\n  if (isSuccess) {\n    return (\n      <div className={`cedros-forgot-password-success ${className}`}>\n        <svg\n          className=\"cedros-success-icon\"\n          width=\"48\"\n          height=\"48\"\n          viewBox=\"0 0 48 48\"\n          fill=\"none\"\n          aria-hidden=\"true\"\n        >\n          <circle cx=\"24\" cy=\"24\" r=\"22\" stroke=\"currentColor\" strokeWidth=\"2\" />\n          <path\n            d=\"M14 24l7 7 13-13\"\n            stroke=\"currentColor\"\n            strokeWidth=\"2\"\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n          />\n        </svg>\n        <h3 className=\"cedros-success-title\">Check your email</h3>\n        <p className=\"cedros-success-message\">\n          If an account exists for <strong>{email}</strong>, you will receive a password reset link\n          shortly.\n        </p>\n        {onCancel && (\n          <button\n            type=\"button\"\n            className=\"cedros-button cedros-button-md cedros-button-outline\"\n            onClick={onCancel}\n          >\n            Back to login\n          </button>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <form className={`cedros-forgot-password-form ${className}`} onSubmit={handleSubmit}>\n      <div className=\"cedros-form-header\">\n        <h3 className=\"cedros-form-title\">Forgot password?</h3>\n        <p className=\"cedros-form-subtitle\">\n          Enter your email address and we&apos;ll send you a link to reset your password.\n        </p>\n      </div>\n\n      <ErrorMessage error={error} onDismiss={clearError} />\n\n      <div className=\"cedros-form-field\">\n        <label htmlFor={emailId} className=\"cedros-label\">\n          Email address\n        </label>\n        <input\n          id={emailId}\n          type=\"email\"\n          className=\"cedros-input\"\n          value={email}\n          onChange={(e) => setEmail(e.target.value)}\n          placeholder=\"you@example.com\"\n          required\n          autoComplete=\"email\"\n          disabled={isLoading}\n        />\n      </div>\n\n      <div className=\"cedros-form-actions\">\n        <button\n          type=\"submit\"\n          className=\"cedros-button cedros-button-md cedros-button-primary cedros-button-full\"\n          disabled={isLoading || !email}\n        >\n          {isLoading ? (\n            <>\n              <LoadingSpinner size=\"sm\" />\n              Sending...\n            </>\n          ) : (\n            'Send reset link'\n          )}\n        </button>\n\n        {onCancel && (\n          <button\n            type=\"button\"\n            className=\"cedros-button cedros-button-md cedros-button-ghost cedros-button-full\"\n            onClick={onCancel}\n            disabled={isLoading}\n          >\n            Back to login\n          </button>\n        )}\n      </div>\n    </form>\n  );\n}\n","import { useState, useCallback, useEffect, useRef, useMemo } from 'react';\nimport { useCedrosLogin } from '../context/useCedrosLogin';\nimport { ApiClient, handleApiError } from '../utils/apiClient';\nimport type { AuthResponse, AuthError } from '../types';\n\n// Module-level singleton for Apple Sign In script loading\n// Prevents race conditions when multiple components mount simultaneously\nconst scriptLoader = {\n  loading: false,\n  loaded: false,\n  error: null as Error | null,\n  callbacks: [] as Array<{ resolve: () => void; reject: (err: Error) => void }>,\n\n  load(): Promise<void> {\n    // UI-15: SSR guard  avoid touching browser globals in Node/SSR environments\n    if (typeof window === 'undefined' || typeof document === 'undefined') {\n      return Promise.reject(new Error('Apple Sign-In script loader cannot run in SSR'));\n    }\n\n    if (this.loaded) {\n      return Promise.resolve();\n    }\n\n    if (this.loading) {\n      return new Promise((resolve, reject) => {\n        this.callbacks.push({ resolve, reject });\n      });\n    }\n\n    this.loading = true;\n    return new Promise((resolve, reject) => {\n      this.callbacks.push({ resolve, reject });\n\n      const existingScript = document.getElementById('apple-signin-script');\n      if (existingScript) {\n        if (window.AppleID) {\n          this.loaded = true;\n          this.loading = false;\n          this.callbacks.forEach((cb) => cb.resolve());\n          this.callbacks = [];\n        } else {\n          existingScript.addEventListener('load', () => {\n            this.loaded = true;\n            this.loading = false;\n            this.callbacks.forEach((cb) => cb.resolve());\n            this.callbacks = [];\n          });\n        }\n        return;\n      }\n\n      const script = document.createElement('script');\n      script.src =\n        'https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js';\n      script.async = true;\n      script.defer = true;\n      script.id = 'apple-signin-script';\n\n      script.onload = () => {\n        this.loaded = true;\n        this.loading = false;\n        this.callbacks.forEach((cb) => cb.resolve());\n        this.callbacks = [];\n      };\n\n      script.onerror = () => {\n        this.loading = false;\n        // M-03: Remove failed script from DOM to allow retry on next load() call.\n        // Without removal, retry finds existingScript and waits for a load event\n        // that will never fire on an already-failed script.\n        script.remove();\n        const error = new Error('Failed to load Apple Sign In script');\n        this.callbacks.forEach((cb) => cb.reject(error));\n        this.callbacks = [];\n      };\n\n      document.head.appendChild(script);\n    });\n  },\n\n  /**\n   * Reset singleton state for test isolation\n   * @internal - Only use in test setup/teardown\n   */\n  _reset(): void {\n    this.loading = false;\n    this.loaded = false;\n    this.error = null;\n    this.callbacks = [];\n  },\n};\n\nexport interface UseAppleAuthReturn {\n  signIn: () => Promise<AuthResponse>;\n  isLoading: boolean;\n  isInitialized: boolean;\n  error: AuthError | null;\n  clearError: () => void;\n}\n\n/**\n * Hook for Apple Sign In authentication.\n *\n * @example\n * ```tsx\n * function AppleButton() {\n *   const { signIn, isLoading, isInitialized, error } = useAppleAuth();\n *\n *   return (\n *     <button onClick={signIn} disabled={!isInitialized || isLoading}>\n *       {isLoading ? 'Signing in...' : 'Sign in with Apple'}\n *     </button>\n *   );\n * }\n * ```\n */\nexport function useAppleAuth(): UseAppleAuthReturn {\n  const { config, _internal } = useCedrosLogin();\n  const [isLoading, setIsLoading] = useState(false);\n  const [isInitialized, setIsInitialized] = useState(false);\n  const [error, setError] = useState<AuthError | null>(null);\n\n  const configRef = useRef(config);\n\n  const apiClient = useMemo(\n    () =>\n      new ApiClient({\n        baseUrl: config.serverUrl,\n        timeoutMs: config.requestTimeout,\n        retryAttempts: config.retryAttempts,\n      }),\n    [config.serverUrl, config.requestTimeout, config.retryAttempts]\n  );\n\n  useEffect(() => {\n    configRef.current = config;\n  }, [config]);\n\n  // Initialize Apple Sign In SDK\n  useEffect(() => {\n    if (!config.appleClientId) {\n      return;\n    }\n\n    let isMounted = true;\n\n    const initializeAppleSignIn = () => {\n      if (!isMounted) return;\n\n      try {\n        window.AppleID?.auth?.init({\n          clientId: config.appleClientId!,\n          scope: 'name email',\n          redirectURI: window.location.origin,\n          usePopup: true,\n        });\n\n        if (isMounted) {\n          setIsInitialized(true);\n        }\n      } catch {\n        if (isMounted) {\n          setError({\n            code: 'SERVER_ERROR',\n            message: 'Failed to initialize Apple Sign In',\n          });\n        }\n      }\n    };\n\n    scriptLoader\n      .load()\n      .then(() => {\n        if (isMounted) {\n          initializeAppleSignIn();\n        }\n      })\n      .catch(() => {\n        if (isMounted) {\n          setError({\n            code: 'SERVER_ERROR',\n            message: 'Failed to load Apple Sign In',\n          });\n        }\n      });\n\n    return () => {\n      isMounted = false;\n    };\n  }, [config.appleClientId]);\n\n  const signIn = useCallback(async (): Promise<AuthResponse> => {\n    if (!config.appleClientId) {\n      const err: AuthError = {\n        code: 'VALIDATION_ERROR',\n        message: 'Apple Client ID not configured',\n      };\n      setError(err);\n      throw err;\n    }\n\n    if (!isInitialized) {\n      const err: AuthError = {\n        code: 'VALIDATION_ERROR',\n        message: 'Apple Sign In not initialized',\n      };\n      setError(err);\n      throw err;\n    }\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      // Trigger Apple Sign In popup\n      const response = await window.AppleID!.auth!.signIn();\n\n      // Apple returns authorization with id_token\n      const idToken = response.authorization?.id_token;\n      if (!idToken) {\n        throw new Error('No ID token received from Apple');\n      }\n\n      // Apple only provides user info on first sign-in\n      // The name comes from response.user (if available)\n      const userName = response.user?.name\n        ? `${response.user.name.firstName || ''} ${response.user.name.lastName || ''}`.trim()\n        : undefined;\n\n      // Send to our backend\n      const data = await apiClient.post<AuthResponse>('/apple', {\n        idToken,\n        name: userName || undefined,\n      });\n\n      configRef.current.callbacks?.onLoginSuccess?.(data.user, 'apple');\n      _internal?.handleLoginSuccess(data.user, data.tokens);\n      setIsLoading(false);\n      return data;\n    } catch (err) {\n      // Check if user cancelled\n      const appleError = err as { error?: string };\n      if (appleError.error === 'popup_closed_by_user') {\n        const authError: AuthError = {\n          code: 'SERVER_ERROR',\n          message: 'Apple Sign In was cancelled',\n        };\n        setError(authError);\n        setIsLoading(false);\n        throw authError;\n      }\n\n      const authError = handleApiError(err, 'Apple sign-in failed');\n      setError(authError);\n      setIsLoading(false);\n      throw authError;\n    }\n  }, [config.appleClientId, isInitialized, apiClient, _internal]);\n\n  const clearError = useCallback(() => setError(null), []);\n\n  return {\n    signIn,\n    isLoading,\n    isInitialized,\n    error,\n    clearError,\n  };\n}\n\n// Type declaration for Apple Sign In JS SDK\ndeclare global {\n  interface Window {\n    AppleID?: {\n      auth?: {\n        init: (config: {\n          clientId: string;\n          scope: string;\n          redirectURI: string;\n          usePopup?: boolean;\n        }) => void;\n        signIn: () => Promise<{\n          authorization?: {\n            id_token?: string;\n            code?: string;\n          };\n          user?: {\n            email?: string;\n            name?: {\n              firstName?: string;\n              lastName?: string;\n            };\n          };\n        }>;\n      };\n    };\n  }\n}\n","/**\n * Device detection utilities\n */\n\n/**\n * Detects if the current device is an Apple device (macOS, iOS, iPadOS).\n * Apple Sign In is most useful on Apple devices where users have Apple ID readily available.\n *\n * @returns true if running on an Apple device\n *\n * @example\n * ```tsx\n * if (isAppleDevice()) {\n *   // Show Apple Sign In button\n * }\n * ```\n */\nexport function isAppleDevice(): boolean {\n  if (typeof window === 'undefined' || typeof navigator === 'undefined') {\n    return false;\n  }\n\n  const userAgent = navigator.userAgent.toLowerCase();\n  const platform = (navigator.platform || '').toLowerCase();\n\n  // Check for iOS devices (iPhone, iPad, iPod)\n  if (/iphone|ipad|ipod/.test(userAgent)) {\n    return true;\n  }\n\n  // Check for macOS\n  if (platform.includes('mac') || /macintosh/.test(userAgent)) {\n    return true;\n  }\n\n  // Check for iPad on iOS 13+ (reports as MacIntel but has touch)\n  if (platform === 'macintel' && navigator.maxTouchPoints > 1) {\n    return true;\n  }\n\n  return false;\n}\n","import { useState } from 'react';\nimport { useAppleAuth } from '../../hooks/useAppleAuth';\nimport { LoadingSpinner } from '../shared/LoadingSpinner';\nimport { isAppleDevice } from '../../utils/deviceDetection';\n\nexport interface AppleLoginButtonProps {\n  onSuccess?: () => void;\n  onError?: (error: Error) => void;\n  className?: string;\n  variant?: 'default' | 'outline';\n  size?: 'sm' | 'md' | 'lg';\n  disabled?: boolean;\n  /**\n   * Hide the button on non-Apple devices (macOS, iOS, iPadOS).\n   * When true (default), button only renders on Apple devices.\n   * When false, button always renders regardless of device.\n   * @default true\n   */\n  hideOnNonApple?: boolean;\n}\n\n/**\n * Apple Sign In button\n *\n * Requires `appleClientId` to be configured in CedrosLoginProvider.\n *\n * @example\n * ```tsx\n * <AppleLoginButton\n *   onSuccess={() => console.log('Logged in!')}\n *   onError={(err) => console.error(err)}\n * />\n * ```\n */\nexport function AppleLoginButton({\n  onSuccess,\n  onError,\n  className = '',\n  variant = 'default',\n  size = 'md',\n  disabled = false,\n  hideOnNonApple = true,\n}: AppleLoginButtonProps) {\n  const { signIn, isLoading, isInitialized } = useAppleAuth();\n\n  // Detect Apple device on initial render (lazy initializer avoids re-detection)\n  const [isApple] = useState(() => isAppleDevice());\n\n  // Hide button on non-Apple devices if hideOnNonApple is true\n  if (hideOnNonApple && !isApple) {\n    return null;\n  }\n\n  const handleClick = async () => {\n    try {\n      await signIn();\n      onSuccess?.();\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err));\n      onError?.(error);\n    }\n  };\n\n  const sizeClasses = {\n    sm: 'cedros-button-sm',\n    md: 'cedros-button-md',\n    lg: 'cedros-button-lg',\n  };\n\n  const variantClasses = {\n    default: 'cedros-button-apple',\n    outline: 'cedros-button-apple-outline',\n  };\n\n  return (\n    <button\n      type=\"button\"\n      className={`cedros-button ${variantClasses[variant]} ${sizeClasses[size]} ${className}`}\n      onClick={handleClick}\n      disabled={disabled || !isInitialized || isLoading}\n      aria-label=\"Sign in with Apple\"\n    >\n      {isLoading ? (\n        <LoadingSpinner size=\"sm\" />\n      ) : (\n        <svg\n          className=\"cedros-button-icon\"\n          width=\"18\"\n          height=\"18\"\n          viewBox=\"0 0 24 24\"\n          fill=\"currentColor\"\n          aria-hidden=\"true\"\n        >\n          <path d=\"M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z\" />\n        </svg>\n      )}\n      <span>Continue with Apple</span>\n    </button>\n  );\n}\n","// Minimal WebAuthn JSON helpers (no external deps).\n//\n// WebAuthn request/response objects contain ArrayBuffers, which can't be sent\n// over JSON. Server endpoints in this repo expose options with base64url fields\n// and expect credentials back with base64url fields.\n\ntype Base64UrlString = string;\n\nfunction assert(condition: unknown, message: string): asserts condition {\n  if (!condition) throw new Error(message);\n}\n\nfunction normalizeBase64Url(input: string): string {\n  // Browser encoders may return base64url without padding.\n  return input.replace(/-/g, '+').replace(/_/g, '/');\n}\n\nexport function base64UrlToArrayBuffer(b64url: Base64UrlString): ArrayBuffer {\n  assert(typeof b64url === 'string' && b64url.length > 0, 'Expected base64url string');\n  const base64 = normalizeBase64Url(b64url);\n  const padded = base64 + '='.repeat((4 - (base64.length % 4)) % 4);\n  const binary = atob(padded);\n  const bytes = new Uint8Array(binary.length);\n  for (let i = 0; i < binary.length; i++) bytes[i] = binary.charCodeAt(i);\n  return bytes.buffer;\n}\n\nexport function arrayBufferToBase64Url(buffer: ArrayBuffer): Base64UrlString {\n  const bytes = new Uint8Array(buffer);\n  let binary = '';\n  for (let i = 0; i < bytes.length; i++) binary += String.fromCharCode(bytes[i]);\n  const base64 = btoa(binary);\n  return base64.replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+$/g, '');\n}\n\nfunction mapCredentialDescriptor(desc: unknown): PublicKeyCredentialDescriptor {\n  assert(typeof desc === 'object' && desc !== null, 'Invalid credential descriptor');\n  const d = desc as Record<string, unknown>;\n  assert(typeof d.type === 'string', 'Invalid credential descriptor type');\n  assert(typeof d.id === 'string', 'Invalid credential descriptor id');\n\n  return {\n    type: d.type as PublicKeyCredentialType,\n    id: base64UrlToArrayBuffer(d.id as string),\n    transports: Array.isArray(d.transports)\n      ? (d.transports as AuthenticatorTransport[])\n      : undefined,\n  };\n}\n\nexport type ServerCreationOptions = {\n  publicKey: Record<string, unknown>;\n};\n\nexport function parseCreationOptionsFromServer(\n  options: ServerCreationOptions\n): PublicKeyCredentialCreationOptions {\n  assert(options && typeof options === 'object', 'Missing creation options');\n  const publicKey = options.publicKey as Record<string, unknown>;\n  assert(publicKey && typeof publicKey === 'object', 'Missing creation options.publicKey');\n\n  assert(typeof publicKey.challenge === 'string', 'Missing creation challenge');\n  assert(typeof publicKey.rp === 'object' && publicKey.rp !== null, 'Missing rp');\n  assert(typeof publicKey.user === 'object' && publicKey.user !== null, 'Missing user');\n\n  const rp = publicKey.rp as Record<string, unknown>;\n  const user = publicKey.user as Record<string, unknown>;\n\n  assert(typeof rp.name === 'string', 'Missing rp.name');\n  assert(typeof user.id === 'string', 'Missing user.id');\n  assert(typeof user.name === 'string', 'Missing user.name');\n  assert(typeof user.displayName === 'string', 'Missing user.displayName');\n\n  const exclude = Array.isArray(publicKey.excludeCredentials)\n    ? (publicKey.excludeCredentials as unknown[]).map(mapCredentialDescriptor)\n    : undefined;\n\n  const pubKeyCredParams = Array.isArray(publicKey.pubKeyCredParams)\n    ? (publicKey.pubKeyCredParams as Array<{ type: string; alg: number }>).map((p) => ({\n        type: p.type as PublicKeyCredentialType,\n        alg: p.alg,\n      }))\n    : [];\n\n  return {\n    challenge: base64UrlToArrayBuffer(publicKey.challenge as string),\n    rp: {\n      name: rp.name as string,\n      id: typeof rp.id === 'string' ? (rp.id as string) : undefined,\n    },\n    user: {\n      id: base64UrlToArrayBuffer(user.id as string),\n      name: user.name as string,\n      displayName: user.displayName as string,\n    },\n    pubKeyCredParams,\n    timeout: typeof publicKey.timeout === 'number' ? (publicKey.timeout as number) : undefined,\n    attestation:\n      typeof publicKey.attestation === 'string'\n        ? (publicKey.attestation as AttestationConveyancePreference)\n        : undefined,\n    authenticatorSelection:\n      typeof publicKey.authenticatorSelection === 'object' &&\n      publicKey.authenticatorSelection !== null\n        ? (publicKey.authenticatorSelection as AuthenticatorSelectionCriteria)\n        : undefined,\n    excludeCredentials: exclude,\n    extensions:\n      typeof publicKey.extensions === 'object' && publicKey.extensions !== null\n        ? (publicKey.extensions as AuthenticationExtensionsClientInputs)\n        : undefined,\n  };\n}\n\nexport type ServerRequestOptions = {\n  publicKey: Record<string, unknown>;\n};\n\nexport function parseRequestOptionsFromServer(\n  options: ServerRequestOptions\n): PublicKeyCredentialRequestOptions {\n  assert(options && typeof options === 'object', 'Missing request options');\n  const publicKey = options.publicKey as Record<string, unknown>;\n  assert(publicKey && typeof publicKey === 'object', 'Missing request options.publicKey');\n\n  assert(typeof publicKey.challenge === 'string', 'Missing request challenge');\n\n  const allow = Array.isArray(publicKey.allowCredentials)\n    ? (publicKey.allowCredentials as unknown[]).map(mapCredentialDescriptor)\n    : undefined;\n\n  return {\n    challenge: base64UrlToArrayBuffer(publicKey.challenge as string),\n    rpId: typeof publicKey.rpId === 'string' ? (publicKey.rpId as string) : undefined,\n    timeout: typeof publicKey.timeout === 'number' ? (publicKey.timeout as number) : undefined,\n    userVerification:\n      typeof publicKey.userVerification === 'string'\n        ? (publicKey.userVerification as UserVerificationRequirement)\n        : undefined,\n    allowCredentials: allow,\n    extensions:\n      typeof publicKey.extensions === 'object' && publicKey.extensions !== null\n        ? (publicKey.extensions as AuthenticationExtensionsClientInputs)\n        : undefined,\n  };\n}\n\nexport type PublicKeyCredentialJSON = {\n  id: string;\n  rawId: string;\n  type: string;\n  authenticatorAttachment?: string;\n  clientExtensionResults?: AuthenticationExtensionsClientOutputs;\n  response: Record<string, unknown>;\n};\n\nexport function credentialToServerJson(cred: PublicKeyCredential): PublicKeyCredentialJSON {\n  const rawId = arrayBufferToBase64Url(cred.rawId);\n  const response = cred.response as AuthenticatorResponse;\n\n  const common = {\n    clientDataJSON: arrayBufferToBase64Url(response.clientDataJSON),\n  };\n\n  const responseJson: Record<string, unknown> = { ...common };\n\n  // Registration\n  if ('attestationObject' in response) {\n    const att = response as AuthenticatorAttestationResponse;\n    responseJson.attestationObject = arrayBufferToBase64Url(att.attestationObject);\n    if (typeof att.getTransports === 'function') {\n      try {\n        responseJson.transports = att.getTransports();\n      } catch {\n        // ignore\n      }\n    }\n  }\n\n  // Authentication\n  if ('authenticatorData' in response) {\n    const asr = response as AuthenticatorAssertionResponse;\n    responseJson.authenticatorData = arrayBufferToBase64Url(asr.authenticatorData);\n    responseJson.signature = arrayBufferToBase64Url(asr.signature);\n    if (asr.userHandle) {\n      responseJson.userHandle = arrayBufferToBase64Url(asr.userHandle);\n    }\n  }\n\n  return {\n    id: cred.id,\n    rawId,\n    type: cred.type,\n    authenticatorAttachment: cred.authenticatorAttachment ?? undefined,\n    clientExtensionResults: cred.getClientExtensionResults?.() ?? {},\n    response: responseJson,\n  };\n}\n","import { useCallback, useMemo, useState } from 'react';\nimport { useCedrosLogin } from '../context/useCedrosLogin';\nimport { ApiClient, handleApiError } from '../utils/apiClient';\nimport type { AuthError, AuthResponse } from '../types';\nimport {\n  credentialToServerJson,\n  parseCreationOptionsFromServer,\n  parseRequestOptionsFromServer,\n} from '../utils/webauthnJson';\n\ntype WebAuthnOptionsResponse = {\n  challengeId: string;\n  options: {\n    publicKey: Record<string, unknown>;\n  };\n};\n\nexport interface UseWebAuthnReturn {\n  isSupported: boolean;\n  isLoading: boolean;\n  error: AuthError | null;\n  clearError: () => void;\n\n  /** Start a server-managed WebAuthn authentication ceremony (login). */\n  authenticatePasskey: (params?: { email?: string }) => Promise<AuthResponse>;\n  /** Register a new passkey for the currently authenticated user. */\n  registerPasskey: (params?: {\n    label?: string;\n  }) => Promise<{ credentialId: string; label?: string }>;\n}\n\nfunction isWebAuthnAvailable(): boolean {\n  if (typeof window !== 'undefined') {\n    const hostname = window.location?.hostname;\n    const isLocalhost =\n      hostname === 'localhost' || hostname === '127.0.0.1' || hostname?.endsWith('.localhost');\n    const isSecure = (window as unknown as { isSecureContext?: boolean }).isSecureContext === true;\n    if (!isSecure && !isLocalhost) {\n      return false;\n    }\n  }\n  return (\n    typeof window !== 'undefined' &&\n    typeof window.PublicKeyCredential !== 'undefined' &&\n    typeof navigator !== 'undefined' &&\n    typeof navigator.credentials !== 'undefined'\n  );\n}\n\nfunction mapWebAuthnDomError(err: unknown): AuthError | null {\n  if (!(err instanceof Error)) return null;\n  // DOMExceptions inherit from Error in modern browsers.\n  const name = err.name;\n\n  // User cancelled, dismissed, timed out, or no available credential.\n  if (name === 'NotAllowedError') {\n    return { code: 'SERVER_ERROR', message: 'Passkey operation was cancelled or timed out' };\n  }\n\n  // Common for trying to create a credential that already exists (or unusable state).\n  if (name === 'InvalidStateError') {\n    return { code: 'VALIDATION_ERROR', message: 'Passkey is not available for this operation' };\n  }\n\n  // Thrown for non-secure contexts, or RP ID / origin mismatches.\n  if (name === 'SecurityError') {\n    return {\n      code: 'VALIDATION_ERROR',\n      message:\n        'Passkeys require HTTPS and a correctly configured relying party (WEBAUTHN_RP_ID / WEBAUTHN_RP_ORIGIN)',\n    };\n  }\n\n  return null;\n}\n\n/**\n * Server-managed WebAuthn (passkey) authentication + registration.\n *\n * - Login: /webauthn/auth/options -> navigator.credentials.get -> /webauthn/auth/verify\n * - Registration: /webauthn/register/options -> navigator.credentials.create -> /webauthn/register/verify\n */\nexport function useWebAuthn(): UseWebAuthnReturn {\n  const { config, _internal } = useCedrosLogin();\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<AuthError | null>(null);\n\n  const apiClient = useMemo(\n    () =>\n      new ApiClient({\n        baseUrl: config.serverUrl,\n        timeoutMs: config.requestTimeout,\n        retryAttempts: config.retryAttempts,\n        // Needed for authenticated registration endpoints when cookie auth is disabled\n        getAccessToken: _internal?.getAccessToken,\n      }),\n    [_internal?.getAccessToken, config.serverUrl, config.requestTimeout, config.retryAttempts]\n  );\n\n  const clearError = useCallback(() => setError(null), []);\n\n  const isSupported = isWebAuthnAvailable();\n\n  const authenticatePasskey = useCallback(\n    async (params?: { email?: string }): Promise<AuthResponse> => {\n      if (!isSupported) {\n        const err: AuthError = {\n          code: 'VALIDATION_ERROR',\n          message: 'Passkeys are not supported in this browser',\n        };\n        setError(err);\n        throw err;\n      }\n\n      setIsLoading(true);\n      setError(null);\n\n      try {\n        const optionsResponse = await apiClient.post<WebAuthnOptionsResponse>(\n          '/webauthn/auth/options',\n          { email: params?.email }\n        );\n\n        const publicKey = parseRequestOptionsFromServer(optionsResponse.options);\n\n        const assertion = (await navigator.credentials.get({\n          publicKey,\n        })) as PublicKeyCredential | null;\n\n        if (!assertion) {\n          throw new Error('Passkey authentication returned no credential');\n        }\n\n        const data = await apiClient.post<AuthResponse>('/webauthn/auth/verify', {\n          challengeId: optionsResponse.challengeId,\n          credential: credentialToServerJson(assertion),\n        });\n\n        config.callbacks?.onLoginSuccess?.(data.user, 'webauthn');\n        _internal?.handleLoginSuccess(data.user, data.tokens);\n\n        return data;\n      } catch (err) {\n        const domMapped = mapWebAuthnDomError(err);\n        const authError = domMapped ?? handleApiError(err, 'Passkey sign-in failed');\n        setError(authError);\n        throw authError;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [apiClient, config.callbacks, _internal, isSupported]\n  );\n\n  const registerPasskey = useCallback(\n    async (params?: { label?: string }): Promise<{ credentialId: string; label?: string }> => {\n      if (!isSupported) {\n        const err: AuthError = {\n          code: 'VALIDATION_ERROR',\n          message: 'Passkeys are not supported in this browser',\n        };\n        setError(err);\n        throw err;\n      }\n\n      setIsLoading(true);\n      setError(null);\n\n      try {\n        const optionsResponse = await apiClient.post<WebAuthnOptionsResponse>(\n          '/webauthn/register/options',\n          {}\n        );\n\n        const publicKey = parseCreationOptionsFromServer(optionsResponse.options);\n\n        const created = (await navigator.credentials.create({\n          publicKey,\n        })) as PublicKeyCredential | null;\n\n        if (!created) {\n          throw new Error('Passkey registration returned no credential');\n        }\n\n        const result = await apiClient.post<{\n          success: boolean;\n          credentialId: string;\n          label?: string;\n        }>('/webauthn/register/verify', {\n          challengeId: optionsResponse.challengeId,\n          credential: credentialToServerJson(created),\n          label: params?.label,\n        });\n\n        if (!result.success) {\n          throw new Error('Passkey registration failed');\n        }\n\n        return { credentialId: result.credentialId, label: result.label };\n      } catch (err) {\n        const domMapped = mapWebAuthnDomError(err);\n        const authError = domMapped ?? handleApiError(err, 'Passkey registration failed');\n        setError(authError);\n        throw authError;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [apiClient, isSupported]\n  );\n\n  return {\n    isSupported,\n    isLoading,\n    error,\n    clearError,\n    authenticatePasskey,\n    registerPasskey,\n  };\n}\n","import type { ReactNode } from 'react';\nimport { useWebAuthn } from '../../hooks/useWebAuthn';\n\nexport interface PasskeyLoginButtonProps {\n  onSuccess?: () => void;\n  className?: string;\n  children?: ReactNode;\n  disabled?: boolean;\n}\n\nexport function PasskeyLoginButton({\n  onSuccess,\n  className = '',\n  children,\n  disabled,\n}: PasskeyLoginButtonProps) {\n  const { authenticatePasskey, isLoading, isSupported } = useWebAuthn();\n\n  const isDisabled = disabled || !isSupported || isLoading;\n\n  return (\n    <button\n      type=\"button\"\n      className={`cedros-button cedros-button-social ${className}`}\n      onClick={async () => {\n        await authenticatePasskey();\n        onSuccess?.();\n      }}\n      disabled={isDisabled}\n      aria-disabled={isDisabled}\n    >\n      <span className=\"cedros-social-icon\" aria-hidden=\"true\">\n        <PasskeyIcon />\n      </span>\n      <span>{children ?? (isLoading ? 'Continuing...' : 'Continue with Passkey')}</span>\n    </button>\n  );\n}\n\nfunction PasskeyIcon() {\n  return (\n    <svg\n      width=\"20\"\n      height=\"20\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"1.5\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <path d=\"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4\" />\n      <path d=\"M14 13.12c0 2.38 0 6.38-1 8.88\" />\n      <path d=\"M17.29 21.02c.12-.6.43-2.3.5-3.02\" />\n      <path d=\"M2 12a10 10 0 0 1 18-6\" />\n      <path d=\"M2 16h.01\" />\n      <path d=\"M21.8 16c.2-2 .131-5.354 0-6\" />\n      <path d=\"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2\" />\n      <path d=\"M8.65 22c.21-.66.45-1.32.57-2\" />\n      <path d=\"M9 6.8a6 6 0 0 1 9 5.2v2\" />\n    </svg>\n  );\n}\n","import { useState, useCallback, useEffect } from 'react';\nimport { useCedrosLogin } from '../context/useCedrosLogin';\nimport { EmailLoginForm } from './email/EmailLoginForm';\nimport { EmailRegisterForm } from './email/EmailRegisterForm';\nimport { ForgotPasswordForm } from './email/ForgotPasswordForm';\nimport { GoogleLoginButton } from './google/GoogleLoginButton';\nimport { AppleLoginButton } from './apple/AppleLoginButton';\nimport { SolanaLoginButton } from './solana/SolanaLoginButton';\nimport { PasskeyLoginButton } from './webauthn/PasskeyLoginButton';\nimport { detectSolanaWallets } from '../utils/walletDetection';\nimport { isAppleDevice } from '../utils/deviceDetection';\n\ntype TabValue = 'login' | 'register';\ntype ViewState = 'form' | 'forgotPassword';\nconst TABS: TabValue[] = ['login', 'register'];\n\nexport interface LoginFormProps {\n  onSuccess?: () => void;\n  className?: string;\n  defaultTab?: 'login' | 'register';\n}\n\n/**\n * Combined login form with all enabled auth methods\n */\nexport function LoginForm({ onSuccess, className = '', defaultTab = 'login' }: LoginFormProps) {\n  const { config } = useCedrosLogin();\n  const [activeTab, setActiveTab] = useState<TabValue>(defaultTab);\n  const [viewState, setViewState] = useState<ViewState>('form');\n  // Detect wallets on initial render and re-check on window load/focus\n  const [hasWallets, setHasWallets] = useState(() => detectSolanaWallets());\n  const [isApple] = useState(() => isAppleDevice());\n\n  useEffect(() => {\n    const updateWallets = () => setHasWallets(detectSolanaWallets());\n    updateWallets();\n    window.addEventListener('load', updateWallets);\n    window.addEventListener('focus', updateWallets);\n    return () => {\n      window.removeEventListener('load', updateWallets);\n      window.removeEventListener('focus', updateWallets);\n    };\n  }, []);\n\n  // Get forgot password mode from config (only show link in 'reset' mode - instantLink is handled inline)\n  const forgotPasswordMode = config.forms?.forgotPassword?.mode ?? 'reset';\n\n  // UI-04: Handle Arrow key navigation for tabs (ARIA tabs pattern)\n  const handleTabKeyDown = useCallback(\n    (e: React.KeyboardEvent<HTMLButtonElement>) => {\n      const currentIndex = TABS.indexOf(activeTab);\n      let newIndex = currentIndex;\n\n      switch (e.key) {\n        case 'ArrowLeft':\n        case 'ArrowUp':\n          // Move to previous tab (wrapping to end)\n          newIndex = currentIndex === 0 ? TABS.length - 1 : currentIndex - 1;\n          break;\n        case 'ArrowRight':\n        case 'ArrowDown':\n          // Move to next tab (wrapping to start)\n          newIndex = currentIndex === TABS.length - 1 ? 0 : currentIndex + 1;\n          break;\n        case 'Home':\n          newIndex = 0;\n          break;\n        case 'End':\n          newIndex = TABS.length - 1;\n          break;\n        default:\n          return; // Don't prevent default for other keys\n      }\n\n      e.preventDefault();\n      const newTab = TABS[newIndex];\n      setActiveTab(newTab);\n      // Focus the new tab button\n      const newButton = document.getElementById(`cedros-tab-${newTab}`);\n      newButton?.focus();\n    },\n    [activeTab]\n  );\n\n  const features = config.features ?? {\n    email: true,\n    google: true,\n    apple: true,\n    solana: true,\n    webauthn: true,\n  };\n  const showEmail = features.email !== false;\n  const showGoogle = features.google !== false && config.googleClientId;\n  // Only show Apple button if feature enabled, clientId configured, AND on Apple device\n  const showApple = features.apple !== false && config.appleClientId && isApple;\n  // Only show Solana button if feature enabled AND wallets are installed\n  const showSolana = features.solana !== false && hasWallets;\n  const showPasskey = features.webauthn !== false;\n\n  const showDivider = showEmail && (showGoogle || showApple || showSolana || showPasskey);\n\n  // Show forgot password form\n  if (viewState === 'forgotPassword') {\n    return (\n      <div className={`cedros-login-form ${className}`}>\n        <ForgotPasswordForm onCancel={() => setViewState('form')} />\n      </div>\n    );\n  }\n\n  return (\n    <div className={`cedros-login-form ${className}`}>\n      {/* Social login buttons */}\n      {(showPasskey || showGoogle || showApple || showSolana) && (\n        <div className=\"cedros-social-buttons\">\n          {showPasskey && <PasskeyLoginButton onSuccess={onSuccess} />}\n          {showGoogle && <GoogleLoginButton onSuccess={onSuccess} />}\n          {showApple && <AppleLoginButton onSuccess={onSuccess} />}\n          {showSolana && <SolanaLoginButton onSuccess={onSuccess} />}\n        </div>\n      )}\n\n      {/* Divider */}\n      {showDivider && (\n        <div className=\"cedros-divider\">\n          <span>Or continue with</span>\n        </div>\n      )}\n\n      {/* Email forms */}\n      {showEmail && (\n        <>\n          {/* Tabs */}\n          <div className=\"cedros-tabs\" role=\"tablist\" aria-label=\"Authentication method\">\n            <button\n              type=\"button\"\n              role=\"tab\"\n              id=\"cedros-tab-login\"\n              className={`cedros-tab ${activeTab === 'login' ? 'cedros-tab-active' : ''}`}\n              onClick={() => setActiveTab('login')}\n              onKeyDown={handleTabKeyDown}\n              aria-selected={activeTab === 'login'}\n              aria-controls=\"cedros-tabpanel-login\"\n              tabIndex={activeTab === 'login' ? 0 : -1}\n            >\n              Sign in\n            </button>\n            <button\n              type=\"button\"\n              role=\"tab\"\n              id=\"cedros-tab-register\"\n              className={`cedros-tab ${activeTab === 'register' ? 'cedros-tab-active' : ''}`}\n              onClick={() => setActiveTab('register')}\n              onKeyDown={handleTabKeyDown}\n              aria-selected={activeTab === 'register'}\n              aria-controls=\"cedros-tabpanel-register\"\n              tabIndex={activeTab === 'register' ? 0 : -1}\n            >\n              Sign up\n            </button>\n          </div>\n\n          {/* Tab panels */}\n          <div\n            role=\"tabpanel\"\n            id={`cedros-tabpanel-${activeTab}`}\n            aria-labelledby={`cedros-tab-${activeTab}`}\n          >\n            {activeTab === 'login' ? (\n              <EmailLoginForm\n                onSuccess={onSuccess}\n                onSwitchToRegister={() => setActiveTab('register')}\n                onForgotPassword={\n                  forgotPasswordMode === 'reset' ? () => setViewState('forgotPassword') : undefined\n                }\n              />\n            ) : (\n              <EmailRegisterForm\n                onSuccess={onSuccess}\n                onSwitchToLogin={() => setActiveTab('login')}\n              />\n            )}\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n","import { Component, type ReactNode, type ErrorInfo } from 'react';\n\nexport interface ErrorBoundaryProps {\n  /** Child components to render */\n  children: ReactNode;\n  /** Custom fallback UI to show when an error occurs */\n  fallback?: ReactNode;\n  /** Callback when an error is caught */\n  onError?: (error: Error, errorInfo: ErrorInfo) => void;\n  /** Whether to show error details (useful for development) */\n  showDetails?: boolean;\n}\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n  error: Error | null;\n  errorInfo: ErrorInfo | null;\n}\n\n/**\n * Error Boundary component that catches JavaScript errors in child components.\n * Prevents the entire app from crashing and shows a fallback UI.\n *\n * @example\n * ```tsx\n * <ErrorBoundary\n *   fallback={<div>Something went wrong</div>}\n *   onError={(error) => logError(error)}\n * >\n *   <LoginForm />\n * </ErrorBoundary>\n * ```\n */\nexport class ErrorBoundary extends Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  constructor(props: ErrorBoundaryProps) {\n    super(props);\n    this.state = {\n      hasError: false,\n      error: null,\n      errorInfo: null,\n    };\n  }\n\n  static getDerivedStateFromError(error: Error): Partial<ErrorBoundaryState> {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo): void {\n    this.setState({ errorInfo });\n\n    // F-47: Always log errors (not just development) for production visibility\n    console.error('[Cedros Login] Error caught by ErrorBoundary:', error);\n    console.error('[Cedros Login] Component stack:', errorInfo.componentStack);\n\n    // Call optional error callback\n    this.props.onError?.(error, errorInfo);\n  }\n\n  handleRetry = (): void => {\n    this.setState({\n      hasError: false,\n      error: null,\n      errorInfo: null,\n    });\n  };\n\n  render(): ReactNode {\n    const { hasError, error, errorInfo } = this.state;\n    const { children, fallback, showDetails = false } = this.props;\n\n    if (hasError) {\n      // Custom fallback provided\n      if (fallback) {\n        return fallback;\n      }\n\n      // Default fallback UI\n      return (\n        <div className=\"cedros-error-boundary\" role=\"alert\" aria-live=\"assertive\">\n          <div className=\"cedros-error-boundary-content\">\n            <svg\n              className=\"cedros-error-boundary-icon\"\n              width=\"48\"\n              height=\"48\"\n              viewBox=\"0 0 24 24\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              aria-hidden=\"true\"\n            >\n              <circle cx=\"12\" cy=\"12\" r=\"10\" />\n              <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\" />\n              <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\" />\n            </svg>\n\n            <h2 className=\"cedros-error-boundary-title\">Something went wrong</h2>\n\n            <p className=\"cedros-error-boundary-message\">\n              We encountered an unexpected error. Please try again.\n            </p>\n\n            {showDetails && error && (\n              <details className=\"cedros-error-boundary-details\">\n                <summary>Error details</summary>\n                <pre>\n                  {error.toString()}\n                  {errorInfo?.componentStack}\n                </pre>\n              </details>\n            )}\n\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-primary\"\n              onClick={this.handleRetry}\n            >\n              Try again\n            </button>\n          </div>\n        </div>\n      );\n    }\n\n    return children;\n  }\n}\n","import { useEffect, useRef } from 'react';\nimport { useCedrosLogin } from '../context/useCedrosLogin';\nimport { LoginForm } from './LoginForm';\nimport { ErrorBoundary } from './shared/ErrorBoundary';\n\nexport interface LoginModalProps {\n  className?: string;\n  title?: string;\n}\n\n/**\n * Modal containing the login form.\n * Controlled by the CedrosLoginProvider context.\n */\nexport function LoginModal({ className = '', title = 'Sign in to your account' }: LoginModalProps) {\n  const { isModalOpen, closeModal } = useCedrosLogin();\n  const modalRef = useRef<HTMLDivElement>(null);\n  const previousActiveElement = useRef<Element | null>(null);\n\n  // C-03: Use ref to avoid closeModal in effect dependencies\n  // Prevents event listener leak when closeModal identity changes\n  const closeModalRef = useRef(closeModal);\n  useEffect(() => {\n    closeModalRef.current = closeModal;\n  }, [closeModal]);\n\n  // Handle escape key and focus trapping\n  useEffect(() => {\n    if (!isModalOpen) return;\n\n    // Store currently focused element\n    previousActiveElement.current = document.activeElement;\n\n    // Focus the modal\n    modalRef.current?.focus();\n\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        closeModalRef.current();\n      }\n\n      // Focus trap\n      if (e.key === 'Tab' && modalRef.current) {\n        const focusableElements = modalRef.current.querySelectorAll<HTMLElement>(\n          'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n        );\n        const firstElement = focusableElements[0];\n        const lastElement = focusableElements[focusableElements.length - 1];\n\n        if (e.shiftKey && document.activeElement === firstElement) {\n          e.preventDefault();\n          lastElement?.focus();\n        } else if (!e.shiftKey && document.activeElement === lastElement) {\n          e.preventDefault();\n          firstElement?.focus();\n        }\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n\n    // Prevent body scroll\n    const previousOverflow = document.body.style.overflow;\n    document.body.style.overflow = 'hidden';\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown);\n      document.body.style.overflow = previousOverflow;\n\n      // Restore focus\n      if (previousActiveElement.current instanceof HTMLElement) {\n        previousActiveElement.current.focus();\n      }\n    };\n  }, [isModalOpen]);\n\n  if (!isModalOpen) return null;\n\n  const handleBackdropClick = (e: React.MouseEvent) => {\n    if (e.target === e.currentTarget) {\n      closeModal();\n    }\n  };\n\n  return (\n    <div\n      className={`cedros-modal-backdrop ${className}`}\n      onClick={handleBackdropClick}\n      role=\"presentation\"\n    >\n      <div\n        ref={modalRef}\n        className=\"cedros-modal\"\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-labelledby=\"cedros-modal-title\"\n        tabIndex={-1}\n      >\n        <div className=\"cedros-modal-header\">\n          <h2 id=\"cedros-modal-title\" className=\"cedros-modal-title\">\n            {title}\n          </h2>\n          <button\n            type=\"button\"\n            className=\"cedros-modal-close\"\n            onClick={closeModal}\n            aria-label=\"Close\"\n          >\n            <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden=\"true\">\n              <path\n                d=\"M18 6L6 18M6 6l12 12\"\n                stroke=\"currentColor\"\n                strokeWidth=\"2\"\n                strokeLinecap=\"round\"\n              />\n            </svg>\n          </button>\n        </div>\n        {/* M-06: ErrorBoundary catches rendering errors in login form */}\n        <div className=\"cedros-modal-content\">\n          <ErrorBoundary>\n            <LoginForm onSuccess={closeModal} />\n          </ErrorBoundary>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useState, type FormEvent } from 'react';\nimport { usePasswordReset } from '../../hooks/usePasswordReset';\nimport { PasswordInput } from './PasswordInput';\nimport { ErrorMessage } from '../shared/ErrorMessage';\nimport { LoadingSpinner } from '../shared/LoadingSpinner';\nimport { validatePassword } from '../../utils/validation';\nimport type { PasswordValidation } from '../../types';\n\nexport interface ResetPasswordFormProps {\n  token: string;\n  onSuccess?: () => void;\n  onLoginClick?: () => void;\n  className?: string;\n}\n\n/**\n * Form for resetting password using a reset token.\n *\n * @example\n * ```tsx\n * // Get token from URL params\n * const token = new URLSearchParams(location.search).get('token');\n *\n * <ResetPasswordForm\n *   token={token}\n *   onSuccess={() => navigate('/login')}\n *   onLoginClick={() => navigate('/login')}\n * />\n * ```\n */\nexport function ResetPasswordForm({\n  token,\n  onSuccess,\n  onLoginClick,\n  className = '',\n}: ResetPasswordFormProps) {\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [validation, setValidation] = useState<PasswordValidation | null>(null);\n  const { resetPassword, isLoading, isSuccess, error, clearError } = usePasswordReset();\n\n  const passwordsMatch = password === confirmPassword;\n  const isValid = validation?.isValid && passwordsMatch && password.length > 0;\n\n  const handleSubmit = async (e: FormEvent) => {\n    e.preventDefault();\n    if (!isValid) return;\n\n    try {\n      await resetPassword(token, password);\n      onSuccess?.();\n    } catch {\n      // Error is already set in the hook\n    }\n  };\n\n  if (isSuccess) {\n    return (\n      <div className={`cedros-reset-password-success ${className}`}>\n        <svg\n          className=\"cedros-success-icon\"\n          width=\"48\"\n          height=\"48\"\n          viewBox=\"0 0 48 48\"\n          fill=\"none\"\n          aria-hidden=\"true\"\n        >\n          <circle cx=\"24\" cy=\"24\" r=\"22\" stroke=\"currentColor\" strokeWidth=\"2\" />\n          <path\n            d=\"M14 24l7 7 13-13\"\n            stroke=\"currentColor\"\n            strokeWidth=\"2\"\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n          />\n        </svg>\n        <h3 className=\"cedros-success-title\">Password reset successful</h3>\n        <p className=\"cedros-success-message\">\n          Your password has been reset. You can now log in with your new password.\n        </p>\n        {onLoginClick && (\n          <button\n            type=\"button\"\n            className=\"cedros-button cedros-button-md cedros-button-primary\"\n            onClick={onLoginClick}\n          >\n            Go to login\n          </button>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <form className={`cedros-reset-password-form ${className}`} onSubmit={handleSubmit}>\n      <div className=\"cedros-form-header\">\n        <h3 className=\"cedros-form-title\">Reset your password</h3>\n        <p className=\"cedros-form-subtitle\">Enter your new password below.</p>\n      </div>\n\n      <ErrorMessage error={error} onDismiss={clearError} />\n\n      <div className=\"cedros-form-field\">\n        <PasswordInput\n          label=\"New password\"\n          value={password}\n          onChange={(e) => {\n            setPassword(e.target.value);\n            setValidation(validatePassword(e.target.value));\n          }}\n          showStrengthMeter\n          onValidationChange={setValidation}\n          disabled={isLoading}\n          autoComplete=\"new-password\"\n          error={\n            validation && !validation.isValid\n              ? Object.values(validation.errors).find(Boolean)\n              : undefined\n          }\n        />\n      </div>\n\n      <div className=\"cedros-form-field\">\n        <PasswordInput\n          label=\"Confirm password\"\n          value={confirmPassword}\n          onChange={(e) => setConfirmPassword(e.target.value)}\n          disabled={isLoading}\n          autoComplete=\"new-password\"\n          error={confirmPassword && !passwordsMatch ? 'Passwords do not match' : undefined}\n        />\n      </div>\n\n      <div className=\"cedros-form-actions\">\n        <button\n          type=\"submit\"\n          className=\"cedros-button cedros-button-md cedros-button-primary cedros-button-full\"\n          disabled={isLoading || !isValid}\n        >\n          {isLoading ? (\n            <>\n              <LoadingSpinner size=\"sm\" />\n              Resetting...\n            </>\n          ) : (\n            'Reset password'\n          )}\n        </button>\n\n        {onLoginClick && (\n          <button\n            type=\"button\"\n            className=\"cedros-button cedros-button-md cedros-button-ghost cedros-button-full\"\n            onClick={onLoginClick}\n            disabled={isLoading}\n          >\n            Back to login\n          </button>\n        )}\n      </div>\n    </form>\n  );\n}\n","/**\n * Organization avatar component\n *\n * Extracted from OrgSwitcher.tsx (F-02)\n */\nimport type { OrgWithMembership } from '../../types';\nimport { sanitizeImageUrl } from '../../utils/sanitization';\n\nexport interface OrgAvatarProps {\n  org: OrgWithMembership;\n  size?: 'sm' | 'lg';\n  className?: string;\n}\n\nexport function OrgAvatar({ org, size = 'lg', className = '' }: OrgAvatarProps) {\n  const sanitizedLogoUrl = sanitizeImageUrl(org.logoUrl);\n  const sizeClass = size === 'lg' ? 'cedros-org-avatar-lg' : '';\n  const imageClassName = ['cedros-org-avatar', sizeClass, className].filter(Boolean).join(' ');\n  const placeholderClassName = ['cedros-org-avatar-placeholder', sizeClass, className]\n    .filter(Boolean)\n    .join(' ');\n  if (sanitizedLogoUrl) {\n    return (\n      <img\n        src={sanitizedLogoUrl}\n        alt={org.name}\n        className={imageClassName}\n        referrerPolicy=\"no-referrer\"\n      />\n    );\n  }\n\n  return <div className={placeholderClassName}>{org.name[0]?.toUpperCase() || '?'}</div>;\n}\n","import { useCallback, useState, useRef, useEffect } from 'react';\nimport type { OrgWithMembership } from '../../types';\nimport { LoadingSpinner } from '../shared/LoadingSpinner';\nimport { OrgAvatar } from './OrgAvatar';\n\nexport interface OrgSelectorProps {\n  /** List of organizations to display */\n  orgs: OrgWithMembership[];\n  /** Currently active organization */\n  activeOrg: OrgWithMembership | null;\n  /** Loading state */\n  isLoading?: boolean;\n  /** Callback when organization is selected */\n  onSelect: (orgId: string) => void;\n  /** Callback when \"Create organization\" is clicked */\n  onCreateClick?: () => void;\n  /** Additional CSS class */\n  className?: string;\n  /** Placeholder when no orgs */\n  placeholder?: string;\n}\n\n/**\n * Dropdown selector for switching between organizations.\n *\n * ## A11Y-02: Keyboard Navigation Limitation\n *\n * Currently supports:\n * - Tab/Shift+Tab: Move focus between trigger and items\n * - Escape: Close dropdown\n * - Enter/Space: Select focused item\n *\n * FUTURE: Consider implementing arrow key navigation for enhanced accessibility:\n * - ArrowUp/ArrowDown: Navigate between items in the list\n * - Home/End: Jump to first/last item\n * - Type-ahead: Focus item starting with typed character\n *\n * See WAI-ARIA Listbox Pattern for reference implementation.\n * Currently the component meets basic accessibility requirements.\n *\n * @example\n * ```tsx\n * function Header() {\n *   const { orgs, activeOrg, switchOrg } = useOrgs();\n *\n *   return (\n *     <OrgSelector\n *       orgs={orgs}\n *       activeOrg={activeOrg}\n *       onSelect={switchOrg}\n *       onCreateClick={() => setShowCreateModal(true)}\n *     />\n *   );\n * }\n * ```\n */\nexport function OrgSelector({\n  orgs,\n  activeOrg,\n  isLoading = false,\n  onSelect,\n  onCreateClick,\n  className = '',\n  placeholder = 'Select organization',\n}: OrgSelectorProps) {\n  const [isOpen, setIsOpen] = useState(false);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n\n  // Close on escape key\n  useEffect(() => {\n    const handleEscape = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        setIsOpen(false);\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('keydown', handleEscape);\n      return () => document.removeEventListener('keydown', handleEscape);\n    }\n  }, [isOpen]);\n\n  const handleSelect = useCallback(\n    (orgId: string) => {\n      onSelect(orgId);\n      setIsOpen(false);\n    },\n    [onSelect]\n  );\n\n  const handleCreateClick = useCallback(() => {\n    setIsOpen(false);\n    onCreateClick?.();\n  }, [onCreateClick]);\n\n  const toggleDropdown = useCallback(() => {\n    setIsOpen((prev) => !prev);\n  }, []);\n\n  if (isLoading) {\n    return (\n      <div\n        className={`cedros-org-selector cedros-org-selector-loading ${className}`}\n        aria-busy=\"true\"\n        aria-live=\"polite\"\n      >\n        <LoadingSpinner size=\"sm\" />\n        <span>Loading...</span>\n      </div>\n    );\n  }\n\n  return (\n    <div ref={dropdownRef} className={`cedros-org-selector ${className}`}>\n      <button\n        type=\"button\"\n        className=\"cedros-org-selector-trigger\"\n        onClick={toggleDropdown}\n        aria-haspopup=\"listbox\"\n        aria-expanded={isOpen}\n      >\n        {activeOrg ? (\n          <>\n            <OrgAvatar org={activeOrg} size=\"sm\" />\n            <span className=\"cedros-org-selector-name\">{activeOrg.name}</span>\n            <RoleBadge role={activeOrg.membership.role} />\n          </>\n        ) : (\n          <span className=\"cedros-org-selector-placeholder\">{placeholder}</span>\n        )}\n        <ChevronIcon isOpen={isOpen} />\n      </button>\n\n      {isOpen && (\n        <div className=\"cedros-org-selector-dropdown\" role=\"listbox\">\n          {orgs.length === 0 ? (\n            <div className=\"cedros-org-selector-empty\">No organizations</div>\n          ) : (\n            <ul className=\"cedros-org-selector-list\">\n              {orgs.map((org) => (\n                <li key={org.id}>\n                  <button\n                    type=\"button\"\n                    className={`cedros-org-selector-item ${\n                      org.id === activeOrg?.id ? 'cedros-org-selector-item-active' : ''\n                    }`}\n                    onClick={() => handleSelect(org.id)}\n                    role=\"option\"\n                    aria-selected={org.id === activeOrg?.id}\n                  >\n                    <OrgAvatar org={org} size=\"sm\" />\n                    <span className=\"cedros-org-selector-item-name\">{org.name}</span>\n                    <RoleBadge role={org.membership.role} />\n                    {org.id === activeOrg?.id && <CheckIcon />}\n                  </button>\n                </li>\n              ))}\n            </ul>\n          )}\n\n          {onCreateClick && (\n            <>\n              <div className=\"cedros-org-selector-divider\" />\n              <button\n                type=\"button\"\n                className=\"cedros-org-selector-create\"\n                onClick={handleCreateClick}\n              >\n                <PlusIcon />\n                <span>Create organization</span>\n              </button>\n            </>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Helper components\nfunction RoleBadge({ role }: { role: string }) {\n  return <span className={`cedros-org-role cedros-org-role-${role}`}>{role}</span>;\n}\n\nfunction ChevronIcon({ isOpen }: { isOpen: boolean }) {\n  return (\n    <svg\n      className={`cedros-org-chevron ${isOpen ? 'cedros-org-chevron-open' : ''}`}\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 16 16\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        d=\"M4 6L8 10L12 6\"\n        stroke=\"currentColor\"\n        strokeWidth=\"1.5\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n    </svg>\n  );\n}\n\nfunction CheckIcon() {\n  return (\n    <svg\n      className=\"cedros-org-check\"\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 16 16\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        d=\"M3 8L6 11L13 4\"\n        stroke=\"currentColor\"\n        strokeWidth=\"1.5\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n    </svg>\n  );\n}\n\nfunction PlusIcon() {\n  return (\n    <svg\n      className=\"cedros-org-plus\"\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 16 16\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        d=\"M8 3V13M3 8H13\"\n        stroke=\"currentColor\"\n        strokeWidth=\"1.5\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n    </svg>\n  );\n}\n","/**\n * Icon components for organization UI\n *\n * Extracted from OrgSwitcher.tsx (F-02)\n */\n\nexport function CloseIcon() {\n  return (\n    <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path\n        d=\"M5 5L15 15M15 5L5 15\"\n        stroke=\"currentColor\"\n        strokeWidth=\"1.5\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n    </svg>\n  );\n}\n\nexport function CheckIcon() {\n  return (\n    <svg\n      className=\"cedros-org-check\"\n      width=\"20\"\n      height=\"20\"\n      viewBox=\"0 0 20 20\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        d=\"M4 10L8 14L16 5\"\n        stroke=\"currentColor\"\n        strokeWidth=\"2\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n    </svg>\n  );\n}\n\nexport function PlusIcon() {\n  return (\n    <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path\n        d=\"M10 4V16M4 10H16\"\n        stroke=\"currentColor\"\n        strokeWidth=\"1.5\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n    </svg>\n  );\n}\n","/**\n * Organization list view component\n *\n * Extracted from OrgSwitcher.tsx (F-02)\n */\nimport type { OrgWithMembership } from '../../types';\nimport { LoadingSpinner } from '../shared/LoadingSpinner';\nimport { OrgAvatar } from './OrgAvatar';\nimport { CheckIcon, PlusIcon } from './icons';\n\nexport interface OrgListViewProps {\n  orgs: OrgWithMembership[];\n  activeOrg: OrgWithMembership | null;\n  isLoading: boolean;\n  onSelect: (orgId: string) => void;\n  onCreateClick?: () => void;\n}\n\nexport function OrgListView({\n  orgs,\n  activeOrg,\n  isLoading,\n  onSelect,\n  onCreateClick,\n}: OrgListViewProps) {\n  if (isLoading) {\n    return (\n      <div className=\"cedros-org-switcher-loading\">\n        <LoadingSpinner />\n        <span>Loading organizations...</span>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      {orgs.length === 0 ? (\n        <div className=\"cedros-org-switcher-empty\">\n          <p>You don't belong to any organizations yet.</p>\n        </div>\n      ) : (\n        <ul className=\"cedros-org-switcher-list\">\n          {orgs.map((org) => (\n            <li key={org.id}>\n              <button\n                type=\"button\"\n                className={`cedros-org-switcher-item ${\n                  org.id === activeOrg?.id ? 'cedros-org-switcher-item-active' : ''\n                }`}\n                onClick={() => onSelect(org.id)}\n              >\n                <OrgAvatar org={org} />\n                <div className=\"cedros-org-switcher-item-content\">\n                  <span className=\"cedros-org-switcher-item-name\">{org.name}</span>\n                  <span className=\"cedros-org-switcher-item-slug\">@{org.slug}</span>\n                </div>\n                <div className=\"cedros-org-switcher-item-meta\">\n                  <span className={`cedros-org-role cedros-org-role-${org.membership.role}`}>\n                    {org.membership.role}\n                  </span>\n                  {org.isPersonal && <span className=\"cedros-org-personal-badge\">Personal</span>}\n                </div>\n                {org.id === activeOrg?.id && <CheckIcon />}\n              </button>\n            </li>\n          ))}\n        </ul>\n      )}\n\n      {onCreateClick && (\n        <button type=\"button\" className=\"cedros-org-switcher-create\" onClick={onCreateClick}>\n          <PlusIcon />\n          <span>Create new organization</span>\n        </button>\n      )}\n    </>\n  );\n}\n","/**\n * Create organization form component\n *\n * Extracted from OrgSwitcher.tsx (F-02)\n */\nimport { useState, useCallback } from 'react';\nimport type { CreateOrgRequest } from '../../types';\nimport { LoadingSpinner } from '../shared/LoadingSpinner';\nimport { ErrorMessage } from '../shared/ErrorMessage';\n\nexport interface CreateOrgFormProps {\n  isLoading: boolean;\n  onSubmit: (data: CreateOrgRequest) => Promise<void>;\n  onCancel: () => void;\n}\n\nexport function CreateOrgForm({ isLoading, onSubmit, onCancel }: CreateOrgFormProps) {\n  const [name, setName] = useState('');\n  const [slug, setSlug] = useState('');\n  const [formError, setFormError] = useState<string | null>(null);\n\n  // Auto-generate slug from name\n  const handleNameChange = useCallback((value: string) => {\n    setName(value);\n    // Generate slug: lowercase, replace spaces with hyphens, remove special chars\n    const generatedSlug = value\n      .toLowerCase()\n      .replace(/\\s+/g, '-')\n      .replace(/[^a-z0-9-]/g, '')\n      .substring(0, 50);\n    setSlug(generatedSlug);\n  }, []);\n\n  const handleSubmit = useCallback(\n    async (event: React.FormEvent) => {\n      event.preventDefault();\n      setFormError(null);\n\n      if (!name.trim()) {\n        setFormError('Organization name is required');\n        return;\n      }\n\n      if (!slug.trim()) {\n        setFormError('Organization slug is required');\n        return;\n      }\n\n      try {\n        await onSubmit({ name: name.trim(), slug: slug.trim() });\n      } catch (err) {\n        setFormError((err as Error).message || 'Failed to create organization');\n      }\n    },\n    [name, slug, onSubmit]\n  );\n\n  return (\n    <form className=\"cedros-org-create-form\" onSubmit={handleSubmit}>\n      {formError && <ErrorMessage error={formError} />}\n\n      <div className=\"cedros-form-group\">\n        <label htmlFor=\"org-name\" className=\"cedros-form-label\">\n          Organization Name\n        </label>\n        <input\n          id=\"org-name\"\n          type=\"text\"\n          className=\"cedros-form-input\"\n          value={name}\n          onChange={(e) => handleNameChange(e.target.value)}\n          placeholder=\"My Organization\"\n          maxLength={255}\n          disabled={isLoading}\n          autoFocus\n        />\n      </div>\n\n      <div className=\"cedros-form-group\">\n        <label htmlFor=\"org-slug\" className=\"cedros-form-label\">\n          URL Slug\n        </label>\n        <div className=\"cedros-form-input-prefix\">\n          <span className=\"cedros-form-prefix\">@</span>\n          <input\n            id=\"org-slug\"\n            type=\"text\"\n            className=\"cedros-form-input\"\n            value={slug}\n            onChange={(e) => setSlug(e.target.value.toLowerCase())}\n            placeholder=\"my-organization\"\n            maxLength={100}\n            pattern=\"[a-z0-9-]+\"\n            disabled={isLoading}\n          />\n        </div>\n        <span className=\"cedros-form-hint\">Only lowercase letters, numbers, and hyphens</span>\n      </div>\n\n      <div className=\"cedros-form-actions\">\n        <button\n          type=\"button\"\n          className=\"cedros-button cedros-button-outline\"\n          onClick={onCancel}\n          disabled={isLoading}\n        >\n          Cancel\n        </button>\n        <button\n          type=\"submit\"\n          className=\"cedros-button cedros-button-primary\"\n          disabled={isLoading || !name.trim() || !slug.trim()}\n        >\n          {isLoading ? <LoadingSpinner size=\"sm\" /> : 'Create Organization'}\n        </button>\n      </div>\n    </form>\n  );\n}\n","/**\n * Organization switcher modal component\n *\n * Refactored to extract sub-components (F-02):\n * - CreateOrgForm -> ./CreateOrgForm.tsx\n * - OrgListView -> ./OrgListView.tsx\n * - OrgAvatar -> ./OrgAvatar.tsx\n * - Icons -> ./icons.tsx\n */\nimport { useState, useCallback, useEffect, useRef } from 'react';\nimport type { OrgWithMembership, CreateOrgRequest, DisplayError } from '../../types';\nimport { ErrorMessage } from '../shared/ErrorMessage';\nimport { OrgListView } from './OrgListView';\nimport { CreateOrgForm } from './CreateOrgForm';\nimport { CloseIcon } from './icons';\n\nexport interface OrgSwitcherProps {\n  /** Whether the modal is open */\n  isOpen: boolean;\n  /** Callback to close the modal */\n  onClose: () => void;\n  /** List of organizations */\n  orgs: OrgWithMembership[];\n  /** Currently active organization */\n  activeOrg: OrgWithMembership | null;\n  /** Loading state */\n  isLoading?: boolean;\n  /** Error message */\n  error?: DisplayError;\n  /** Callback when organization is selected */\n  onSelect: (orgId: string) => void;\n  /** Callback when new organization is created */\n  onCreate?: (data: CreateOrgRequest) => Promise<void>;\n  /** Additional CSS class */\n  className?: string;\n}\n\ntype ViewMode = 'list' | 'create';\n\n/**\n * Modal for switching organizations and creating new ones.\n *\n * @example\n * ```tsx\n * function App() {\n *   const [isOpen, setIsOpen] = useState(false);\n *   const { orgs, activeOrg, switchOrg, createOrg } = useOrgs();\n *\n *   return (\n *     <>\n *       <button onClick={() => setIsOpen(true)}>Switch org</button>\n *       <OrgSwitcher\n *         isOpen={isOpen}\n *         onClose={() => setIsOpen(false)}\n *         orgs={orgs}\n *         activeOrg={activeOrg}\n *         onSelect={switchOrg}\n *         onCreate={createOrg}\n *       />\n *     </>\n *   );\n * }\n * ```\n */\nexport function OrgSwitcher({\n  isOpen,\n  onClose,\n  orgs,\n  activeOrg,\n  isLoading = false,\n  error,\n  onSelect,\n  onCreate,\n  className = '',\n}: OrgSwitcherProps) {\n  // Render null when closed - inner content unmounts, resetting state naturally\n  if (!isOpen) return null;\n\n  return (\n    <OrgSwitcherModal\n      onClose={onClose}\n      orgs={orgs}\n      activeOrg={activeOrg}\n      isLoading={isLoading}\n      error={error}\n      onSelect={onSelect}\n      onCreate={onCreate}\n      className={className}\n    />\n  );\n}\n\n// Inner modal component - unmounts when modal closes, resetting viewMode state\nfunction OrgSwitcherModal({\n  onClose,\n  orgs,\n  activeOrg,\n  isLoading = false,\n  error,\n  onSelect,\n  onCreate,\n  className,\n}: Omit<OrgSwitcherProps, 'isOpen'>) {\n  const [viewMode, setViewMode] = useState<ViewMode>('list');\n  const modalRef = useRef<HTMLDivElement>(null);\n  // UI-05: Store previously focused element for restoration\n  const previousFocusRef = useRef<HTMLElement | null>(null);\n\n  // UI-05: Focus trap and restoration\n  useEffect(() => {\n    // Save currently focused element\n    previousFocusRef.current = document.activeElement as HTMLElement;\n\n    // Focus the close button when modal opens\n    const closeButton = modalRef.current?.querySelector<HTMLElement>('.cedros-modal-close');\n    closeButton?.focus();\n\n    return () => {\n      // Restore focus when modal closes\n      previousFocusRef.current?.focus();\n    };\n  }, []);\n\n  // Close on escape key - runs unconditionally since component only mounts when modal is open\n  useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        onClose();\n        return;\n      }\n\n      // UI-05: Focus trap - Tab/Shift+Tab within modal\n      if (event.key === 'Tab' && modalRef.current) {\n        const focusableElements = modalRef.current.querySelectorAll<HTMLElement>(\n          'button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex=\"-1\"])'\n        );\n        const firstElement = focusableElements[0];\n        const lastElement = focusableElements[focusableElements.length - 1];\n\n        if (event.shiftKey) {\n          // Shift+Tab: wrap from first to last\n          if (document.activeElement === firstElement) {\n            event.preventDefault();\n            lastElement?.focus();\n          }\n        } else {\n          // Tab: wrap from last to first\n          if (document.activeElement === lastElement) {\n            event.preventDefault();\n            firstElement?.focus();\n          }\n        }\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [onClose]);\n\n  // Handle backdrop click\n  const handleBackdropClick = useCallback(\n    (event: React.MouseEvent) => {\n      if (event.target === event.currentTarget) {\n        onClose();\n      }\n    },\n    [onClose]\n  );\n\n  const handleSelect = useCallback(\n    (orgId: string) => {\n      onSelect(orgId);\n      onClose();\n    },\n    [onSelect, onClose]\n  );\n\n  const handleCreate = useCallback(\n    async (data: CreateOrgRequest) => {\n      await onCreate?.(data);\n      onClose();\n    },\n    [onCreate, onClose]\n  );\n\n  return (\n    <div className=\"cedros-modal-backdrop\" onClick={handleBackdropClick}>\n      <div\n        ref={modalRef}\n        className={`cedros-modal cedros-org-switcher ${className}`}\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-labelledby=\"org-switcher-title\"\n      >\n        <div className=\"cedros-modal-header\">\n          <h2 id=\"org-switcher-title\" className=\"cedros-modal-title\">\n            {viewMode === 'list' ? 'Switch Organization' : 'Create Organization'}\n          </h2>\n          <button type=\"button\" className=\"cedros-modal-close\" onClick={onClose} aria-label=\"Close\">\n            <CloseIcon />\n          </button>\n        </div>\n\n        <div className=\"cedros-modal-body\">\n          {error && <ErrorMessage error={error} />}\n\n          {viewMode === 'list' ? (\n            <OrgListView\n              orgs={orgs}\n              activeOrg={activeOrg}\n              isLoading={isLoading}\n              onSelect={handleSelect}\n              onCreateClick={onCreate ? () => setViewMode('create') : undefined}\n            />\n          ) : (\n            <CreateOrgForm\n              isLoading={isLoading}\n              onSubmit={handleCreate}\n              onCancel={() => setViewMode('list')}\n            />\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useState, useCallback, useEffect, useRef, useMemo } from 'react';\nimport type { Session, DisplayError } from '../../types';\nimport { LoadingSpinner } from '../shared/LoadingSpinner';\nimport { ErrorMessage } from '../shared/ErrorMessage';\n\nexport interface SessionListProps {\n  /** List of active sessions */\n  sessions: Session[];\n  /** Loading state */\n  isLoading?: boolean;\n  /** Error message */\n  error?: DisplayError;\n  /** Callback to revoke all other sessions */\n  onRevokeAll?: () => Promise<void>;\n  /** Additional CSS class */\n  className?: string;\n}\n\n/**\n * Display active sessions and allow revoking all other sessions.\n *\n * @example\n * ```tsx\n * function SecuritySettings() {\n *   const { sessions, isLoading, error, revokeAllSessions } = useSessions();\n *\n *   return (\n *     <SessionList\n *       sessions={sessions}\n *       isLoading={isLoading}\n *       error={error?.message}\n *       onRevokeAll={revokeAllSessions}\n *     />\n *   );\n * }\n * ```\n */\nexport function SessionList({\n  sessions,\n  isLoading = false,\n  error,\n  onRevokeAll,\n  className = '',\n}: SessionListProps) {\n  const [isRevoking, setIsRevoking] = useState(false);\n  const [revokeSuccess, setRevokeSuccess] = useState(false);\n  const revokeTimerRef = useRef<number | null>(null);\n\n  // PERF-05: Memoize filtered count to avoid O(n) filter on every render.\n  // This count is used in the button text and handleRevokeAll callback.\n  const otherSessionCount = useMemo(() => sessions.filter((s) => !s.isCurrent).length, [sessions]);\n\n  const handleRevokeAll = useCallback(async () => {\n    if (!onRevokeAll) return;\n\n    // M-09: Recalculate count inside handler to avoid stale closure.\n    // If sessions change between callback creation and confirm dialog,\n    // we want the confirm message to show the current count.\n    const currentOtherCount = sessions.filter((s) => !s.isCurrent).length;\n    if (currentOtherCount === 0) return;\n\n    const confirmed = window.confirm(\n      `Are you sure you want to sign out of ${currentOtherCount} other device(s)? This will log you out everywhere except this browser.`\n    );\n    if (!confirmed) return;\n\n    setIsRevoking(true);\n    setRevokeSuccess(false);\n\n    try {\n      await onRevokeAll();\n      setRevokeSuccess(true);\n      if (revokeTimerRef.current !== null) {\n        window.clearTimeout(revokeTimerRef.current);\n      }\n      revokeTimerRef.current = window.setTimeout(() => {\n        setRevokeSuccess(false);\n        revokeTimerRef.current = null;\n      }, 3000);\n    } finally {\n      setIsRevoking(false);\n    }\n  }, [onRevokeAll, sessions]);\n\n  useEffect(() => {\n    return () => {\n      if (revokeTimerRef.current !== null) {\n        window.clearTimeout(revokeTimerRef.current);\n        revokeTimerRef.current = null;\n      }\n    };\n  }, []);\n\n  if (isLoading && sessions.length === 0) {\n    return (\n      <div className={`cedros-session-list cedros-session-list-loading ${className}`}>\n        <LoadingSpinner />\n        <span>Loading sessions...</span>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={`cedros-session-list ${className}`}>\n        <ErrorMessage error={error} />\n      </div>\n    );\n  }\n\n  if (sessions.length === 0) {\n    return (\n      <div className={`cedros-session-list cedros-session-list-empty ${className}`}>\n        <p>No active sessions found.</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`cedros-session-list ${className}`}>\n      {revokeSuccess && (\n        <div className=\"cedros-session-success\" role=\"status\">\n          <CheckIcon />\n          <span>All other sessions have been revoked.</span>\n        </div>\n      )}\n\n      <ul className=\"cedros-session-items\">\n        {sessions.map((session) => (\n          <SessionItem key={session.id} session={session} />\n        ))}\n      </ul>\n\n      {onRevokeAll && otherSessionCount > 0 && (\n        <div className=\"cedros-session-actions\">\n          <button\n            type=\"button\"\n            className=\"cedros-button cedros-button-danger\"\n            onClick={handleRevokeAll}\n            disabled={isRevoking}\n          >\n            {isRevoking ? (\n              <>\n                <LoadingSpinner size=\"sm\" />\n                <span>Signing out...</span>\n              </>\n            ) : (\n              `Sign out of ${otherSessionCount} other device${otherSessionCount > 1 ? 's' : ''}`\n            )}\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Session item component\nfunction SessionItem({ session }: { session: Session }) {\n  const browserInfo = parseUserAgent(session.userAgent);\n  const isExpiringSoon = isSessionExpiringSoon(session.expiresAt);\n\n  return (\n    <li className={`cedros-session-item ${session.isCurrent ? 'cedros-session-item-current' : ''}`}>\n      <div className=\"cedros-session-item-icon\">\n        <DeviceIcon userAgent={session.userAgent} />\n      </div>\n      <div className=\"cedros-session-item-info\">\n        <div className=\"cedros-session-item-main\">\n          <span className=\"cedros-session-item-device\">\n            {browserInfo.browser} on {browserInfo.os}\n          </span>\n          {session.isCurrent && (\n            <span className=\"cedros-session-current-badge\">Current session</span>\n          )}\n        </div>\n        <div className=\"cedros-session-item-meta\">\n          {session.ipAddress && (\n            <span className=\"cedros-session-item-ip\">IP: {session.ipAddress}</span>\n          )}\n          <span className=\"cedros-session-item-created\">\n            Started {formatRelativeTime(session.createdAt)}\n          </span>\n          {isExpiringSoon && <span className=\"cedros-session-expiring\">Expires soon</span>}\n        </div>\n      </div>\n    </li>\n  );\n}\n\n// Helper functions\ninterface BrowserInfo {\n  browser: string;\n  os: string;\n}\n\nfunction parseUserAgent(userAgent?: string): BrowserInfo {\n  if (!userAgent) {\n    return { browser: 'Unknown browser', os: 'Unknown device' };\n  }\n\n  // Simple browser detection\n  let browser = 'Unknown browser';\n  if (userAgent.includes('Chrome') && !userAgent.includes('Edg')) {\n    browser = 'Chrome';\n  } else if (userAgent.includes('Safari') && !userAgent.includes('Chrome')) {\n    browser = 'Safari';\n  } else if (userAgent.includes('Firefox')) {\n    browser = 'Firefox';\n  } else if (userAgent.includes('Edg')) {\n    browser = 'Edge';\n  }\n\n  // Simple OS detection\n  let os = 'Unknown device';\n  if (userAgent.includes('Windows')) {\n    os = 'Windows';\n  } else if (userAgent.includes('Mac')) {\n    os = 'macOS';\n  } else if (userAgent.includes('Linux')) {\n    os = 'Linux';\n  } else if (userAgent.includes('iPhone') || userAgent.includes('iPad')) {\n    os = 'iOS';\n  } else if (userAgent.includes('Android')) {\n    os = 'Android';\n  }\n\n  return { browser, os };\n}\n\nfunction formatRelativeTime(dateString: string): string {\n  const date = new Date(dateString);\n  const now = new Date();\n  const diffMs = now.getTime() - date.getTime();\n  const diffMins = Math.floor(diffMs / (1000 * 60));\n  const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n  const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\n\n  if (diffMins < 1) {\n    return 'just now';\n  } else if (diffMins < 60) {\n    return `${diffMins} minute${diffMins > 1 ? 's' : ''} ago`;\n  } else if (diffHours < 24) {\n    return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;\n  } else if (diffDays < 7) {\n    return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;\n  } else {\n    return date.toLocaleDateString(undefined, {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n    });\n  }\n}\n\nfunction isSessionExpiringSoon(expiresAt: string): boolean {\n  const expires = new Date(expiresAt);\n  const now = new Date();\n  const hourInMs = 60 * 60 * 1000;\n  return expires.getTime() - now.getTime() < hourInMs;\n}\n\n// Icon components\nfunction DeviceIcon({ userAgent }: { userAgent?: string }) {\n  const isMobile =\n    userAgent?.includes('iPhone') || userAgent?.includes('iPad') || userAgent?.includes('Android');\n\n  if (isMobile) {\n    return (\n      <svg\n        className=\"cedros-session-device-icon\"\n        width=\"24\"\n        height=\"24\"\n        viewBox=\"0 0 24 24\"\n        fill=\"none\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n      >\n        <rect x=\"5\" y=\"2\" width=\"14\" height=\"20\" rx=\"2\" stroke=\"currentColor\" strokeWidth=\"1.5\" />\n        <circle cx=\"12\" cy=\"18\" r=\"1\" fill=\"currentColor\" />\n      </svg>\n    );\n  }\n\n  return (\n    <svg\n      className=\"cedros-session-device-icon\"\n      width=\"24\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <rect x=\"2\" y=\"4\" width=\"20\" height=\"14\" rx=\"2\" stroke=\"currentColor\" strokeWidth=\"1.5\" />\n      <path d=\"M8 21H16\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" />\n      <path d=\"M12 18V21\" stroke=\"currentColor\" strokeWidth=\"1.5\" />\n    </svg>\n  );\n}\n\nfunction CheckIcon() {\n  return (\n    <svg\n      className=\"cedros-session-check\"\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 16 16\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        d=\"M3 8L6 11L13 5\"\n        stroke=\"currentColor\"\n        strokeWidth=\"2\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n      />\n    </svg>\n  );\n}\n","/**\n * Component to display BIP-39 recovery phrase\n *\n * Shows 12 words in a grid format with copy functionality.\n * Includes security warnings about storing the phrase safely.\n */\n\nimport { useState, useCallback, useRef, useEffect } from 'react';\nimport { formatMnemonicForDisplay } from '../../crypto';\n\nexport interface RecoveryPhraseDisplayProps {\n  /** Array of 12 mnemonic words */\n  words: string[];\n  /** Callback when user confirms they've saved the phrase */\n  onConfirm: () => void;\n  /** Optional class name */\n  className?: string;\n}\n\n/**\n * Display recovery phrase with security warnings\n */\nexport function RecoveryPhraseDisplay({\n  words,\n  onConfirm,\n  className = '',\n}: RecoveryPhraseDisplayProps) {\n  const [copied, setCopied] = useState(false);\n  const [confirmed, setConfirmed] = useState(false);\n  const copyTimerRef = useRef<number | null>(null);\n\n  const wordGroups = formatMnemonicForDisplay(words);\n\n  const handleCopy = useCallback(async () => {\n    try {\n      await navigator.clipboard.writeText(words.join(' '));\n      setCopied(true);\n      if (copyTimerRef.current !== null) {\n        window.clearTimeout(copyTimerRef.current);\n      }\n      copyTimerRef.current = window.setTimeout(() => setCopied(false), 2000);\n    } catch {\n      // Clipboard API not available\n    }\n  }, [words]);\n\n  useEffect(() => {\n    return () => {\n      if (copyTimerRef.current !== null) {\n        window.clearTimeout(copyTimerRef.current);\n        copyTimerRef.current = null;\n      }\n    };\n  }, []);\n\n  // COMP-02: The `confirmed` check is defense-in-depth - button is disabled when\n  // !confirmed, but check guards against CSS/JS injection enabling the button\n  const handleConfirm = useCallback(() => {\n    if (confirmed) {\n      onConfirm();\n    }\n  }, [confirmed, onConfirm]);\n\n  return (\n    <div className={`cedros-recovery-phrase-display ${className}`}>\n      <div className=\"cedros-recovery-header\">\n        <h3 className=\"cedros-recovery-title\">Recovery Phrase</h3>\n        <p className=\"cedros-recovery-warning\">\n          Write down these 12 words in order and store them securely. This is the only way to\n          recover your wallet if you lose access.\n        </p>\n      </div>\n\n      <div className=\"cedros-recovery-grid\">\n        {wordGroups.map((group, groupIndex) => (\n          <div key={groupIndex} className=\"cedros-word-group\">\n            {group.map((word, wordIndex) => {\n              const number = groupIndex * 4 + wordIndex + 1;\n              return (\n                <div key={number} className=\"cedros-word-item\">\n                  <span className=\"cedros-word-number\">{number}.</span>\n                  <span className=\"cedros-word-text\">{word}</span>\n                </div>\n              );\n            })}\n          </div>\n        ))}\n      </div>\n\n      <button\n        type=\"button\"\n        className=\"cedros-button cedros-button-secondary cedros-copy-btn\"\n        onClick={handleCopy}\n      >\n        {copied ? 'Copied!' : 'Copy to Clipboard'}\n      </button>\n\n      <div className=\"cedros-recovery-security\">\n        <div className=\"cedros-warning-box\">\n          <svg\n            className=\"cedros-warning-icon\"\n            width=\"20\"\n            height=\"20\"\n            viewBox=\"0 0 20 20\"\n            fill=\"none\"\n            aria-hidden=\"true\"\n          >\n            <path\n              d=\"M10 6v4m0 4h.01M19 10a9 9 0 11-18 0 9 9 0 0118 0z\"\n              stroke=\"currentColor\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n            />\n          </svg>\n          <div className=\"cedros-warning-content\">\n            <strong>Security Warning</strong>\n            <ul>\n              <li>Never share this phrase with anyone</li>\n              <li>Store it offline in a secure location</li>\n              <li>Anyone with this phrase can access your wallet</li>\n              <li>Cedros cannot recover this phrase for you</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"cedros-recovery-confirm\">\n        <label className=\"cedros-checkbox-label\">\n          <input\n            type=\"checkbox\"\n            checked={confirmed}\n            onChange={(e) => setConfirmed(e.target.checked)}\n            className=\"cedros-checkbox\"\n          />\n          <span>I have written down and securely stored my recovery phrase</span>\n        </label>\n\n        <button\n          type=\"button\"\n          className=\"cedros-button cedros-button-primary\"\n          onClick={handleConfirm}\n          disabled={!confirmed}\n        >\n          Continue\n        </button>\n      </div>\n    </div>\n  );\n}\n","/**\n * Component for entering BIP-39 recovery phrase\n *\n * Provides input fields for 12 words with validation and autocomplete.\n */\n\nimport { useState, useCallback, useId, useRef, useEffect } from 'react';\nimport {\n  isValidWord,\n  getWordSuggestions,\n  parseMnemonicInput,\n  isValidMnemonic,\n  MNEMONIC_WORD_COUNT,\n} from '../../crypto';\n\nexport interface RecoveryPhraseInputProps {\n  /** Callback when valid phrase is entered */\n  onSubmit: (words: string[]) => void;\n  /** Callback to cancel */\n  onCancel?: () => void;\n  /** Whether submission is in progress */\n  isSubmitting?: boolean;\n  /** Error message to display */\n  error?: string;\n  /** Optional class name */\n  className?: string;\n}\n\n/**\n * Input form for recovery phrase\n */\nexport function RecoveryPhraseInput({\n  onSubmit,\n  onCancel,\n  isSubmitting = false,\n  error,\n  className = '',\n}: RecoveryPhraseInputProps) {\n  const [words, setWords] = useState<string[]>(Array(MNEMONIC_WORD_COUNT).fill(''));\n  const [activeIndex, setActiveIndex] = useState<number | null>(null);\n  const [suggestions, setSuggestions] = useState<string[]>([]);\n  const [validationError, setValidationError] = useState<string | null>(null);\n  const inputId = useId();\n  const suggestionsTimerRef = useRef<number | null>(null);\n\n  const handleWordChange = useCallback(\n    (index: number, value: string) => {\n      const newWords = [...words];\n      newWords[index] = value.toLowerCase().trim();\n      setWords(newWords);\n\n      // Update suggestions\n      if (value.length > 0) {\n        const newSuggestions = getWordSuggestions(value, 5);\n        setSuggestions(newSuggestions);\n      } else {\n        setSuggestions([]);\n      }\n\n      // Clear validation error while typing\n      setValidationError(null);\n    },\n    [words]\n  );\n\n  const handleWordFocus = useCallback((index: number) => {\n    setActiveIndex(index);\n    setSuggestions([]);\n  }, []);\n\n  const handleWordBlur = useCallback(\n    (index: number) => {\n      // Validate word on blur\n      const word = words[index];\n      if (word && !isValidWord(word)) {\n        setValidationError(`Word ${index + 1} is not in the wordlist`);\n      }\n\n      // Clear suggestions after a delay (allows clicking suggestions)\n      if (suggestionsTimerRef.current !== null) {\n        window.clearTimeout(suggestionsTimerRef.current);\n      }\n      suggestionsTimerRef.current = window.setTimeout(() => {\n        if (activeIndex === index) {\n          setSuggestions([]);\n        }\n      }, 200);\n    },\n    [words, activeIndex]\n  );\n\n  useEffect(() => {\n    return () => {\n      if (suggestionsTimerRef.current !== null) {\n        window.clearTimeout(suggestionsTimerRef.current);\n        suggestionsTimerRef.current = null;\n      }\n    };\n  }, []);\n\n  const handleSuggestionClick = useCallback(\n    (suggestion: string) => {\n      if (activeIndex !== null) {\n        const newWords = [...words];\n        newWords[activeIndex] = suggestion;\n        setWords(newWords);\n        setSuggestions([]);\n\n        // Move to next input\n        const nextInput = document.querySelector<HTMLInputElement>(\n          `[data-word-index=\"${activeIndex + 1}\"]`\n        );\n        nextInput?.focus();\n      }\n    },\n    [activeIndex, words]\n  );\n\n  const handlePaste = useCallback((e: React.ClipboardEvent) => {\n    const pastedText = e.clipboardData.getData('text');\n    const parsedWords = parseMnemonicInput(pastedText);\n\n    if (parsedWords.length === MNEMONIC_WORD_COUNT) {\n      e.preventDefault();\n      setWords(parsedWords);\n      setValidationError(null);\n    }\n  }, []);\n\n  const handleSubmit = useCallback(\n    (e: React.FormEvent) => {\n      e.preventDefault();\n\n      // Validate all words are filled\n      const emptyCount = words.filter((w) => !w).length;\n      if (emptyCount > 0) {\n        setValidationError(`Please enter all ${MNEMONIC_WORD_COUNT} words`);\n        return;\n      }\n\n      // Validate each word is in wordlist\n      const invalidWords = words\n        .map((w, i) => ({ word: w, index: i + 1 }))\n        .filter(({ word }) => !isValidWord(word));\n\n      if (invalidWords.length > 0) {\n        setValidationError(`Invalid words: ${invalidWords.map((w) => `#${w.index}`).join(', ')}`);\n        return;\n      }\n\n      // Validate checksum\n      if (!isValidMnemonic(words)) {\n        setValidationError('Invalid recovery phrase - please check your words');\n        return;\n      }\n\n      onSubmit(words);\n    },\n    [words, onSubmit]\n  );\n\n  const displayError = error || validationError;\n\n  return (\n    <form\n      className={`cedros-recovery-phrase-input ${className}`}\n      onSubmit={handleSubmit}\n      onPaste={handlePaste}\n    >\n      <div className=\"cedros-recovery-input-header\">\n        <h3 className=\"cedros-recovery-input-title\">Enter Recovery Phrase</h3>\n        <p className=\"cedros-recovery-input-description\">\n          Enter your 12-word recovery phrase. You can paste the entire phrase at once.\n        </p>\n      </div>\n\n      <div className=\"cedros-word-inputs\">\n        {Array.from({ length: MNEMONIC_WORD_COUNT }, (_, index) => (\n          <div key={index} className=\"cedros-word-input-wrapper\">\n            <label className=\"cedros-word-label\">{index + 1}.</label>\n            <input\n              type=\"text\"\n              className={`cedros-word-input ${\n                words[index] && !isValidWord(words[index])\n                  ? 'cedros-word-invalid'\n                  : words[index] && isValidWord(words[index])\n                    ? 'cedros-word-valid'\n                    : ''\n              }`}\n              value={words[index]}\n              onChange={(e) => handleWordChange(index, e.target.value)}\n              onFocus={() => handleWordFocus(index)}\n              onBlur={() => handleWordBlur(index)}\n              data-word-index={index}\n              autoComplete=\"off\"\n              autoCapitalize=\"none\"\n              spellCheck={false}\n              disabled={isSubmitting}\n              aria-label={`Word ${index + 1}`}\n            />\n          </div>\n        ))}\n      </div>\n\n      {activeIndex !== null && suggestions.length > 0 && (\n        <div className=\"cedros-suggestions\" role=\"listbox\" id={`${inputId}-suggestions`}>\n          {suggestions.map((suggestion) => (\n            <button\n              key={suggestion}\n              type=\"button\"\n              className=\"cedros-suggestion\"\n              onClick={() => handleSuggestionClick(suggestion)}\n              role=\"option\"\n            >\n              {suggestion}\n            </button>\n          ))}\n        </div>\n      )}\n\n      {displayError && (\n        <p className=\"cedros-input-error\" role=\"alert\">\n          {displayError}\n        </p>\n      )}\n\n      <div className=\"cedros-recovery-input-actions\">\n        {onCancel && (\n          <button\n            type=\"button\"\n            className=\"cedros-button cedros-button-secondary\"\n            onClick={onCancel}\n            disabled={isSubmitting}\n          >\n            Cancel\n          </button>\n        )}\n        <button\n          type=\"submit\"\n          className=\"cedros-button cedros-button-primary\"\n          disabled={isSubmitting}\n        >\n          {isSubmitting ? 'Recovering...' : 'Recover Wallet'}\n        </button>\n      </div>\n    </form>\n  );\n}\n","/**\n * Component to display warnings about missing crypto capabilities\n */\n\nimport { getMissingCapabilitiesMessage, getBrowserSupportInfo } from '../../crypto';\nimport type { CryptoCapabilities } from '../../crypto';\n\nexport interface CapabilityWarningProps {\n  /** Capability check results */\n  capabilities: CryptoCapabilities;\n  /** Optional class name */\n  className?: string;\n}\n\n/**\n * Warning display for missing capabilities\n */\nexport function CapabilityWarning({ capabilities, className = '' }: CapabilityWarningProps) {\n  if (capabilities.allSupported) {\n    return null;\n  }\n\n  const message = getMissingCapabilitiesMessage(capabilities);\n  const browserInfo = getBrowserSupportInfo();\n\n  return (\n    <div className={`cedros-capability-warning ${className}`} role=\"alert\">\n      <div className=\"cedros-warning-header\">\n        <svg\n          className=\"cedros-warning-icon\"\n          width=\"24\"\n          height=\"24\"\n          viewBox=\"0 0 24 24\"\n          fill=\"none\"\n          aria-hidden=\"true\"\n        >\n          <path\n            d=\"M12 9v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n            stroke=\"currentColor\"\n            strokeWidth=\"2\"\n            strokeLinecap=\"round\"\n          />\n        </svg>\n        <h3 className=\"cedros-warning-title\">Wallet Feature Unavailable</h3>\n      </div>\n\n      <p className=\"cedros-warning-message\">{message}</p>\n\n      <div className=\"cedros-capability-details\">\n        <h4>Browser Compatibility</h4>\n        <p>\n          Detected: {browserInfo.browser} {browserInfo.version}\n          {browserInfo.likelySupported ? ' (likely supported)' : ' (may not be supported)'}\n        </p>\n\n        <h4>Required Features</h4>\n        <ul className=\"cedros-capability-list\">\n          <li className={capabilities.webCrypto ? 'cedros-cap-ok' : 'cedros-cap-missing'}>\n            Web Crypto API: {capabilities.webCrypto ? 'Available' : 'Missing'}\n          </li>\n          <li className={capabilities.aesGcm ? 'cedros-cap-ok' : 'cedros-cap-missing'}>\n            AES-GCM Encryption: {capabilities.aesGcm ? 'Available' : 'Missing'}\n          </li>\n          <li className={capabilities.hkdf ? 'cedros-cap-ok' : 'cedros-cap-missing'}>\n            HKDF Key Derivation: {capabilities.hkdf ? 'Available' : 'Missing'}\n          </li>\n          <li className={capabilities.webAuthn ? 'cedros-cap-ok' : 'cedros-cap-missing'}>\n            WebAuthn/Passkeys: {capabilities.webAuthn ? 'Available' : 'Missing'}\n          </li>\n          <li className={capabilities.webAuthnPrf ? 'cedros-cap-ok' : 'cedros-cap-missing'}>\n            WebAuthn PRF Extension: {capabilities.webAuthnPrf ? 'Available' : 'Missing'}\n          </li>\n          <li className={capabilities.argon2 ? 'cedros-cap-ok' : 'cedros-cap-missing'}>\n            Argon2 Password Hashing: {capabilities.argon2 ? 'Available' : 'Missing'}\n          </li>\n        </ul>\n      </div>\n\n      <div className=\"cedros-capability-help\">\n        <h4>Recommended Browsers</h4>\n        <ul>\n          <li>Chrome 116+ on Windows, macOS, or Android</li>\n          <li>Safari 17+ on macOS or iOS</li>\n          <li>Edge 116+ on Windows</li>\n        </ul>\n        <p className=\"cedros-capability-note\">\n          A platform authenticator (Touch ID, Face ID, or Windows Hello) is required.\n        </p>\n      </div>\n    </div>\n  );\n}\n","/**\n * Hook to fetch wallet discovery config from server\n *\n * Fetches wallet configuration from the discovery endpoint to determine\n * recovery mode and other wallet settings.\n */\n\nimport { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useCedrosLoginOptional } from '../context/useCedrosLogin';\nimport { ApiClient } from '../utils/apiClient';\nimport type { WalletDiscoveryConfig, WalletRecoveryMode } from '../types/wallet';\n\n/** Discovery endpoint response */\ninterface DiscoveryResponse {\n  wallet?: {\n    enabled: boolean;\n    recoveryMode: string;\n    unlockTtlSeconds: number;\n  };\n}\n\nconst VALID_RECOVERY_MODES: WalletRecoveryMode[] = ['share_c_only', 'full_seed', 'none'];\n\nfunction normalizeRecoveryMode(mode: string | undefined): WalletRecoveryMode {\n  if (!mode) return 'share_c_only';\n  return VALID_RECOVERY_MODES.includes(mode as WalletRecoveryMode)\n    ? (mode as WalletRecoveryMode)\n    : 'share_c_only';\n}\n\n/** Return type for useWalletDiscovery hook */\nexport interface UseWalletDiscoveryReturn {\n  /** Whether wallet feature is enabled on server */\n  walletEnabled: boolean;\n  /** Recovery mode: share_c_only or full_seed */\n  recoveryMode: WalletRecoveryMode;\n  /** Session unlock TTL in seconds */\n  unlockTtlSeconds: number;\n  /** Whether config is still loading */\n  isLoading: boolean;\n  /** Error message if fetch failed */\n  error: string | null;\n  /** Refetch the config */\n  refetch: () => Promise<void>;\n}\n\n/** Default return value when outside provider context */\nconst DEFAULT_RETURN: UseWalletDiscoveryReturn = {\n  walletEnabled: false,\n  recoveryMode: 'share_c_only',\n  unlockTtlSeconds: 900,\n  isLoading: false,\n  error: null,\n  refetch: async () => {},\n};\n\n/**\n * Hook to fetch wallet discovery configuration from server\n *\n * Automatically fetches on mount and caches the result.\n * Default values are used if fetch fails or wallet is not enabled.\n * Returns defaults when used outside CedrosLoginProvider.\n */\nexport function useWalletDiscovery(): UseWalletDiscoveryReturn {\n  const context = useCedrosLoginOptional();\n\n  const [walletConfig, setWalletConfig] = useState<WalletDiscoveryConfig | null>(null);\n  const [isLoading, setIsLoading] = useState(!!context);\n  const [error, setError] = useState<string | null>(null);\n\n  const apiClient = useMemo(() => {\n    if (!context) return null;\n    return new ApiClient({\n      baseUrl: context.config.serverUrl,\n      timeoutMs: context.config.requestTimeout,\n      retryAttempts: context.config.retryAttempts,\n    });\n  }, [context]);\n\n  const fetchConfig = useCallback(async () => {\n    if (!apiClient) return;\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const response = await apiClient.get<DiscoveryResponse>('/discovery');\n\n      if (response.wallet) {\n        setWalletConfig({\n          enabled: response.wallet.enabled,\n          recoveryMode: normalizeRecoveryMode(response.wallet.recoveryMode),\n          unlockTtlSeconds: response.wallet.unlockTtlSeconds,\n        });\n      } else {\n        // Wallet not configured on server\n        setWalletConfig({\n          enabled: false,\n          recoveryMode: 'share_c_only',\n          unlockTtlSeconds: 900,\n        });\n      }\n    } catch (err) {\n      const message = err instanceof Error ? err.message : 'Failed to fetch wallet config';\n      setError(message);\n      // Use defaults on error\n      setWalletConfig({\n        enabled: false,\n        recoveryMode: 'share_c_only',\n        unlockTtlSeconds: 900,\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  }, [apiClient]);\n\n  useEffect(() => {\n    if (apiClient) {\n      fetchConfig();\n    }\n  }, [apiClient, fetchConfig]);\n\n  // Return defaults when outside provider\n  if (!context) {\n    return DEFAULT_RETURN;\n  }\n\n  return {\n    walletEnabled: walletConfig?.enabled ?? false,\n    recoveryMode: walletConfig?.recoveryMode ?? 'share_c_only',\n    unlockTtlSeconds: walletConfig?.unlockTtlSeconds ?? 900,\n    isLoading,\n    error,\n    refetch: fetchConfig,\n  };\n}\n","/**\n * Hook for wallet enrollment flow (server-side signing)\n *\n * Orchestrates the complete enrollment process:\n * 1. Generate 32-byte seed\n * 2. Split into 3 Shamir shares\n * 3. Encrypt Share A with password/PIN or passkey PRF\n * 4. Derive Solana public key from seed\n * 5. Upload encrypted Share A + plaintext Share B to server\n * 6. Display recovery phrase (Share C or full seed based on config)\n *\n * Recovery modes:\n * - share_c_only: User gets Share C. Recovery within app only (not portable).\n * - full_seed: User gets full seed. Can use wallet elsewhere (portable).\n *\n * Share B is sent as plaintext (SSS math protects it - 1 share reveals nothing).\n * Passkey PRF is used only for passkey auth method. Server combines shares for signing.\n *\n * H-03: Security Note - Recovery Phrase Visibility\n * The recovery phrase is stored in React state during the 'showing_recovery' step.\n * This is intentional - the user MUST see the phrase to back it up. The phrase:\n * - Is visible in React DevTools during enrollment\n * - Is cleared from state when the component unmounts or enrollment completes\n * - Byte arrays (seed, shares) are securely wiped via sensitiveData ref\n * - String mnemonics cannot be securely wiped (JS string immutability)\n */\n\nimport { useState, useCallback, useRef, useEffect } from 'react';\nimport { useCedrosLogin } from '../context/useCedrosLogin';\nimport {\n  generateSeed,\n  generateArgon2Salt,\n  generatePrfSalt,\n  splitSecret,\n  argon2DeriveInWorker,\n  aesGcmEncryptToBase64,\n  uint8ArrayToBase64,\n  authenticateWithDiscoverablePrf,\n  registerPasskeyWithPrf,\n  deriveKeyFromPrf,\n  getPublicKeyFromSeed,\n  publicKeyToBase58,\n  seedToMnemonic,\n  shareToMnemonic,\n  wipeAll,\n  toEncryptionKey,\n  toShamirShare,\n  DEFAULT_KDF_PARAMS,\n} from '../crypto';\nimport { useWalletMaterial } from './useWalletMaterial';\nimport { useWalletDiscovery } from './useWalletDiscovery';\nimport type {\n  UseWalletEnrollmentReturn,\n  EnrollmentState,\n  WalletEnrollRequest,\n  ShareAAuthMethod,\n} from '../types/wallet';\n\n/**\n * Hook for wallet enrollment\n *\n * Supports auth methods:\n * - password: User sets a wallet password (Argon2id KDF)\n * - passkey: Uses passkey PRF extension\n */\nexport function useWalletEnrollment(): UseWalletEnrollmentReturn {\n  const { user } = useCedrosLogin();\n  const { enroll } = useWalletMaterial();\n  const { recoveryMode } = useWalletDiscovery();\n\n  const [state, setState] = useState<EnrollmentState>({ step: 'idle' });\n  const [isEnrolling, setIsEnrolling] = useState(false);\n\n  // Store sensitive data for cleanup\n  const sensitiveData = useRef<Uint8Array[]>([]);\n\n  const cleanup = useCallback(() => {\n    wipeAll(...sensitiveData.current);\n    sensitiveData.current = [];\n  }, []);\n\n  useEffect(() => {\n    return () => {\n      cleanup();\n    };\n  }, [cleanup]);\n\n  /**\n   * Core enrollment logic shared by all auth methods\n   */\n  const doEnrollment = useCallback(\n    async (\n      authMethod: ShareAAuthMethod,\n      encryptionKey: Uint8Array,\n      kdfSalt?: Uint8Array,\n      prfSalt?: string\n    ): Promise<void> => {\n      // Step 1: Generate seed\n      setState({ step: 'generating_seed' });\n      const seed = generateSeed();\n      sensitiveData.current.push(seed);\n\n      // Step 2: Split into shares\n      setState({ step: 'splitting_shares' });\n      const { shareA, shareB, shareC } = splitSecret(seed);\n      sensitiveData.current.push(shareA, shareB, shareC);\n\n      // Step 3: Encrypt Share A\n      setState({ step: 'encrypting_shares' });\n      const encryptedA = await aesGcmEncryptToBase64(shareA, toEncryptionKey(encryptionKey));\n\n      // Step 4: Derive Solana public key\n      const publicKey = getPublicKeyFromSeed(seed);\n      const solanaPubkey = publicKeyToBase58(publicKey);\n\n      // Step 5: Upload to server\n      setState({ step: 'uploading' });\n\n      const request: WalletEnrollRequest = {\n        solanaPubkey,\n        shareAAuthMethod: authMethod,\n        shareACiphertext: encryptedA.ciphertext,\n        shareANonce: encryptedA.nonce,\n        // Share B is now plaintext (SSS math protects it)\n        shareB: uint8ArrayToBase64(shareB),\n      };\n\n      // Add auth-method-specific fields\n      if (authMethod === 'password') {\n        if (!kdfSalt) throw new Error('KDF salt required for password method');\n        request.shareAKdfSalt = uint8ArrayToBase64(kdfSalt);\n        request.shareAKdfParams = DEFAULT_KDF_PARAMS;\n      }\n\n      if (authMethod === 'passkey' && prfSalt) {\n        request.prfSalt = prfSalt;\n      }\n\n      await enroll(request);\n\n      // Step 6: Show recovery phrase based on recovery mode\n      // - share_c_only: Show Share C (app-locked, not portable)\n      // - full_seed: Show full seed (portable to other wallets)\n      // - none: Skip recovery phrase entirely (Privacy Cash mode)\n      if (recoveryMode === 'none') {\n        // No recovery option - go straight to complete\n        cleanup();\n        setState({\n          step: 'complete',\n          solanaPubkey,\n        });\n      } else {\n        const recoveryPhrase =\n          recoveryMode === 'full_seed'\n            ? seedToMnemonic(seed)\n            : shareToMnemonic(toShamirShare(shareC));\n\n        setState({\n          step: 'showing_recovery',\n          recoveryPhrase,\n          solanaPubkey,\n        });\n      }\n    },\n    [enroll, recoveryMode, cleanup]\n  );\n\n  /**\n   * Start enrollment with password (email users)\n   * Uses user's login password for Share A encryption\n   */\n  const startEnrollmentWithPassword = useCallback(\n    async (password: string): Promise<void> => {\n      if (!user) {\n        setState({ step: 'error', error: 'User not authenticated' });\n        return;\n      }\n\n      setIsEnrolling(true);\n      cleanup();\n\n      try {\n        // Derive key from password using Argon2id\n        const salt = generateArgon2Salt();\n        const key = await argon2DeriveInWorker(password, salt, DEFAULT_KDF_PARAMS);\n        sensitiveData.current.push(key);\n\n        await doEnrollment('password', key, salt);\n      } catch (err) {\n        setState({\n          step: 'error',\n          error: err instanceof Error ? err.message : 'Enrollment failed',\n        });\n      } finally {\n        setIsEnrolling(false);\n      }\n    },\n    [user, cleanup, doEnrollment]\n  );\n\n  /**\n   * Start enrollment with passkey PRF\n   * Uses WebAuthn PRF extension for Share A encryption\n   */\n  const startEnrollmentWithPasskey = useCallback(async (): Promise<void> => {\n    if (!user) {\n      setState({ step: 'error', error: 'User not authenticated' });\n      return;\n    }\n\n    setIsEnrolling(true);\n    cleanup();\n\n    try {\n      // Generate PRF salt\n      const prfSalt = generatePrfSalt();\n      const prfSaltBase64 = uint8ArrayToBase64(prfSalt);\n\n      // Register passkey with PRF; fallback to authenticate if credential exists\n      setState({ step: 'registering_passkey' });\n      let prfOutput: Uint8Array;\n      try {\n        const userIdBytes = new TextEncoder().encode(user.id);\n        const displayName = user.name ?? user.email ?? 'User';\n        const userName = user.email ?? user.id;\n        const registration = await registerPasskeyWithPrf(\n          userIdBytes,\n          userName,\n          displayName,\n          prfSalt\n        );\n        prfOutput = registration.prfOutput;\n      } catch (err) {\n        const error = err as DOMException;\n        if (error?.name !== 'InvalidStateError') {\n          throw err;\n        }\n        const prfResult = await authenticateWithDiscoverablePrf(prfSaltBase64);\n        prfOutput = prfResult.prfOutput;\n      }\n      sensitiveData.current.push(prfOutput);\n\n      // Derive key from PRF output\n      const key = await deriveKeyFromPrf(prfOutput, prfSalt);\n      sensitiveData.current.push(key);\n\n      await doEnrollment('passkey', key, undefined, prfSaltBase64);\n    } catch (err) {\n      setState({\n        step: 'error',\n        error: err instanceof Error ? err.message : 'Enrollment failed',\n      });\n    } finally {\n      setIsEnrolling(false);\n    }\n  }, [user, cleanup, doEnrollment]);\n\n  const confirmRecoveryPhrase = useCallback(() => {\n    // User confirmed they saved the recovery phrase\n    const solanaPubkey = state.solanaPubkey;\n    cleanup();\n\n    setState({\n      step: 'complete',\n      solanaPubkey,\n    });\n  }, [state.solanaPubkey, cleanup]);\n\n  const cancel = useCallback(() => {\n    cleanup();\n    setState({ step: 'idle' });\n    setIsEnrolling(false);\n  }, [cleanup]);\n\n  return {\n    state,\n    startEnrollmentWithPassword,\n    startEnrollmentWithPasskey,\n    confirmRecoveryPhrase,\n    cancel,\n    isEnrolling,\n  };\n}\n","/**\n * Wallet enrollment wizard component (server-side signing)\n *\n * Guides user through the complete wallet enrollment process:\n * 1. Choose authentication method (password/passkey)\n * 2. Enter credentials for Share A encryption\n * 3. Display and confirm recovery phrase\n *\n * Share B is stored as plaintext on the server (SSS math protects it).\n */\n\nimport { useState, useCallback, useEffect } from 'react';\nimport { useCedrosLogin } from '../../context/useCedrosLogin';\nimport { useWalletEnrollment } from '../../hooks/useWalletEnrollment';\nimport { PasswordInput } from '../email/PasswordInput';\nimport { RecoveryPhraseDisplay } from './RecoveryPhraseDisplay';\nimport { validatePassword } from '../../utils/validation';\nimport type { ShareAAuthMethod } from '../../types/wallet';\n\nexport interface WalletEnrollmentProps {\n  /** Callback when enrollment completes */\n  onComplete?: (solanaPubkey: string) => void;\n  /** Callback to cancel enrollment */\n  onCancel?: () => void;\n  /** Optional class name */\n  className?: string;\n  /** Force a specific auth method (otherwise auto-detected) */\n  forceAuthMethod?: ShareAAuthMethod;\n}\n\n/**\n * Wallet enrollment wizard\n */\nexport function WalletEnrollment({\n  onComplete,\n  onCancel,\n  className = '',\n  forceAuthMethod,\n}: WalletEnrollmentProps) {\n  const { user } = useCedrosLogin();\n  const {\n    state,\n    startEnrollmentWithPassword,\n    startEnrollmentWithPasskey,\n    confirmRecoveryPhrase,\n    cancel,\n    isEnrolling,\n  } = useWalletEnrollment();\n\n  // Determine default auth method based on user type\n  const getDefaultAuthMethod = (): ShareAAuthMethod => {\n    if (forceAuthMethod) return forceAuthMethod;\n    return 'password';\n  };\n\n  const [authMethod, setAuthMethod] = useState<ShareAAuthMethod>(getDefaultAuthMethod);\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [passwordError, setPasswordError] = useState<string | null>(null);\n\n  // MAINT-02: Update authMethod when user changes (e.g., different login)\n  useEffect(() => {\n    setAuthMethod(getDefaultAuthMethod());\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [user?.id, forceAuthMethod]);\n\n  const handlePasswordSubmit = useCallback(\n    async (e: React.FormEvent) => {\n      e.preventDefault();\n\n      // Validate passwords match\n      if (password !== confirmPassword) {\n        setPasswordError('Passwords do not match');\n        return;\n      }\n\n      // Validate password strength using full validation rules\n      const passwordValidation = validatePassword(password);\n      if (!passwordValidation.isValid) {\n        const firstError = Object.values(passwordValidation.errors)[0];\n        setPasswordError(firstError ?? 'Password does not meet requirements');\n        return;\n      }\n\n      setPasswordError(null);\n      await startEnrollmentWithPassword(password);\n    },\n    [password, confirmPassword, startEnrollmentWithPassword]\n  );\n\n  const handlePasskeySubmit = useCallback(async () => {\n    await startEnrollmentWithPasskey();\n  }, [startEnrollmentWithPasskey]);\n\n  const handleRecoveryConfirm = useCallback(() => {\n    confirmRecoveryPhrase();\n    if (state.solanaPubkey) {\n      onComplete?.(state.solanaPubkey);\n    }\n  }, [confirmRecoveryPhrase, state.solanaPubkey, onComplete]);\n\n  const handleCancel = useCallback(() => {\n    cancel();\n    onCancel?.();\n  }, [cancel, onCancel]);\n\n  // Show loading/progress indicator during enrollment steps\n  // A11Y-03: aria-busy indicates async operation in progress\n  if (state.step === 'generating_seed' || state.step === 'splitting_shares') {\n    return (\n      <div className={`cedros-wallet-enrollment ${className}`} aria-busy=\"true\">\n        <div className=\"cedros-enrollment-progress\" role=\"status\" aria-live=\"polite\">\n          <div className=\"cedros-spinner\" aria-hidden=\"true\" />\n          <p>Generating secure wallet...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (state.step === 'encrypting_shares') {\n    return (\n      <div className={`cedros-wallet-enrollment ${className}`} aria-busy=\"true\">\n        <div className=\"cedros-enrollment-progress\" role=\"status\" aria-live=\"polite\">\n          <div className=\"cedros-spinner\" aria-hidden=\"true\" />\n          <p>Encrypting wallet shares...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (state.step === 'registering_passkey') {\n    return (\n      <div className={`cedros-wallet-enrollment ${className}`} aria-busy=\"true\">\n        <div className=\"cedros-enrollment-progress\" role=\"status\" aria-live=\"polite\">\n          <div className=\"cedros-passkey-prompt\">\n            <svg\n              className=\"cedros-passkey-icon\"\n              width=\"48\"\n              height=\"48\"\n              viewBox=\"0 0 48 48\"\n              fill=\"none\"\n              aria-hidden=\"true\"\n            >\n              <rect\n                x=\"8\"\n                y=\"16\"\n                width=\"32\"\n                height=\"24\"\n                rx=\"4\"\n                stroke=\"currentColor\"\n                strokeWidth=\"2\"\n              />\n              <circle cx=\"24\" cy=\"28\" r=\"4\" stroke=\"currentColor\" strokeWidth=\"2\" />\n              <path d=\"M24 32v4\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" />\n            </svg>\n            <h3>Authenticate with Passkey</h3>\n            <p>Follow your browser's prompt to use your passkey.</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (state.step === 'uploading') {\n    return (\n      <div className={`cedros-wallet-enrollment ${className}`} aria-busy=\"true\">\n        <div className=\"cedros-enrollment-progress\" role=\"status\" aria-live=\"polite\">\n          <div className=\"cedros-spinner\" aria-hidden=\"true\" />\n          <p>Saving wallet...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (state.step === 'showing_recovery' && state.recoveryPhrase) {\n    return (\n      <div className={`cedros-wallet-enrollment ${className}`}>\n        <RecoveryPhraseDisplay words={state.recoveryPhrase} onConfirm={handleRecoveryConfirm} />\n      </div>\n    );\n  }\n\n  if (state.step === 'complete') {\n    return (\n      <div className={`cedros-wallet-enrollment ${className}`}>\n        <div className=\"cedros-enrollment-complete\">\n          <svg\n            className=\"cedros-success-icon\"\n            width=\"48\"\n            height=\"48\"\n            viewBox=\"0 0 48 48\"\n            fill=\"none\"\n            aria-hidden=\"true\"\n          >\n            <circle cx=\"24\" cy=\"24\" r=\"20\" stroke=\"currentColor\" strokeWidth=\"2\" />\n            <path\n              d=\"M16 24l6 6 12-12\"\n              stroke=\"currentColor\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            />\n          </svg>\n          <h3>Wallet Created!</h3>\n          <p className=\"cedros-pubkey\">\n            <strong>Address:</strong> {state.solanaPubkey}\n          </p>\n          <p>Your non-custodial Solana wallet is ready to use.</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (state.step === 'error') {\n    return (\n      <div className={`cedros-wallet-enrollment ${className}`}>\n        <div className=\"cedros-enrollment-error\">\n          <svg\n            className=\"cedros-error-icon\"\n            width=\"48\"\n            height=\"48\"\n            viewBox=\"0 0 48 48\"\n            fill=\"none\"\n            aria-hidden=\"true\"\n          >\n            <circle cx=\"24\" cy=\"24\" r=\"20\" stroke=\"currentColor\" strokeWidth=\"2\" />\n            <path\n              d=\"M24 16v12m0 6h.01\"\n              stroke=\"currentColor\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n            />\n          </svg>\n          <h3>Enrollment Failed</h3>\n          <p className=\"cedros-error-message\">{state.error}</p>\n          <div className=\"cedros-error-actions\">\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-secondary\"\n              onClick={handleCancel}\n            >\n              Cancel\n            </button>\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-primary\"\n              onClick={() => cancel()}\n            >\n              Try Again\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Default: credential entry form\n  return (\n    <div className={`cedros-wallet-enrollment ${className}`}>\n      <div className=\"cedros-enrollment-header\">\n        <h2>Create Wallet</h2>\n        <p>Secure your wallet with a {authMethod === 'passkey' ? 'passkey' : 'password'}.</p>\n      </div>\n\n      {/* Auth method selector (only show if not forced) */}\n      {!forceAuthMethod && (\n        <div className=\"cedros-auth-method-selector\">\n          <label className=\"cedros-radio-label\">\n            <input\n              type=\"radio\"\n              name=\"authMethod\"\n              value=\"password\"\n              checked={authMethod === 'password'}\n              onChange={() => setAuthMethod('password')}\n              disabled={isEnrolling}\n            />\n            <span>Password</span>\n          </label>\n          <label className=\"cedros-radio-label\">\n            <input\n              type=\"radio\"\n              name=\"authMethod\"\n              value=\"passkey\"\n              checked={authMethod === 'passkey'}\n              onChange={() => setAuthMethod('passkey')}\n              disabled={isEnrolling}\n            />\n            <span>Passkey</span>\n          </label>\n        </div>\n      )}\n\n      {/* Password form */}\n      {authMethod === 'password' && (\n        <form onSubmit={handlePasswordSubmit} className=\"cedros-enrollment-form\">\n          <PasswordInput\n            label=\"Password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            showStrengthMeter\n            disabled={isEnrolling}\n            required\n            minLength={8}\n            placeholder=\"Enter a strong password\"\n          />\n\n          <PasswordInput\n            label=\"Confirm Password\"\n            value={confirmPassword}\n            onChange={(e) => setConfirmPassword(e.target.value)}\n            error={passwordError ?? undefined}\n            disabled={isEnrolling}\n            required\n            minLength={8}\n            placeholder=\"Confirm your password\"\n          />\n\n          <div className=\"cedros-password-info\">\n            <p>This password will be used to sign transactions.</p>\n          </div>\n\n          <div className=\"cedros-enrollment-actions\">\n            {onCancel && (\n              <button\n                type=\"button\"\n                className=\"cedros-button cedros-button-secondary\"\n                onClick={handleCancel}\n                disabled={isEnrolling}\n              >\n                Cancel\n              </button>\n            )}\n            <button\n              type=\"submit\"\n              className=\"cedros-button cedros-button-primary\"\n              disabled={isEnrolling || !password || !confirmPassword}\n            >\n              {isEnrolling ? 'Creating...' : 'Continue'}\n            </button>\n          </div>\n        </form>\n      )}\n\n      {/* Passkey form */}\n      {authMethod === 'passkey' && (\n        <div className=\"cedros-enrollment-form\">\n          <div className=\"cedros-passkey-info\">\n            <svg\n              className=\"cedros-passkey-icon\"\n              width=\"48\"\n              height=\"48\"\n              viewBox=\"0 0 48 48\"\n              fill=\"none\"\n              aria-hidden=\"true\"\n            >\n              <rect\n                x=\"8\"\n                y=\"16\"\n                width=\"32\"\n                height=\"24\"\n                rx=\"4\"\n                stroke=\"currentColor\"\n                strokeWidth=\"2\"\n              />\n              <circle cx=\"24\" cy=\"28\" r=\"4\" stroke=\"currentColor\" strokeWidth=\"2\" />\n              <path d=\"M24 32v4\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" />\n            </svg>\n            <p>Use your passkey (Touch ID, Face ID, or Windows Hello) to secure your wallet.</p>\n            <p>You'll use the same passkey to sign transactions.</p>\n          </div>\n\n          <div className=\"cedros-enrollment-actions\">\n            {onCancel && (\n              <button\n                type=\"button\"\n                className=\"cedros-button cedros-button-secondary\"\n                onClick={handleCancel}\n                disabled={isEnrolling}\n              >\n                Cancel\n              </button>\n            )}\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-primary\"\n              onClick={handlePasskeySubmit}\n              disabled={isEnrolling}\n            >\n              {isEnrolling ? 'Creating...' : 'Use Passkey'}\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","/**\n * Hook for wallet transaction signing (server-side signing)\n *\n * Signing happens server-side:\n * - User provides unlock credential (password/PIN/passkey PRF)\n * - Server decrypts Share A, combines with Share B, signs, wipes\n * - Client just sends credential and transaction, receives signature\n */\n\nimport { useState, useCallback } from 'react';\nimport { useCedrosLogin } from '../context/useCedrosLogin';\nimport { useWalletMaterial } from './useWalletMaterial';\nimport { authenticateWithDiscoverablePrf, base64ToUint8Array, uint8ArrayToBase64 } from '../crypto';\nimport type { UseWalletSigningReturn, UnlockCredential } from '../types/wallet';\nimport { toCredentialRequest } from '../utils/unlockCredential';\n\n/**\n * Hook for wallet transaction signing\n *\n * Usage:\n * ```tsx\n * const { signTransaction, isSigning, error } = useWalletSigning();\n *\n * // Sign with password\n * const signature = await signTransaction(txBytes, { type: 'password', password: 'xxx' });\n *\n * // Sign with PIN\n * const signature = await signTransaction(txBytes, { type: 'password', password: 'secret' });\n *\n * // Sign with passkey (PRF)\n * const signature = await signTransaction(txBytes, { type: 'prfOutput', prfOutput: 'base64...' });\n * ```\n */\nexport function useWalletSigning(): UseWalletSigningReturn {\n  const { user } = useCedrosLogin();\n  const { signTransaction: apiSignTransaction } = useWalletMaterial();\n\n  const [isSigning, setIsSigning] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  /**\n   * Sign a transaction with the wallet\n   *\n   * @param transaction - Transaction bytes to sign\n   * @param credential - Unlock credential (password, PIN, or PRF output)\n   * @returns Ed25519 signature (64 bytes)\n   */\n  const signTransaction = useCallback(\n    async (transaction: Uint8Array, credential?: UnlockCredential): Promise<Uint8Array> => {\n      if (!user) {\n        const msg = 'User not authenticated';\n        setError(msg);\n        throw new Error(msg);\n      }\n\n      setIsSigning(true);\n      setError(null);\n\n      try {\n        const request = {\n          transaction: uint8ArrayToBase64(transaction),\n          ...(credential ? { credential: toCredentialRequest(credential) } : {}),\n        };\n\n        const response = await apiSignTransaction(request);\n\n        // Decode signature from base64\n        return base64ToUint8Array(response.signature);\n      } catch (err) {\n        const msg = err instanceof Error ? err.message : 'Signing failed';\n        setError(msg);\n        throw err;\n      } finally {\n        setIsSigning(false);\n      }\n    },\n    [user, apiSignTransaction]\n  );\n\n  const clearError = useCallback(() => setError(null), []);\n\n  return {\n    signTransaction,\n    isSigning,\n    error,\n    clearError,\n  };\n}\n\n/**\n * Helper hook to get PRF output for passkey signing\n *\n * This handles the WebAuthn PRF flow and returns a credential\n * that can be used with useWalletSigning.\n */\nexport function usePasskeySigning() {\n  const { getMaterial } = useWalletMaterial();\n  const [isAuthenticating, setIsAuthenticating] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  /**\n   * Get PRF output from passkey for wallet signing\n   *\n   * @returns UnlockCredential with PRF output, or null if cancelled\n   */\n  const getPasskeyCredential = useCallback(async (): Promise<UnlockCredential | null> => {\n    setIsAuthenticating(true);\n    setError(null);\n\n    try {\n      // Get wallet material to get PRF salt\n      const material = await getMaterial();\n      if (!material) {\n        throw new Error('No wallet enrolled');\n      }\n\n      if (material.shareAAuthMethod !== 'passkey') {\n        throw new Error('Wallet is not configured for passkey authentication');\n      }\n\n      if (!material.prfSalt) {\n        throw new Error('No PRF salt configured for wallet');\n      }\n\n      // Authenticate with passkey and get PRF output\n      const result = await authenticateWithDiscoverablePrf(material.prfSalt);\n\n      try {\n        return {\n          type: 'prfOutput',\n          prfOutput: uint8ArrayToBase64(result.prfOutput),\n        };\n      } finally {\n        // UI-21: Wipe PRF output from memory after encoding to base64\n        result.prfOutput.fill(0);\n      }\n    } catch (err) {\n      // User cancelled or error occurred\n      const msg = err instanceof Error ? err.message : 'Passkey authentication failed';\n      setError(msg);\n      return null;\n    } finally {\n      setIsAuthenticating(false);\n    }\n  }, [getMaterial]);\n\n  const clearError = useCallback(() => setError(null), []);\n\n  return {\n    getPasskeyCredential,\n    isAuthenticating,\n    error,\n    clearError,\n  };\n}\n","/**\n * Passkey prompt component for WebAuthn interactions\n *\n * Provides visual feedback during WebAuthn ceremonies:\n * - Registration of new passkeys\n * - Authentication with existing passkeys\n * - PRF extension operations\n */\n\nimport { useCallback } from 'react';\n\nexport interface PasskeyPromptProps {\n  /** Type of WebAuthn operation */\n  mode: 'register' | 'authenticate';\n  /** Whether the operation is in progress */\n  isLoading?: boolean;\n  /** Error message if operation failed */\n  error?: string;\n  /** Callback to trigger the operation */\n  onPrompt?: () => void;\n  /** Callback to retry after error */\n  onRetry?: () => void;\n  /** Callback to cancel the operation */\n  onCancel?: () => void;\n  /** Optional custom title */\n  title?: string;\n  /** Optional custom description */\n  description?: string;\n  /** Additional CSS classes */\n  className?: string;\n}\n\n/**\n * WebAuthn passkey interaction prompt\n *\n * Displays appropriate UI and messaging for passkey operations.\n */\nexport function PasskeyPrompt({\n  mode,\n  isLoading = false,\n  error,\n  onPrompt,\n  onRetry,\n  onCancel,\n  title,\n  description,\n  className = '',\n}: PasskeyPromptProps) {\n  const handlePrompt = useCallback(() => {\n    if (!isLoading) {\n      onPrompt?.();\n    }\n  }, [isLoading, onPrompt]);\n\n  const handleRetry = useCallback(() => {\n    onRetry?.();\n  }, [onRetry]);\n\n  const defaultTitle = mode === 'register' ? 'Set Up Passkey' : 'Verify with Passkey';\n\n  const defaultDescription =\n    mode === 'register'\n      ? 'Create a passkey to securely encrypt your wallet on this device. You will use your fingerprint, face, or device PIN.'\n      : 'Use your passkey to unlock your wallet. You will be prompted for biometric verification.';\n\n  return (\n    <div className={`cedros-passkey-prompt ${className}`}>\n      <div className=\"cedros-passkey-icon\">\n        {isLoading ? <LoadingSpinner /> : error ? <ErrorIcon /> : <PasskeyIcon />}\n      </div>\n\n      <h3 className=\"cedros-passkey-title\">{title ?? defaultTitle}</h3>\n\n      <p className=\"cedros-passkey-description\">{description ?? defaultDescription}</p>\n\n      {error && (\n        <div className=\"cedros-passkey-error\" role=\"alert\">\n          <p>{error}</p>\n        </div>\n      )}\n\n      <div className=\"cedros-passkey-actions\">\n        {error ? (\n          <>\n            {onRetry && (\n              <button\n                type=\"button\"\n                className=\"cedros-button cedros-button-primary\"\n                onClick={handleRetry}\n              >\n                Try Again\n              </button>\n            )}\n            {onCancel && (\n              <button\n                type=\"button\"\n                className=\"cedros-button cedros-button-secondary\"\n                onClick={onCancel}\n              >\n                Cancel\n              </button>\n            )}\n          </>\n        ) : (\n          <>\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-primary\"\n              onClick={handlePrompt}\n              disabled={isLoading}\n            >\n              {isLoading ? (\n                <>\n                  <span className=\"cedros-button-spinner\" aria-hidden=\"true\" />\n                  Waiting for passkey...\n                </>\n              ) : mode === 'register' ? (\n                'Create Passkey'\n              ) : (\n                'Use Passkey'\n              )}\n            </button>\n            {onCancel && !isLoading && (\n              <button\n                type=\"button\"\n                className=\"cedros-button cedros-button-secondary\"\n                onClick={onCancel}\n              >\n                Cancel\n              </button>\n            )}\n          </>\n        )}\n      </div>\n\n      {isLoading && (\n        <p className=\"cedros-passkey-hint\">\n          Follow the prompts on your device to {mode === 'register' ? 'create' : 'verify'} your\n          passkey.\n        </p>\n      )}\n    </div>\n  );\n}\n\n/** Fingerprint icon for passkey */\nfunction PasskeyIcon() {\n  return (\n    <svg\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"1.5\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      aria-hidden=\"true\"\n    >\n      <path d=\"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4\" />\n      <path d=\"M14 13.12c0 2.38 0 6.38-1 8.88\" />\n      <path d=\"M17.29 21.02c.12-.6.43-2.3.5-3.02\" />\n      <path d=\"M2 12a10 10 0 0 1 18-6\" />\n      <path d=\"M2 16h.01\" />\n      <path d=\"M21.8 16c.2-2 .131-5.354 0-6\" />\n      <path d=\"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2\" />\n      <path d=\"M8.65 22c.21-.66.45-1.32.57-2\" />\n      <path d=\"M9 6.8a6 6 0 0 1 9 5.2v2\" />\n    </svg>\n  );\n}\n\n/** Loading spinner icon */\nfunction LoadingSpinner() {\n  return (\n    <svg viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden=\"true\" className=\"cedros-spinner\">\n      <circle cx=\"12\" cy=\"12\" r=\"9\" stroke=\"currentColor\" strokeWidth=\"2\" opacity=\"0.25\" />\n      <path d=\"M12 3a9 9 0 0 1 9 9\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" />\n    </svg>\n  );\n}\n\n/** Error icon */\nfunction ErrorIcon() {\n  return (\n    <svg\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      aria-hidden=\"true\"\n    >\n      <circle cx=\"12\" cy=\"12\" r=\"10\" />\n      <path d=\"M12 8v4M12 16h.01\" />\n    </svg>\n  );\n}\n","/**\n * Wallet unlock component (v2 - server-side signing)\n *\n * Provides the UI for unlocking an enrolled wallet.\n * User enters their credential (password or passkey),\n * server validates and caches the derived key for session signing.\n *\n * No client-side share reconstruction - server handles everything.\n */\n\nimport { useState, useCallback, useEffect } from 'react';\nimport type { FormEvent } from 'react';\nimport { useWalletMaterial } from '../../hooks/useWalletMaterial';\nimport { usePasskeySigning } from '../../hooks/useWalletSigning';\nimport { useCedrosLogin } from '../../context/useCedrosLogin';\nimport { PasskeyPrompt } from './PasskeyPrompt';\nimport { LoadingSpinner } from '../shared/LoadingSpinner';\nimport { PasswordInput } from '../email/PasswordInput';\nimport type { ShareAAuthMethod, UnlockCredential } from '../../types/wallet';\n\nexport interface WalletUnlockProps {\n  /** Callback when wallet is successfully unlocked */\n  onUnlock?: () => void;\n  /** Callback when unlock is cancelled */\n  onCancel?: () => void;\n  /** Whether to show the cancel button */\n  showCancel?: boolean;\n  /** The wallet's auth method (if known) */\n  authMethod?: ShareAAuthMethod;\n  /** Additional CSS classes */\n  className?: string;\n}\n\ntype UnlockPhase = 'idle' | 'credential' | 'unlocking' | 'unlocked' | 'error';\n\n/**\n * Wallet unlock form\n *\n * Simple single-credential flow:\n * - Password users: Enter password\n * - Passkey users: Authenticate with passkey\n *\n * Server validates credential and caches derived key for session signing.\n */\nexport function WalletUnlock({\n  onUnlock,\n  onCancel,\n  showCancel = true,\n  authMethod: propAuthMethod,\n  className = '',\n}: WalletUnlockProps) {\n  useCedrosLogin(); // Ensure user is authenticated\n  const { unlock, getMaterial, isLoading } = useWalletMaterial();\n  const { getPasskeyCredential, isAuthenticating } = usePasskeySigning();\n\n  const [phase, setPhase] = useState<UnlockPhase>('idle');\n  const [authMethod, setAuthMethod] = useState<ShareAAuthMethod | null>(propAuthMethod ?? null);\n  const [credential, setCredential] = useState('');\n  const [error, setError] = useState<string | null>(null);\n\n  // MAINT-01: Sync authMethod state when prop changes\n  useEffect(() => {\n    if (propAuthMethod !== undefined) {\n      setAuthMethod(propAuthMethod);\n    }\n  }, [propAuthMethod]);\n\n  // Determine credential type based on auth method\n  const isPasswordAuth = authMethod === 'password';\n  const isPasskeyAuth = authMethod === 'passkey';\n\n  // Start the unlock flow - fetch material to get auth method\n  const startUnlock = useCallback(async () => {\n    setPhase('credential');\n    setError(null);\n\n    if (!authMethod) {\n      try {\n        const material = await getMaterial();\n        if (material) {\n          setAuthMethod(material.shareAAuthMethod);\n        } else {\n          setError('No wallet enrolled');\n          setPhase('error');\n        }\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to get wallet info');\n        setPhase('error');\n      }\n    }\n  }, [authMethod, getMaterial]);\n\n  // Handle credential submission\n  const handleSubmit = useCallback(\n    async (e: FormEvent) => {\n      e.preventDefault();\n      setError(null);\n      setPhase('unlocking');\n\n      try {\n        let unlockCredential: UnlockCredential;\n\n        if (isPasswordAuth) {\n          unlockCredential = { type: 'password', password: credential };\n        } else {\n          throw new Error('Invalid auth method');\n        }\n\n        await unlock(unlockCredential);\n        setPhase('unlocked');\n        onUnlock?.();\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to unlock wallet');\n        setPhase('error');\n      }\n    },\n    [isPasswordAuth, credential, unlock, onUnlock]\n  );\n\n  // Handle passkey authentication\n  const handlePasskeyUnlock = useCallback(async () => {\n    setError(null);\n    setPhase('unlocking');\n\n    try {\n      const passkeyCredential = await getPasskeyCredential();\n      if (!passkeyCredential) {\n        setPhase('credential');\n        return;\n      }\n\n      await unlock(passkeyCredential);\n      setPhase('unlocked');\n      onUnlock?.();\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to unlock wallet');\n      setPhase('error');\n    }\n  }, [getPasskeyCredential, unlock, onUnlock]);\n\n  // Handle cancel\n  const handleCancel = useCallback(() => {\n    setCredential('');\n    setPhase('idle');\n    setError(null);\n    onCancel?.();\n  }, [onCancel]);\n\n  // Retry from error state\n  const handleRetry = useCallback(() => {\n    setCredential('');\n    setPhase('credential');\n    setError(null);\n  }, []);\n\n  const isProcessing = isLoading || isAuthenticating;\n\n  // Render based on phase\n  const renderContent = () => {\n    switch (phase) {\n      case 'idle':\n        return (\n          <div className=\"cedros-wallet-unlock-idle\">\n            <div className=\"cedros-wallet-unlock-icon\">\n              <LockIcon />\n            </div>\n            <h3 className=\"cedros-wallet-unlock-title\">Wallet Locked</h3>\n            <p className=\"cedros-wallet-unlock-description\">\n              Unlock your wallet to sign transactions.\n            </p>\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-primary\"\n              onClick={startUnlock}\n            >\n              Unlock Wallet\n            </button>\n          </div>\n        );\n\n      case 'credential':\n        // Password form\n        if (isPasswordAuth) {\n          return (\n            <form className=\"cedros-wallet-unlock-form\" onSubmit={handleSubmit}>\n              <h3 className=\"cedros-wallet-unlock-title\">Enter Password</h3>\n              <p className=\"cedros-wallet-unlock-description\">\n                Enter your wallet password to unlock.\n              </p>\n\n              <PasswordInput\n                label=\"Password\"\n                value={credential}\n                onChange={(e) => setCredential(e.target.value)}\n                disabled={isProcessing}\n                autoComplete=\"current-password\"\n                error={error ?? undefined}\n              />\n\n              <div className=\"cedros-wallet-unlock-actions\">\n                <button\n                  type=\"submit\"\n                  className=\"cedros-button cedros-button-primary\"\n                  disabled={isProcessing || credential.length === 0}\n                >\n                  {isProcessing ? 'Unlocking...' : 'Unlock'}\n                </button>\n                {showCancel && (\n                  <button\n                    type=\"button\"\n                    className=\"cedros-button cedros-button-secondary\"\n                    onClick={handleCancel}\n                    disabled={isProcessing}\n                  >\n                    Cancel\n                  </button>\n                )}\n              </div>\n            </form>\n          );\n        }\n\n        // Passkey authentication\n        if (isPasskeyAuth) {\n          return (\n            <div className=\"cedros-wallet-unlock-passkey\">\n              <h3 className=\"cedros-wallet-unlock-title\">Verify with Passkey</h3>\n              <p className=\"cedros-wallet-unlock-description\">\n                Use your passkey to unlock your wallet.\n              </p>\n\n              <PasskeyPrompt\n                mode=\"authenticate\"\n                isLoading={isProcessing}\n                error={error ?? undefined}\n                onPrompt={handlePasskeyUnlock}\n                onRetry={handlePasskeyUnlock}\n                onCancel={showCancel ? handleCancel : undefined}\n              />\n            </div>\n          );\n        }\n\n        // Loading auth method\n        return (\n          <div className=\"cedros-wallet-unlock-loading\">\n            <LoadingSpinner size=\"xl\" />\n            <p>Loading wallet info...</p>\n          </div>\n        );\n\n      case 'unlocking':\n        return (\n          <div className=\"cedros-wallet-unlock-progress\">\n            <div className=\"cedros-wallet-unlock-icon\">\n              <LoadingSpinner size=\"xl\" />\n            </div>\n            <h3 className=\"cedros-wallet-unlock-title\">Unlocking Wallet</h3>\n            <p className=\"cedros-wallet-unlock-description\">Verifying your credentials...</p>\n          </div>\n        );\n\n      case 'unlocked':\n        return (\n          <div className=\"cedros-wallet-unlock-success\">\n            <div className=\"cedros-wallet-unlock-icon\">\n              <SuccessIcon />\n            </div>\n            <h3 className=\"cedros-wallet-unlock-title\">Wallet Unlocked</h3>\n            <p className=\"cedros-wallet-unlock-description\">\n              Your wallet is ready to sign transactions.\n            </p>\n          </div>\n        );\n\n      case 'error':\n        return (\n          <div className=\"cedros-wallet-unlock-error\">\n            <div className=\"cedros-wallet-unlock-icon\">\n              <ErrorIcon />\n            </div>\n            <h3 className=\"cedros-wallet-unlock-title\">Unlock Failed</h3>\n            <p className=\"cedros-wallet-unlock-description\">\n              {error ?? 'Failed to unlock wallet. Please try again.'}\n            </p>\n            <div className=\"cedros-wallet-unlock-actions\">\n              <button\n                type=\"button\"\n                className=\"cedros-button cedros-button-primary\"\n                onClick={handleRetry}\n              >\n                Try Again\n              </button>\n              {showCancel && (\n                <button\n                  type=\"button\"\n                  className=\"cedros-button cedros-button-secondary\"\n                  onClick={handleCancel}\n                >\n                  Cancel\n                </button>\n              )}\n            </div>\n          </div>\n        );\n    }\n  };\n\n  return <div className={`cedros-wallet-unlock ${className}`}>{renderContent()}</div>;\n}\n\n// Icon components\nfunction LockIcon() {\n  return (\n    <svg width=\"48\" height=\"48\" viewBox=\"0 0 48 48\" fill=\"none\" aria-hidden=\"true\">\n      <rect\n        x=\"10\"\n        y=\"22\"\n        width=\"28\"\n        height=\"20\"\n        rx=\"4\"\n        stroke=\"currentColor\"\n        strokeWidth=\"2\"\n        fill=\"var(--cedros-muted, #f3f4f6)\"\n      />\n      <path d=\"M16 22V16a8 8 0 1 1 16 0v6\" stroke=\"currentColor\" strokeWidth=\"2\" fill=\"none\" />\n      <circle cx=\"24\" cy=\"32\" r=\"3\" fill=\"currentColor\" />\n    </svg>\n  );\n}\n\nfunction SuccessIcon() {\n  return (\n    <svg width=\"48\" height=\"48\" viewBox=\"0 0 48 48\" fill=\"none\" aria-hidden=\"true\">\n      <circle\n        cx=\"24\"\n        cy=\"24\"\n        r=\"20\"\n        stroke=\"var(--cedros-success, #22c55e)\"\n        strokeWidth=\"2\"\n        fill=\"var(--cedros-success-light, #dcfce7)\"\n      />\n      <path\n        d=\"M16 24l6 6 10-10\"\n        stroke=\"var(--cedros-success, #22c55e)\"\n        strokeWidth=\"3\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        fill=\"none\"\n      />\n    </svg>\n  );\n}\n\nfunction ErrorIcon() {\n  return (\n    <svg width=\"48\" height=\"48\" viewBox=\"0 0 48 48\" fill=\"none\" aria-hidden=\"true\">\n      <circle\n        cx=\"24\"\n        cy=\"24\"\n        r=\"20\"\n        stroke=\"var(--cedros-destructive, #ef4444)\"\n        strokeWidth=\"2\"\n        fill=\"var(--cedros-destructive-light, #fee2e2)\"\n      />\n      <path\n        d=\"M24 16v10M24 30v2\"\n        stroke=\"var(--cedros-destructive, #ef4444)\"\n        strokeWidth=\"3\"\n        strokeLinecap=\"round\"\n      />\n    </svg>\n  );\n}\n","/**\n * Hook for wallet recovery flow\n *\n * Handles recovery using the BIP-39 mnemonic (recovery phrase):\n *\n * Two recovery modes supported:\n * - full_seed: User enters 12-word full seed mnemonic (portable to other wallets)\n * - share_c_only: User enters 12-word Share C mnemonic (app-locked recovery)\n *\n * Recovery flow:\n * 1. User enters 12-word recovery phrase\n * 2. Validate and decode to seed (or Share C  fetch Share B  combine)\n * 3. Re-derive Solana pubkey (proves ownership)\n * 4. Re-split seed into new Shamir shares\n * 5. Encrypt Share A with new credential\n * 6. Send to server (pubkey match verifies ownership)\n */\n\nimport { useState, useCallback, useRef, useEffect } from 'react';\nimport {\n  mnemonicToSeed,\n  mnemonicToShare,\n  isValidMnemonic,\n  combineShares,\n  splitSecret,\n  generateArgon2Salt,\n  generatePrfSalt,\n  argon2DeriveInWorker,\n  authenticateWithDiscoverablePrf,\n  deriveKeyFromPrf,\n  aesGcmEncryptToBase64,\n  getPublicKeyFromSeed,\n  publicKeyToBase58,\n  wipeAll,\n  toEncryptionKey,\n  toShamirShare,\n  DEFAULT_KDF_PARAMS,\n  base64ToUint8Array,\n  uint8ArrayToBase64,\n  type Seed,\n  type Argon2Salt,\n} from '../crypto';\nimport { useWalletMaterial } from './useWalletMaterial';\nimport { useWalletDiscovery } from './useWalletDiscovery';\nimport type {\n  UseWalletRecoveryReturn,\n  RecoveryState,\n  WalletRecoverRequest,\n  ShareAAuthMethod,\n} from '../types/wallet';\n\n/**\n * Hook for wallet recovery\n *\n * Supports two recovery modes based on server config:\n * - full_seed: User enters the full 12-word seed phrase (portable)\n * - share_c_only: User enters 12-word Share C phrase, server provides Share B (app-locked)\n */\nexport function useWalletRecovery(): UseWalletRecoveryReturn {\n  const { recover, getShareBForRecovery } = useWalletMaterial();\n  const { recoveryMode } = useWalletDiscovery();\n\n  const [state, setState] = useState<RecoveryState>({ step: 'idle' });\n  const [isRecovering, setIsRecovering] = useState(false);\n\n  // Store sensitive data for cleanup\n  const sensitiveData = useRef<Uint8Array[]>([]);\n\n  const cleanup = useCallback(() => {\n    wipeAll(...sensitiveData.current);\n    sensitiveData.current = [];\n  }, []);\n\n  useEffect(() => {\n    return () => {\n      cleanup();\n    };\n  }, [cleanup]);\n\n  /**\n   * Start and complete recovery in one step\n   *\n   * @param words - 12-word recovery phrase (full seed or Share C based on mode)\n   * @param method - New auth method (password or passkey)\n   * @param credential - New password (ignored for passkey)\n   */\n  const startRecovery = useCallback(\n    async (words: string[], method: ShareAAuthMethod, credential: string): Promise<void> => {\n      setIsRecovering(true);\n      cleanup();\n\n      try {\n        // Step 1: Validate mnemonic\n        setState({ step: 'validating' });\n\n        if (!isValidMnemonic(words)) {\n          throw new Error('Invalid recovery phrase. Please check your words.');\n        }\n\n        let seed: Seed;\n\n        if (recoveryMode === 'share_c_only') {\n          // Share C mode: decode to Share C, fetch Share B, combine\n          const shareC = mnemonicToShare(words);\n          sensitiveData.current.push(shareC);\n\n          // Send Share C to server to get Share B\n          const shareCBase64 = uint8ArrayToBase64(shareC);\n          const response = await getShareBForRecovery({ shareC: shareCBase64 });\n\n          // Decode Share B from response\n          const shareB = base64ToUint8Array(response.shareB);\n          sensitiveData.current.push(shareB);\n\n          // Combine Share B + Share C to reconstruct seed\n          seed = combineShares(toShamirShare(shareB), toShamirShare(shareC));\n          sensitiveData.current.push(seed);\n        } else {\n          // Full seed mode: decode mnemonic directly to seed\n          seed = mnemonicToSeed(words);\n          sensitiveData.current.push(seed);\n        }\n\n        // Step 3: Derive Solana pubkey (proves ownership when server verifies match)\n        const publicKey = getPublicKeyFromSeed(seed);\n        const solanaPubkey = publicKeyToBase58(publicKey);\n\n        // Step 4: Re-split seed into new shares\n        const { shareA, shareB } = splitSecret(seed);\n        sensitiveData.current.push(shareA, shareB);\n\n        // Step 5: Encrypt Share A with new credential\n        setState({ step: 'encrypting' });\n\n        let encryptionKey: Uint8Array;\n        let kdfSalt: Argon2Salt | undefined;\n        let prfSaltBase64: string | undefined;\n\n        if (method === 'passkey') {\n          // Passkey method: authenticate and derive key from PRF\n          const prfSalt = generatePrfSalt();\n          prfSaltBase64 = uint8ArrayToBase64(prfSalt);\n\n          const prfResult = await authenticateWithDiscoverablePrf(prfSaltBase64);\n          sensitiveData.current.push(prfResult.prfOutput);\n\n          encryptionKey = await deriveKeyFromPrf(prfResult.prfOutput, prfSalt);\n          sensitiveData.current.push(encryptionKey);\n        } else {\n          // Password method: derive key with Argon2id\n          kdfSalt = generateArgon2Salt();\n          encryptionKey = await argon2DeriveInWorker(credential, kdfSalt, DEFAULT_KDF_PARAMS);\n          sensitiveData.current.push(encryptionKey);\n        }\n\n        const encryptedA = await aesGcmEncryptToBase64(shareA, toEncryptionKey(encryptionKey));\n\n        // Step 6: Build request and send to server\n        setState({ step: 'uploading' });\n\n        const request: WalletRecoverRequest = {\n          solanaPubkey,\n          shareAAuthMethod: method,\n          shareACiphertext: encryptedA.ciphertext,\n          shareANonce: encryptedA.nonce,\n          shareB: uint8ArrayToBase64(shareB),\n        };\n\n        // Add method-specific fields\n        if (method === 'password') {\n          request.shareAKdfSalt = uint8ArrayToBase64(kdfSalt!);\n          request.shareAKdfParams = DEFAULT_KDF_PARAMS;\n        }\n\n        if (method === 'passkey') {\n          request.prfSalt = prfSaltBase64;\n        }\n\n        await recover(request);\n\n        // Success\n        cleanup();\n        setState({ step: 'complete' });\n      } catch (err) {\n        cleanup();\n        setState({\n          step: 'error',\n          error: err instanceof Error ? err.message : 'Recovery failed',\n        });\n      } finally {\n        setIsRecovering(false);\n      }\n    },\n    [recover, getShareBForRecovery, recoveryMode, cleanup]\n  );\n\n  const cancel = useCallback(() => {\n    cleanup();\n    setState({ step: 'idle' });\n    setIsRecovering(false);\n  }, [cleanup]);\n\n  return {\n    state,\n    startRecovery,\n    cancel,\n    isRecovering,\n  };\n}\n","/**\n * Wallet recovery wizard component\n *\n * Guides users through wallet recovery using their BIP-39 recovery phrase:\n * 1. Enter 12-word recovery phrase\n * 2. Choose new auth method (password/passkey)\n * 3. Enter new credential\n * 4. Submit to re-encrypt and replace wallet material\n */\n\nimport { useState, useCallback } from 'react';\nimport type { FormEvent } from 'react';\nimport { useWalletRecovery } from '../../hooks/useWalletRecovery';\nimport { RecoveryPhraseInput } from './RecoveryPhraseInput';\nimport type { ShareAAuthMethod } from '../../types/wallet';\n\nexport interface WalletRecoveryProps {\n  /** Callback when recovery completes successfully */\n  onComplete?: () => void;\n  /** Callback when user cancels recovery */\n  onCancel?: () => void;\n  /** Additional CSS classes */\n  className?: string;\n  /** Default auth method (optional) */\n  defaultAuthMethod?: ShareAAuthMethod;\n}\n\n/**\n * Wallet recovery wizard\n *\n * Two-phase flow:\n * 1. Enter recovery phrase\n * 2. Enter new credential (password/passkey)\n */\nexport function WalletRecovery({\n  onComplete,\n  onCancel,\n  className = '',\n  defaultAuthMethod = 'password',\n}: WalletRecoveryProps) {\n  const { state, startRecovery, cancel, isRecovering } = useWalletRecovery();\n\n  // Phase 1: Recovery phrase\n  const [words, setWords] = useState<string[]>([]);\n  const [phraseValidated, setPhraseValidated] = useState(false);\n\n  // Phase 2: New credential\n  const [authMethod, setAuthMethod] = useState<ShareAAuthMethod>(defaultAuthMethod);\n  const [credential, setCredential] = useState('');\n  const [confirmCredential, setConfirmCredential] = useState('');\n  const [credentialError, setCredentialError] = useState<string | null>(null);\n\n  // Handle phrase submission (phase 1 complete)\n  const handlePhraseSubmit = useCallback((submittedWords: string[]) => {\n    setWords(submittedWords);\n    setPhraseValidated(true);\n  }, []);\n\n  // Handle credential submission (phase 2 complete)\n  const handleCredentialSubmit = useCallback(\n    async (e: FormEvent) => {\n      e.preventDefault();\n      setCredentialError(null);\n\n      // Passkey doesn't need confirmation\n      if (authMethod !== 'passkey') {\n        if (credential !== confirmCredential) {\n          setCredentialError('Passwords do not match');\n          return;\n        }\n\n        if (authMethod === 'password' && credential.length < 8) {\n          setCredentialError('Password must be at least 8 characters');\n          return;\n        }\n      }\n\n      await startRecovery(words, authMethod, credential);\n    },\n    [words, authMethod, credential, confirmCredential, startRecovery]\n  );\n\n  // Handle cancel\n  const handleCancel = useCallback(() => {\n    cancel();\n    setWords([]);\n    setPhraseValidated(false);\n    setCredential('');\n    setConfirmCredential('');\n    onCancel?.();\n  }, [cancel, onCancel]);\n\n  // Handle back to phrase entry\n  const handleBack = useCallback(() => {\n    setPhraseValidated(false);\n    setCredential('');\n    setConfirmCredential('');\n  }, []);\n\n  // Handle completion\n  const handleComplete = useCallback(() => {\n    onComplete?.();\n  }, [onComplete]);\n\n  // Render based on state\n  if (state.step === 'validating' || state.step === 'encrypting' || state.step === 'uploading') {\n    return (\n      <div className={`cedros-wallet-recovery ${className}`}>\n        <div className=\"cedros-wallet-recovery-progress\">\n          <div className=\"cedros-wallet-recovery-icon\">\n            <LoadingSpinner />\n          </div>\n          <h3 className=\"cedros-wallet-recovery-title\">\n            {state.step === 'validating' && 'Validating Recovery Phrase'}\n            {state.step === 'encrypting' && 'Encrypting Wallet'}\n            {state.step === 'uploading' && 'Saving to Server'}\n          </h3>\n          <p className=\"cedros-wallet-recovery-description\">\n            {state.step === 'validating' && 'Checking your recovery phrase...'}\n            {state.step === 'encrypting' && 'Securing your wallet with new encryption...'}\n            {state.step === 'uploading' && 'Uploading encrypted wallet data...'}\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  if (state.step === 'complete') {\n    return (\n      <div className={`cedros-wallet-recovery ${className}`}>\n        <div className=\"cedros-wallet-recovery-success\">\n          <div className=\"cedros-wallet-recovery-icon\">\n            <SuccessIcon />\n          </div>\n          <h3 className=\"cedros-wallet-recovery-title\">Wallet Recovered</h3>\n          <p className=\"cedros-wallet-recovery-description\">\n            Your wallet has been successfully recovered and secured with your new{' '}\n            {authMethod === 'passkey' ? 'passkey' : 'password'}.\n          </p>\n          <div className=\"cedros-wallet-recovery-actions\">\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-primary\"\n              onClick={handleComplete}\n            >\n              Done\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (state.step === 'error') {\n    return (\n      <div className={`cedros-wallet-recovery ${className}`}>\n        <div className=\"cedros-wallet-recovery-error\">\n          <div className=\"cedros-wallet-recovery-icon\">\n            <ErrorIcon />\n          </div>\n          <h3 className=\"cedros-wallet-recovery-title\">Recovery Failed</h3>\n          <p className=\"cedros-wallet-recovery-description\">\n            {state.error ?? 'An error occurred during recovery. Please try again.'}\n          </p>\n          <div className=\"cedros-wallet-recovery-actions\">\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-primary\"\n              onClick={handleCancel}\n            >\n              Start Over\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Phase 1: Enter recovery phrase\n  if (!phraseValidated) {\n    return (\n      <div className={`cedros-wallet-recovery ${className}`}>\n        <div className=\"cedros-wallet-recovery-phrase\">\n          <div className=\"cedros-wallet-recovery-header\">\n            <h3 className=\"cedros-wallet-recovery-title\">Recover Your Wallet</h3>\n            <p className=\"cedros-wallet-recovery-description\">\n              Enter your 12-word recovery phrase to restore your wallet.\n            </p>\n          </div>\n\n          <RecoveryPhraseInput\n            onSubmit={handlePhraseSubmit}\n            onCancel={handleCancel}\n            isSubmitting={false}\n          />\n        </div>\n      </div>\n    );\n  }\n\n  // Phase 2: Enter new credential\n  return (\n    <div className={`cedros-wallet-recovery ${className}`}>\n      <form className=\"cedros-wallet-recovery-credential\" onSubmit={handleCredentialSubmit}>\n        <div className=\"cedros-wallet-recovery-header\">\n          <h3 className=\"cedros-wallet-recovery-title\">Set New Security</h3>\n          <p className=\"cedros-wallet-recovery-description\">\n            Choose how to secure your recovered wallet.\n          </p>\n        </div>\n\n        {/* Auth method selector */}\n        <div className=\"cedros-auth-method-selector\">\n          <label className=\"cedros-radio-label\">\n            <input\n              type=\"radio\"\n              name=\"authMethod\"\n              value=\"password\"\n              checked={authMethod === 'password'}\n              onChange={() => setAuthMethod('password')}\n              disabled={isRecovering}\n            />\n            <span>Password</span>\n          </label>\n          <label className=\"cedros-radio-label\">\n            <input\n              type=\"radio\"\n              name=\"authMethod\"\n              value=\"passkey\"\n              checked={authMethod === 'passkey'}\n              onChange={() => setAuthMethod('passkey')}\n              disabled={isRecovering}\n            />\n            <span>Passkey</span>\n          </label>\n        </div>\n\n        {/* Password input */}\n        {authMethod === 'password' && (\n          <>\n            <div className=\"cedros-password-input\">\n              <label htmlFor=\"recovery-password\" className=\"cedros-label\">\n                New Password\n              </label>\n              <input\n                id=\"recovery-password\"\n                type=\"password\"\n                className=\"cedros-input\"\n                value={credential}\n                onChange={(e) => setCredential(e.target.value)}\n                disabled={isRecovering}\n                minLength={8}\n                placeholder=\"Enter a strong password\"\n              />\n            </div>\n            <div className=\"cedros-password-input\">\n              <label htmlFor=\"recovery-password-confirm\" className=\"cedros-label\">\n                Confirm Password\n              </label>\n              <input\n                id=\"recovery-password-confirm\"\n                type=\"password\"\n                className=\"cedros-input\"\n                value={confirmCredential}\n                onChange={(e) => setConfirmCredential(e.target.value)}\n                disabled={isRecovering}\n                aria-invalid={credentialError ? 'true' : undefined}\n                placeholder=\"Confirm your password\"\n              />\n              {credentialError && (\n                <p className=\"cedros-input-error\" role=\"alert\">\n                  {credentialError}\n                </p>\n              )}\n            </div>\n          </>\n        )}\n\n        {/* Passkey info */}\n        {authMethod === 'passkey' && (\n          <div className=\"cedros-passkey-info\">\n            <PasskeyIcon />\n            <p>Use your passkey (Touch ID, Face ID, or Windows Hello) to secure your wallet.</p>\n          </div>\n        )}\n\n        <div className=\"cedros-wallet-recovery-actions\">\n          <button\n            type=\"button\"\n            className=\"cedros-button cedros-button-secondary\"\n            onClick={handleBack}\n            disabled={isRecovering}\n          >\n            Back\n          </button>\n          <button\n            type=\"submit\"\n            className=\"cedros-button cedros-button-primary\"\n            disabled={\n              isRecovering ||\n              (authMethod !== 'passkey' &&\n                (credential.length === 0 || confirmCredential.length === 0))\n            }\n          >\n            {isRecovering ? 'Recovering...' : 'Recover Wallet'}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n\n// Icon components\nfunction LoadingSpinner() {\n  return (\n    <svg\n      width=\"48\"\n      height=\"48\"\n      viewBox=\"0 0 48 48\"\n      fill=\"none\"\n      aria-hidden=\"true\"\n      className=\"cedros-spinner\"\n    >\n      <circle\n        cx=\"24\"\n        cy=\"24\"\n        r=\"20\"\n        stroke=\"var(--cedros-muted, #e5e7eb)\"\n        strokeWidth=\"3\"\n        fill=\"none\"\n      />\n      <path\n        d=\"M24 4a20 20 0 0 1 20 20\"\n        stroke=\"var(--cedros-primary, #6366f1)\"\n        strokeWidth=\"3\"\n        strokeLinecap=\"round\"\n        fill=\"none\"\n      />\n    </svg>\n  );\n}\n\nfunction SuccessIcon() {\n  return (\n    <svg width=\"48\" height=\"48\" viewBox=\"0 0 48 48\" fill=\"none\" aria-hidden=\"true\">\n      <circle\n        cx=\"24\"\n        cy=\"24\"\n        r=\"20\"\n        stroke=\"var(--cedros-success, #22c55e)\"\n        strokeWidth=\"2\"\n        fill=\"var(--cedros-success-light, #dcfce7)\"\n      />\n      <path\n        d=\"M16 24l6 6 10-10\"\n        stroke=\"var(--cedros-success, #22c55e)\"\n        strokeWidth=\"3\"\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        fill=\"none\"\n      />\n    </svg>\n  );\n}\n\nfunction ErrorIcon() {\n  return (\n    <svg width=\"48\" height=\"48\" viewBox=\"0 0 48 48\" fill=\"none\" aria-hidden=\"true\">\n      <circle\n        cx=\"24\"\n        cy=\"24\"\n        r=\"20\"\n        stroke=\"var(--cedros-destructive, #ef4444)\"\n        strokeWidth=\"2\"\n        fill=\"var(--cedros-destructive-light, #fee2e2)\"\n      />\n      <path\n        d=\"M24 16v10M24 30v2\"\n        stroke=\"var(--cedros-destructive, #ef4444)\"\n        strokeWidth=\"3\"\n        strokeLinecap=\"round\"\n      />\n    </svg>\n  );\n}\n\nfunction PasskeyIcon() {\n  return (\n    <svg\n      className=\"cedros-passkey-icon\"\n      width=\"48\"\n      height=\"48\"\n      viewBox=\"0 0 48 48\"\n      fill=\"none\"\n      aria-hidden=\"true\"\n    >\n      <rect x=\"8\" y=\"16\" width=\"32\" height=\"24\" rx=\"4\" stroke=\"currentColor\" strokeWidth=\"2\" />\n      <circle cx=\"24\" cy=\"28\" r=\"4\" stroke=\"currentColor\" strokeWidth=\"2\" />\n      <path d=\"M24 32v4\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" />\n    </svg>\n  );\n}\n","import { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { useCedrosLoginOptional } from '../../context/useCedrosLogin';\n\nexport interface WalletAddressRowProps {\n  address: string;\n  label?: string;\n  showCopy?: boolean;\n  showExplorerLink?: boolean;\n  /** If address is long, show a truncated preview with a reveal toggle. */\n  allowReveal?: boolean;\n  className?: string;\n}\n\nexport function WalletAddressRow({\n  address,\n  label = 'Wallet Address',\n  showCopy = true,\n  showExplorerLink = true,\n  allowReveal = true,\n  className = '',\n}: WalletAddressRowProps) {\n  const context = useCedrosLoginOptional();\n  const [copied, setCopied] = useState(false);\n  const [copyError, setCopyError] = useState<string | null>(null);\n  const [revealFull, setRevealFull] = useState(false);\n  const copyTimerRef = useRef<number | null>(null);\n\n  const network = context?.config.solana?.network ?? 'mainnet-beta';\n  const explorerHref = useMemo(() => {\n    const base = `https://explorer.solana.com/address/${address}`;\n    if (network === 'mainnet-beta') return base;\n    return `${base}?cluster=${encodeURIComponent(network)}`;\n  }, [address, network]);\n\n  const isTruncatable = allowReveal && address.length > 18;\n\n  const displayAddress = useMemo(() => {\n    if (!isTruncatable || revealFull) return address;\n    return `${address.slice(0, 8)}...${address.slice(-8)}`;\n  }, [address, isTruncatable, revealFull]);\n\n  const handleCopy = useCallback(async () => {\n    try {\n      setCopyError(null);\n      await navigator.clipboard.writeText(address);\n      setCopied(true);\n\n      if (copyTimerRef.current !== null) {\n        window.clearTimeout(copyTimerRef.current);\n      }\n      copyTimerRef.current = window.setTimeout(() => {\n        setCopied(false);\n        copyTimerRef.current = null;\n      }, 2000);\n    } catch (err) {\n      setCopied(false);\n      setCopyError(err instanceof Error ? err.message : 'Copy failed');\n    }\n  }, [address]);\n\n  useEffect(() => {\n    return () => {\n      if (copyTimerRef.current !== null) {\n        window.clearTimeout(copyTimerRef.current);\n        copyTimerRef.current = null;\n      }\n    };\n  }, []);\n\n  return (\n    <div className={`cedros-wallet-address-row ${className}`}>\n      <div className=\"cedros-wallet-address-row-header\">\n        <span className=\"cedros-wallet-status-pubkey-label\">{label}</span>\n        <div className=\"cedros-wallet-address-row-actions\">\n          {isTruncatable && (\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-sm cedros-button-ghost\"\n              onClick={() => setRevealFull((v) => !v)}\n              aria-label={revealFull ? 'Hide full wallet address' : 'Show full wallet address'}\n            >\n              {revealFull ? (\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden=\"true\">\n                  <path\n                    d=\"M3 3l18 18\"\n                    stroke=\"currentColor\"\n                    strokeWidth=\"2\"\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                  />\n                  <path\n                    d=\"M10.7 10.7a3 3 0 0 0 4.24 4.24\"\n                    stroke=\"currentColor\"\n                    strokeWidth=\"2\"\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                  />\n                  <path\n                    d=\"M9.88 5.09A10.94 10.94 0 0 1 12 5c5 0 9.27 3.11 11 7-0.55 1.23-1.32 2.33-2.27 3.25\"\n                    stroke=\"currentColor\"\n                    strokeWidth=\"2\"\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                  />\n                  <path\n                    d=\"M6.61 6.61C4.4 7.9 2.74 9.8 1 12c1.73 3.89 6 7 11 7 1.14 0 2.25-0.16 3.3-0.46\"\n                    stroke=\"currentColor\"\n                    strokeWidth=\"2\"\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                  />\n                </svg>\n              ) : (\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden=\"true\">\n                  <path\n                    d=\"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12Z\"\n                    stroke=\"currentColor\"\n                    strokeWidth=\"2\"\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                  />\n                  <path\n                    d=\"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z\"\n                    stroke=\"currentColor\"\n                    strokeWidth=\"2\"\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                  />\n                </svg>\n              )}\n            </button>\n          )}\n          {showExplorerLink && (\n            <a\n              className=\"cedros-button cedros-button-sm cedros-button-ghost\"\n              href={explorerHref}\n              target=\"_blank\"\n              rel=\"noreferrer\"\n            >\n              Explorer\n            </a>\n          )}\n          {showCopy && (\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-sm cedros-button-outline\"\n              onClick={handleCopy}\n              aria-label=\"Copy wallet address\"\n            >\n              {copied ? 'Copied' : 'Copy'}\n            </button>\n          )}\n        </div>\n      </div>\n      <code className=\"cedros-wallet-status-pubkey-value\" title={address}>\n        {displayAddress}\n      </code>\n      {copyError && (\n        <p className=\"cedros-input-hint\" role=\"status\">\n          {copyError}\n        </p>\n      )}\n    </div>\n  );\n}\n","/**\n * Wallet status indicator component\n *\n * Displays the current state of the user's wallet:\n * - Loading: Checking wallet status\n * - Not enrolled: No wallet created yet\n * - Enrolled (locked): Wallet exists but needs unlock\n * - Enrolled (unlocked): Wallet ready for transactions\n * - Error: Something went wrong\n *\n * Supports two modes:\n * - Uncontrolled (default): Gets status from useWallet() hook\n * - Controlled: Accepts status/publicKey props (useful for stories/demos)\n */\n\nimport { useWallet } from '../../hooks/useWallet';\nimport type { WalletStatus as WalletStatusType } from '../../types/wallet';\nimport { WalletAddressRow } from './WalletAddressRow';\n\nexport interface WalletStatusProps {\n  /** Controlled mode: Override wallet status (for demos/stories) */\n  status?: WalletStatusType;\n  /** Controlled mode: Override public key display */\n  publicKey?: string;\n  /** Controlled mode: Override lock state */\n  onLock?: () => void;\n  /** Callback when user wants to create a wallet */\n  onEnroll?: () => void;\n  /** Callback when user wants to unlock wallet */\n  onUnlock?: () => void;\n  /** Callback when user wants to recover wallet */\n  onRecover?: () => void;\n  /** Whether to show action buttons */\n  showActions?: boolean;\n  /** Compact display mode */\n  compact?: boolean;\n  /** Additional CSS classes */\n  className?: string;\n}\n\n/**\n * Wallet status indicator\n *\n * Shows current wallet state with optional action buttons.\n * Pass `status` prop to use in controlled mode (bypasses hook).\n */\nexport function WalletStatus({\n  status: controlledStatus,\n  publicKey: controlledPubkey,\n  onLock: _onLock,\n  onEnroll,\n  onUnlock,\n  onRecover,\n  showActions = true,\n  compact = false,\n  className = '',\n}: WalletStatusProps) {\n  // onLock reserved for future use\n  void _onLock;\n  // Use controlled mode if status prop is provided, otherwise use hook\n  const isControlled = controlledStatus !== undefined;\n  const wallet = useWallet();\n\n  const status = isControlled ? controlledStatus : wallet.status;\n  const solanaPubkey = isControlled ? (controlledPubkey ?? null) : wallet.solanaPubkey;\n  const error = isControlled ? null : wallet.error;\n  const refresh = isControlled ? () => {} : wallet.refresh;\n  const clearError = isControlled ? () => {} : wallet.clearError;\n\n  const statusConfig = getStatusConfig(status, error);\n\n  if (compact) {\n    return (\n      <div className={`cedros-wallet-status cedros-wallet-status-compact ${className}`}>\n        <span\n          className={`cedros-wallet-status-dot cedros-wallet-status-${statusConfig.color}`}\n          title={statusConfig.label}\n        />\n        <span className=\"cedros-wallet-status-label\">{statusConfig.label}</span>\n        {solanaPubkey && (\n          <span className=\"cedros-wallet-status-pubkey\" title={solanaPubkey}>\n            {truncatePubkey(solanaPubkey)}\n          </span>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div className={`cedros-wallet-status ${className}`}>\n      <div className=\"cedros-wallet-status-header\">\n        <div\n          className={`cedros-wallet-status-icon cedros-wallet-status-icon-${statusConfig.color}`}\n        >\n          <StatusIcon status={status} />\n        </div>\n        <div className=\"cedros-wallet-status-info\">\n          <h4 className=\"cedros-wallet-status-title\">{statusConfig.title}</h4>\n          <p className=\"cedros-wallet-status-description\">{statusConfig.description}</p>\n        </div>\n      </div>\n\n      {solanaPubkey && (\n        <div className=\"cedros-wallet-status-pubkey-full\">\n          <WalletAddressRow address={solanaPubkey} />\n        </div>\n      )}\n\n      {error && (\n        <div className=\"cedros-wallet-status-error-box\" role=\"alert\">\n          <p>{error}</p>\n          <button\n            type=\"button\"\n            className=\"cedros-button cedros-button-sm cedros-button-secondary\"\n            onClick={clearError}\n          >\n            Dismiss\n          </button>\n        </div>\n      )}\n\n      {showActions && (\n        <div className=\"cedros-wallet-status-actions\">\n          {status === 'not_enrolled' && onEnroll && (\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-primary cedros-button-sm\"\n              onClick={onEnroll}\n            >\n              Create Wallet\n            </button>\n          )}\n\n          {status === 'enrolled_locked' && onUnlock && (\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-primary cedros-button-sm\"\n              onClick={onUnlock}\n            >\n              Unlock Wallet\n            </button>\n          )}\n\n          {(status === 'not_enrolled' || status === 'error') && onRecover && (\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-outline cedros-button-sm\"\n              onClick={onRecover}\n            >\n              Recover Wallet\n            </button>\n          )}\n\n          {status === 'error' && (\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-outline cedros-button-sm\"\n              onClick={refresh}\n            >\n              Retry\n            </button>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n\ninterface StatusConfig {\n  label: string;\n  title: string;\n  description: string;\n  color: 'loading' | 'success' | 'warning' | 'error' | 'muted';\n}\n\nfunction getStatusConfig(status: WalletStatusType, error: string | null): StatusConfig {\n  switch (status) {\n    case 'loading':\n      return {\n        label: 'Loading',\n        title: 'Checking Wallet',\n        description: 'Verifying wallet status...',\n        color: 'loading',\n      };\n\n    case 'not_enrolled':\n      return {\n        label: 'Not Set Up',\n        title: 'No Wallet',\n        description: 'Create a wallet to start using Solana.',\n        color: 'muted',\n      };\n\n    case 'enrolled_locked':\n      return {\n        label: 'Locked',\n        title: 'Wallet Locked',\n        description: 'Unlock your wallet to sign transactions.',\n        color: 'warning',\n      };\n\n    case 'enrolled_unlocked':\n    case 'unlocked':\n      return {\n        label: 'Ready',\n        title: 'Wallet Ready',\n        description: 'Your wallet is unlocked and ready to use.',\n        color: 'success',\n      };\n\n    case 'error':\n    default:\n      return {\n        label: 'Error',\n        title: 'Wallet Error',\n        description: error ?? 'An error occurred with your wallet.',\n        color: 'error',\n      };\n  }\n}\n\nfunction truncatePubkey(pubkey: string): string {\n  if (pubkey.length <= 12) return pubkey;\n  return `${pubkey.slice(0, 4)}...${pubkey.slice(-4)}`;\n}\n\nfunction StatusIcon({ status }: { status: WalletStatusType }) {\n  switch (status) {\n    case 'loading':\n      return (\n        <svg viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden=\"true\" className=\"cedros-spinner\">\n          <circle cx=\"12\" cy=\"12\" r=\"9\" stroke=\"currentColor\" strokeWidth=\"2\" opacity=\"0.25\" />\n          <path\n            d=\"M12 3a9 9 0 0 1 9 9\"\n            stroke=\"currentColor\"\n            strokeWidth=\"2\"\n            strokeLinecap=\"round\"\n          />\n        </svg>\n      );\n\n    case 'not_enrolled':\n      // Plus icon (add wallet)\n      return (\n        <svg\n          viewBox=\"0 0 24 24\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          strokeWidth=\"2\"\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n          aria-hidden=\"true\"\n        >\n          <circle cx=\"12\" cy=\"12\" r=\"10\" />\n          <path d=\"M8 12h8M12 8v8\" />\n        </svg>\n      );\n\n    case 'enrolled_locked':\n      // Lock icon\n      return (\n        <svg\n          viewBox=\"0 0 24 24\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          strokeWidth=\"2\"\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n          aria-hidden=\"true\"\n        >\n          <rect x=\"3\" y=\"11\" width=\"18\" height=\"11\" rx=\"2\" ry=\"2\" />\n          <path d=\"M7 11V7a5 5 0 0 1 10 0v4\" />\n        </svg>\n      );\n\n    case 'enrolled_unlocked':\n    case 'unlocked':\n      // Check icon\n      return (\n        <svg\n          viewBox=\"0 0 24 24\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          strokeWidth=\"2.5\"\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n          aria-hidden=\"true\"\n        >\n          <path d=\"M20 6L9 17l-5-5\" />\n        </svg>\n      );\n\n    case 'error':\n      // Alert triangle icon\n      return (\n        <svg\n          viewBox=\"0 0 24 24\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          strokeWidth=\"2\"\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n          aria-hidden=\"true\"\n        >\n          <path d=\"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3\" />\n          <path d=\"M12 9v4M12 17h.01\" />\n        </svg>\n      );\n\n    default:\n      return null;\n  }\n}\n","import { useCallback, useMemo, useState } from 'react';\nimport { useWallet } from '../../hooks/useWallet';\nimport { WalletEnrollment } from './WalletEnrollment';\nimport { WalletRecovery } from './WalletRecovery';\nimport { WalletStatus } from './WalletStatus';\nimport { WalletUnlock } from './WalletUnlock';\n\ntype WalletManagerView = 'status' | 'enroll' | 'unlock' | 'recover_intro' | 'recover';\n\nexport interface WalletManagerProps {\n  className?: string;\n  showActions?: boolean;\n}\n\n/**\n * Orchestrates embedded wallet flows in one cohesive surface:\n * status -> enroll/unlock/recover.\n */\nexport function WalletManager({ className = '', showActions = true }: WalletManagerProps) {\n  const wallet = useWallet();\n\n  const [view, setView] = useState<WalletManagerView>('status');\n\n  const header = useMemo(() => {\n    switch (view) {\n      case 'enroll':\n        return { title: 'Create Wallet', description: 'Set up your embedded wallet.' };\n      case 'unlock':\n        return { title: 'Unlock Wallet', description: 'Unlock to sign transactions.' };\n      case 'recover_intro':\n      case 'recover':\n        return {\n          title: 'Recover Wallet',\n          description: 'Restore access using your recovery phrase.',\n        };\n      case 'status':\n      default:\n        return null;\n    }\n  }, [view]);\n\n  const handleBackToStatus = useCallback(() => setView('status'), []);\n\n  const handleEnrollComplete = useCallback(async () => {\n    setView('status');\n    await wallet.refresh();\n  }, [wallet]);\n\n  const handleUnlockComplete = useCallback(async () => {\n    setView('status');\n    await wallet.refresh();\n  }, [wallet]);\n\n  const handleRecoverComplete = useCallback(async () => {\n    setView('status');\n    await wallet.refresh();\n  }, [wallet]);\n\n  return (\n    <div className={`cedros-wallet-manager ${className}`}>\n      {view !== 'status' && header && (\n        <div className=\"cedros-wallet-manager-header\">\n          <div className=\"cedros-wallet-manager-header-text\">\n            <h3 className=\"cedros-wallet-manager-title\">{header.title}</h3>\n            <p className=\"cedros-wallet-manager-subtitle\">{header.description}</p>\n          </div>\n          <button\n            type=\"button\"\n            className=\"cedros-button cedros-button-sm cedros-button-ghost\"\n            onClick={handleBackToStatus}\n          >\n            Back\n          </button>\n        </div>\n      )}\n\n      {view === 'status' && (\n        <WalletStatus\n          onEnroll={() => setView('enroll')}\n          onUnlock={() => setView('unlock')}\n          onRecover={() => setView('recover_intro')}\n          showActions={showActions}\n        />\n      )}\n\n      {view === 'enroll' && (\n        <WalletEnrollment\n          onComplete={() => {\n            void handleEnrollComplete();\n          }}\n          onCancel={handleBackToStatus}\n        />\n      )}\n\n      {view === 'unlock' && (\n        <WalletUnlock\n          onUnlock={() => {\n            void handleUnlockComplete();\n          }}\n          onCancel={handleBackToStatus}\n        />\n      )}\n\n      {view === 'recover_intro' && (\n        <div className=\"cedros-wallet-manager-intro\">\n          <div className=\"cedros-wallet-manager-intro-card\">\n            <h4 className=\"cedros-wallet-manager-intro-title\">Before you start</h4>\n            <ul className=\"cedros-wallet-manager-intro-list\">\n              <li>Youll need your 12-word recovery phrase.</li>\n              <li>Youll set a new password or passkey for this wallet.</li>\n              <li>If youre on a shared device, avoid copying the phrase into other apps.</li>\n            </ul>\n            <div className=\"cedros-wallet-manager-intro-actions\">\n              <button\n                type=\"button\"\n                className=\"cedros-button cedros-button-primary\"\n                onClick={() => setView('recover')}\n              >\n                Start recovery\n              </button>\n              <button\n                type=\"button\"\n                className=\"cedros-button cedros-button-secondary\"\n                onClick={handleBackToStatus}\n              >\n                Cancel\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {view === 'recover' && (\n        <WalletRecovery\n          onComplete={() => {\n            void handleRecoverComplete();\n          }}\n          onCancel={handleBackToStatus}\n        />\n      )}\n    </div>\n  );\n}\n","import { useState, useCallback, useEffect, useMemo } from 'react';\nimport type { SystemSetting, UpdateSettingRequest } from '../../types';\nimport { LoadingSpinner } from '../shared/LoadingSpinner';\nimport { ErrorMessage } from '../shared/ErrorMessage';\nimport { useSystemSettings } from '../../hooks/useSystemSettings';\nimport { SETTING_METADATA, CATEGORY_METADATA } from './settings/settingsMetadata';\nimport { SettingsSection as SettingsGrid } from './settings/settingsInputs';\n\n// =============================================================================\n// COMPONENT PROPS\n// =============================================================================\n\nexport interface SystemSettingsProps {\n  /** Whether to show section descriptions */\n  showDescriptions?: boolean;\n  /** Additional CSS class */\n  className?: string;\n  /** Callback when settings are saved */\n  onSave?: () => void;\n}\n\n// =============================================================================\n// MAIN COMPONENT\n// =============================================================================\n\n/**\n * System settings management component for administrators.\n * Uses manual save/reset flow (not autosave).\n */\nexport function SystemSettings({\n  showDescriptions = true,\n  className = '',\n  onSave,\n}: SystemSettingsProps) {\n  const { settings, isLoading, isUpdating, error, fetchSettings, updateSettings } =\n    useSystemSettings();\n\n  const [edits, setEdits] = useState<Record<string, string>>({});\n  const [saveError, setSaveError] = useState<string | null>(null);\n  const [saveSuccess, setSaveSuccess] = useState(false);\n\n  useEffect(() => {\n    fetchSettings();\n  }, [fetchSettings]);\n\n  // Clear success message after 3 seconds\n  useEffect(() => {\n    if (saveSuccess) {\n      const timer = setTimeout(() => setSaveSuccess(false), 3000);\n      return () => clearTimeout(timer);\n    }\n  }, [saveSuccess]);\n\n  const handleChange = useCallback((key: string, value: string) => {\n    setEdits((prev) => ({ ...prev, [key]: value }));\n    setSaveError(null);\n    setSaveSuccess(false);\n  }, []);\n\n  const handleSave = useCallback(async () => {\n    const updates: UpdateSettingRequest[] = Object.entries(edits).map(([key, value]) => ({\n      key,\n      value,\n    }));\n\n    if (updates.length === 0) return;\n\n    try {\n      await updateSettings(updates);\n      setEdits({});\n      setSaveError(null);\n      setSaveSuccess(true);\n      onSave?.();\n    } catch (err) {\n      setSaveError(err instanceof Error ? err.message : 'Failed to save settings');\n    }\n  }, [edits, updateSettings, onSave]);\n\n  const handleReset = useCallback(() => {\n    setEdits({});\n    setSaveError(null);\n    setSaveSuccess(false);\n  }, []);\n\n  const hasChanges = Object.keys(edits).length > 0;\n  const changeCount = Object.keys(edits).length;\n\n  if (isLoading && Object.keys(settings).length === 0) {\n    return (\n      <div className={`cedros-system-settings cedros-system-settings-loading ${className}`}>\n        <LoadingSpinner />\n        <span>Loading settings...</span>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={`cedros-system-settings ${className}`}>\n        <ErrorMessage error={error.message} />\n      </div>\n    );\n  }\n\n  const categories = Object.keys(settings).sort();\n\n  if (categories.length === 0) {\n    return (\n      <div className={`cedros-system-settings cedros-system-settings-empty ${className}`}>\n        <p>No system settings found.</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`cedros-system-settings ${className}`}>\n      {saveError && <ErrorMessage error={saveError} />}\n      {saveSuccess && <div className=\"cedros-settings-success\">Settings saved successfully.</div>}\n\n      {categories.map((category) => (\n        <CategorySection\n          key={category}\n          category={category}\n          settings={settings[category]}\n          edits={edits}\n          showDescription={showDescriptions}\n          onChange={handleChange}\n        />\n      ))}\n\n      <div className=\"cedros-system-settings-actions\">\n        {hasChanges && (\n          <span className=\"cedros-settings-change-count\">\n            {changeCount} unsaved change{changeCount !== 1 ? 's' : ''}\n          </span>\n        )}\n        <button\n          type=\"button\"\n          className=\"cedros-button cedros-button-secondary\"\n          onClick={handleReset}\n          disabled={!hasChanges || isUpdating}\n        >\n          Reset\n        </button>\n        <button\n          type=\"button\"\n          className=\"cedros-button cedros-button-primary\"\n          onClick={handleSave}\n          disabled={!hasChanges || isUpdating}\n        >\n          {isUpdating ? <LoadingSpinner size=\"sm\" /> : 'Save Changes'}\n        </button>\n      </div>\n    </div>\n  );\n}\n\n// =============================================================================\n// CATEGORY SECTION  header + ordered settings grid\n// =============================================================================\n\n/** Stable key order derived from SETTING_METADATA insertion order */\nconst METADATA_KEY_ORDER = Object.keys(SETTING_METADATA);\n\ninterface CategorySectionProps {\n  category: string;\n  settings: SystemSetting[];\n  edits: Record<string, string>;\n  showDescription: boolean;\n  onChange: (key: string, value: string) => void;\n}\n\nfunction CategorySection({\n  category,\n  settings,\n  edits,\n  showDescription,\n  onChange,\n}: CategorySectionProps) {\n  const meta = CATEGORY_METADATA[category] || {\n    label: category,\n    description: '',\n    icon: '',\n  };\n\n  // Sort settings by SETTING_METADATA order; unknown keys sort to end\n  const orderedSettings = useMemo(() => {\n    return [...settings].sort((a, b) => {\n      const ai = METADATA_KEY_ORDER.indexOf(a.key);\n      const bi = METADATA_KEY_ORDER.indexOf(b.key);\n      return (ai === -1 ? Infinity : ai) - (bi === -1 ? Infinity : bi);\n    });\n  }, [settings]);\n\n  return (\n    <section className=\"cedros-settings-section\">\n      <div className=\"cedros-settings-section-header\">\n        <span className=\"cedros-settings-section-icon\">{meta.icon}</span>\n        <div>\n          <h3 className=\"cedros-settings-section-title\">{meta.label}</h3>\n          {showDescription && meta.description && (\n            <p className=\"cedros-settings-section-description\">{meta.description}</p>\n          )}\n        </div>\n      </div>\n\n      <SettingsGrid settings={orderedSettings} edits={edits} onChange={onChange} />\n    </section>\n  );\n}\n","import type {\n  SetupStatusResponse,\n  CreateFirstAdminRequest,\n  CreateFirstAdminResponse,\n} from '../types/setup';\nimport { ApiClient, handleApiError } from './apiClient';\n\n/**\n * API client for setup operations (unauthenticated)\n *\n * These endpoints are used during first-run configuration before\n * any admin user exists.\n */\nexport class SetupApiClient {\n  private client: ApiClient;\n\n  constructor(baseUrl: string, timeoutMs?: number, retryAttempts?: number) {\n    // No auth token needed - setup endpoints are unauthenticated\n    this.client = new ApiClient({ baseUrl, timeoutMs, retryAttempts });\n  }\n\n  /**\n   * Check if initial setup is required\n   * Returns whether the system needs initial setup (no admin exists)\n   */\n  async getStatus(): Promise<SetupStatusResponse> {\n    try {\n      return await this.client.get<SetupStatusResponse>('/setup/status');\n    } catch (error) {\n      throw handleApiError(error, 'Failed to check setup status');\n    }\n  }\n\n  /**\n   * Create the first admin user\n   * Only works when no admin users exist\n   */\n  async createFirstAdmin(request: CreateFirstAdminRequest): Promise<CreateFirstAdminResponse> {\n    try {\n      return await this.client.post<CreateFirstAdminResponse>('/setup/admin', request);\n    } catch (error) {\n      throw handleApiError(error, 'Failed to create admin account');\n    }\n  }\n}\n","import { useState, useCallback, useMemo, useRef } from 'react';\nimport type {\n  SetupStatusResponse,\n  CreateFirstAdminRequest,\n  CreateFirstAdminResponse,\n  UseSetupReturn,\n} from '../types/setup';\nimport { useCedrosLogin } from '../context/useCedrosLogin';\nimport { SetupApiClient } from '../utils/setupApi';\n\n/**\n * Hook for first-run setup operations.\n *\n * Checks if setup is needed (no admin exists) and provides\n * ability to create the first admin user.\n *\n * @example\n * ```tsx\n * function SetupCheck() {\n *   const { status, isLoading, checkStatus, createAdmin } = useSetup();\n *\n *   useEffect(() => {\n *     checkStatus();\n *   }, [checkStatus]);\n *\n *   if (isLoading) return <Loading />;\n *   if (status?.needsSetup) {\n *     return <SetupWizard onCreateAdmin={createAdmin} />;\n *   }\n *   return <Dashboard />;\n * }\n * ```\n */\nexport function useSetup(): UseSetupReturn {\n  const { config } = useCedrosLogin();\n\n  const [status, setStatus] = useState<SetupStatusResponse | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isCreating, setIsCreating] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const requestIdRef = useRef(0);\n\n  const apiClient = useMemo(\n    () => new SetupApiClient(config.serverUrl, config.requestTimeout, config.retryAttempts),\n    [config.serverUrl, config.requestTimeout, config.retryAttempts]\n  );\n\n  // Use ref to avoid apiClient in callback dependencies\n  const apiClientRef = useRef(apiClient);\n  apiClientRef.current = apiClient;\n\n  const checkStatus = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    const requestId = ++requestIdRef.current;\n\n    try {\n      const response = await apiClientRef.current.getStatus();\n      if (requestId !== requestIdRef.current) return;\n      setStatus(response);\n    } catch (err) {\n      if (requestId !== requestIdRef.current) return;\n      setError(err instanceof Error ? err : new Error('Failed to check setup status'));\n    } finally {\n      if (requestId === requestIdRef.current) {\n        setIsLoading(false);\n      }\n    }\n  }, []);\n\n  const createAdmin = useCallback(\n    async (request: CreateFirstAdminRequest): Promise<CreateFirstAdminResponse> => {\n      setIsCreating(true);\n      setError(null);\n\n      try {\n        const response = await apiClientRef.current.createFirstAdmin(request);\n        // Refresh status after creating admin\n        await checkStatus();\n        return response;\n      } catch (err) {\n        const error = err instanceof Error ? err : new Error('Failed to create admin');\n        setError(error);\n        throw error;\n      } finally {\n        setIsCreating(false);\n      }\n    },\n    [checkStatus]\n  );\n\n  return {\n    status,\n    isLoading,\n    isCreating,\n    error,\n    checkStatus,\n    createAdmin,\n  };\n}\n","/**\n * Setup Wizard Component\n *\n * Displayed during first-run when no admin user exists.\n * Allows creating the first admin account.\n *\n * @example\n * ```tsx\n * function AdminApp() {\n *   const { status, isLoading, checkStatus, createAdmin } = useSetup();\n *\n *   useEffect(() => {\n *     checkStatus();\n *   }, [checkStatus]);\n *\n *   if (isLoading) return <LoadingSpinner />;\n *   if (status?.needsSetup) {\n *     return <SetupWizard onComplete={() => window.location.reload()} />;\n *   }\n *   return <CedrosAdminDashboard />;\n * }\n * ```\n */\n\nimport { useState, useCallback, useEffect } from 'react';\nimport { useSetup } from '../../hooks/useSetup';\nimport { LoadingSpinner } from '../shared/LoadingSpinner';\nimport { ErrorMessage } from '../shared/ErrorMessage';\n\nexport interface SetupWizardProps {\n  /** Callback when setup is complete */\n  onComplete?: () => void;\n  /** Additional CSS class */\n  className?: string;\n}\n\ninterface FormState {\n  email: string;\n  password: string;\n  confirmPassword: string;\n  name: string;\n  orgName: string;\n}\n\ninterface ValidationErrors {\n  email?: string;\n  password?: string;\n  confirmPassword?: string;\n}\n\nconst EMAIL_REGEX = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\nconst MIN_PASSWORD_LENGTH = 8;\n\nfunction validateForm(form: FormState): ValidationErrors {\n  const errors: ValidationErrors = {};\n\n  if (!form.email) {\n    errors.email = 'Email is required';\n  } else if (!EMAIL_REGEX.test(form.email)) {\n    errors.email = 'Invalid email format';\n  }\n\n  if (!form.password) {\n    errors.password = 'Password is required';\n  } else if (form.password.length < MIN_PASSWORD_LENGTH) {\n    errors.password = `Password must be at least ${MIN_PASSWORD_LENGTH} characters`;\n  }\n\n  if (!form.confirmPassword) {\n    errors.confirmPassword = 'Please confirm your password';\n  } else if (form.password !== form.confirmPassword) {\n    errors.confirmPassword = 'Passwords do not match';\n  }\n\n  return errors;\n}\n\nexport function SetupWizard({ onComplete, className = '' }: SetupWizardProps) {\n  const { status, isLoading, isCreating, error, checkStatus, createAdmin } = useSetup();\n  const [form, setForm] = useState<FormState>({\n    email: '',\n    password: '',\n    confirmPassword: '',\n    name: '',\n    orgName: '',\n  });\n  const [validationErrors, setValidationErrors] = useState<ValidationErrors>({});\n  const [success, setSuccess] = useState(false);\n\n  useEffect(() => {\n    checkStatus();\n  }, [checkStatus]);\n\n  const handleChange = useCallback(\n    (field: keyof FormState) => (e: React.ChangeEvent<HTMLInputElement>) => {\n      setForm((prev) => ({ ...prev, [field]: e.target.value }));\n      // Clear validation error when user types\n      setValidationErrors((prev) => ({ ...prev, [field]: undefined }));\n    },\n    []\n  );\n\n  const handleSubmit = useCallback(\n    async (e: React.FormEvent) => {\n      e.preventDefault();\n\n      const errors = validateForm(form);\n      if (Object.keys(errors).length > 0) {\n        setValidationErrors(errors);\n        return;\n      }\n\n      try {\n        await createAdmin({\n          email: form.email,\n          password: form.password,\n          name: form.name || undefined,\n          orgName: form.orgName || undefined,\n        });\n        setSuccess(true);\n        onComplete?.();\n      } catch {\n        // Error is handled by the hook\n      }\n    },\n    [form, createAdmin, onComplete]\n  );\n\n  if (isLoading) {\n    return (\n      <div className={`cedros-setup ${className}`}>\n        <div className=\"cedros-setup__loading\">\n          <LoadingSpinner />\n          <span className=\"cedros-setup__loading-text\">Checking setup status...</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (status && !status.needsSetup) {\n    return (\n      <div className={`cedros-setup ${className}`}>\n        <div className=\"cedros-setup__complete\">\n          <div className=\"cedros-setup__icon cedros-setup__icon--success\">\n            <svg\n              width=\"48\"\n              height=\"48\"\n              viewBox=\"0 0 24 24\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            >\n              <path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\" />\n              <polyline points=\"22 4 12 14.01 9 11.01\" />\n            </svg>\n          </div>\n          <h2 className=\"cedros-setup__title\">Setup Complete</h2>\n          <p className=\"cedros-setup__text\">An admin account already exists. You can now log in.</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (success) {\n    return (\n      <div className={`cedros-setup ${className}`}>\n        <div className=\"cedros-setup__complete\">\n          <div className=\"cedros-setup__icon cedros-setup__icon--success\">\n            <svg\n              width=\"48\"\n              height=\"48\"\n              viewBox=\"0 0 24 24\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            >\n              <path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\" />\n              <polyline points=\"22 4 12 14.01 9 11.01\" />\n            </svg>\n          </div>\n          <h2 className=\"cedros-setup__title\">Admin Account Created</h2>\n          <p className=\"cedros-setup__text\">\n            Your admin account has been created successfully. You can now log in with your\n            credentials.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`cedros-setup ${className}`}>\n      <div className=\"cedros-setup__container\">\n        <div className=\"cedros-setup__header\">\n          <div className=\"cedros-setup__logo\">\n            <svg\n              width=\"32\"\n              height=\"32\"\n              viewBox=\"0 0 24 24\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            >\n              <path d=\"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1\" />\n              <path d=\"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4\" />\n            </svg>\n          </div>\n          <h1 className=\"cedros-setup__title\">Welcome to Cedros</h1>\n          <p className=\"cedros-setup__subtitle\">\n            Let&apos;s set up your admin account to get started.\n          </p>\n        </div>\n\n        <form className=\"cedros-setup__form\" onSubmit={handleSubmit}>\n          {error && <ErrorMessage error={error.message} />}\n\n          <div className=\"cedros-setup__field\">\n            <label htmlFor=\"setup-email\" className=\"cedros-setup__label\">\n              Email Address <span className=\"cedros-setup__required\">*</span>\n            </label>\n            <input\n              id=\"setup-email\"\n              type=\"email\"\n              className={`cedros-setup__input ${validationErrors.email ? 'cedros-setup__input--error' : ''}`}\n              value={form.email}\n              onChange={handleChange('email')}\n              placeholder=\"admin@example.com\"\n              autoComplete=\"email\"\n              autoFocus\n              disabled={isCreating}\n            />\n            {validationErrors.email && (\n              <span className=\"cedros-setup__error\">{validationErrors.email}</span>\n            )}\n          </div>\n\n          <div className=\"cedros-setup__field\">\n            <label htmlFor=\"setup-name\" className=\"cedros-setup__label\">\n              Display Name\n            </label>\n            <input\n              id=\"setup-name\"\n              type=\"text\"\n              className=\"cedros-setup__input\"\n              value={form.name}\n              onChange={handleChange('name')}\n              placeholder=\"Admin\"\n              autoComplete=\"name\"\n              disabled={isCreating}\n            />\n          </div>\n\n          <div className=\"cedros-setup__field\">\n            <label htmlFor=\"setup-org-name\" className=\"cedros-setup__label\">\n              Organization Name\n            </label>\n            <input\n              id=\"setup-org-name\"\n              type=\"text\"\n              className=\"cedros-setup__input\"\n              value={form.orgName}\n              onChange={handleChange('orgName')}\n              placeholder=\"My Organization\"\n              disabled={isCreating}\n            />\n          </div>\n\n          <div className=\"cedros-setup__field\">\n            <label htmlFor=\"setup-password\" className=\"cedros-setup__label\">\n              Password <span className=\"cedros-setup__required\">*</span>\n            </label>\n            <input\n              id=\"setup-password\"\n              type=\"password\"\n              className={`cedros-setup__input ${validationErrors.password ? 'cedros-setup__input--error' : ''}`}\n              value={form.password}\n              onChange={handleChange('password')}\n              placeholder=\"At least 8 characters\"\n              autoComplete=\"new-password\"\n              disabled={isCreating}\n            />\n            {validationErrors.password && (\n              <span className=\"cedros-setup__error\">{validationErrors.password}</span>\n            )}\n          </div>\n\n          <div className=\"cedros-setup__field\">\n            <label htmlFor=\"setup-confirm-password\" className=\"cedros-setup__label\">\n              Confirm Password <span className=\"cedros-setup__required\">*</span>\n            </label>\n            <input\n              id=\"setup-confirm-password\"\n              type=\"password\"\n              className={`cedros-setup__input ${validationErrors.confirmPassword ? 'cedros-setup__input--error' : ''}`}\n              value={form.confirmPassword}\n              onChange={handleChange('confirmPassword')}\n              placeholder=\"Confirm your password\"\n              autoComplete=\"new-password\"\n              disabled={isCreating}\n            />\n            {validationErrors.confirmPassword && (\n              <span className=\"cedros-setup__error\">{validationErrors.confirmPassword}</span>\n            )}\n          </div>\n\n          <button type=\"submit\" className=\"cedros-setup__button\" disabled={isCreating}>\n            {isCreating ? (\n              <>\n                <LoadingSpinner />\n                <span>Creating Account...</span>\n              </>\n            ) : (\n              'Create Admin Account'\n            )}\n          </button>\n        </form>\n\n        <div className=\"cedros-setup__footer\">\n          <p className=\"cedros-setup__note\">\n            This will be the first administrator account for your installation.\n          </p>\n          {status?.serverVersion && (\n            <p className=\"cedros-setup__version\">Server version: {status.serverVersion}</p>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","/**\n * Security settings page - CORS, cookies, sessions, rate limiting\n */\nimport { SettingsPageLayout } from './SettingsPageLayout';\n\nconst CATEGORIES = ['security', 'rate_limit'];\n\nexport interface SecuritySettingsProps {\n  className?: string;\n}\n\nexport function SecuritySettings({ className }: SecuritySettingsProps) {\n  return (\n    <SettingsPageLayout\n      title=\"Security\"\n      description=\"Configure CORS, cookies, sessions, JWT, and rate limiting settings.\"\n      categories={CATEGORIES}\n      className={className}\n    />\n  );\n}\n","/**\n * Messaging settings page - Email/SMTP and Webhooks with tabs\n */\nimport { useState, useEffect, useMemo } from 'react';\nimport { LoadingSpinner } from '../../shared/LoadingSpinner';\nimport { ErrorMessage } from '../../shared/ErrorMessage';\nimport { useSettingsAutosave } from '../../../hooks/useSettingsAutosave';\nimport { SettingsSection } from './settingsInputs';\nimport { AutosaveStatus } from './AutosaveStatus';\nimport {\n  PROVIDER_SMTP_HOSTS,\n  SIMPLIFIED_EMAIL_FIELDS,\n  ALL_EMAIL_FIELDS,\n} from './EmailSettings';\n\ntype MessagingTab = 'email' | 'webhooks';\n\ninterface TabConfig {\n  id: MessagingTab;\n  label: string;\n  category: string;\n}\n\nconst TABS: TabConfig[] = [\n  { id: 'email', label: 'Email', category: 'email' },\n  { id: 'webhooks', label: 'Webhooks', category: 'webhook' },\n];\n\nexport interface MessagingSettingsProps {\n  className?: string;\n}\n\nexport function MessagingSettings({ className }: MessagingSettingsProps) {\n  const {\n    settings,\n    edits,\n    isLoading,\n    autosaveStatus,\n    autosaveError,\n    error,\n    fetchSettings,\n    handleChange,\n    getEffectiveValue,\n  } = useSettingsAutosave();\n\n  const [activeTab, setActiveTab] = useState<MessagingTab>('email');\n\n  useEffect(() => {\n    fetchSettings();\n  }, [fetchSettings]);\n\n  // Get current tab's category\n  const currentTab = TABS.find((t) => t.id === activeTab);\n  const currentCategory = currentTab?.category ?? '';\n\n  // Get current email provider\n  const emailProvider = getEffectiveValue('email_provider') || 'custom';\n  const isCustomProvider = emailProvider === 'custom';\n\n  // Check if SMTP is configured (has a host or a non-custom provider selected)\n  const smtpHost = getEffectiveValue('email_smtp_host');\n  const isSmtpConfigured = !isCustomProvider || (smtpHost != null && smtpHost !== '');\n\n  // PERF-02: Compute categorySettings inside useMemo with stable dependencies\n  // to prevent re-computation on every render\n  const currentSettings = useMemo(() => {\n    const categorySettings = settings[currentCategory] ?? [];\n    if (activeTab !== 'email') return categorySettings;\n\n    const fieldsToShow = isCustomProvider ? ALL_EMAIL_FIELDS : SIMPLIFIED_EMAIL_FIELDS;\n    return categorySettings\n      .filter((s) => fieldsToShow.includes(s.key))\n      .sort((a, b) => fieldsToShow.indexOf(a.key) - fieldsToShow.indexOf(b.key));\n  }, [settings, currentCategory, activeTab, isCustomProvider]);\n\n  // Auto-set SMTP host when provider changes (for non-custom providers)\n  const handleProviderAwareChange = (key: string, value: string) => {\n    handleChange(key, value);\n\n    // When provider changes, auto-fill the SMTP host\n    if (key === 'email_provider' && value !== 'custom') {\n      const smtpHost = PROVIDER_SMTP_HOSTS[value];\n      if (smtpHost) {\n        handleChange('email_smtp_host', smtpHost);\n        // Also set default port and TLS for convenience\n        handleChange('email_smtp_port', '587');\n        handleChange('email_smtp_tls', 'true');\n      }\n    }\n  };\n\n  if (isLoading && Object.keys(settings).length === 0) {\n    return (\n      <div className={`cedros-system-settings cedros-system-settings-loading ${className ?? ''}`}>\n        <LoadingSpinner />\n        <span>Loading settings...</span>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={`cedros-system-settings ${className ?? ''}`}>\n        <ErrorMessage error={error.message} />\n      </div>\n    );\n  }\n\n  return (\n    <div className={`cedros-system-settings ${className ?? ''}`}>\n      <div className=\"cedros-settings-page-header\">\n        <div className=\"cedros-settings-page-header-content\">\n          <h2 className=\"cedros-settings-page-title\">Auth Messages</h2>\n          <p className=\"cedros-settings-page-description\">\n            Configure email delivery for verification emails, password resets, and instant link\n            login. Webhook notifications can be sent to Discord or Slack.\n          </p>\n        </div>\n        <AutosaveStatus status={autosaveStatus} error={autosaveError} />\n      </div>\n\n      {activeTab === 'email' && !isSmtpConfigured && (\n        <div className=\"cedros-settings-warning-banner\">\n          Email features (verification, password reset, instant link) are disabled until SMTP is\n          configured. Select a provider or enter custom SMTP settings below.\n        </div>\n      )}\n\n      {/* Tabs */}\n      <div className=\"cedros-admin-tabs cedros-admin-tabs--line\">\n        {TABS.map((tab) => (\n          <button\n            key={tab.id}\n            type=\"button\"\n            className={`cedros-admin-tab ${activeTab === tab.id ? 'cedros-admin-tab-active' : ''}`}\n            onClick={() => setActiveTab(tab.id)}\n            aria-selected={activeTab === tab.id}\n            role=\"tab\"\n          >\n            {tab.label}\n          </button>\n        ))}\n      </div>\n\n      {/* Tab content */}\n      <div className=\"cedros-admin-tab-content\" role=\"tabpanel\">\n        {currentSettings.length === 0 ? (\n          <div className=\"cedros-system-settings-empty\">\n            <p>No settings found for {currentTab?.label ?? 'this section'}.</p>\n          </div>\n        ) : (\n          <SettingsSection\n            settings={currentSettings}\n            edits={edits}\n            onChange={activeTab === 'email' ? handleProviderAwareChange : handleChange}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n","/**\n * Unified Admin Dashboard\n *\n * A complete, ready-to-use admin panel following shadcn/ui dashboard patterns.\n *\n * @example\n * ```tsx\n * // Minimal setup - everything included\n * function AdminPage() {\n *   return <CedrosAdminDashboard />;\n * }\n *\n * // Customized sections\n * function AdminPage() {\n *   return (\n *     <CedrosAdminDashboard\n *       sections={['users', 'team', 'deposits', 'settings-auth']}\n *       title=\"My App Admin\"\n *     />\n *   );\n * }\n * ```\n */\n\nimport { useState, useCallback, useEffect } from 'react';\nimport type { Permission } from '../../types';\nimport { MemberList } from '../members/MemberList';\nimport { InviteForm } from '../invites/InviteForm';\nimport { InviteList } from '../invites/InviteList';\nimport { SetupWizard } from './SetupWizard';\nimport {\n  AuthenticationSettings,\n  EmbeddedWalletSettings,\n  MessagingSettings,\n  CreditSystemSettings,\n  ServerSettings,\n} from './settings';\nimport { LoadingSpinner } from '../shared/LoadingSpinner';\nimport { ErrorMessage } from '../shared/ErrorMessage';\nimport { useOrgs } from '../../hooks/useOrgs';\nimport { useMembers } from '../../hooks/useMembers';\nimport { useInvites } from '../../hooks/useInvites';\nimport { useCedrosLogin } from '../../context/useCedrosLogin';\nimport { useSetup } from '../../hooks/useSetup';\nimport { useServerFeatures } from '../../hooks/useServerFeatures';\nimport { useDashboardPermissions } from '../../hooks/useDashboardPermissions';\nimport { AdminDepositStats } from '../deposit/admin/AdminDepositStats';\nimport { AdminWithdrawalStats } from '../deposit/admin/AdminWithdrawalStats';\nimport { AdminDepositList } from '../deposit/admin/AdminDepositList';\nimport { AdminWithdrawalQueue } from '../deposit/admin/AdminWithdrawalQueue';\nimport { AdminPrivacyPeriodDeposits } from '../deposit/admin/AdminPrivacyPeriodDeposits';\nimport { AdminWithdrawalHistory } from '../deposit/admin/AdminWithdrawalHistory';\nimport { AdminUserList } from './AdminUserList';\nimport { AdminUserDetail } from './AdminUserDetail';\nimport { StatsBar } from './StatsBar';\nimport { PermissionsSection } from './PermissionsSection';\nimport { ProfileDropdown } from './ProfileDropdown';\nimport type { AdminUser } from '../../types';\nimport { useUsersStatsSummary } from './hooks/useUsersStatsSummary';\n\n/** Available dashboard sections */\nexport type DashboardSection =\n  | 'users'\n  | 'team'\n  | 'deposits'\n  | 'withdrawals'\n  | 'settings-wallet'\n  | 'settings-auth'\n  | 'settings-messaging'\n  | 'settings-credits'\n  | 'settings-server';\n\nexport interface CedrosAdminDashboardProps {\n  /** Dashboard title */\n  title?: string;\n  /** Sections to display (defaults to all) */\n  sections?: DashboardSection[];\n  /** Initial active section */\n  defaultSection?: DashboardSection;\n  /** Auto-refresh interval for stats in ms (0 to disable) */\n  refreshInterval?: number;\n  /** Items per page for lists */\n  pageSize?: number;\n  /** Callback when section changes */\n  onSectionChange?: (section: DashboardSection) => void;\n  /** Callback when user clicks Settings in profile dropdown */\n  onSettingsClick?: () => void;\n  /** Callback when user clicks Logout in profile dropdown (defaults to context logout) */\n  onLogoutClick?: () => void;\n  /** Additional CSS class */\n  className?: string;\n}\n\n// SVG Icons (Lucide-style, 24x24)\nconst Icons = {\n  users: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <path d=\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\" />\n      <circle cx=\"9\" cy=\"7\" r=\"4\" />\n      <path d=\"M22 21v-2a4 4 0 0 0-3-3.87\" />\n      <path d=\"M16 3.13a4 4 0 0 1 0 7.75\" />\n    </svg>\n  ),\n  members: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <path d=\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\" />\n      <circle cx=\"9\" cy=\"7\" r=\"4\" />\n      <path d=\"M22 21v-2a4 4 0 0 0-3-3.87\" />\n      <path d=\"M16 3.13a4 4 0 0 1 0 7.75\" />\n    </svg>\n  ),\n  invites: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <rect width=\"20\" height=\"16\" x=\"2\" y=\"4\" rx=\"2\" />\n      <path d=\"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7\" />\n    </svg>\n  ),\n  deposits: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <circle cx=\"12\" cy=\"12\" r=\"10\" />\n      <path d=\"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8\" />\n      <path d=\"M12 18V6\" />\n    </svg>\n  ),\n  withdrawals: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <rect width=\"16\" height=\"20\" x=\"4\" y=\"2\" rx=\"2\" ry=\"2\" />\n      <path d=\"M9 22v-4h6v4\" />\n      <path d=\"M8 6h.01\" />\n      <path d=\"M16 6h.01\" />\n      <path d=\"M12 6h.01\" />\n      <path d=\"M12 10h.01\" />\n      <path d=\"M12 14h.01\" />\n      <path d=\"M16 10h.01\" />\n      <path d=\"M16 14h.01\" />\n      <path d=\"M8 10h.01\" />\n      <path d=\"M8 14h.01\" />\n    </svg>\n  ),\n  settings: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <path d=\"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z\" />\n      <circle cx=\"12\" cy=\"12\" r=\"3\" />\n    </svg>\n  ),\n  wallet: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <path d=\"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1\" />\n      <path d=\"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4\" />\n    </svg>\n  ),\n  chevronRight: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <path d=\"m9 18 6-6-6-6\" />\n    </svg>\n  ),\n  // Settings sub-page icons\n  key: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <path d=\"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4\" />\n    </svg>\n  ),\n  toggles: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <rect width=\"20\" height=\"12\" x=\"2\" y=\"6\" rx=\"6\" />\n      <circle cx=\"8\" cy=\"12\" r=\"2\" />\n    </svg>\n  ),\n  shield: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <path d=\"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z\" />\n    </svg>\n  ),\n  mail: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <rect width=\"20\" height=\"16\" x=\"2\" y=\"4\" rx=\"2\" />\n      <path d=\"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7\" />\n    </svg>\n  ),\n  webhook: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <path d=\"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2\" />\n      <path d=\"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06\" />\n      <path d=\"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8\" />\n    </svg>\n  ),\n  coins: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <circle cx=\"8\" cy=\"8\" r=\"6\" />\n      <path d=\"M18.09 10.37A6 6 0 1 1 10.34 18\" />\n      <path d=\"M7 6h1v4\" />\n      <path d=\"m16.71 13.88.7.71-2.82 2.82\" />\n    </svg>\n  ),\n  server: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <rect width=\"20\" height=\"8\" x=\"2\" y=\"2\" rx=\"2\" ry=\"2\" />\n      <rect width=\"20\" height=\"8\" x=\"2\" y=\"14\" rx=\"2\" ry=\"2\" />\n      <line x1=\"6\" x2=\"6.01\" y1=\"6\" y2=\"6\" />\n      <line x1=\"6\" x2=\"6.01\" y1=\"18\" y2=\"18\" />\n    </svg>\n  ),\n};\n\ninterface SectionConfig {\n  id: DashboardSection;\n  label: string;\n  icon: React.ReactNode;\n  /** Optional group name for sidebar organization */\n  group?: string;\n  /** Feature flag required for this section (from server settings) */\n  requiredFeature?: 'organizations' | 'credits';\n}\n\nconst ALL_SECTIONS: SectionConfig[] = [\n  // Top-level menu items\n  { id: 'users', label: 'Users', icon: Icons.users },\n  { id: 'team', label: 'Team', icon: Icons.members },\n  { id: 'deposits', label: 'Deposits', icon: Icons.deposits, requiredFeature: 'credits' },\n  { id: 'withdrawals', label: 'Withdrawals', icon: Icons.withdrawals, requiredFeature: 'credits' },\n  // Configuration group\n  { id: 'settings-auth', label: 'Authentication', icon: Icons.key, group: 'Configuration' },\n  { id: 'settings-messaging', label: 'Auth Messages', icon: Icons.mail, group: 'Configuration' },\n  { id: 'settings-wallet', label: 'User Wallets', icon: Icons.wallet, group: 'Configuration' },\n  {\n    id: 'settings-credits',\n    label: 'Credit System',\n    icon: Icons.coins,\n    group: 'Configuration',\n    requiredFeature: 'credits',\n  },\n  { id: 'settings-server', label: 'Auth Server', icon: Icons.server, group: 'Configuration' },\n];\n\n/**\n * Unified Admin Dashboard\n *\n * Provides a complete admin interface with sidebar navigation.\n * Follows shadcn/ui dashboard patterns.\n */\nexport function CedrosAdminDashboard({\n  title = 'Dashboard',\n  sections = [\n    'users',\n    'team',\n    'deposits',\n    'withdrawals',\n    'settings-wallet',\n    'settings-auth',\n    'settings-messaging',\n    'settings-credits',\n    'settings-server',\n  ],\n  defaultSection = 'users',\n  refreshInterval = 0,\n  pageSize = 20,\n  onSectionChange,\n  onSettingsClick,\n  onLogoutClick,\n  className = '',\n}: CedrosAdminDashboardProps) {\n  const [activeSection, setActiveSection] = useState<DashboardSection>(defaultSection);\n  const [configExpanded, setConfigExpanded] = useState(true);\n\n  const { user, logout } = useCedrosLogin();\n  const { activeOrg, role, isLoading: orgsLoading, fetchOrgs, hasPermission } = useOrgs();\n  const { status, isLoading: setupLoading, checkStatus } = useSetup();\n  const { features, isLoading: featuresLoading } = useServerFeatures();\n  const { canAccess } = useDashboardPermissions();\n\n  const handleSectionChange = useCallback(\n    (section: DashboardSection) => {\n      setActiveSection(section);\n      onSectionChange?.(section);\n    },\n    [onSectionChange]\n  );\n\n  // Filter sections by: 1) explicitly enabled in props, 2) feature flag enabled, 3) role permissions\n  const enabledSections = ALL_SECTIONS.filter((s) => {\n    // Must be in the sections prop\n    if (!sections.includes(s.id)) return false;\n    // If section requires a feature, check if feature is enabled\n    if (s.requiredFeature && !features[s.requiredFeature]) return false;\n    // Check role-based dashboard permissions (owner always has access via canAccess)\n    if (!canAccess(s.id)) return false;\n    return true;\n  });\n\n  const currentSection = enabledSections.find((s) => s.id === activeSection);\n  const activeSectionDisabled = !currentSection && !featuresLoading;\n\n  useEffect(() => {\n    fetchOrgs();\n    checkStatus();\n  }, [fetchOrgs, checkStatus]);\n\n  // If active section is disabled (feature flag off), redirect to users\n  useEffect(() => {\n    if (activeSectionDisabled && enabledSections.length > 0) {\n      setActiveSection('users');\n    }\n  }, [activeSectionDisabled, enabledSections.length]);\n\n  // Show setup wizard if no admin exists\n  if (!setupLoading && status?.needsSetup) {\n    return (\n      <div className={`cedros-admin cedros-dashboard cedros-dashboard--setup ${className}`}>\n        <SetupWizard onComplete={() => checkStatus()} />\n      </div>\n    );\n  }\n\n  if ((orgsLoading || setupLoading || featuresLoading) && !activeOrg) {\n    return (\n      <div className={`cedros-admin cedros-dashboard cedros-dashboard--loading ${className}`}>\n        <LoadingSpinner />\n        <span className=\"cedros-dashboard__loading-text\">Loading...</span>\n      </div>\n    );\n  }\n\n  const needsOrg = activeSection === 'team';\n  if (needsOrg && !activeOrg) {\n    return (\n      <div className={`cedros-admin cedros-dashboard ${className}`}>\n        <ErrorMessage error=\"No organization selected. Please select an organization first.\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className={`cedros-admin cedros-dashboard ${className}`}>\n      {/* Sidebar */}\n      <aside className=\"cedros-dashboard__sidebar\">\n        <div className=\"cedros-dashboard__sidebar-header\">\n          <div className=\"cedros-dashboard__logo\">\n            {Icons.wallet}\n            <span className=\"cedros-dashboard__logo-text\">{title}</span>\n          </div>\n        </div>\n\n        <nav className=\"cedros-dashboard__nav\">\n          {/* Top-level menu items (no group) */}\n          <div className=\"cedros-dashboard__nav-group\">\n            <span className=\"cedros-dashboard__nav-label\">Menu</span>\n            {enabledSections\n              .filter((s) => !s.group)\n              .map((section) => (\n                <button\n                  key={section.id}\n                  type=\"button\"\n                  className={`cedros-dashboard__nav-item ${activeSection === section.id ? 'cedros-dashboard__nav-item--active' : ''}`}\n                  onClick={() => handleSectionChange(section.id)}\n                  aria-current={activeSection === section.id ? 'page' : undefined}\n                >\n                  <span className=\"cedros-dashboard__nav-icon\">{section.icon}</span>\n                  <span className=\"cedros-dashboard__nav-text\">{section.label}</span>\n                </button>\n              ))}\n          </div>\n\n          {/* Configuration group (collapsible) */}\n          {enabledSections.some((s) => s.group === 'Configuration') && (\n            <div className=\"cedros-dashboard__nav-group\">\n              <button\n                type=\"button\"\n                className=\"cedros-dashboard__nav-label cedros-dashboard__nav-label--collapsible\"\n                onClick={() => setConfigExpanded(!configExpanded)}\n                aria-expanded={configExpanded}\n              >\n                <span>Configuration</span>\n                <span\n                  className={`cedros-dashboard__nav-chevron ${configExpanded ? 'cedros-dashboard__nav-chevron--expanded' : ''}`}\n                >\n                  {Icons.chevronRight}\n                </span>\n              </button>\n              {configExpanded &&\n                enabledSections\n                  .filter((s) => s.group === 'Configuration')\n                  .map((section) => (\n                    <button\n                      key={section.id}\n                      type=\"button\"\n                      className={`cedros-dashboard__nav-item ${activeSection === section.id ? 'cedros-dashboard__nav-item--active' : ''}`}\n                      onClick={() => handleSectionChange(section.id)}\n                      aria-current={activeSection === section.id ? 'page' : undefined}\n                    >\n                      <span className=\"cedros-dashboard__nav-icon\">{section.icon}</span>\n                      <span className=\"cedros-dashboard__nav-text\">{section.label}</span>\n                    </button>\n                  ))}\n            </div>\n          )}\n        </nav>\n\n        {/* User profile dropdown at bottom */}\n        {user && (\n          <div className=\"cedros-dashboard__sidebar-footer\">\n            <ProfileDropdown\n              name={user.name}\n              email={user.email}\n              picture={user.picture}\n              onSettings={onSettingsClick}\n              onLogout={onLogoutClick ?? logout}\n            />\n          </div>\n        )}\n      </aside>\n\n      {/* Main Content */}\n      <main className=\"cedros-dashboard__main\">\n        <header className=\"cedros-dashboard__header\">\n          <div className=\"cedros-dashboard__breadcrumb\">\n            <span className=\"cedros-dashboard__breadcrumb-root\">{title}</span>\n            <span className=\"cedros-dashboard__breadcrumb-sep\">{Icons.chevronRight}</span>\n            <span className=\"cedros-dashboard__breadcrumb-current\">{currentSection?.label}</span>\n          </div>\n        </header>\n\n        <div className=\"cedros-dashboard__content\">\n          {activeSection === 'users' && (\n            <UsersSection pageSize={pageSize} currentUserId={user?.id} />\n          )}\n          {activeSection === 'team' && activeOrg && (\n            <TeamSection\n              orgId={activeOrg.id}\n              currentUserId={user?.id}\n              hasPermission={hasPermission}\n              role={role}\n            />\n          )}\n          {activeSection === 'deposits' && (\n            <DepositsSection pageSize={pageSize} refreshInterval={refreshInterval} />\n          )}\n          {activeSection === 'withdrawals' && (\n            <WithdrawalsSection pageSize={pageSize} refreshInterval={refreshInterval} />\n          )}\n          {activeSection === 'settings-auth' && (\n            <div className=\"cedros-dashboard__section\">\n              <AuthenticationSettings />\n            </div>\n          )}\n          {activeSection === 'settings-wallet' && (\n            <div className=\"cedros-dashboard__section\">\n              <EmbeddedWalletSettings />\n            </div>\n          )}\n          {activeSection === 'settings-messaging' && (\n            <div className=\"cedros-dashboard__section\">\n              <MessagingSettings />\n            </div>\n          )}\n          {activeSection === 'settings-credits' && (\n            <div className=\"cedros-dashboard__section\">\n              <CreditSystemSettings />\n            </div>\n          )}\n          {activeSection === 'settings-server' && (\n            <div className=\"cedros-dashboard__section\">\n              <ServerSettings />\n            </div>\n          )}\n        </div>\n      </main>\n    </div>\n  );\n}\n\n// =============================================================================\n// Section Components\n// =============================================================================\n\ninterface UsersSectionProps {\n  pageSize: number;\n  currentUserId?: string;\n}\n\nfunction UsersSection({ pageSize, currentUserId }: UsersSectionProps) {\n  const [selectedUser, setSelectedUser] = useState<AdminUser | null>(null);\n  const { statsItems, isLoading: statsLoading, error: statsError, refresh } = useUsersStatsSummary();\n\n  if (selectedUser) {\n    return (\n      <div className=\"cedros-dashboard__section\">\n        <AdminUserDetail\n          userId={selectedUser.id}\n          currentUserId={currentUserId}\n          onBack={() => setSelectedUser(null)}\n        />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"cedros-dashboard__section\">\n      <StatsBar stats={statsItems} isLoading={statsLoading} onRefresh={refresh} />\n      {statsError && <p className=\"cedros-admin-error-inline\">{statsError}</p>}\n\n      <AdminUserList\n        pageSize={pageSize}\n        currentUserId={currentUserId}\n        onUserClick={(user) => setSelectedUser(user)}\n      />\n    </div>\n  );\n}\n\ntype TeamTab = 'members' | 'invites' | 'permissions';\n\ninterface TeamSectionProps {\n  orgId: string;\n  currentUserId?: string;\n  hasPermission: (permission: Permission) => boolean;\n  role: string | null;\n}\n\nfunction TeamSection({ orgId, currentUserId, hasPermission, role }: TeamSectionProps) {\n  const [activeTab, setActiveTab] = useState<TeamTab>('members');\n\n  const {\n    members,\n    isLoading: membersLoading,\n    error: membersError,\n    fetchMembers,\n    updateMemberRole,\n    removeMember,\n  } = useMembers(orgId);\n  const {\n    invites,\n    isLoading: invitesLoading,\n    error: invitesError,\n    fetchInvites,\n    createInvite,\n    cancelInvite,\n    resendInvite,\n  } = useInvites(orgId);\n\n  useEffect(() => {\n    fetchMembers();\n    fetchInvites();\n  }, [fetchMembers, fetchInvites]);\n\n  const canInvite = hasPermission('invite:create');\n  const canCancel = hasPermission('invite:cancel');\n  const pendingCount = invites.length;\n  const roleCounts = members.reduce(\n    (acc, member) => {\n      acc[member.role] = (acc[member.role] ?? 0) + 1;\n      return acc;\n    },\n    {} as Record<string, number>\n  );\n  const ownerCount = roleCounts.owner ?? 0;\n  const adminCount = roleCounts.admin ?? 0;\n  const memberCount = roleCounts.member ?? 0;\n\n  return (\n    <div className=\"cedros-dashboard__team\">\n      <StatsBar\n        stats={[\n          { label: 'Owners', value: ownerCount },\n          { label: 'Admins', value: adminCount },\n          { label: 'Members', value: memberCount },\n          { label: 'Pending Invites', value: pendingCount },\n        ]}\n      />\n      {/* Tabs */}\n      <div className=\"cedros-admin-tabs cedros-admin-tabs--line\">\n        <button\n          type=\"button\"\n          className={`cedros-admin-tab ${activeTab === 'members' ? 'cedros-admin-tab-active' : ''}`}\n          onClick={() => setActiveTab('members')}\n          aria-selected={activeTab === 'members'}\n          role=\"tab\"\n        >\n          Members\n        </button>\n        <button\n          type=\"button\"\n          className={`cedros-admin-tab ${activeTab === 'invites' ? 'cedros-admin-tab-active' : ''}`}\n          onClick={() => setActiveTab('invites')}\n          aria-selected={activeTab === 'invites'}\n          role=\"tab\"\n        >\n          Pending Invites{pendingCount > 0 && ` (${pendingCount})`}\n        </button>\n        {role === 'owner' && (\n          <button\n            type=\"button\"\n            className={`cedros-admin-tab ${activeTab === 'permissions' ? 'cedros-admin-tab-active' : ''}`}\n            onClick={() => setActiveTab('permissions')}\n            aria-selected={activeTab === 'permissions'}\n            role=\"tab\"\n          >\n            Permissions\n          </button>\n        )}\n      </div>\n\n      {/* Tab content */}\n      <div className=\"cedros-admin-tab-content\" role=\"tabpanel\">\n        {activeTab === 'members' && (\n          <MemberList\n            members={members}\n            currentUserId={currentUserId}\n            isLoading={membersLoading}\n            error={membersError?.message}\n            canManage={hasPermission('member:remove')}\n            canChangeRoles={hasPermission('member:role_change')}\n            onUpdateRole={updateMemberRole}\n            onRemove={removeMember}\n          />\n        )}\n\n        {activeTab === 'invites' && (\n          <div className=\"cedros-dashboard__invites\">\n            {canInvite && (\n              <div className=\"cedros-dashboard__section\">\n                <div className=\"cedros-dashboard__section-header\">\n                  <h3 className=\"cedros-dashboard__section-title\">Send Invitation</h3>\n                </div>\n                <InviteForm\n                  onSubmit={createInvite}\n                  isLoading={invitesLoading}\n                  error={invitesError?.message}\n                />\n              </div>\n            )}\n\n            <div className=\"cedros-dashboard__section\">\n              <InviteList\n                invites={invites}\n                isLoading={invitesLoading}\n                error={invitesError?.message}\n                canManage={canCancel || canInvite}\n                onCancel={canCancel ? cancelInvite : undefined}\n                onResend={canInvite ? resendInvite : undefined}\n              />\n            </div>\n          </div>\n        )}\n\n        {activeTab === 'permissions' && role === 'owner' && <PermissionsSection userRole={role} />}\n      </div>\n    </div>\n  );\n}\n\ninterface DepositsSectionProps {\n  pageSize: number;\n  refreshInterval: number;\n}\n\nfunction DepositsSection({ pageSize, refreshInterval }: DepositsSectionProps) {\n  const [statusFilter, setStatusFilter] = useState<string>('');\n\n  return (\n    <div className=\"cedros-dashboard__deposits\">\n      {/* Stats summary */}\n      <AdminDepositStats refreshInterval={refreshInterval} />\n\n      {/* Filter and list */}\n      <div className=\"cedros-dashboard__deposits-list\">\n        <div className=\"cedros-dashboard__toolbar\">\n          <div className=\"cedros-dashboard__filter\">\n            <label className=\"cedros-dashboard__filter-label\" htmlFor=\"status-filter\">\n              Status\n            </label>\n            <select\n              id=\"status-filter\"\n              className=\"cedros-dashboard__select\"\n              value={statusFilter}\n              onChange={(e) => setStatusFilter(e.target.value)}\n            >\n              <option value=\"\">All statuses</option>\n              <option value=\"pending\">Pending</option>\n              <option value=\"detected\">Detected</option>\n              <option value=\"processing\">Processing</option>\n              <option value=\"completed\">Completed</option>\n              <option value=\"withdrawn\">Withdrawn</option>\n              <option value=\"expired\">Expired</option>\n              <option value=\"failed\">Failed</option>\n            </select>\n          </div>\n        </div>\n\n        <AdminDepositList\n          statusFilter={statusFilter || undefined}\n          pageSize={pageSize}\n          refreshInterval={refreshInterval}\n        />\n      </div>\n    </div>\n  );\n}\n\ninterface WithdrawalsSectionProps {\n  pageSize: number;\n  refreshInterval: number;\n}\n\nfunction WithdrawalsSection({ pageSize, refreshInterval }: WithdrawalsSectionProps) {\n  return (\n    <div className=\"cedros-dashboard__withdrawals\">\n      <AdminWithdrawalStats refreshInterval={refreshInterval} />\n      <p className=\"cedros-dashboard__text-muted\">\n        Track deposits through the withdrawal pipeline: privacy period, ready for processing, and\n        completed.\n      </p>\n\n      {/* Pipeline view: Privacy Period  Ready  Completed */}\n      <div className=\"cedros-dashboard__pipeline\">\n        <AdminPrivacyPeriodDeposits pageSize={pageSize} refreshInterval={refreshInterval} />\n        <AdminWithdrawalQueue pageSize={pageSize} refreshInterval={refreshInterval} />\n        <AdminWithdrawalHistory pageSize={pageSize} refreshInterval={refreshInterval} />\n      </div>\n    </div>\n  );\n}\n","// can-promise has a crash in some versions of react native that dont have\n// standard global objects\n// https://github.com/soldair/node-qrcode/issues/157\n\nmodule.exports = function () {\n  return typeof Promise === 'function' && Promise.prototype && Promise.prototype.then\n}\n","let toSJISFunction\nconst CODEWORDS_COUNT = [\n  0, // Not used\n  26, 44, 70, 100, 134, 172, 196, 242, 292, 346,\n  404, 466, 532, 581, 655, 733, 815, 901, 991, 1085,\n  1156, 1258, 1364, 1474, 1588, 1706, 1828, 1921, 2051, 2185,\n  2323, 2465, 2611, 2761, 2876, 3034, 3196, 3362, 3532, 3706\n]\n\n/**\n * Returns the QR Code size for the specified version\n *\n * @param  {Number} version QR Code version\n * @return {Number}         size of QR code\n */\nexports.getSymbolSize = function getSymbolSize (version) {\n  if (!version) throw new Error('\"version\" cannot be null or undefined')\n  if (version < 1 || version > 40) throw new Error('\"version\" should be in range from 1 to 40')\n  return version * 4 + 17\n}\n\n/**\n * Returns the total number of codewords used to store data and EC information.\n *\n * @param  {Number} version QR Code version\n * @return {Number}         Data length in bits\n */\nexports.getSymbolTotalCodewords = function getSymbolTotalCodewords (version) {\n  return CODEWORDS_COUNT[version]\n}\n\n/**\n * Encode data with Bose-Chaudhuri-Hocquenghem\n *\n * @param  {Number} data Value to encode\n * @return {Number}      Encoded value\n */\nexports.getBCHDigit = function (data) {\n  let digit = 0\n\n  while (data !== 0) {\n    digit++\n    data >>>= 1\n  }\n\n  return digit\n}\n\nexports.setToSJISFunction = function setToSJISFunction (f) {\n  if (typeof f !== 'function') {\n    throw new Error('\"toSJISFunc\" is not a valid function.')\n  }\n\n  toSJISFunction = f\n}\n\nexports.isKanjiModeEnabled = function () {\n  return typeof toSJISFunction !== 'undefined'\n}\n\nexports.toSJIS = function toSJIS (kanji) {\n  return toSJISFunction(kanji)\n}\n","exports.L = { bit: 1 }\nexports.M = { bit: 0 }\nexports.Q = { bit: 3 }\nexports.H = { bit: 2 }\n\nfunction fromString (string) {\n  if (typeof string !== 'string') {\n    throw new Error('Param is not a string')\n  }\n\n  const lcStr = string.toLowerCase()\n\n  switch (lcStr) {\n    case 'l':\n    case 'low':\n      return exports.L\n\n    case 'm':\n    case 'medium':\n      return exports.M\n\n    case 'q':\n    case 'quartile':\n      return exports.Q\n\n    case 'h':\n    case 'high':\n      return exports.H\n\n    default:\n      throw new Error('Unknown EC Level: ' + string)\n  }\n}\n\nexports.isValid = function isValid (level) {\n  return level && typeof level.bit !== 'undefined' &&\n    level.bit >= 0 && level.bit < 4\n}\n\nexports.from = function from (value, defaultValue) {\n  if (exports.isValid(value)) {\n    return value\n  }\n\n  try {\n    return fromString(value)\n  } catch (e) {\n    return defaultValue\n  }\n}\n","function BitBuffer () {\n  this.buffer = []\n  this.length = 0\n}\n\nBitBuffer.prototype = {\n\n  get: function (index) {\n    const bufIndex = Math.floor(index / 8)\n    return ((this.buffer[bufIndex] >>> (7 - index % 8)) & 1) === 1\n  },\n\n  put: function (num, length) {\n    for (let i = 0; i < length; i++) {\n      this.putBit(((num >>> (length - i - 1)) & 1) === 1)\n    }\n  },\n\n  getLengthInBits: function () {\n    return this.length\n  },\n\n  putBit: function (bit) {\n    const bufIndex = Math.floor(this.length / 8)\n    if (this.buffer.length <= bufIndex) {\n      this.buffer.push(0)\n    }\n\n    if (bit) {\n      this.buffer[bufIndex] |= (0x80 >>> (this.length % 8))\n    }\n\n    this.length++\n  }\n}\n\nmodule.exports = BitBuffer\n","/**\n * Helper class to handle QR Code symbol modules\n *\n * @param {Number} size Symbol size\n */\nfunction BitMatrix (size) {\n  if (!size || size < 1) {\n    throw new Error('BitMatrix size must be defined and greater than 0')\n  }\n\n  this.size = size\n  this.data = new Uint8Array(size * size)\n  this.reservedBit = new Uint8Array(size * size)\n}\n\n/**\n * Set bit value at specified location\n * If reserved flag is set, this bit will be ignored during masking process\n *\n * @param {Number}  row\n * @param {Number}  col\n * @param {Boolean} value\n * @param {Boolean} reserved\n */\nBitMatrix.prototype.set = function (row, col, value, reserved) {\n  const index = row * this.size + col\n  this.data[index] = value\n  if (reserved) this.reservedBit[index] = true\n}\n\n/**\n * Returns bit value at specified location\n *\n * @param  {Number}  row\n * @param  {Number}  col\n * @return {Boolean}\n */\nBitMatrix.prototype.get = function (row, col) {\n  return this.data[row * this.size + col]\n}\n\n/**\n * Applies xor operator at specified location\n * (used during masking process)\n *\n * @param {Number}  row\n * @param {Number}  col\n * @param {Boolean} value\n */\nBitMatrix.prototype.xor = function (row, col, value) {\n  this.data[row * this.size + col] ^= value\n}\n\n/**\n * Check if bit at specified location is reserved\n *\n * @param {Number}   row\n * @param {Number}   col\n * @return {Boolean}\n */\nBitMatrix.prototype.isReserved = function (row, col) {\n  return this.reservedBit[row * this.size + col]\n}\n\nmodule.exports = BitMatrix\n","/**\n * Alignment pattern are fixed reference pattern in defined positions\n * in a matrix symbology, which enables the decode software to re-synchronise\n * the coordinate mapping of the image modules in the event of moderate amounts\n * of distortion of the image.\n *\n * Alignment patterns are present only in QR Code symbols of version 2 or larger\n * and their number depends on the symbol version.\n */\n\nconst getSymbolSize = require('./utils').getSymbolSize\n\n/**\n * Calculate the row/column coordinates of the center module of each alignment pattern\n * for the specified QR Code version.\n *\n * The alignment patterns are positioned symmetrically on either side of the diagonal\n * running from the top left corner of the symbol to the bottom right corner.\n *\n * Since positions are simmetrical only half of the coordinates are returned.\n * Each item of the array will represent in turn the x and y coordinate.\n * @see {@link getPositions}\n *\n * @param  {Number} version QR Code version\n * @return {Array}          Array of coordinate\n */\nexports.getRowColCoords = function getRowColCoords (version) {\n  if (version === 1) return []\n\n  const posCount = Math.floor(version / 7) + 2\n  const size = getSymbolSize(version)\n  const intervals = size === 145 ? 26 : Math.ceil((size - 13) / (2 * posCount - 2)) * 2\n  const positions = [size - 7] // Last coord is always (size - 7)\n\n  for (let i = 1; i < posCount - 1; i++) {\n    positions[i] = positions[i - 1] - intervals\n  }\n\n  positions.push(6) // First coord is always 6\n\n  return positions.reverse()\n}\n\n/**\n * Returns an array containing the positions of each alignment pattern.\n * Each array's element represent the center point of the pattern as (x, y) coordinates\n *\n * Coordinates are calculated expanding the row/column coordinates returned by {@link getRowColCoords}\n * and filtering out the items that overlaps with finder pattern\n *\n * @example\n * For a Version 7 symbol {@link getRowColCoords} returns values 6, 22 and 38.\n * The alignment patterns, therefore, are to be centered on (row, column)\n * positions (6,22), (22,6), (22,22), (22,38), (38,22), (38,38).\n * Note that the coordinates (6,6), (6,38), (38,6) are occupied by finder patterns\n * and are not therefore used for alignment patterns.\n *\n * let pos = getPositions(7)\n * // [[6,22], [22,6], [22,22], [22,38], [38,22], [38,38]]\n *\n * @param  {Number} version QR Code version\n * @return {Array}          Array of coordinates\n */\nexports.getPositions = function getPositions (version) {\n  const coords = []\n  const pos = exports.getRowColCoords(version)\n  const posLength = pos.length\n\n  for (let i = 0; i < posLength; i++) {\n    for (let j = 0; j < posLength; j++) {\n      // Skip if position is occupied by finder patterns\n      if ((i === 0 && j === 0) || // top-left\n          (i === 0 && j === posLength - 1) || // bottom-left\n          (i === posLength - 1 && j === 0)) { // top-right\n        continue\n      }\n\n      coords.push([pos[i], pos[j]])\n    }\n  }\n\n  return coords\n}\n","const getSymbolSize = require('./utils').getSymbolSize\nconst FINDER_PATTERN_SIZE = 7\n\n/**\n * Returns an array containing the positions of each finder pattern.\n * Each array's element represent the top-left point of the pattern as (x, y) coordinates\n *\n * @param  {Number} version QR Code version\n * @return {Array}          Array of coordinates\n */\nexports.getPositions = function getPositions (version) {\n  const size = getSymbolSize(version)\n\n  return [\n    // top-left\n    [0, 0],\n    // top-right\n    [size - FINDER_PATTERN_SIZE, 0],\n    // bottom-left\n    [0, size - FINDER_PATTERN_SIZE]\n  ]\n}\n","/**\n * Data mask pattern reference\n * @type {Object}\n */\nexports.Patterns = {\n  PATTERN000: 0,\n  PATTERN001: 1,\n  PATTERN010: 2,\n  PATTERN011: 3,\n  PATTERN100: 4,\n  PATTERN101: 5,\n  PATTERN110: 6,\n  PATTERN111: 7\n}\n\n/**\n * Weighted penalty scores for the undesirable features\n * @type {Object}\n */\nconst PenaltyScores = {\n  N1: 3,\n  N2: 3,\n  N3: 40,\n  N4: 10\n}\n\n/**\n * Check if mask pattern value is valid\n *\n * @param  {Number}  mask    Mask pattern\n * @return {Boolean}         true if valid, false otherwise\n */\nexports.isValid = function isValid (mask) {\n  return mask != null && mask !== '' && !isNaN(mask) && mask >= 0 && mask <= 7\n}\n\n/**\n * Returns mask pattern from a value.\n * If value is not valid, returns undefined\n *\n * @param  {Number|String} value        Mask pattern value\n * @return {Number}                     Valid mask pattern or undefined\n */\nexports.from = function from (value) {\n  return exports.isValid(value) ? parseInt(value, 10) : undefined\n}\n\n/**\n* Find adjacent modules in row/column with the same color\n* and assign a penalty value.\n*\n* Points: N1 + i\n* i is the amount by which the number of adjacent modules of the same color exceeds 5\n*/\nexports.getPenaltyN1 = function getPenaltyN1 (data) {\n  const size = data.size\n  let points = 0\n  let sameCountCol = 0\n  let sameCountRow = 0\n  let lastCol = null\n  let lastRow = null\n\n  for (let row = 0; row < size; row++) {\n    sameCountCol = sameCountRow = 0\n    lastCol = lastRow = null\n\n    for (let col = 0; col < size; col++) {\n      let module = data.get(row, col)\n      if (module === lastCol) {\n        sameCountCol++\n      } else {\n        if (sameCountCol >= 5) points += PenaltyScores.N1 + (sameCountCol - 5)\n        lastCol = module\n        sameCountCol = 1\n      }\n\n      module = data.get(col, row)\n      if (module === lastRow) {\n        sameCountRow++\n      } else {\n        if (sameCountRow >= 5) points += PenaltyScores.N1 + (sameCountRow - 5)\n        lastRow = module\n        sameCountRow = 1\n      }\n    }\n\n    if (sameCountCol >= 5) points += PenaltyScores.N1 + (sameCountCol - 5)\n    if (sameCountRow >= 5) points += PenaltyScores.N1 + (sameCountRow - 5)\n  }\n\n  return points\n}\n\n/**\n * Find 2x2 blocks with the same color and assign a penalty value\n *\n * Points: N2 * (m - 1) * (n - 1)\n */\nexports.getPenaltyN2 = function getPenaltyN2 (data) {\n  const size = data.size\n  let points = 0\n\n  for (let row = 0; row < size - 1; row++) {\n    for (let col = 0; col < size - 1; col++) {\n      const last = data.get(row, col) +\n        data.get(row, col + 1) +\n        data.get(row + 1, col) +\n        data.get(row + 1, col + 1)\n\n      if (last === 4 || last === 0) points++\n    }\n  }\n\n  return points * PenaltyScores.N2\n}\n\n/**\n * Find 1:1:3:1:1 ratio (dark:light:dark:light:dark) pattern in row/column,\n * preceded or followed by light area 4 modules wide\n *\n * Points: N3 * number of pattern found\n */\nexports.getPenaltyN3 = function getPenaltyN3 (data) {\n  const size = data.size\n  let points = 0\n  let bitsCol = 0\n  let bitsRow = 0\n\n  for (let row = 0; row < size; row++) {\n    bitsCol = bitsRow = 0\n    for (let col = 0; col < size; col++) {\n      bitsCol = ((bitsCol << 1) & 0x7FF) | data.get(row, col)\n      if (col >= 10 && (bitsCol === 0x5D0 || bitsCol === 0x05D)) points++\n\n      bitsRow = ((bitsRow << 1) & 0x7FF) | data.get(col, row)\n      if (col >= 10 && (bitsRow === 0x5D0 || bitsRow === 0x05D)) points++\n    }\n  }\n\n  return points * PenaltyScores.N3\n}\n\n/**\n * Calculate proportion of dark modules in entire symbol\n *\n * Points: N4 * k\n *\n * k is the rating of the deviation of the proportion of dark modules\n * in the symbol from 50% in steps of 5%\n */\nexports.getPenaltyN4 = function getPenaltyN4 (data) {\n  let darkCount = 0\n  const modulesCount = data.data.length\n\n  for (let i = 0; i < modulesCount; i++) darkCount += data.data[i]\n\n  const k = Math.abs(Math.ceil((darkCount * 100 / modulesCount) / 5) - 10)\n\n  return k * PenaltyScores.N4\n}\n\n/**\n * Return mask value at given position\n *\n * @param  {Number} maskPattern Pattern reference value\n * @param  {Number} i           Row\n * @param  {Number} j           Column\n * @return {Boolean}            Mask value\n */\nfunction getMaskAt (maskPattern, i, j) {\n  switch (maskPattern) {\n    case exports.Patterns.PATTERN000: return (i + j) % 2 === 0\n    case exports.Patterns.PATTERN001: return i % 2 === 0\n    case exports.Patterns.PATTERN010: return j % 3 === 0\n    case exports.Patterns.PATTERN011: return (i + j) % 3 === 0\n    case exports.Patterns.PATTERN100: return (Math.floor(i / 2) + Math.floor(j / 3)) % 2 === 0\n    case exports.Patterns.PATTERN101: return (i * j) % 2 + (i * j) % 3 === 0\n    case exports.Patterns.PATTERN110: return ((i * j) % 2 + (i * j) % 3) % 2 === 0\n    case exports.Patterns.PATTERN111: return ((i * j) % 3 + (i + j) % 2) % 2 === 0\n\n    default: throw new Error('bad maskPattern:' + maskPattern)\n  }\n}\n\n/**\n * Apply a mask pattern to a BitMatrix\n *\n * @param  {Number}    pattern Pattern reference number\n * @param  {BitMatrix} data    BitMatrix data\n */\nexports.applyMask = function applyMask (pattern, data) {\n  const size = data.size\n\n  for (let col = 0; col < size; col++) {\n    for (let row = 0; row < size; row++) {\n      if (data.isReserved(row, col)) continue\n      data.xor(row, col, getMaskAt(pattern, row, col))\n    }\n  }\n}\n\n/**\n * Returns the best mask pattern for data\n *\n * @param  {BitMatrix} data\n * @return {Number} Mask pattern reference number\n */\nexports.getBestMask = function getBestMask (data, setupFormatFunc) {\n  const numPatterns = Object.keys(exports.Patterns).length\n  let bestPattern = 0\n  let lowerPenalty = Infinity\n\n  for (let p = 0; p < numPatterns; p++) {\n    setupFormatFunc(p)\n    exports.applyMask(p, data)\n\n    // Calculate penalty\n    const penalty =\n      exports.getPenaltyN1(data) +\n      exports.getPenaltyN2(data) +\n      exports.getPenaltyN3(data) +\n      exports.getPenaltyN4(data)\n\n    // Undo previously applied mask\n    exports.applyMask(p, data)\n\n    if (penalty < lowerPenalty) {\n      lowerPenalty = penalty\n      bestPattern = p\n    }\n  }\n\n  return bestPattern\n}\n","const ECLevel = require('./error-correction-level')\r\n\r\nconst EC_BLOCKS_TABLE = [\r\n// L  M  Q  H\r\n  1, 1, 1, 1,\r\n  1, 1, 1, 1,\r\n  1, 1, 2, 2,\r\n  1, 2, 2, 4,\r\n  1, 2, 4, 4,\r\n  2, 4, 4, 4,\r\n  2, 4, 6, 5,\r\n  2, 4, 6, 6,\r\n  2, 5, 8, 8,\r\n  4, 5, 8, 8,\r\n  4, 5, 8, 11,\r\n  4, 8, 10, 11,\r\n  4, 9, 12, 16,\r\n  4, 9, 16, 16,\r\n  6, 10, 12, 18,\r\n  6, 10, 17, 16,\r\n  6, 11, 16, 19,\r\n  6, 13, 18, 21,\r\n  7, 14, 21, 25,\r\n  8, 16, 20, 25,\r\n  8, 17, 23, 25,\r\n  9, 17, 23, 34,\r\n  9, 18, 25, 30,\r\n  10, 20, 27, 32,\r\n  12, 21, 29, 35,\r\n  12, 23, 34, 37,\r\n  12, 25, 34, 40,\r\n  13, 26, 35, 42,\r\n  14, 28, 38, 45,\r\n  15, 29, 40, 48,\r\n  16, 31, 43, 51,\r\n  17, 33, 45, 54,\r\n  18, 35, 48, 57,\r\n  19, 37, 51, 60,\r\n  19, 38, 53, 63,\r\n  20, 40, 56, 66,\r\n  21, 43, 59, 70,\r\n  22, 45, 62, 74,\r\n  24, 47, 65, 77,\r\n  25, 49, 68, 81\r\n]\r\n\r\nconst EC_CODEWORDS_TABLE = [\r\n// L  M  Q  H\r\n  7, 10, 13, 17,\r\n  10, 16, 22, 28,\r\n  15, 26, 36, 44,\r\n  20, 36, 52, 64,\r\n  26, 48, 72, 88,\r\n  36, 64, 96, 112,\r\n  40, 72, 108, 130,\r\n  48, 88, 132, 156,\r\n  60, 110, 160, 192,\r\n  72, 130, 192, 224,\r\n  80, 150, 224, 264,\r\n  96, 176, 260, 308,\r\n  104, 198, 288, 352,\r\n  120, 216, 320, 384,\r\n  132, 240, 360, 432,\r\n  144, 280, 408, 480,\r\n  168, 308, 448, 532,\r\n  180, 338, 504, 588,\r\n  196, 364, 546, 650,\r\n  224, 416, 600, 700,\r\n  224, 442, 644, 750,\r\n  252, 476, 690, 816,\r\n  270, 504, 750, 900,\r\n  300, 560, 810, 960,\r\n  312, 588, 870, 1050,\r\n  336, 644, 952, 1110,\r\n  360, 700, 1020, 1200,\r\n  390, 728, 1050, 1260,\r\n  420, 784, 1140, 1350,\r\n  450, 812, 1200, 1440,\r\n  480, 868, 1290, 1530,\r\n  510, 924, 1350, 1620,\r\n  540, 980, 1440, 1710,\r\n  570, 1036, 1530, 1800,\r\n  570, 1064, 1590, 1890,\r\n  600, 1120, 1680, 1980,\r\n  630, 1204, 1770, 2100,\r\n  660, 1260, 1860, 2220,\r\n  720, 1316, 1950, 2310,\r\n  750, 1372, 2040, 2430\r\n]\r\n\r\n/**\r\n * Returns the number of error correction block that the QR Code should contain\r\n * for the specified version and error correction level.\r\n *\r\n * @param  {Number} version              QR Code version\r\n * @param  {Number} errorCorrectionLevel Error correction level\r\n * @return {Number}                      Number of error correction blocks\r\n */\r\nexports.getBlocksCount = function getBlocksCount (version, errorCorrectionLevel) {\r\n  switch (errorCorrectionLevel) {\r\n    case ECLevel.L:\r\n      return EC_BLOCKS_TABLE[(version - 1) * 4 + 0]\r\n    case ECLevel.M:\r\n      return EC_BLOCKS_TABLE[(version - 1) * 4 + 1]\r\n    case ECLevel.Q:\r\n      return EC_BLOCKS_TABLE[(version - 1) * 4 + 2]\r\n    case ECLevel.H:\r\n      return EC_BLOCKS_TABLE[(version - 1) * 4 + 3]\r\n    default:\r\n      return undefined\r\n  }\r\n}\r\n\r\n/**\r\n * Returns the number of error correction codewords to use for the specified\r\n * version and error correction level.\r\n *\r\n * @param  {Number} version              QR Code version\r\n * @param  {Number} errorCorrectionLevel Error correction level\r\n * @return {Number}                      Number of error correction codewords\r\n */\r\nexports.getTotalCodewordsCount = function getTotalCodewordsCount (version, errorCorrectionLevel) {\r\n  switch (errorCorrectionLevel) {\r\n    case ECLevel.L:\r\n      return EC_CODEWORDS_TABLE[(version - 1) * 4 + 0]\r\n    case ECLevel.M:\r\n      return EC_CODEWORDS_TABLE[(version - 1) * 4 + 1]\r\n    case ECLevel.Q:\r\n      return EC_CODEWORDS_TABLE[(version - 1) * 4 + 2]\r\n    case ECLevel.H:\r\n      return EC_CODEWORDS_TABLE[(version - 1) * 4 + 3]\r\n    default:\r\n      return undefined\r\n  }\r\n}\r\n","const EXP_TABLE = new Uint8Array(512)\nconst LOG_TABLE = new Uint8Array(256)\n/**\n * Precompute the log and anti-log tables for faster computation later\n *\n * For each possible value in the galois field 2^8, we will pre-compute\n * the logarithm and anti-logarithm (exponential) of this value\n *\n * ref {@link https://en.wikiversity.org/wiki/Reed%E2%80%93Solomon_codes_for_coders#Introduction_to_mathematical_fields}\n */\n;(function initTables () {\n  let x = 1\n  for (let i = 0; i < 255; i++) {\n    EXP_TABLE[i] = x\n    LOG_TABLE[x] = i\n\n    x <<= 1 // multiply by 2\n\n    // The QR code specification says to use byte-wise modulo 100011101 arithmetic.\n    // This means that when a number is 256 or larger, it should be XORed with 0x11D.\n    if (x & 0x100) { // similar to x >= 256, but a lot faster (because 0x100 == 256)\n      x ^= 0x11D\n    }\n  }\n\n  // Optimization: double the size of the anti-log table so that we don't need to mod 255 to\n  // stay inside the bounds (because we will mainly use this table for the multiplication of\n  // two GF numbers, no more).\n  // @see {@link mul}\n  for (let i = 255; i < 512; i++) {\n    EXP_TABLE[i] = EXP_TABLE[i - 255]\n  }\n}())\n\n/**\n * Returns log value of n inside Galois Field\n *\n * @param  {Number} n\n * @return {Number}\n */\nexports.log = function log (n) {\n  if (n < 1) throw new Error('log(' + n + ')')\n  return LOG_TABLE[n]\n}\n\n/**\n * Returns anti-log value of n inside Galois Field\n *\n * @param  {Number} n\n * @return {Number}\n */\nexports.exp = function exp (n) {\n  return EXP_TABLE[n]\n}\n\n/**\n * Multiplies two number inside Galois Field\n *\n * @param  {Number} x\n * @param  {Number} y\n * @return {Number}\n */\nexports.mul = function mul (x, y) {\n  if (x === 0 || y === 0) return 0\n\n  // should be EXP_TABLE[(LOG_TABLE[x] + LOG_TABLE[y]) % 255] if EXP_TABLE wasn't oversized\n  // @see {@link initTables}\n  return EXP_TABLE[LOG_TABLE[x] + LOG_TABLE[y]]\n}\n","const GF = require('./galois-field')\n\n/**\n * Multiplies two polynomials inside Galois Field\n *\n * @param  {Uint8Array} p1 Polynomial\n * @param  {Uint8Array} p2 Polynomial\n * @return {Uint8Array}    Product of p1 and p2\n */\nexports.mul = function mul (p1, p2) {\n  const coeff = new Uint8Array(p1.length + p2.length - 1)\n\n  for (let i = 0; i < p1.length; i++) {\n    for (let j = 0; j < p2.length; j++) {\n      coeff[i + j] ^= GF.mul(p1[i], p2[j])\n    }\n  }\n\n  return coeff\n}\n\n/**\n * Calculate the remainder of polynomials division\n *\n * @param  {Uint8Array} divident Polynomial\n * @param  {Uint8Array} divisor  Polynomial\n * @return {Uint8Array}          Remainder\n */\nexports.mod = function mod (divident, divisor) {\n  let result = new Uint8Array(divident)\n\n  while ((result.length - divisor.length) >= 0) {\n    const coeff = result[0]\n\n    for (let i = 0; i < divisor.length; i++) {\n      result[i] ^= GF.mul(divisor[i], coeff)\n    }\n\n    // remove all zeros from buffer head\n    let offset = 0\n    while (offset < result.length && result[offset] === 0) offset++\n    result = result.slice(offset)\n  }\n\n  return result\n}\n\n/**\n * Generate an irreducible generator polynomial of specified degree\n * (used by Reed-Solomon encoder)\n *\n * @param  {Number} degree Degree of the generator polynomial\n * @return {Uint8Array}    Buffer containing polynomial coefficients\n */\nexports.generateECPolynomial = function generateECPolynomial (degree) {\n  let poly = new Uint8Array([1])\n  for (let i = 0; i < degree; i++) {\n    poly = exports.mul(poly, new Uint8Array([1, GF.exp(i)]))\n  }\n\n  return poly\n}\n","const Polynomial = require('./polynomial')\n\nfunction ReedSolomonEncoder (degree) {\n  this.genPoly = undefined\n  this.degree = degree\n\n  if (this.degree) this.initialize(this.degree)\n}\n\n/**\n * Initialize the encoder.\n * The input param should correspond to the number of error correction codewords.\n *\n * @param  {Number} degree\n */\nReedSolomonEncoder.prototype.initialize = function initialize (degree) {\n  // create an irreducible generator polynomial\n  this.degree = degree\n  this.genPoly = Polynomial.generateECPolynomial(this.degree)\n}\n\n/**\n * Encodes a chunk of data\n *\n * @param  {Uint8Array} data Buffer containing input data\n * @return {Uint8Array}      Buffer containing encoded data\n */\nReedSolomonEncoder.prototype.encode = function encode (data) {\n  if (!this.genPoly) {\n    throw new Error('Encoder not initialized')\n  }\n\n  // Calculate EC for this data block\n  // extends data size to data+genPoly size\n  const paddedData = new Uint8Array(data.length + this.degree)\n  paddedData.set(data)\n\n  // The error correction codewords are the remainder after dividing the data codewords\n  // by a generator polynomial\n  const remainder = Polynomial.mod(paddedData, this.genPoly)\n\n  // return EC data blocks (last n byte, where n is the degree of genPoly)\n  // If coefficients number in remainder are less than genPoly degree,\n  // pad with 0s to the left to reach the needed number of coefficients\n  const start = this.degree - remainder.length\n  if (start > 0) {\n    const buff = new Uint8Array(this.degree)\n    buff.set(remainder, start)\n\n    return buff\n  }\n\n  return remainder\n}\n\nmodule.exports = ReedSolomonEncoder\n","/**\n * Check if QR Code version is valid\n *\n * @param  {Number}  version QR Code version\n * @return {Boolean}         true if valid version, false otherwise\n */\nexports.isValid = function isValid (version) {\n  return !isNaN(version) && version >= 1 && version <= 40\n}\n","const numeric = '[0-9]+'\nconst alphanumeric = '[A-Z $%*+\\\\-./:]+'\nlet kanji = '(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|' +\n  '[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|' +\n  '[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|' +\n  '[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+'\nkanji = kanji.replace(/u/g, '\\\\u')\n\nconst byte = '(?:(?![A-Z0-9 $%*+\\\\-./:]|' + kanji + ')(?:.|[\\r\\n]))+'\n\nexports.KANJI = new RegExp(kanji, 'g')\nexports.BYTE_KANJI = new RegExp('[^A-Z0-9 $%*+\\\\-./:]+', 'g')\nexports.BYTE = new RegExp(byte, 'g')\nexports.NUMERIC = new RegExp(numeric, 'g')\nexports.ALPHANUMERIC = new RegExp(alphanumeric, 'g')\n\nconst TEST_KANJI = new RegExp('^' + kanji + '$')\nconst TEST_NUMERIC = new RegExp('^' + numeric + '$')\nconst TEST_ALPHANUMERIC = new RegExp('^[A-Z0-9 $%*+\\\\-./:]+$')\n\nexports.testKanji = function testKanji (str) {\n  return TEST_KANJI.test(str)\n}\n\nexports.testNumeric = function testNumeric (str) {\n  return TEST_NUMERIC.test(str)\n}\n\nexports.testAlphanumeric = function testAlphanumeric (str) {\n  return TEST_ALPHANUMERIC.test(str)\n}\n","const VersionCheck = require('./version-check')\nconst Regex = require('./regex')\n\n/**\n * Numeric mode encodes data from the decimal digit set (0 - 9)\n * (byte values 30HEX to 39HEX).\n * Normally, 3 data characters are represented by 10 bits.\n *\n * @type {Object}\n */\nexports.NUMERIC = {\n  id: 'Numeric',\n  bit: 1 << 0,\n  ccBits: [10, 12, 14]\n}\n\n/**\n * Alphanumeric mode encodes data from a set of 45 characters,\n * i.e. 10 numeric digits (0 - 9),\n *      26 alphabetic characters (A - Z),\n *   and 9 symbols (SP, $, %, *, +, -, ., /, :).\n * Normally, two input characters are represented by 11 bits.\n *\n * @type {Object}\n */\nexports.ALPHANUMERIC = {\n  id: 'Alphanumeric',\n  bit: 1 << 1,\n  ccBits: [9, 11, 13]\n}\n\n/**\n * In byte mode, data is encoded at 8 bits per character.\n *\n * @type {Object}\n */\nexports.BYTE = {\n  id: 'Byte',\n  bit: 1 << 2,\n  ccBits: [8, 16, 16]\n}\n\n/**\n * The Kanji mode efficiently encodes Kanji characters in accordance with\n * the Shift JIS system based on JIS X 0208.\n * The Shift JIS values are shifted from the JIS X 0208 values.\n * JIS X 0208 gives details of the shift coded representation.\n * Each two-byte character value is compacted to a 13-bit binary codeword.\n *\n * @type {Object}\n */\nexports.KANJI = {\n  id: 'Kanji',\n  bit: 1 << 3,\n  ccBits: [8, 10, 12]\n}\n\n/**\n * Mixed mode will contain a sequences of data in a combination of any of\n * the modes described above\n *\n * @type {Object}\n */\nexports.MIXED = {\n  bit: -1\n}\n\n/**\n * Returns the number of bits needed to store the data length\n * according to QR Code specifications.\n *\n * @param  {Mode}   mode    Data mode\n * @param  {Number} version QR Code version\n * @return {Number}         Number of bits\n */\nexports.getCharCountIndicator = function getCharCountIndicator (mode, version) {\n  if (!mode.ccBits) throw new Error('Invalid mode: ' + mode)\n\n  if (!VersionCheck.isValid(version)) {\n    throw new Error('Invalid version: ' + version)\n  }\n\n  if (version >= 1 && version < 10) return mode.ccBits[0]\n  else if (version < 27) return mode.ccBits[1]\n  return mode.ccBits[2]\n}\n\n/**\n * Returns the most efficient mode to store the specified data\n *\n * @param  {String} dataStr Input data string\n * @return {Mode}           Best mode\n */\nexports.getBestModeForData = function getBestModeForData (dataStr) {\n  if (Regex.testNumeric(dataStr)) return exports.NUMERIC\n  else if (Regex.testAlphanumeric(dataStr)) return exports.ALPHANUMERIC\n  else if (Regex.testKanji(dataStr)) return exports.KANJI\n  else return exports.BYTE\n}\n\n/**\n * Return mode name as string\n *\n * @param {Mode} mode Mode object\n * @returns {String}  Mode name\n */\nexports.toString = function toString (mode) {\n  if (mode && mode.id) return mode.id\n  throw new Error('Invalid mode')\n}\n\n/**\n * Check if input param is a valid mode object\n *\n * @param   {Mode}    mode Mode object\n * @returns {Boolean} True if valid mode, false otherwise\n */\nexports.isValid = function isValid (mode) {\n  return mode && mode.bit && mode.ccBits\n}\n\n/**\n * Get mode object from its name\n *\n * @param   {String} string Mode name\n * @returns {Mode}          Mode object\n */\nfunction fromString (string) {\n  if (typeof string !== 'string') {\n    throw new Error('Param is not a string')\n  }\n\n  const lcStr = string.toLowerCase()\n\n  switch (lcStr) {\n    case 'numeric':\n      return exports.NUMERIC\n    case 'alphanumeric':\n      return exports.ALPHANUMERIC\n    case 'kanji':\n      return exports.KANJI\n    case 'byte':\n      return exports.BYTE\n    default:\n      throw new Error('Unknown mode: ' + string)\n  }\n}\n\n/**\n * Returns mode from a value.\n * If value is not a valid mode, returns defaultValue\n *\n * @param  {Mode|String} value        Encoding mode\n * @param  {Mode}        defaultValue Fallback value\n * @return {Mode}                     Encoding mode\n */\nexports.from = function from (value, defaultValue) {\n  if (exports.isValid(value)) {\n    return value\n  }\n\n  try {\n    return fromString(value)\n  } catch (e) {\n    return defaultValue\n  }\n}\n","const Utils = require('./utils')\nconst ECCode = require('./error-correction-code')\nconst ECLevel = require('./error-correction-level')\nconst Mode = require('./mode')\nconst VersionCheck = require('./version-check')\n\n// Generator polynomial used to encode version information\nconst G18 = (1 << 12) | (1 << 11) | (1 << 10) | (1 << 9) | (1 << 8) | (1 << 5) | (1 << 2) | (1 << 0)\nconst G18_BCH = Utils.getBCHDigit(G18)\n\nfunction getBestVersionForDataLength (mode, length, errorCorrectionLevel) {\n  for (let currentVersion = 1; currentVersion <= 40; currentVersion++) {\n    if (length <= exports.getCapacity(currentVersion, errorCorrectionLevel, mode)) {\n      return currentVersion\n    }\n  }\n\n  return undefined\n}\n\nfunction getReservedBitsCount (mode, version) {\n  // Character count indicator + mode indicator bits\n  return Mode.getCharCountIndicator(mode, version) + 4\n}\n\nfunction getTotalBitsFromDataArray (segments, version) {\n  let totalBits = 0\n\n  segments.forEach(function (data) {\n    const reservedBits = getReservedBitsCount(data.mode, version)\n    totalBits += reservedBits + data.getBitsLength()\n  })\n\n  return totalBits\n}\n\nfunction getBestVersionForMixedData (segments, errorCorrectionLevel) {\n  for (let currentVersion = 1; currentVersion <= 40; currentVersion++) {\n    const length = getTotalBitsFromDataArray(segments, currentVersion)\n    if (length <= exports.getCapacity(currentVersion, errorCorrectionLevel, Mode.MIXED)) {\n      return currentVersion\n    }\n  }\n\n  return undefined\n}\n\n/**\n * Returns version number from a value.\n * If value is not a valid version, returns defaultValue\n *\n * @param  {Number|String} value        QR Code version\n * @param  {Number}        defaultValue Fallback value\n * @return {Number}                     QR Code version number\n */\nexports.from = function from (value, defaultValue) {\n  if (VersionCheck.isValid(value)) {\n    return parseInt(value, 10)\n  }\n\n  return defaultValue\n}\n\n/**\n * Returns how much data can be stored with the specified QR code version\n * and error correction level\n *\n * @param  {Number} version              QR Code version (1-40)\n * @param  {Number} errorCorrectionLevel Error correction level\n * @param  {Mode}   mode                 Data mode\n * @return {Number}                      Quantity of storable data\n */\nexports.getCapacity = function getCapacity (version, errorCorrectionLevel, mode) {\n  if (!VersionCheck.isValid(version)) {\n    throw new Error('Invalid QR Code version')\n  }\n\n  // Use Byte mode as default\n  if (typeof mode === 'undefined') mode = Mode.BYTE\n\n  // Total codewords for this QR code version (Data + Error correction)\n  const totalCodewords = Utils.getSymbolTotalCodewords(version)\n\n  // Total number of error correction codewords\n  const ecTotalCodewords = ECCode.getTotalCodewordsCount(version, errorCorrectionLevel)\n\n  // Total number of data codewords\n  const dataTotalCodewordsBits = (totalCodewords - ecTotalCodewords) * 8\n\n  if (mode === Mode.MIXED) return dataTotalCodewordsBits\n\n  const usableBits = dataTotalCodewordsBits - getReservedBitsCount(mode, version)\n\n  // Return max number of storable codewords\n  switch (mode) {\n    case Mode.NUMERIC:\n      return Math.floor((usableBits / 10) * 3)\n\n    case Mode.ALPHANUMERIC:\n      return Math.floor((usableBits / 11) * 2)\n\n    case Mode.KANJI:\n      return Math.floor(usableBits / 13)\n\n    case Mode.BYTE:\n    default:\n      return Math.floor(usableBits / 8)\n  }\n}\n\n/**\n * Returns the minimum version needed to contain the amount of data\n *\n * @param  {Segment} data                    Segment of data\n * @param  {Number} [errorCorrectionLevel=H] Error correction level\n * @param  {Mode} mode                       Data mode\n * @return {Number}                          QR Code version\n */\nexports.getBestVersionForData = function getBestVersionForData (data, errorCorrectionLevel) {\n  let seg\n\n  const ecl = ECLevel.from(errorCorrectionLevel, ECLevel.M)\n\n  if (Array.isArray(data)) {\n    if (data.length > 1) {\n      return getBestVersionForMixedData(data, ecl)\n    }\n\n    if (data.length === 0) {\n      return 1\n    }\n\n    seg = data[0]\n  } else {\n    seg = data\n  }\n\n  return getBestVersionForDataLength(seg.mode, seg.getLength(), ecl)\n}\n\n/**\n * Returns version information with relative error correction bits\n *\n * The version information is included in QR Code symbols of version 7 or larger.\n * It consists of an 18-bit sequence containing 6 data bits,\n * with 12 error correction bits calculated using the (18, 6) Golay code.\n *\n * @param  {Number} version QR Code version\n * @return {Number}         Encoded version info bits\n */\nexports.getEncodedBits = function getEncodedBits (version) {\n  if (!VersionCheck.isValid(version) || version < 7) {\n    throw new Error('Invalid QR Code version')\n  }\n\n  let d = version << 12\n\n  while (Utils.getBCHDigit(d) - G18_BCH >= 0) {\n    d ^= (G18 << (Utils.getBCHDigit(d) - G18_BCH))\n  }\n\n  return (version << 12) | d\n}\n","const Utils = require('./utils')\n\nconst G15 = (1 << 10) | (1 << 8) | (1 << 5) | (1 << 4) | (1 << 2) | (1 << 1) | (1 << 0)\nconst G15_MASK = (1 << 14) | (1 << 12) | (1 << 10) | (1 << 4) | (1 << 1)\nconst G15_BCH = Utils.getBCHDigit(G15)\n\n/**\n * Returns format information with relative error correction bits\n *\n * The format information is a 15-bit sequence containing 5 data bits,\n * with 10 error correction bits calculated using the (15, 5) BCH code.\n *\n * @param  {Number} errorCorrectionLevel Error correction level\n * @param  {Number} mask                 Mask pattern\n * @return {Number}                      Encoded format information bits\n */\nexports.getEncodedBits = function getEncodedBits (errorCorrectionLevel, mask) {\n  const data = ((errorCorrectionLevel.bit << 3) | mask)\n  let d = data << 10\n\n  while (Utils.getBCHDigit(d) - G15_BCH >= 0) {\n    d ^= (G15 << (Utils.getBCHDigit(d) - G15_BCH))\n  }\n\n  // xor final data with mask pattern in order to ensure that\n  // no combination of Error Correction Level and data mask pattern\n  // will result in an all-zero data string\n  return ((data << 10) | d) ^ G15_MASK\n}\n","const Mode = require('./mode')\n\nfunction NumericData (data) {\n  this.mode = Mode.NUMERIC\n  this.data = data.toString()\n}\n\nNumericData.getBitsLength = function getBitsLength (length) {\n  return 10 * Math.floor(length / 3) + ((length % 3) ? ((length % 3) * 3 + 1) : 0)\n}\n\nNumericData.prototype.getLength = function getLength () {\n  return this.data.length\n}\n\nNumericData.prototype.getBitsLength = function getBitsLength () {\n  return NumericData.getBitsLength(this.data.length)\n}\n\nNumericData.prototype.write = function write (bitBuffer) {\n  let i, group, value\n\n  // The input data string is divided into groups of three digits,\n  // and each group is converted to its 10-bit binary equivalent.\n  for (i = 0; i + 3 <= this.data.length; i += 3) {\n    group = this.data.substr(i, 3)\n    value = parseInt(group, 10)\n\n    bitBuffer.put(value, 10)\n  }\n\n  // If the number of input digits is not an exact multiple of three,\n  // the final one or two digits are converted to 4 or 7 bits respectively.\n  const remainingNum = this.data.length - i\n  if (remainingNum > 0) {\n    group = this.data.substr(i)\n    value = parseInt(group, 10)\n\n    bitBuffer.put(value, remainingNum * 3 + 1)\n  }\n}\n\nmodule.exports = NumericData\n","const Mode = require('./mode')\n\n/**\n * Array of characters available in alphanumeric mode\n *\n * As per QR Code specification, to each character\n * is assigned a value from 0 to 44 which in this case coincides\n * with the array index\n *\n * @type {Array}\n */\nconst ALPHA_NUM_CHARS = [\n  '0', '1', '2', '3', '4', '5', '6', '7', '8', '9',\n  'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M',\n  'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z',\n  ' ', '$', '%', '*', '+', '-', '.', '/', ':'\n]\n\nfunction AlphanumericData (data) {\n  this.mode = Mode.ALPHANUMERIC\n  this.data = data\n}\n\nAlphanumericData.getBitsLength = function getBitsLength (length) {\n  return 11 * Math.floor(length / 2) + 6 * (length % 2)\n}\n\nAlphanumericData.prototype.getLength = function getLength () {\n  return this.data.length\n}\n\nAlphanumericData.prototype.getBitsLength = function getBitsLength () {\n  return AlphanumericData.getBitsLength(this.data.length)\n}\n\nAlphanumericData.prototype.write = function write (bitBuffer) {\n  let i\n\n  // Input data characters are divided into groups of two characters\n  // and encoded as 11-bit binary codes.\n  for (i = 0; i + 2 <= this.data.length; i += 2) {\n    // The character value of the first character is multiplied by 45\n    let value = ALPHA_NUM_CHARS.indexOf(this.data[i]) * 45\n\n    // The character value of the second digit is added to the product\n    value += ALPHA_NUM_CHARS.indexOf(this.data[i + 1])\n\n    // The sum is then stored as 11-bit binary number\n    bitBuffer.put(value, 11)\n  }\n\n  // If the number of input data characters is not a multiple of two,\n  // the character value of the final character is encoded as a 6-bit binary number.\n  if (this.data.length % 2) {\n    bitBuffer.put(ALPHA_NUM_CHARS.indexOf(this.data[i]), 6)\n  }\n}\n\nmodule.exports = AlphanumericData\n","const Mode = require('./mode')\n\nfunction ByteData (data) {\n  this.mode = Mode.BYTE\n  if (typeof (data) === 'string') {\n    this.data = new TextEncoder().encode(data)\n  } else {\n    this.data = new Uint8Array(data)\n  }\n}\n\nByteData.getBitsLength = function getBitsLength (length) {\n  return length * 8\n}\n\nByteData.prototype.getLength = function getLength () {\n  return this.data.length\n}\n\nByteData.prototype.getBitsLength = function getBitsLength () {\n  return ByteData.getBitsLength(this.data.length)\n}\n\nByteData.prototype.write = function (bitBuffer) {\n  for (let i = 0, l = this.data.length; i < l; i++) {\n    bitBuffer.put(this.data[i], 8)\n  }\n}\n\nmodule.exports = ByteData\n","const Mode = require('./mode')\nconst Utils = require('./utils')\n\nfunction KanjiData (data) {\n  this.mode = Mode.KANJI\n  this.data = data\n}\n\nKanjiData.getBitsLength = function getBitsLength (length) {\n  return length * 13\n}\n\nKanjiData.prototype.getLength = function getLength () {\n  return this.data.length\n}\n\nKanjiData.prototype.getBitsLength = function getBitsLength () {\n  return KanjiData.getBitsLength(this.data.length)\n}\n\nKanjiData.prototype.write = function (bitBuffer) {\n  let i\n\n  // In the Shift JIS system, Kanji characters are represented by a two byte combination.\n  // These byte values are shifted from the JIS X 0208 values.\n  // JIS X 0208 gives details of the shift coded representation.\n  for (i = 0; i < this.data.length; i++) {\n    let value = Utils.toSJIS(this.data[i])\n\n    // For characters with Shift JIS values from 0x8140 to 0x9FFC:\n    if (value >= 0x8140 && value <= 0x9FFC) {\n      // Subtract 0x8140 from Shift JIS value\n      value -= 0x8140\n\n    // For characters with Shift JIS values from 0xE040 to 0xEBBF\n    } else if (value >= 0xE040 && value <= 0xEBBF) {\n      // Subtract 0xC140 from Shift JIS value\n      value -= 0xC140\n    } else {\n      throw new Error(\n        'Invalid SJIS character: ' + this.data[i] + '\\n' +\n        'Make sure your charset is UTF-8')\n    }\n\n    // Multiply most significant byte of result by 0xC0\n    // and add least significant byte to product\n    value = (((value >>> 8) & 0xff) * 0xC0) + (value & 0xff)\n\n    // Convert result to a 13-bit binary string\n    bitBuffer.put(value, 13)\n  }\n}\n\nmodule.exports = KanjiData\n","'use strict';\n\n/******************************************************************************\n * Created 2008-08-19.\n *\n * Dijkstra path-finding functions. Adapted from the Dijkstar Python project.\n *\n * Copyright (C) 2008\n *   Wyatt Baldwin <self@wyattbaldwin.com>\n *   All rights reserved\n *\n * Licensed under the MIT license.\n *\n *   http://www.opensource.org/licenses/mit-license.php\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *****************************************************************************/\nvar dijkstra = {\n  single_source_shortest_paths: function(graph, s, d) {\n    // Predecessor map for each node that has been encountered.\n    // node ID => predecessor node ID\n    var predecessors = {};\n\n    // Costs of shortest paths from s to all nodes encountered.\n    // node ID => cost\n    var costs = {};\n    costs[s] = 0;\n\n    // Costs of shortest paths from s to all nodes encountered; differs from\n    // `costs` in that it provides easy access to the node that currently has\n    // the known shortest path from s.\n    // XXX: Do we actually need both `costs` and `open`?\n    var open = dijkstra.PriorityQueue.make();\n    open.push(s, 0);\n\n    var closest,\n        u, v,\n        cost_of_s_to_u,\n        adjacent_nodes,\n        cost_of_e,\n        cost_of_s_to_u_plus_cost_of_e,\n        cost_of_s_to_v,\n        first_visit;\n    while (!open.empty()) {\n      // In the nodes remaining in graph that have a known cost from s,\n      // find the node, u, that currently has the shortest path from s.\n      closest = open.pop();\n      u = closest.value;\n      cost_of_s_to_u = closest.cost;\n\n      // Get nodes adjacent to u...\n      adjacent_nodes = graph[u] || {};\n\n      // ...and explore the edges that connect u to those nodes, updating\n      // the cost of the shortest paths to any or all of those nodes as\n      // necessary. v is the node across the current edge from u.\n      for (v in adjacent_nodes) {\n        if (adjacent_nodes.hasOwnProperty(v)) {\n          // Get the cost of the edge running from u to v.\n          cost_of_e = adjacent_nodes[v];\n\n          // Cost of s to u plus the cost of u to v across e--this is *a*\n          // cost from s to v that may or may not be less than the current\n          // known cost to v.\n          cost_of_s_to_u_plus_cost_of_e = cost_of_s_to_u + cost_of_e;\n\n          // If we haven't visited v yet OR if the current known cost from s to\n          // v is greater than the new cost we just found (cost of s to u plus\n          // cost of u to v across e), update v's cost in the cost list and\n          // update v's predecessor in the predecessor list (it's now u).\n          cost_of_s_to_v = costs[v];\n          first_visit = (typeof costs[v] === 'undefined');\n          if (first_visit || cost_of_s_to_v > cost_of_s_to_u_plus_cost_of_e) {\n            costs[v] = cost_of_s_to_u_plus_cost_of_e;\n            open.push(v, cost_of_s_to_u_plus_cost_of_e);\n            predecessors[v] = u;\n          }\n        }\n      }\n    }\n\n    if (typeof d !== 'undefined' && typeof costs[d] === 'undefined') {\n      var msg = ['Could not find a path from ', s, ' to ', d, '.'].join('');\n      throw new Error(msg);\n    }\n\n    return predecessors;\n  },\n\n  extract_shortest_path_from_predecessor_list: function(predecessors, d) {\n    var nodes = [];\n    var u = d;\n    var predecessor;\n    while (u) {\n      nodes.push(u);\n      predecessor = predecessors[u];\n      u = predecessors[u];\n    }\n    nodes.reverse();\n    return nodes;\n  },\n\n  find_path: function(graph, s, d) {\n    var predecessors = dijkstra.single_source_shortest_paths(graph, s, d);\n    return dijkstra.extract_shortest_path_from_predecessor_list(\n      predecessors, d);\n  },\n\n  /**\n   * A very naive priority queue implementation.\n   */\n  PriorityQueue: {\n    make: function (opts) {\n      var T = dijkstra.PriorityQueue,\n          t = {},\n          key;\n      opts = opts || {};\n      for (key in T) {\n        if (T.hasOwnProperty(key)) {\n          t[key] = T[key];\n        }\n      }\n      t.queue = [];\n      t.sorter = opts.sorter || T.default_sorter;\n      return t;\n    },\n\n    default_sorter: function (a, b) {\n      return a.cost - b.cost;\n    },\n\n    /**\n     * Add a new item to the queue and ensure the highest priority element\n     * is at the front of the queue.\n     */\n    push: function (value, cost) {\n      var item = {value: value, cost: cost};\n      this.queue.push(item);\n      this.queue.sort(this.sorter);\n    },\n\n    /**\n     * Return the highest priority element in the queue.\n     */\n    pop: function () {\n      return this.queue.shift();\n    },\n\n    empty: function () {\n      return this.queue.length === 0;\n    }\n  }\n};\n\n\n// node.js module exports\nif (typeof module !== 'undefined') {\n  module.exports = dijkstra;\n}\n","const Mode = require('./mode')\nconst NumericData = require('./numeric-data')\nconst AlphanumericData = require('./alphanumeric-data')\nconst ByteData = require('./byte-data')\nconst KanjiData = require('./kanji-data')\nconst Regex = require('./regex')\nconst Utils = require('./utils')\nconst dijkstra = require('dijkstrajs')\n\n/**\n * Returns UTF8 byte length\n *\n * @param  {String} str Input string\n * @return {Number}     Number of byte\n */\nfunction getStringByteLength (str) {\n  return unescape(encodeURIComponent(str)).length\n}\n\n/**\n * Get a list of segments of the specified mode\n * from a string\n *\n * @param  {Mode}   mode Segment mode\n * @param  {String} str  String to process\n * @return {Array}       Array of object with segments data\n */\nfunction getSegments (regex, mode, str) {\n  const segments = []\n  let result\n\n  while ((result = regex.exec(str)) !== null) {\n    segments.push({\n      data: result[0],\n      index: result.index,\n      mode: mode,\n      length: result[0].length\n    })\n  }\n\n  return segments\n}\n\n/**\n * Extracts a series of segments with the appropriate\n * modes from a string\n *\n * @param  {String} dataStr Input string\n * @return {Array}          Array of object with segments data\n */\nfunction getSegmentsFromString (dataStr) {\n  const numSegs = getSegments(Regex.NUMERIC, Mode.NUMERIC, dataStr)\n  const alphaNumSegs = getSegments(Regex.ALPHANUMERIC, Mode.ALPHANUMERIC, dataStr)\n  let byteSegs\n  let kanjiSegs\n\n  if (Utils.isKanjiModeEnabled()) {\n    byteSegs = getSegments(Regex.BYTE, Mode.BYTE, dataStr)\n    kanjiSegs = getSegments(Regex.KANJI, Mode.KANJI, dataStr)\n  } else {\n    byteSegs = getSegments(Regex.BYTE_KANJI, Mode.BYTE, dataStr)\n    kanjiSegs = []\n  }\n\n  const segs = numSegs.concat(alphaNumSegs, byteSegs, kanjiSegs)\n\n  return segs\n    .sort(function (s1, s2) {\n      return s1.index - s2.index\n    })\n    .map(function (obj) {\n      return {\n        data: obj.data,\n        mode: obj.mode,\n        length: obj.length\n      }\n    })\n}\n\n/**\n * Returns how many bits are needed to encode a string of\n * specified length with the specified mode\n *\n * @param  {Number} length String length\n * @param  {Mode} mode     Segment mode\n * @return {Number}        Bit length\n */\nfunction getSegmentBitsLength (length, mode) {\n  switch (mode) {\n    case Mode.NUMERIC:\n      return NumericData.getBitsLength(length)\n    case Mode.ALPHANUMERIC:\n      return AlphanumericData.getBitsLength(length)\n    case Mode.KANJI:\n      return KanjiData.getBitsLength(length)\n    case Mode.BYTE:\n      return ByteData.getBitsLength(length)\n  }\n}\n\n/**\n * Merges adjacent segments which have the same mode\n *\n * @param  {Array} segs Array of object with segments data\n * @return {Array}      Array of object with segments data\n */\nfunction mergeSegments (segs) {\n  return segs.reduce(function (acc, curr) {\n    const prevSeg = acc.length - 1 >= 0 ? acc[acc.length - 1] : null\n    if (prevSeg && prevSeg.mode === curr.mode) {\n      acc[acc.length - 1].data += curr.data\n      return acc\n    }\n\n    acc.push(curr)\n    return acc\n  }, [])\n}\n\n/**\n * Generates a list of all possible nodes combination which\n * will be used to build a segments graph.\n *\n * Nodes are divided by groups. Each group will contain a list of all the modes\n * in which is possible to encode the given text.\n *\n * For example the text '12345' can be encoded as Numeric, Alphanumeric or Byte.\n * The group for '12345' will contain then 3 objects, one for each\n * possible encoding mode.\n *\n * Each node represents a possible segment.\n *\n * @param  {Array} segs Array of object with segments data\n * @return {Array}      Array of object with segments data\n */\nfunction buildNodes (segs) {\n  const nodes = []\n  for (let i = 0; i < segs.length; i++) {\n    const seg = segs[i]\n\n    switch (seg.mode) {\n      case Mode.NUMERIC:\n        nodes.push([seg,\n          { data: seg.data, mode: Mode.ALPHANUMERIC, length: seg.length },\n          { data: seg.data, mode: Mode.BYTE, length: seg.length }\n        ])\n        break\n      case Mode.ALPHANUMERIC:\n        nodes.push([seg,\n          { data: seg.data, mode: Mode.BYTE, length: seg.length }\n        ])\n        break\n      case Mode.KANJI:\n        nodes.push([seg,\n          { data: seg.data, mode: Mode.BYTE, length: getStringByteLength(seg.data) }\n        ])\n        break\n      case Mode.BYTE:\n        nodes.push([\n          { data: seg.data, mode: Mode.BYTE, length: getStringByteLength(seg.data) }\n        ])\n    }\n  }\n\n  return nodes\n}\n\n/**\n * Builds a graph from a list of nodes.\n * All segments in each node group will be connected with all the segments of\n * the next group and so on.\n *\n * At each connection will be assigned a weight depending on the\n * segment's byte length.\n *\n * @param  {Array} nodes    Array of object with segments data\n * @param  {Number} version QR Code version\n * @return {Object}         Graph of all possible segments\n */\nfunction buildGraph (nodes, version) {\n  const table = {}\n  const graph = { start: {} }\n  let prevNodeIds = ['start']\n\n  for (let i = 0; i < nodes.length; i++) {\n    const nodeGroup = nodes[i]\n    const currentNodeIds = []\n\n    for (let j = 0; j < nodeGroup.length; j++) {\n      const node = nodeGroup[j]\n      const key = '' + i + j\n\n      currentNodeIds.push(key)\n      table[key] = { node: node, lastCount: 0 }\n      graph[key] = {}\n\n      for (let n = 0; n < prevNodeIds.length; n++) {\n        const prevNodeId = prevNodeIds[n]\n\n        if (table[prevNodeId] && table[prevNodeId].node.mode === node.mode) {\n          graph[prevNodeId][key] =\n            getSegmentBitsLength(table[prevNodeId].lastCount + node.length, node.mode) -\n            getSegmentBitsLength(table[prevNodeId].lastCount, node.mode)\n\n          table[prevNodeId].lastCount += node.length\n        } else {\n          if (table[prevNodeId]) table[prevNodeId].lastCount = node.length\n\n          graph[prevNodeId][key] = getSegmentBitsLength(node.length, node.mode) +\n            4 + Mode.getCharCountIndicator(node.mode, version) // switch cost\n        }\n      }\n    }\n\n    prevNodeIds = currentNodeIds\n  }\n\n  for (let n = 0; n < prevNodeIds.length; n++) {\n    graph[prevNodeIds[n]].end = 0\n  }\n\n  return { map: graph, table: table }\n}\n\n/**\n * Builds a segment from a specified data and mode.\n * If a mode is not specified, the more suitable will be used.\n *\n * @param  {String} data             Input data\n * @param  {Mode | String} modesHint Data mode\n * @return {Segment}                 Segment\n */\nfunction buildSingleSegment (data, modesHint) {\n  let mode\n  const bestMode = Mode.getBestModeForData(data)\n\n  mode = Mode.from(modesHint, bestMode)\n\n  // Make sure data can be encoded\n  if (mode !== Mode.BYTE && mode.bit < bestMode.bit) {\n    throw new Error('\"' + data + '\"' +\n      ' cannot be encoded with mode ' + Mode.toString(mode) +\n      '.\\n Suggested mode is: ' + Mode.toString(bestMode))\n  }\n\n  // Use Mode.BYTE if Kanji support is disabled\n  if (mode === Mode.KANJI && !Utils.isKanjiModeEnabled()) {\n    mode = Mode.BYTE\n  }\n\n  switch (mode) {\n    case Mode.NUMERIC:\n      return new NumericData(data)\n\n    case Mode.ALPHANUMERIC:\n      return new AlphanumericData(data)\n\n    case Mode.KANJI:\n      return new KanjiData(data)\n\n    case Mode.BYTE:\n      return new ByteData(data)\n  }\n}\n\n/**\n * Builds a list of segments from an array.\n * Array can contain Strings or Objects with segment's info.\n *\n * For each item which is a string, will be generated a segment with the given\n * string and the more appropriate encoding mode.\n *\n * For each item which is an object, will be generated a segment with the given\n * data and mode.\n * Objects must contain at least the property \"data\".\n * If property \"mode\" is not present, the more suitable mode will be used.\n *\n * @param  {Array} array Array of objects with segments data\n * @return {Array}       Array of Segments\n */\nexports.fromArray = function fromArray (array) {\n  return array.reduce(function (acc, seg) {\n    if (typeof seg === 'string') {\n      acc.push(buildSingleSegment(seg, null))\n    } else if (seg.data) {\n      acc.push(buildSingleSegment(seg.data, seg.mode))\n    }\n\n    return acc\n  }, [])\n}\n\n/**\n * Builds an optimized sequence of segments from a string,\n * which will produce the shortest possible bitstream.\n *\n * @param  {String} data    Input string\n * @param  {Number} version QR Code version\n * @return {Array}          Array of segments\n */\nexports.fromString = function fromString (data, version) {\n  const segs = getSegmentsFromString(data, Utils.isKanjiModeEnabled())\n\n  const nodes = buildNodes(segs)\n  const graph = buildGraph(nodes, version)\n  const path = dijkstra.find_path(graph.map, 'start', 'end')\n\n  const optimizedSegs = []\n  for (let i = 1; i < path.length - 1; i++) {\n    optimizedSegs.push(graph.table[path[i]].node)\n  }\n\n  return exports.fromArray(mergeSegments(optimizedSegs))\n}\n\n/**\n * Splits a string in various segments with the modes which\n * best represent their content.\n * The produced segments are far from being optimized.\n * The output of this function is only used to estimate a QR Code version\n * which may contain the data.\n *\n * @param  {string} data Input string\n * @return {Array}       Array of segments\n */\nexports.rawSplit = function rawSplit (data) {\n  return exports.fromArray(\n    getSegmentsFromString(data, Utils.isKanjiModeEnabled())\n  )\n}\n","const Utils = require('./utils')\nconst ECLevel = require('./error-correction-level')\nconst BitBuffer = require('./bit-buffer')\nconst BitMatrix = require('./bit-matrix')\nconst AlignmentPattern = require('./alignment-pattern')\nconst FinderPattern = require('./finder-pattern')\nconst MaskPattern = require('./mask-pattern')\nconst ECCode = require('./error-correction-code')\nconst ReedSolomonEncoder = require('./reed-solomon-encoder')\nconst Version = require('./version')\nconst FormatInfo = require('./format-info')\nconst Mode = require('./mode')\nconst Segments = require('./segments')\n\n/**\n * QRCode for JavaScript\n *\n * modified by Ryan Day for nodejs support\n * Copyright (c) 2011 Ryan Day\n *\n * Licensed under the MIT license:\n *   http://www.opensource.org/licenses/mit-license.php\n *\n//---------------------------------------------------------------------\n// QRCode for JavaScript\n//\n// Copyright (c) 2009 Kazuhiko Arase\n//\n// URL: http://www.d-project.com/\n//\n// Licensed under the MIT license:\n//   http://www.opensource.org/licenses/mit-license.php\n//\n// The word \"QR Code\" is registered trademark of\n// DENSO WAVE INCORPORATED\n//   http://www.denso-wave.com/qrcode/faqpatent-e.html\n//\n//---------------------------------------------------------------------\n*/\n\n/**\n * Add finder patterns bits to matrix\n *\n * @param  {BitMatrix} matrix  Modules matrix\n * @param  {Number}    version QR Code version\n */\nfunction setupFinderPattern (matrix, version) {\n  const size = matrix.size\n  const pos = FinderPattern.getPositions(version)\n\n  for (let i = 0; i < pos.length; i++) {\n    const row = pos[i][0]\n    const col = pos[i][1]\n\n    for (let r = -1; r <= 7; r++) {\n      if (row + r <= -1 || size <= row + r) continue\n\n      for (let c = -1; c <= 7; c++) {\n        if (col + c <= -1 || size <= col + c) continue\n\n        if ((r >= 0 && r <= 6 && (c === 0 || c === 6)) ||\n          (c >= 0 && c <= 6 && (r === 0 || r === 6)) ||\n          (r >= 2 && r <= 4 && c >= 2 && c <= 4)) {\n          matrix.set(row + r, col + c, true, true)\n        } else {\n          matrix.set(row + r, col + c, false, true)\n        }\n      }\n    }\n  }\n}\n\n/**\n * Add timing pattern bits to matrix\n *\n * Note: this function must be called before {@link setupAlignmentPattern}\n *\n * @param  {BitMatrix} matrix Modules matrix\n */\nfunction setupTimingPattern (matrix) {\n  const size = matrix.size\n\n  for (let r = 8; r < size - 8; r++) {\n    const value = r % 2 === 0\n    matrix.set(r, 6, value, true)\n    matrix.set(6, r, value, true)\n  }\n}\n\n/**\n * Add alignment patterns bits to matrix\n *\n * Note: this function must be called after {@link setupTimingPattern}\n *\n * @param  {BitMatrix} matrix  Modules matrix\n * @param  {Number}    version QR Code version\n */\nfunction setupAlignmentPattern (matrix, version) {\n  const pos = AlignmentPattern.getPositions(version)\n\n  for (let i = 0; i < pos.length; i++) {\n    const row = pos[i][0]\n    const col = pos[i][1]\n\n    for (let r = -2; r <= 2; r++) {\n      for (let c = -2; c <= 2; c++) {\n        if (r === -2 || r === 2 || c === -2 || c === 2 ||\n          (r === 0 && c === 0)) {\n          matrix.set(row + r, col + c, true, true)\n        } else {\n          matrix.set(row + r, col + c, false, true)\n        }\n      }\n    }\n  }\n}\n\n/**\n * Add version info bits to matrix\n *\n * @param  {BitMatrix} matrix  Modules matrix\n * @param  {Number}    version QR Code version\n */\nfunction setupVersionInfo (matrix, version) {\n  const size = matrix.size\n  const bits = Version.getEncodedBits(version)\n  let row, col, mod\n\n  for (let i = 0; i < 18; i++) {\n    row = Math.floor(i / 3)\n    col = i % 3 + size - 8 - 3\n    mod = ((bits >> i) & 1) === 1\n\n    matrix.set(row, col, mod, true)\n    matrix.set(col, row, mod, true)\n  }\n}\n\n/**\n * Add format info bits to matrix\n *\n * @param  {BitMatrix} matrix               Modules matrix\n * @param  {ErrorCorrectionLevel}    errorCorrectionLevel Error correction level\n * @param  {Number}    maskPattern          Mask pattern reference value\n */\nfunction setupFormatInfo (matrix, errorCorrectionLevel, maskPattern) {\n  const size = matrix.size\n  const bits = FormatInfo.getEncodedBits(errorCorrectionLevel, maskPattern)\n  let i, mod\n\n  for (i = 0; i < 15; i++) {\n    mod = ((bits >> i) & 1) === 1\n\n    // vertical\n    if (i < 6) {\n      matrix.set(i, 8, mod, true)\n    } else if (i < 8) {\n      matrix.set(i + 1, 8, mod, true)\n    } else {\n      matrix.set(size - 15 + i, 8, mod, true)\n    }\n\n    // horizontal\n    if (i < 8) {\n      matrix.set(8, size - i - 1, mod, true)\n    } else if (i < 9) {\n      matrix.set(8, 15 - i - 1 + 1, mod, true)\n    } else {\n      matrix.set(8, 15 - i - 1, mod, true)\n    }\n  }\n\n  // fixed module\n  matrix.set(size - 8, 8, 1, true)\n}\n\n/**\n * Add encoded data bits to matrix\n *\n * @param  {BitMatrix}  matrix Modules matrix\n * @param  {Uint8Array} data   Data codewords\n */\nfunction setupData (matrix, data) {\n  const size = matrix.size\n  let inc = -1\n  let row = size - 1\n  let bitIndex = 7\n  let byteIndex = 0\n\n  for (let col = size - 1; col > 0; col -= 2) {\n    if (col === 6) col--\n\n    while (true) {\n      for (let c = 0; c < 2; c++) {\n        if (!matrix.isReserved(row, col - c)) {\n          let dark = false\n\n          if (byteIndex < data.length) {\n            dark = (((data[byteIndex] >>> bitIndex) & 1) === 1)\n          }\n\n          matrix.set(row, col - c, dark)\n          bitIndex--\n\n          if (bitIndex === -1) {\n            byteIndex++\n            bitIndex = 7\n          }\n        }\n      }\n\n      row += inc\n\n      if (row < 0 || size <= row) {\n        row -= inc\n        inc = -inc\n        break\n      }\n    }\n  }\n}\n\n/**\n * Create encoded codewords from data input\n *\n * @param  {Number}   version              QR Code version\n * @param  {ErrorCorrectionLevel}   errorCorrectionLevel Error correction level\n * @param  {ByteData} data                 Data input\n * @return {Uint8Array}                    Buffer containing encoded codewords\n */\nfunction createData (version, errorCorrectionLevel, segments) {\n  // Prepare data buffer\n  const buffer = new BitBuffer()\n\n  segments.forEach(function (data) {\n    // prefix data with mode indicator (4 bits)\n    buffer.put(data.mode.bit, 4)\n\n    // Prefix data with character count indicator.\n    // The character count indicator is a string of bits that represents the\n    // number of characters that are being encoded.\n    // The character count indicator must be placed after the mode indicator\n    // and must be a certain number of bits long, depending on the QR version\n    // and data mode\n    // @see {@link Mode.getCharCountIndicator}.\n    buffer.put(data.getLength(), Mode.getCharCountIndicator(data.mode, version))\n\n    // add binary data sequence to buffer\n    data.write(buffer)\n  })\n\n  // Calculate required number of bits\n  const totalCodewords = Utils.getSymbolTotalCodewords(version)\n  const ecTotalCodewords = ECCode.getTotalCodewordsCount(version, errorCorrectionLevel)\n  const dataTotalCodewordsBits = (totalCodewords - ecTotalCodewords) * 8\n\n  // Add a terminator.\n  // If the bit string is shorter than the total number of required bits,\n  // a terminator of up to four 0s must be added to the right side of the string.\n  // If the bit string is more than four bits shorter than the required number of bits,\n  // add four 0s to the end.\n  if (buffer.getLengthInBits() + 4 <= dataTotalCodewordsBits) {\n    buffer.put(0, 4)\n  }\n\n  // If the bit string is fewer than four bits shorter, add only the number of 0s that\n  // are needed to reach the required number of bits.\n\n  // After adding the terminator, if the number of bits in the string is not a multiple of 8,\n  // pad the string on the right with 0s to make the string's length a multiple of 8.\n  while (buffer.getLengthInBits() % 8 !== 0) {\n    buffer.putBit(0)\n  }\n\n  // Add pad bytes if the string is still shorter than the total number of required bits.\n  // Extend the buffer to fill the data capacity of the symbol corresponding to\n  // the Version and Error Correction Level by adding the Pad Codewords 11101100 (0xEC)\n  // and 00010001 (0x11) alternately.\n  const remainingByte = (dataTotalCodewordsBits - buffer.getLengthInBits()) / 8\n  for (let i = 0; i < remainingByte; i++) {\n    buffer.put(i % 2 ? 0x11 : 0xEC, 8)\n  }\n\n  return createCodewords(buffer, version, errorCorrectionLevel)\n}\n\n/**\n * Encode input data with Reed-Solomon and return codewords with\n * relative error correction bits\n *\n * @param  {BitBuffer} bitBuffer            Data to encode\n * @param  {Number}    version              QR Code version\n * @param  {ErrorCorrectionLevel} errorCorrectionLevel Error correction level\n * @return {Uint8Array}                     Buffer containing encoded codewords\n */\nfunction createCodewords (bitBuffer, version, errorCorrectionLevel) {\n  // Total codewords for this QR code version (Data + Error correction)\n  const totalCodewords = Utils.getSymbolTotalCodewords(version)\n\n  // Total number of error correction codewords\n  const ecTotalCodewords = ECCode.getTotalCodewordsCount(version, errorCorrectionLevel)\n\n  // Total number of data codewords\n  const dataTotalCodewords = totalCodewords - ecTotalCodewords\n\n  // Total number of blocks\n  const ecTotalBlocks = ECCode.getBlocksCount(version, errorCorrectionLevel)\n\n  // Calculate how many blocks each group should contain\n  const blocksInGroup2 = totalCodewords % ecTotalBlocks\n  const blocksInGroup1 = ecTotalBlocks - blocksInGroup2\n\n  const totalCodewordsInGroup1 = Math.floor(totalCodewords / ecTotalBlocks)\n\n  const dataCodewordsInGroup1 = Math.floor(dataTotalCodewords / ecTotalBlocks)\n  const dataCodewordsInGroup2 = dataCodewordsInGroup1 + 1\n\n  // Number of EC codewords is the same for both groups\n  const ecCount = totalCodewordsInGroup1 - dataCodewordsInGroup1\n\n  // Initialize a Reed-Solomon encoder with a generator polynomial of degree ecCount\n  const rs = new ReedSolomonEncoder(ecCount)\n\n  let offset = 0\n  const dcData = new Array(ecTotalBlocks)\n  const ecData = new Array(ecTotalBlocks)\n  let maxDataSize = 0\n  const buffer = new Uint8Array(bitBuffer.buffer)\n\n  // Divide the buffer into the required number of blocks\n  for (let b = 0; b < ecTotalBlocks; b++) {\n    const dataSize = b < blocksInGroup1 ? dataCodewordsInGroup1 : dataCodewordsInGroup2\n\n    // extract a block of data from buffer\n    dcData[b] = buffer.slice(offset, offset + dataSize)\n\n    // Calculate EC codewords for this data block\n    ecData[b] = rs.encode(dcData[b])\n\n    offset += dataSize\n    maxDataSize = Math.max(maxDataSize, dataSize)\n  }\n\n  // Create final data\n  // Interleave the data and error correction codewords from each block\n  const data = new Uint8Array(totalCodewords)\n  let index = 0\n  let i, r\n\n  // Add data codewords\n  for (i = 0; i < maxDataSize; i++) {\n    for (r = 0; r < ecTotalBlocks; r++) {\n      if (i < dcData[r].length) {\n        data[index++] = dcData[r][i]\n      }\n    }\n  }\n\n  // Apped EC codewords\n  for (i = 0; i < ecCount; i++) {\n    for (r = 0; r < ecTotalBlocks; r++) {\n      data[index++] = ecData[r][i]\n    }\n  }\n\n  return data\n}\n\n/**\n * Build QR Code symbol\n *\n * @param  {String} data                 Input string\n * @param  {Number} version              QR Code version\n * @param  {ErrorCorretionLevel} errorCorrectionLevel Error level\n * @param  {MaskPattern} maskPattern     Mask pattern\n * @return {Object}                      Object containing symbol data\n */\nfunction createSymbol (data, version, errorCorrectionLevel, maskPattern) {\n  let segments\n\n  if (Array.isArray(data)) {\n    segments = Segments.fromArray(data)\n  } else if (typeof data === 'string') {\n    let estimatedVersion = version\n\n    if (!estimatedVersion) {\n      const rawSegments = Segments.rawSplit(data)\n\n      // Estimate best version that can contain raw splitted segments\n      estimatedVersion = Version.getBestVersionForData(rawSegments, errorCorrectionLevel)\n    }\n\n    // Build optimized segments\n    // If estimated version is undefined, try with the highest version\n    segments = Segments.fromString(data, estimatedVersion || 40)\n  } else {\n    throw new Error('Invalid data')\n  }\n\n  // Get the min version that can contain data\n  const bestVersion = Version.getBestVersionForData(segments, errorCorrectionLevel)\n\n  // If no version is found, data cannot be stored\n  if (!bestVersion) {\n    throw new Error('The amount of data is too big to be stored in a QR Code')\n  }\n\n  // If not specified, use min version as default\n  if (!version) {\n    version = bestVersion\n\n  // Check if the specified version can contain the data\n  } else if (version < bestVersion) {\n    throw new Error('\\n' +\n      'The chosen QR Code version cannot contain this amount of data.\\n' +\n      'Minimum version required to store current data is: ' + bestVersion + '.\\n'\n    )\n  }\n\n  const dataBits = createData(version, errorCorrectionLevel, segments)\n\n  // Allocate matrix buffer\n  const moduleCount = Utils.getSymbolSize(version)\n  const modules = new BitMatrix(moduleCount)\n\n  // Add function modules\n  setupFinderPattern(modules, version)\n  setupTimingPattern(modules)\n  setupAlignmentPattern(modules, version)\n\n  // Add temporary dummy bits for format info just to set them as reserved.\n  // This is needed to prevent these bits from being masked by {@link MaskPattern.applyMask}\n  // since the masking operation must be performed only on the encoding region.\n  // These blocks will be replaced with correct values later in code.\n  setupFormatInfo(modules, errorCorrectionLevel, 0)\n\n  if (version >= 7) {\n    setupVersionInfo(modules, version)\n  }\n\n  // Add data codewords\n  setupData(modules, dataBits)\n\n  if (isNaN(maskPattern)) {\n    // Find best mask pattern\n    maskPattern = MaskPattern.getBestMask(modules,\n      setupFormatInfo.bind(null, modules, errorCorrectionLevel))\n  }\n\n  // Apply mask pattern\n  MaskPattern.applyMask(maskPattern, modules)\n\n  // Replace format info bits with correct values\n  setupFormatInfo(modules, errorCorrectionLevel, maskPattern)\n\n  return {\n    modules: modules,\n    version: version,\n    errorCorrectionLevel: errorCorrectionLevel,\n    maskPattern: maskPattern,\n    segments: segments\n  }\n}\n\n/**\n * QR Code\n *\n * @param {String | Array} data                 Input data\n * @param {Object} options                      Optional configurations\n * @param {Number} options.version              QR Code version\n * @param {String} options.errorCorrectionLevel Error correction level\n * @param {Function} options.toSJISFunc         Helper func to convert utf8 to sjis\n */\nexports.create = function create (data, options) {\n  if (typeof data === 'undefined' || data === '') {\n    throw new Error('No input text')\n  }\n\n  let errorCorrectionLevel = ECLevel.M\n  let version\n  let mask\n\n  if (typeof options !== 'undefined') {\n    // Use higher error correction level as default\n    errorCorrectionLevel = ECLevel.from(options.errorCorrectionLevel, ECLevel.M)\n    version = Version.from(options.version)\n    mask = MaskPattern.from(options.maskPattern)\n\n    if (options.toSJISFunc) {\n      Utils.setToSJISFunction(options.toSJISFunc)\n    }\n  }\n\n  return createSymbol(data, version, errorCorrectionLevel, mask)\n}\n","function hex2rgba (hex) {\n  if (typeof hex === 'number') {\n    hex = hex.toString()\n  }\n\n  if (typeof hex !== 'string') {\n    throw new Error('Color should be defined as hex string')\n  }\n\n  let hexCode = hex.slice().replace('#', '').split('')\n  if (hexCode.length < 3 || hexCode.length === 5 || hexCode.length > 8) {\n    throw new Error('Invalid hex color: ' + hex)\n  }\n\n  // Convert from short to long form (fff -> ffffff)\n  if (hexCode.length === 3 || hexCode.length === 4) {\n    hexCode = Array.prototype.concat.apply([], hexCode.map(function (c) {\n      return [c, c]\n    }))\n  }\n\n  // Add default alpha value\n  if (hexCode.length === 6) hexCode.push('F', 'F')\n\n  const hexValue = parseInt(hexCode.join(''), 16)\n\n  return {\n    r: (hexValue >> 24) & 255,\n    g: (hexValue >> 16) & 255,\n    b: (hexValue >> 8) & 255,\n    a: hexValue & 255,\n    hex: '#' + hexCode.slice(0, 6).join('')\n  }\n}\n\nexports.getOptions = function getOptions (options) {\n  if (!options) options = {}\n  if (!options.color) options.color = {}\n\n  const margin = typeof options.margin === 'undefined' ||\n    options.margin === null ||\n    options.margin < 0\n    ? 4\n    : options.margin\n\n  const width = options.width && options.width >= 21 ? options.width : undefined\n  const scale = options.scale || 4\n\n  return {\n    width: width,\n    scale: width ? 4 : scale,\n    margin: margin,\n    color: {\n      dark: hex2rgba(options.color.dark || '#000000ff'),\n      light: hex2rgba(options.color.light || '#ffffffff')\n    },\n    type: options.type,\n    rendererOpts: options.rendererOpts || {}\n  }\n}\n\nexports.getScale = function getScale (qrSize, opts) {\n  return opts.width && opts.width >= qrSize + opts.margin * 2\n    ? opts.width / (qrSize + opts.margin * 2)\n    : opts.scale\n}\n\nexports.getImageWidth = function getImageWidth (qrSize, opts) {\n  const scale = exports.getScale(qrSize, opts)\n  return Math.floor((qrSize + opts.margin * 2) * scale)\n}\n\nexports.qrToImageData = function qrToImageData (imgData, qr, opts) {\n  const size = qr.modules.size\n  const data = qr.modules.data\n  const scale = exports.getScale(size, opts)\n  const symbolSize = Math.floor((size + opts.margin * 2) * scale)\n  const scaledMargin = opts.margin * scale\n  const palette = [opts.color.light, opts.color.dark]\n\n  for (let i = 0; i < symbolSize; i++) {\n    for (let j = 0; j < symbolSize; j++) {\n      let posDst = (i * symbolSize + j) * 4\n      let pxColor = opts.color.light\n\n      if (i >= scaledMargin && j >= scaledMargin &&\n        i < symbolSize - scaledMargin && j < symbolSize - scaledMargin) {\n        const iSrc = Math.floor((i - scaledMargin) / scale)\n        const jSrc = Math.floor((j - scaledMargin) / scale)\n        pxColor = palette[data[iSrc * size + jSrc] ? 1 : 0]\n      }\n\n      imgData[posDst++] = pxColor.r\n      imgData[posDst++] = pxColor.g\n      imgData[posDst++] = pxColor.b\n      imgData[posDst] = pxColor.a\n    }\n  }\n}\n","const Utils = require('./utils')\n\nfunction clearCanvas (ctx, canvas, size) {\n  ctx.clearRect(0, 0, canvas.width, canvas.height)\n\n  if (!canvas.style) canvas.style = {}\n  canvas.height = size\n  canvas.width = size\n  canvas.style.height = size + 'px'\n  canvas.style.width = size + 'px'\n}\n\nfunction getCanvasElement () {\n  try {\n    return document.createElement('canvas')\n  } catch (e) {\n    throw new Error('You need to specify a canvas element')\n  }\n}\n\nexports.render = function render (qrData, canvas, options) {\n  let opts = options\n  let canvasEl = canvas\n\n  if (typeof opts === 'undefined' && (!canvas || !canvas.getContext)) {\n    opts = canvas\n    canvas = undefined\n  }\n\n  if (!canvas) {\n    canvasEl = getCanvasElement()\n  }\n\n  opts = Utils.getOptions(opts)\n  const size = Utils.getImageWidth(qrData.modules.size, opts)\n\n  const ctx = canvasEl.getContext('2d')\n  const image = ctx.createImageData(size, size)\n  Utils.qrToImageData(image.data, qrData, opts)\n\n  clearCanvas(ctx, canvasEl, size)\n  ctx.putImageData(image, 0, 0)\n\n  return canvasEl\n}\n\nexports.renderToDataURL = function renderToDataURL (qrData, canvas, options) {\n  let opts = options\n\n  if (typeof opts === 'undefined' && (!canvas || !canvas.getContext)) {\n    opts = canvas\n    canvas = undefined\n  }\n\n  if (!opts) opts = {}\n\n  const canvasEl = exports.render(qrData, canvas, opts)\n\n  const type = opts.type || 'image/png'\n  const rendererOpts = opts.rendererOpts || {}\n\n  return canvasEl.toDataURL(type, rendererOpts.quality)\n}\n","const Utils = require('./utils')\n\nfunction getColorAttrib (color, attrib) {\n  const alpha = color.a / 255\n  const str = attrib + '=\"' + color.hex + '\"'\n\n  return alpha < 1\n    ? str + ' ' + attrib + '-opacity=\"' + alpha.toFixed(2).slice(1) + '\"'\n    : str\n}\n\nfunction svgCmd (cmd, x, y) {\n  let str = cmd + x\n  if (typeof y !== 'undefined') str += ' ' + y\n\n  return str\n}\n\nfunction qrToPath (data, size, margin) {\n  let path = ''\n  let moveBy = 0\n  let newRow = false\n  let lineLength = 0\n\n  for (let i = 0; i < data.length; i++) {\n    const col = Math.floor(i % size)\n    const row = Math.floor(i / size)\n\n    if (!col && !newRow) newRow = true\n\n    if (data[i]) {\n      lineLength++\n\n      if (!(i > 0 && col > 0 && data[i - 1])) {\n        path += newRow\n          ? svgCmd('M', col + margin, 0.5 + row + margin)\n          : svgCmd('m', moveBy, 0)\n\n        moveBy = 0\n        newRow = false\n      }\n\n      if (!(col + 1 < size && data[i + 1])) {\n        path += svgCmd('h', lineLength)\n        lineLength = 0\n      }\n    } else {\n      moveBy++\n    }\n  }\n\n  return path\n}\n\nexports.render = function render (qrData, options, cb) {\n  const opts = Utils.getOptions(options)\n  const size = qrData.modules.size\n  const data = qrData.modules.data\n  const qrcodesize = size + opts.margin * 2\n\n  const bg = !opts.color.light.a\n    ? ''\n    : '<path ' + getColorAttrib(opts.color.light, 'fill') +\n      ' d=\"M0 0h' + qrcodesize + 'v' + qrcodesize + 'H0z\"/>'\n\n  const path =\n    '<path ' + getColorAttrib(opts.color.dark, 'stroke') +\n    ' d=\"' + qrToPath(data, size, opts.margin) + '\"/>'\n\n  const viewBox = 'viewBox=\"' + '0 0 ' + qrcodesize + ' ' + qrcodesize + '\"'\n\n  const width = !opts.width ? '' : 'width=\"' + opts.width + '\" height=\"' + opts.width + '\" '\n\n  const svgTag = '<svg xmlns=\"http://www.w3.org/2000/svg\" ' + width + viewBox + ' shape-rendering=\"crispEdges\">' + bg + path + '</svg>\\n'\n\n  if (typeof cb === 'function') {\n    cb(null, svgTag)\n  }\n\n  return svgTag\n}\n","\nconst canPromise = require('./can-promise')\n\nconst QRCode = require('./core/qrcode')\nconst CanvasRenderer = require('./renderer/canvas')\nconst SvgRenderer = require('./renderer/svg-tag.js')\n\nfunction renderCanvas (renderFunc, canvas, text, opts, cb) {\n  const args = [].slice.call(arguments, 1)\n  const argsNum = args.length\n  const isLastArgCb = typeof args[argsNum - 1] === 'function'\n\n  if (!isLastArgCb && !canPromise()) {\n    throw new Error('Callback required as last argument')\n  }\n\n  if (isLastArgCb) {\n    if (argsNum < 2) {\n      throw new Error('Too few arguments provided')\n    }\n\n    if (argsNum === 2) {\n      cb = text\n      text = canvas\n      canvas = opts = undefined\n    } else if (argsNum === 3) {\n      if (canvas.getContext && typeof cb === 'undefined') {\n        cb = opts\n        opts = undefined\n      } else {\n        cb = opts\n        opts = text\n        text = canvas\n        canvas = undefined\n      }\n    }\n  } else {\n    if (argsNum < 1) {\n      throw new Error('Too few arguments provided')\n    }\n\n    if (argsNum === 1) {\n      text = canvas\n      canvas = opts = undefined\n    } else if (argsNum === 2 && !canvas.getContext) {\n      opts = text\n      text = canvas\n      canvas = undefined\n    }\n\n    return new Promise(function (resolve, reject) {\n      try {\n        const data = QRCode.create(text, opts)\n        resolve(renderFunc(data, canvas, opts))\n      } catch (e) {\n        reject(e)\n      }\n    })\n  }\n\n  try {\n    const data = QRCode.create(text, opts)\n    cb(null, renderFunc(data, canvas, opts))\n  } catch (e) {\n    cb(e)\n  }\n}\n\nexports.create = QRCode.create\nexports.toCanvas = renderCanvas.bind(null, CanvasRenderer.render)\nexports.toDataURL = renderCanvas.bind(null, CanvasRenderer.renderToDataURL)\n\n// only svg for now.\nexports.toString = renderCanvas.bind(null, function (data, _, opts) {\n  return SvgRenderer.render(data, opts)\n})\n","/**\n * QR Code component for TOTP setup\n *\n * Generates QR codes client-side using the qrcode library.\n * SECURITY: Never sends the TOTP secret to external services.\n */\n\nimport { useEffect, useRef, useState } from 'react';\nimport QRCode from 'qrcode';\n\nexport interface QrCodeProps {\n  /** The data to encode in the QR code (e.g., otpauth:// URL) */\n  value: string;\n  /** Size in pixels (width and height) */\n  size?: number;\n  /** Alt text for accessibility */\n  alt?: string;\n  /** Additional CSS class */\n  className?: string;\n}\n\n/**\n * Renders a QR code as a canvas element.\n * Generated entirely client-side for security.\n */\nexport function QrCode({ value, size = 200, alt = 'QR code', className = '' }: QrCodeProps) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!canvasRef.current || !value) return;\n\n    QRCode.toCanvas(canvasRef.current, value, {\n      width: size,\n      margin: 2,\n      color: {\n        dark: '#000000',\n        light: '#ffffff',\n      },\n      errorCorrectionLevel: 'M',\n    })\n      .then(() => {\n        // Clear any previous error on successful generation\n        setError(null);\n      })\n      .catch((err) => {\n        setError(err instanceof Error ? err.message : 'Failed to generate QR code');\n      });\n  }, [value, size]);\n\n  if (error) {\n    return (\n      <div\n        className={`cedros-qr-error ${className}`}\n        style={{ width: size, height: size }}\n        role=\"img\"\n        aria-label={alt}\n      >\n        <p>Failed to generate QR code</p>\n      </div>\n    );\n  }\n\n  return (\n    <canvas\n      ref={canvasRef}\n      className={`cedros-totp-qr-image ${className}`}\n      role=\"img\"\n      aria-label={alt}\n      style={{ borderRadius: '0.5rem' }}\n    />\n  );\n}\n","import { useState, useCallback, useMemo } from 'react';\nimport { useCedrosLogin } from '../context/useCedrosLogin';\nimport { ApiClient, handleApiError } from '../utils/apiClient';\nimport type {\n  AuthError,\n  TotpStatus,\n  TotpSetupResponse,\n  TotpBackupCodesResponse,\n  TotpSetupState,\n} from '../types';\n\nexport interface UseTotpReturn {\n  /** Current TOTP status for the user */\n  status: TotpStatus | null;\n  /** Setup state for the enrollment flow */\n  setupState: TotpSetupState;\n  /** Setup data (secret, QR URL, backup codes) */\n  setupData: TotpSetupResponse | null;\n  /** Whether a request is in progress */\n  isLoading: boolean;\n  /** Error from the last request */\n  error: AuthError | null;\n  /** Fetch current TOTP status */\n  getStatus: () => Promise<TotpStatus>;\n  /** Start TOTP setup (generates secret and backup codes) */\n  beginSetup: () => Promise<TotpSetupResponse>;\n  /** Verify code and enable TOTP */\n  enableTotp: (code: string) => Promise<void>;\n  /** Disable TOTP (requires password confirmation) */\n  disableTotp: (password: string) => Promise<void>;\n  /** Regenerate recovery codes (requires current authenticator code) */\n  regenerateBackupCodes: (code: string) => Promise<TotpBackupCodesResponse>;\n  /** Clear error state */\n  clearError: () => void;\n  /** Reset to initial state */\n  reset: () => void;\n}\n\n/**\n * Hook for TOTP (Time-based One-Time Password) two-factor authentication.\n *\n * Provides methods for:\n * - Setting up TOTP with authenticator apps\n * - Enabling/disabling TOTP for the user's account\n * - Managing backup codes\n *\n * @example\n * ```tsx\n * function TotpSettings() {\n *   const { status, beginSetup, enableTotp, setupData } = useTotp();\n *\n *   if (status?.enabled) {\n *     return <p>2FA is enabled</p>;\n *   }\n *\n *   const handleSetup = async () => {\n *     const data = await beginSetup();\n *     // Show QR code from data.otpauthUri\n *   };\n * }\n * ```\n */\nexport function useTotp(): UseTotpReturn {\n  const { config, _internal } = useCedrosLogin();\n  const [status, setStatus] = useState<TotpStatus | null>(null);\n  const [setupState, setSetupState] = useState<TotpSetupState>('idle');\n  const [setupData, setSetupData] = useState<TotpSetupResponse | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<AuthError | null>(null);\n\n  const apiClient = useMemo(\n    () =>\n      new ApiClient({\n        baseUrl: config.serverUrl,\n        timeoutMs: config.requestTimeout,\n        retryAttempts: config.retryAttempts,\n        getAccessToken: _internal?.getAccessToken,\n      }),\n    [config.serverUrl, config.requestTimeout, config.retryAttempts, _internal]\n  );\n\n  const getStatus = useCallback(async (): Promise<TotpStatus> => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const result = await apiClient.get<TotpStatus>('/mfa/status');\n      setStatus(result);\n      return result;\n    } catch (err) {\n      const authError = handleApiError(err, 'Failed to get TOTP status');\n      setError(authError);\n      throw authError;\n    } finally {\n      setIsLoading(false);\n    }\n  }, [apiClient]);\n\n  const beginSetup = useCallback(async (): Promise<TotpSetupResponse> => {\n    setIsLoading(true);\n    setError(null);\n    setSetupState('loading');\n\n    try {\n      const result = await apiClient.post<TotpSetupResponse>('/mfa/setup', {});\n      setSetupData(result);\n      setSetupState('setup');\n      return result;\n    } catch (err) {\n      const authError = handleApiError(err, 'Failed to start TOTP setup');\n      setError(authError);\n      setSetupState('error');\n      throw authError;\n    } finally {\n      setIsLoading(false);\n    }\n  }, [apiClient]);\n\n  const enableTotp = useCallback(\n    async (code: string): Promise<void> => {\n      if (!/^\\d{6}$/.test(code)) {\n        const validationError: AuthError = {\n          code: 'VALIDATION_ERROR',\n          message: 'Please enter a 6-digit code',\n        };\n        setError(validationError);\n        throw validationError;\n      }\n\n      setIsLoading(true);\n      setError(null);\n      setSetupState('verifying');\n\n      try {\n        await apiClient.post('/mfa/enable', { code });\n        setSetupState('success');\n        // UI-17: Fetch fresh status from server instead of using local state count\n        try {\n          const freshStatus = await apiClient.get<TotpStatus>('/mfa/status');\n          setStatus(freshStatus);\n        } catch {\n          // Fallback to a known-enabled state if the status fetch fails\n          setStatus({ enabled: true, recoveryCodesRemaining: 0 });\n        }\n      } catch (err) {\n        const authError = handleApiError(err, 'Invalid verification code');\n        setError(authError);\n        setSetupState('error');\n        throw authError;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [apiClient]\n  );\n\n  const disableTotp = useCallback(\n    async (password: string): Promise<void> => {\n      if (!password) {\n        const validationError: AuthError = {\n          code: 'VALIDATION_ERROR',\n          message: 'Please enter your password',\n        };\n        setError(validationError);\n        throw validationError;\n      }\n\n      setIsLoading(true);\n      setError(null);\n\n      try {\n        await apiClient.post('/mfa/disable', { password });\n        setStatus({ enabled: false, recoveryCodesRemaining: 0 });\n        setSetupData(null);\n        setSetupState('idle');\n      } catch (err) {\n        const authError = handleApiError(err, 'Failed to disable TOTP');\n        setError(authError);\n        throw authError;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [apiClient]\n  );\n\n  const regenerateBackupCodes = useCallback(\n    async (code: string): Promise<TotpBackupCodesResponse> => {\n      if (!/^\\d{6}$/.test(code)) {\n        const validationError: AuthError = {\n          code: 'VALIDATION_ERROR',\n          message: 'Please enter a 6-digit code',\n        };\n        setError(validationError);\n        throw validationError;\n      }\n\n      setIsLoading(true);\n      setError(null);\n\n      try {\n        const result = await apiClient.post<TotpBackupCodesResponse>(\n          '/mfa/recovery-codes/regenerate',\n          { code }\n        );\n        return result;\n      } catch (err) {\n        const authError = handleApiError(err, 'Failed to regenerate recovery codes');\n        setError(authError);\n        throw authError;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [apiClient]\n  );\n\n  const clearError = useCallback(() => setError(null), []);\n\n  const reset = useCallback(() => {\n    setError(null);\n    setSetupData(null);\n    setSetupState('idle');\n    setIsLoading(false);\n  }, []);\n\n  return {\n    status,\n    setupState,\n    setupData,\n    isLoading,\n    error,\n    getStatus,\n    beginSetup,\n    enableTotp,\n    disableTotp,\n    regenerateBackupCodes,\n    clearError,\n    reset,\n  };\n}\n","/**\n * TOTP Setup component for enabling two-factor authentication\n *\n * Guides users through:\n * 1. Scanning QR code with authenticator app\n * 2. Saving backup codes\n * 3. Verifying setup with a code\n */\n\nimport { useState, useEffect, useRef } from 'react';\nimport { useTotp } from '../../hooks/useTotp';\nimport { OtpInput } from './OtpInput';\nimport { QrCode } from './QrCode';\nimport { LoadingSpinner } from '../shared/LoadingSpinner';\nimport { ErrorMessage } from '../shared/ErrorMessage';\n\nexport interface TotpSetupProps {\n  /** Called when setup is completed successfully */\n  onSuccess?: () => void;\n  /** Called when user cancels setup */\n  onCancel?: () => void;\n  /** Additional CSS class */\n  className?: string;\n}\n\n/**\n * Two-factor authentication setup wizard.\n *\n * Displays QR code for authenticator app scanning,\n * recovery codes for account recovery, and verification step.\n */\nexport function TotpSetup({ onSuccess, onCancel, className = '' }: TotpSetupProps) {\n  const { setupState, setupData, isLoading, error, beginSetup, enableTotp, clearError, reset } =\n    useTotp();\n\n  const [step, setStep] = useState<'qr' | 'backup' | 'verify'>('qr');\n  const [verifyCode, setVerifyCode] = useState('');\n  const [copiedSecret, setCopiedSecret] = useState(false);\n  const [savedBackupCodes, setSavedBackupCodes] = useState(false);\n  const copyTimerRef = useRef<number | null>(null);\n\n  // Start setup on mount\n  useEffect(() => {\n    if (setupState === 'idle') {\n      beginSetup().catch(() => {\n        // Error handled by hook\n      });\n    }\n  }, [setupState, beginSetup]);\n\n  // Handle successful setup\n  useEffect(() => {\n    if (setupState === 'success') {\n      onSuccess?.();\n    }\n  }, [setupState, onSuccess]);\n\n  const handleCopySecret = async () => {\n    if (setupData?.secret) {\n      await navigator.clipboard.writeText(setupData.secret);\n      setCopiedSecret(true);\n      if (copyTimerRef.current !== null) {\n        window.clearTimeout(copyTimerRef.current);\n      }\n      copyTimerRef.current = window.setTimeout(() => setCopiedSecret(false), 2000);\n    }\n  };\n\n  const handleCopyBackupCodes = async () => {\n    if (setupData?.recoveryCodes) {\n      const codes = setupData.recoveryCodes.join('\\n');\n      await navigator.clipboard.writeText(codes);\n    }\n  };\n\n  const handleVerify = async () => {\n    try {\n      await enableTotp(verifyCode);\n    } catch {\n      // Error handled by hook\n      setVerifyCode('');\n    }\n  };\n\n  const handleCancel = () => {\n    reset();\n    onCancel?.();\n  };\n\n  useEffect(() => {\n    return () => {\n      if (copyTimerRef.current !== null) {\n        window.clearTimeout(copyTimerRef.current);\n        copyTimerRef.current = null;\n      }\n    };\n  }, []);\n\n  // Loading state\n  if (setupState === 'loading' || (setupState === 'idle' && isLoading)) {\n    return (\n      <div className={`cedros-totp-setup ${className}`}>\n        <div className=\"cedros-totp-loading\">\n          <LoadingSpinner size=\"lg\" label=\"Setting up two-factor authentication\" />\n        </div>\n      </div>\n    );\n  }\n\n  // Error state (failed to start setup)\n  if (setupState === 'error' && !setupData) {\n    return (\n      <div className={`cedros-totp-setup ${className}`}>\n        <ErrorMessage error={error} onDismiss={clearError} />\n        <div className=\"cedros-totp-actions\">\n          <button\n            type=\"button\"\n            className=\"cedros-button cedros-button-outline cedros-button-md\"\n            onClick={handleCancel}\n          >\n            Cancel\n          </button>\n          <button\n            type=\"button\"\n            className=\"cedros-button cedros-button-primary cedros-button-md\"\n            onClick={() => beginSetup()}\n          >\n            Try again\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // Success state\n  if (setupState === 'success') {\n    return (\n      <div className={`cedros-totp-setup ${className}`}>\n        <div className=\"cedros-totp-success\">\n          <svg\n            className=\"cedros-totp-success-icon\"\n            width=\"48\"\n            height=\"48\"\n            viewBox=\"0 0 48 48\"\n            fill=\"none\"\n            aria-hidden=\"true\"\n          >\n            <circle cx=\"24\" cy=\"24\" r=\"22\" stroke=\"var(--cedros-success)\" strokeWidth=\"2\" />\n            <path\n              d=\"M14 24l7 7 13-13\"\n              stroke=\"var(--cedros-success)\"\n              strokeWidth=\"2\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n            />\n          </svg>\n          <h3 className=\"cedros-totp-title\">Two-factor authentication enabled</h3>\n          <p className=\"cedros-totp-description\">\n            Your account is now protected with an additional layer of security.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!setupData) return null;\n\n  return (\n    <div className={`cedros-totp-setup ${className}`}>\n      {/* Step 1: QR Code */}\n      {step === 'qr' && (\n        <div className=\"cedros-totp-step\">\n          <h3 className=\"cedros-totp-title\">Scan QR code</h3>\n          <p className=\"cedros-totp-description\">\n            Use your authenticator app to scan this QR code.\n          </p>\n\n          <div className=\"cedros-totp-qr\">\n            {/* QR code generated client-side from the server-provided otpauth URI */}\n            <QrCode value={setupData.otpauthUri} size={200} alt=\"QR code for authenticator app\" />\n          </div>\n\n          <div className=\"cedros-totp-manual\">\n            <p className=\"cedros-totp-manual-label\">Or enter this code manually:</p>\n            <div className=\"cedros-totp-secret\">\n              <code className=\"cedros-totp-secret-code\">{setupData.secret}</code>\n              <button\n                type=\"button\"\n                className=\"cedros-button cedros-button-ghost cedros-button-sm\"\n                onClick={handleCopySecret}\n                aria-label=\"Copy secret\"\n              >\n                {copiedSecret ? 'Copied!' : 'Copy'}\n              </button>\n            </div>\n          </div>\n\n          <div className=\"cedros-totp-actions\">\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-outline cedros-button-md\"\n              onClick={handleCancel}\n            >\n              Cancel\n            </button>\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-primary cedros-button-md\"\n              onClick={() => setStep('backup')}\n            >\n              Continue\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Step 2: Recovery Codes */}\n      {step === 'backup' && (\n        <div className=\"cedros-totp-step\">\n          <h3 className=\"cedros-totp-title\">Save recovery codes</h3>\n          <p className=\"cedros-totp-description\">\n            Save these codes in a secure place. You can use them to access your account if you lose\n            your authenticator device.\n          </p>\n\n          <div className=\"cedros-totp-backup-codes\">\n            {setupData.recoveryCodes.map((code, index) => (\n              <code key={index} className=\"cedros-totp-backup-code\">\n                {code}\n              </code>\n            ))}\n          </div>\n\n          <button\n            type=\"button\"\n            className=\"cedros-button cedros-button-outline cedros-button-md cedros-button-full\"\n            onClick={handleCopyBackupCodes}\n          >\n            Copy all codes\n          </button>\n\n          <label className=\"cedros-checkbox-label cedros-totp-confirm\">\n            <input\n              type=\"checkbox\"\n              className=\"cedros-checkbox\"\n              checked={savedBackupCodes}\n              onChange={(e) => setSavedBackupCodes(e.target.checked)}\n            />\n            <span className=\"cedros-checkbox-text\">I have saved these recovery codes</span>\n          </label>\n\n          <div className=\"cedros-totp-actions\">\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-outline cedros-button-md\"\n              onClick={() => setStep('qr')}\n            >\n              Back\n            </button>\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-primary cedros-button-md\"\n              onClick={() => setStep('verify')}\n              disabled={!savedBackupCodes}\n            >\n              Continue\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Step 3: Verify */}\n      {step === 'verify' && (\n        <div className=\"cedros-totp-step\">\n          <h3 className=\"cedros-totp-title\">Verify setup</h3>\n          <p className=\"cedros-totp-description\">\n            Enter the 6-digit code from your authenticator app to complete setup.\n          </p>\n\n          <OtpInput\n            value={verifyCode}\n            onChange={setVerifyCode}\n            onComplete={handleVerify}\n            disabled={isLoading}\n            error={error?.message}\n            autoFocus\n          />\n\n          <div className=\"cedros-totp-actions\">\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-outline cedros-button-md\"\n              onClick={() => setStep('backup')}\n              disabled={isLoading}\n            >\n              Back\n            </button>\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-primary cedros-button-md\"\n              onClick={handleVerify}\n              disabled={isLoading || verifyCode.length !== 6}\n            >\n              {isLoading ? (\n                <>\n                  <LoadingSpinner size=\"sm\" />\n                  <span>Verifying...</span>\n                </>\n              ) : (\n                'Enable 2FA'\n              )}\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","/**\n * TOTP Settings component for managing two-factor authentication\n *\n * Allows users to:\n * - View current 2FA status\n * - Enable 2FA (via TotpSetup wizard)\n * - Disable 2FA (requires verification)\n * - Regenerate backup codes\n */\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { useTotp } from '../../hooks/useTotp';\nimport { TotpSetup } from './TotpSetup';\nimport { OtpInput } from './OtpInput';\nimport { PasswordInput } from '../email/PasswordInput';\nimport { LoadingSpinner } from '../shared/LoadingSpinner';\nimport { ErrorMessage } from '../shared/ErrorMessage';\n\nexport interface TotpSettingsProps {\n  /** Called when 2FA status changes */\n  onStatusChange?: (enabled: boolean) => void;\n  /** Additional CSS class */\n  className?: string;\n}\n\ntype SettingsView = 'status' | 'setup' | 'disable' | 'regenerate';\n\n/**\n * Two-factor authentication settings panel.\n *\n * Shows current 2FA status and provides controls for\n * enabling, disabling, and managing backup codes.\n *\n * @example\n * ```tsx\n * function SecuritySettings() {\n *   return (\n *     <div>\n *       <h2>Security</h2>\n *       <TotpSettings\n *         onStatusChange={(enabled) => {\n *           console.log('2FA is now', enabled ? 'enabled' : 'disabled');\n *         }}\n *       />\n *     </div>\n *   );\n * }\n * ```\n */\nexport function TotpSettings({ onStatusChange, className = '' }: TotpSettingsProps) {\n  const { status, isLoading, error, getStatus, disableTotp, regenerateBackupCodes, clearError } =\n    useTotp();\n\n  const [view, setView] = useState<SettingsView>('status');\n  const [disablePassword, setDisablePassword] = useState('');\n  const [regenerateCode, setRegenerateCode] = useState('');\n  const [newRecoveryCodes, setNewRecoveryCodes] = useState<string[] | null>(null);\n  const [actionLoading, setActionLoading] = useState(false);\n  const [actionError, setActionError] = useState<string | null>(null);\n\n  // Fetch status on mount\n  useEffect(() => {\n    getStatus().catch(() => {\n      // Error handled by hook\n    });\n  }, [getStatus]);\n\n  const handleSetupComplete = useCallback(() => {\n    setView('status');\n    onStatusChange?.(true);\n  }, [onStatusChange]);\n\n  const handleDisable = async () => {\n    setActionLoading(true);\n    setActionError(null);\n    try {\n      await disableTotp(disablePassword);\n      setView('status');\n      setDisablePassword('');\n      onStatusChange?.(false);\n    } catch (err) {\n      setActionError(err instanceof Error ? err.message : 'Failed to disable 2FA');\n      setDisablePassword('');\n    } finally {\n      setActionLoading(false);\n    }\n  };\n\n  const handleRegenerate = async () => {\n    setActionLoading(true);\n    setActionError(null);\n    try {\n      const result = await regenerateBackupCodes(regenerateCode);\n      setNewRecoveryCodes(result.recoveryCodes);\n      setRegenerateCode('');\n    } catch (err) {\n      setActionError(err instanceof Error ? err.message : 'Failed to regenerate codes');\n      setRegenerateCode('');\n    } finally {\n      setActionLoading(false);\n    }\n  };\n\n  const handleCopyBackupCodes = async () => {\n    if (newRecoveryCodes) {\n      await navigator.clipboard.writeText(newRecoveryCodes.join('\\n'));\n    }\n  };\n\n  // Loading state\n  if (isLoading && !status) {\n    return (\n      <div className={`cedros-totp-settings ${className}`}>\n        <div className=\"cedros-totp-loading\">\n          <LoadingSpinner size=\"md\" label=\"Loading security settings\" />\n        </div>\n      </div>\n    );\n  }\n\n  // Error state\n  if (error && !status) {\n    return (\n      <div className={`cedros-totp-settings ${className}`}>\n        <ErrorMessage error={error} onDismiss={clearError} />\n        <button\n          type=\"button\"\n          className=\"cedros-button cedros-button-primary cedros-button-md\"\n          onClick={() => getStatus()}\n        >\n          Retry\n        </button>\n      </div>\n    );\n  }\n\n  // Setup view\n  if (view === 'setup') {\n    return (\n      <div className={`cedros-totp-settings ${className}`}>\n        <TotpSetup onSuccess={handleSetupComplete} onCancel={() => setView('status')} />\n      </div>\n    );\n  }\n\n  // Disable confirmation view\n  if (view === 'disable') {\n    return (\n      <div className={`cedros-totp-settings ${className}`}>\n        <div className=\"cedros-totp-panel\">\n          <h3 className=\"cedros-totp-title\">Disable two-factor authentication</h3>\n          <p className=\"cedros-totp-description cedros-totp-warning\">\n            This will make your account less secure. Enter your password to confirm.\n          </p>\n\n          {actionError && (\n            <div className=\"cedros-totp-error\">\n              <ErrorMessage\n                error={{ code: 'UNKNOWN_ERROR', message: actionError }}\n                onDismiss={() => setActionError(null)}\n              />\n            </div>\n          )}\n\n          <div className=\"cedros-totp-verify-input\">\n            <PasswordInput\n              label=\"Password\"\n              placeholder=\"Enter your password\"\n              value={disablePassword}\n              onChange={(e) => setDisablePassword(e.target.value)}\n              disabled={actionLoading}\n              autoFocus\n            />\n          </div>\n\n          <div className=\"cedros-totp-actions\">\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-outline cedros-button-md\"\n              onClick={() => {\n                setView('status');\n                setDisablePassword('');\n                setActionError(null);\n              }}\n              disabled={actionLoading}\n            >\n              Cancel\n            </button>\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-destructive cedros-button-md\"\n              onClick={handleDisable}\n              disabled={actionLoading || disablePassword.length === 0}\n            >\n              {actionLoading ? (\n                <>\n                  <LoadingSpinner size=\"sm\" />\n                  <span>Disabling...</span>\n                </>\n              ) : (\n                'Disable 2FA'\n              )}\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Regenerate backup codes view\n  if (view === 'regenerate') {\n    // Show new codes after regeneration\n    if (newRecoveryCodes) {\n      return (\n        <div className={`cedros-totp-settings ${className}`}>\n          <div className=\"cedros-totp-panel\">\n            <h3 className=\"cedros-totp-title\">New recovery codes</h3>\n            <p className=\"cedros-totp-description\">\n              Save these codes in a secure place. Your old codes are no longer valid.\n            </p>\n\n            <div className=\"cedros-totp-backup-codes\">\n              {newRecoveryCodes.map((code, index) => (\n                <code key={index} className=\"cedros-totp-backup-code\">\n                  {code}\n                </code>\n              ))}\n            </div>\n\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-outline cedros-button-md cedros-button-full\"\n              onClick={handleCopyBackupCodes}\n            >\n              Copy all codes\n            </button>\n\n            <div className=\"cedros-totp-actions\">\n              <button\n                type=\"button\"\n                className=\"cedros-button cedros-button-primary cedros-button-md\"\n                onClick={() => {\n                  setView('status');\n                  setNewRecoveryCodes(null);\n                }}\n              >\n                Done\n              </button>\n            </div>\n          </div>\n        </div>\n      );\n    }\n\n    // Code entry for regeneration\n    return (\n      <div className={`cedros-totp-settings ${className}`}>\n        <div className=\"cedros-totp-panel\">\n          <h3 className=\"cedros-totp-title\">Regenerate recovery codes</h3>\n          <p className=\"cedros-totp-description\">\n            This will invalidate all existing recovery codes. Enter your authenticator code to\n            confirm.\n          </p>\n\n          {actionError && (\n            <div className=\"cedros-totp-error\">\n              <ErrorMessage\n                error={{ code: 'UNKNOWN_ERROR', message: actionError }}\n                onDismiss={() => setActionError(null)}\n              />\n            </div>\n          )}\n\n          <div className=\"cedros-totp-verify-input\">\n            <OtpInput\n              value={regenerateCode}\n              onChange={setRegenerateCode}\n              onComplete={handleRegenerate}\n              disabled={actionLoading}\n              autoFocus\n            />\n          </div>\n\n          <div className=\"cedros-totp-actions\">\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-outline cedros-button-md\"\n              onClick={() => {\n                setView('status');\n                setRegenerateCode('');\n                setActionError(null);\n              }}\n              disabled={actionLoading}\n            >\n              Cancel\n            </button>\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-primary cedros-button-md\"\n              onClick={handleRegenerate}\n              disabled={actionLoading || regenerateCode.length !== 6}\n            >\n              {actionLoading ? (\n                <>\n                  <LoadingSpinner size=\"sm\" />\n                  <span>Regenerating...</span>\n                </>\n              ) : (\n                'Regenerate codes'\n              )}\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Main status view\n  return (\n    <div className={`cedros-totp-settings ${className}`}>\n      <div className=\"cedros-totp-panel\">\n        <div className=\"cedros-totp-status-header\">\n          <div className=\"cedros-totp-status-info\">\n            <h3 className=\"cedros-totp-title\">Two-factor authentication</h3>\n            <p className=\"cedros-totp-description\">\n              Add an extra layer of security to your account by requiring a verification code from\n              your authenticator app when signing in.\n            </p>\n          </div>\n          <div\n            className={`cedros-totp-badge ${status?.enabled ? 'cedros-totp-badge-enabled' : 'cedros-totp-badge-disabled'}`}\n          >\n            {status?.enabled ? 'Enabled' : 'Disabled'}\n          </div>\n        </div>\n\n        {status?.enabled ? (\n          <div className=\"cedros-totp-enabled-actions\">\n            <div className=\"cedros-totp-description\" style={{ marginTop: '0.25rem' }}>\n              Recovery codes remaining: <strong>{status.recoveryCodesRemaining}</strong>\n            </div>\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-outline cedros-button-md\"\n              onClick={() => setView('regenerate')}\n            >\n              Regenerate recovery codes\n            </button>\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-destructive-outline cedros-button-md\"\n              onClick={() => setView('disable')}\n            >\n              Disable 2FA\n            </button>\n          </div>\n        ) : (\n          <button\n            type=\"button\"\n            className=\"cedros-button cedros-button-primary cedros-button-md\"\n            onClick={() => setView('setup')}\n          >\n            Enable two-factor authentication\n          </button>\n        )}\n      </div>\n    </div>\n  );\n}\n","import type {\n  ChangePasswordRequest,\n  ChangePasswordResponse,\n  UpdateProfileRequest,\n  UpdateProfileResponse,\n} from '../types';\nimport { ApiClient, handleApiError } from './apiClient';\n\n/**\n * API client for user profile operations\n *\n * Supports:\n * - POST /auth/change-password - Change user password\n * - PATCH /auth/me - Update profile (name, picture) [requires backend support]\n */\nexport class ProfileApiClient {\n  private client: ApiClient;\n\n  constructor(\n    baseUrl: string,\n    timeoutMs?: number,\n    retryAttempts?: number,\n    getAccessToken?: () => string | null\n  ) {\n    this.client = new ApiClient({ baseUrl, timeoutMs, retryAttempts, getAccessToken });\n  }\n\n  /**\n   * Change the user's password\n   *\n   * Requires the current password for verification. Also revokes all other sessions\n   * and re-encrypts wallet Share A if using password-based wallet protection.\n   */\n  async changePassword(data: ChangePasswordRequest): Promise<ChangePasswordResponse> {\n    try {\n      return await this.client.post<ChangePasswordResponse>('/auth/change-password', data);\n    } catch (error) {\n      throw handleApiError(error, 'Failed to change password');\n    }\n  }\n\n  /**\n   * Update user profile (name, picture)\n   *\n   * NOTE: Requires PATCH /auth/me endpoint on the backend.\n   * If not implemented, returns a rejection.\n   */\n  async updateProfile(data: UpdateProfileRequest): Promise<UpdateProfileResponse> {\n    try {\n      return await this.client.patch<UpdateProfileResponse>('/auth/me', data);\n    } catch (error) {\n      throw handleApiError(error, 'Failed to update profile');\n    }\n  }\n}\n","import { useState, useCallback, useMemo } from 'react';\nimport type {\n  ChangePasswordRequest,\n  UpdateProfileRequest,\n  UpdateProfileResponse,\n  UseProfileReturn,\n} from '../types';\nimport { useCedrosLogin } from '../context/useCedrosLogin';\nimport { ProfileApiClient } from '../utils/profileApi';\n\n/**\n * Hook for managing user profile operations.\n *\n * Provides methods for updating profile information and changing password.\n *\n * @example\n * ```tsx\n * function ProfileSettings() {\n *   const { isLoading, error, changePassword, clearError } = useProfile();\n *\n *   const handlePasswordChange = async () => {\n *     try {\n *       await changePassword({\n *         currentPassword: 'oldpass',\n *         newPassword: 'newpass123',\n *       });\n *       // Success - other sessions have been revoked\n *     } catch (err) {\n *       // Error is available via the error property\n *     }\n *   };\n *\n *   return (\n *     <div>\n *       {error && <p className=\"error\">{error.message}</p>}\n *       <button onClick={handlePasswordChange} disabled={isLoading}>\n *         Change Password\n *       </button>\n *     </div>\n *   );\n * }\n * ```\n */\nexport function useProfile(): UseProfileReturn {\n  const { config, authState, _internal } = useCedrosLogin();\n\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n\n  const apiClient = useMemo(\n    () =>\n      new ProfileApiClient(\n        config.serverUrl,\n        config.requestTimeout,\n        config.retryAttempts,\n        _internal?.getAccessToken\n      ),\n    [config.serverUrl, config.requestTimeout, config.retryAttempts, _internal]\n  );\n\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  /**\n   * Update profile (name, picture)\n   *\n   * NOTE: Requires PATCH /auth/me endpoint on the backend.\n   */\n  const updateProfile = useCallback(\n    async (data: UpdateProfileRequest): Promise<UpdateProfileResponse> => {\n      if (authState !== 'authenticated') {\n        throw new Error('Must be authenticated to update profile');\n      }\n\n      setIsLoading(true);\n      setError(null);\n\n      try {\n        const response = await apiClient.updateProfile(data);\n        return response;\n      } catch (err) {\n        const error = err instanceof Error ? err : new Error('Failed to update profile');\n        setError(error);\n        throw error;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [authState, apiClient]\n  );\n\n  /**\n   * Change password\n   *\n   * Requires current password for verification. On success:\n   * - All other sessions are revoked (forced re-login on other devices)\n   * - Wallet Share A is re-encrypted if using password-based protection\n   */\n  const changePassword = useCallback(\n    async (data: ChangePasswordRequest): Promise<void> => {\n      if (authState !== 'authenticated') {\n        throw new Error('Must be authenticated to change password');\n      }\n\n      setIsLoading(true);\n      setError(null);\n\n      try {\n        await apiClient.changePassword(data);\n      } catch (err) {\n        const error = err instanceof Error ? err : new Error('Failed to change password');\n        setError(error);\n        throw error;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [authState, apiClient]\n  );\n\n  return {\n    isLoading,\n    error,\n    updateProfile,\n    changePassword,\n    clearError,\n  };\n}\n","/**\n * User Profile Settings component\n *\n * Allows users to:\n * - View their profile information\n * - Change their password\n * - (Future) Update name and picture when backend supports it\n */\n\nimport { useState, useCallback } from 'react';\nimport { useProfile } from '../../hooks/useProfile';\nimport { useAuth } from '../../hooks/useAuth';\nimport { PasswordInput } from '../email/PasswordInput';\nimport { LoadingSpinner } from '../shared/LoadingSpinner';\nimport { ErrorMessage } from '../shared/ErrorMessage';\nimport { validatePassword } from '../../utils/validation';\n\nexport interface UserProfileSettingsProps {\n  /** Called when password is changed successfully */\n  onPasswordChange?: () => void;\n  /** Called when user requests to close/cancel */\n  onClose?: () => void;\n  /** Additional CSS class */\n  className?: string;\n}\n\ntype SettingsView = 'main' | 'change-password';\n\n/**\n * User profile settings panel.\n *\n * Shows user profile information and provides controls for\n * changing password and managing profile settings.\n *\n * @example\n * ```tsx\n * function SettingsPage() {\n *   return (\n *     <UserProfileSettings\n *       onPasswordChange={() => console.log('Password changed')}\n *       onClose={() => navigate('/dashboard')}\n *     />\n *   );\n * }\n * ```\n */\nexport function UserProfileSettings({\n  onPasswordChange,\n  onClose,\n  className = '',\n}: UserProfileSettingsProps) {\n  const { user } = useAuth();\n  const { isLoading, error, changePassword, clearError } = useProfile();\n\n  const [view, setView] = useState<SettingsView>('main');\n  const [currentPassword, setCurrentPassword] = useState('');\n  const [newPassword, setNewPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [actionError, setActionError] = useState<string | null>(null);\n  const [successMessage, setSuccessMessage] = useState<string | null>(null);\n\n  // Password validation\n  const passwordValidation = validatePassword(newPassword);\n  const passwordsMatch = newPassword === confirmPassword;\n  const canSubmitPassword =\n    currentPassword.length > 0 &&\n    newPassword.length > 0 &&\n    confirmPassword.length > 0 &&\n    passwordValidation.isValid &&\n    passwordsMatch;\n\n  const handlePasswordChange = useCallback(async () => {\n    if (!canSubmitPassword) return;\n\n    setActionError(null);\n    setSuccessMessage(null);\n\n    try {\n      await changePassword({\n        currentPassword,\n        newPassword,\n      });\n\n      // Clear form and show success\n      setCurrentPassword('');\n      setNewPassword('');\n      setConfirmPassword('');\n      setSuccessMessage('Password changed successfully. Other sessions have been logged out.');\n      onPasswordChange?.();\n\n      // Return to main view after short delay\n      setTimeout(() => {\n        setView('main');\n        setSuccessMessage(null);\n      }, 2000);\n    } catch (err) {\n      setActionError(err instanceof Error ? err.message : 'Failed to change password');\n    }\n  }, [canSubmitPassword, currentPassword, newPassword, changePassword, onPasswordChange]);\n\n  const handleCancelPasswordChange = useCallback(() => {\n    setView('main');\n    setCurrentPassword('');\n    setNewPassword('');\n    setConfirmPassword('');\n    setActionError(null);\n    clearError();\n  }, [clearError]);\n\n  // Get user initials for avatar fallback\n  const getInitials = () => {\n    if (user?.name) {\n      return user.name\n        .split(' ')\n        .map((n) => n[0])\n        .join('')\n        .toUpperCase()\n        .slice(0, 2);\n    }\n    if (user?.email) {\n      return user.email[0].toUpperCase();\n    }\n    return '?';\n  };\n\n  // Change Password view\n  if (view === 'change-password') {\n    return (\n      <div className={`cedros-profile-settings ${className}`}>\n        <div className=\"cedros-profile-panel\">\n          <h3 className=\"cedros-profile-title\">Change password</h3>\n          <p className=\"cedros-profile-description\">\n            Enter your current password and choose a new one. This will log you out of other\n            devices.\n          </p>\n\n          {(actionError || error) && (\n            <div className=\"cedros-profile-error\">\n              <ErrorMessage\n                error={{ code: 'UNKNOWN_ERROR', message: actionError || error?.message || '' }}\n                onDismiss={() => {\n                  setActionError(null);\n                  clearError();\n                }}\n              />\n            </div>\n          )}\n\n          {successMessage && (\n            <div className=\"cedros-profile-success\">\n              <span className=\"cedros-profile-success-icon\">&#10003;</span>\n              {successMessage}\n            </div>\n          )}\n\n          <div className=\"cedros-profile-form\">\n            <div className=\"cedros-profile-field\">\n              <PasswordInput\n                label=\"Current password\"\n                placeholder=\"Enter your current password\"\n                value={currentPassword}\n                onChange={(e) => setCurrentPassword(e.target.value)}\n                disabled={isLoading}\n                autoFocus\n              />\n            </div>\n\n            <div className=\"cedros-profile-field\">\n              <PasswordInput\n                label=\"New password\"\n                placeholder=\"Enter new password\"\n                value={newPassword}\n                onChange={(e) => setNewPassword(e.target.value)}\n                disabled={isLoading}\n                showStrengthMeter\n              />\n            </div>\n\n            <div className=\"cedros-profile-field\">\n              <PasswordInput\n                label=\"Confirm new password\"\n                placeholder=\"Confirm new password\"\n                value={confirmPassword}\n                onChange={(e) => setConfirmPassword(e.target.value)}\n                disabled={isLoading}\n                error={\n                  confirmPassword.length > 0 && !passwordsMatch\n                    ? 'Passwords do not match'\n                    : undefined\n                }\n              />\n            </div>\n          </div>\n\n          <div className=\"cedros-profile-actions\">\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-outline cedros-button-md\"\n              onClick={handleCancelPasswordChange}\n              disabled={isLoading}\n            >\n              Cancel\n            </button>\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-primary cedros-button-md\"\n              onClick={handlePasswordChange}\n              disabled={isLoading || !canSubmitPassword}\n            >\n              {isLoading ? (\n                <>\n                  <LoadingSpinner size=\"sm\" />\n                  <span>Changing...</span>\n                </>\n              ) : (\n                'Change password'\n              )}\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Main profile view\n  return (\n    <div className={`cedros-profile-settings ${className}`}>\n      <div className=\"cedros-profile-panel\">\n        <div className=\"cedros-profile-header\">\n          <div className=\"cedros-profile-avatar-container\">\n            {user?.picture ? (\n              <img\n                src={user.picture}\n                alt={user.name || 'Profile'}\n                className=\"cedros-profile-avatar\"\n              />\n            ) : (\n              <div className=\"cedros-profile-avatar cedros-profile-avatar-fallback\">\n                {getInitials()}\n              </div>\n            )}\n          </div>\n          <div className=\"cedros-profile-info\">\n            <h3 className=\"cedros-profile-name\">{user?.name || 'User'}</h3>\n            <p className=\"cedros-profile-email\">{user?.email}</p>\n          </div>\n        </div>\n\n        <div className=\"cedros-profile-section\">\n          <h4 className=\"cedros-profile-section-title\">Account</h4>\n\n          <div className=\"cedros-profile-row\">\n            <div className=\"cedros-profile-row-content\">\n              <span className=\"cedros-profile-row-label\">Email</span>\n              <span className=\"cedros-profile-row-value\">{user?.email || 'Not set'}</span>\n            </div>\n          </div>\n\n          <div className=\"cedros-profile-row\">\n            <div className=\"cedros-profile-row-content\">\n              <span className=\"cedros-profile-row-label\">Password</span>\n              <span className=\"cedros-profile-row-value\"></span>\n            </div>\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-outline cedros-button-sm\"\n              onClick={() => setView('change-password')}\n            >\n              Change\n            </button>\n          </div>\n        </div>\n\n        {onClose && (\n          <div className=\"cedros-profile-footer\">\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-outline cedros-button-md\"\n              onClick={onClose}\n            >\n              Close\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","/**\n * Hook for Privacy Cash deposit operations\n *\n * Handles depositing SOL to the user's Privacy Cash account.\n * Requires an unlocked SSS wallet with no-recovery mode.\n *\n * Safe to call outside CedrosLoginProvider (returns no-op functions).\n */\n\nimport { useState, useCallback, useMemo } from 'react';\nimport { useCedrosLoginOptional } from '../context/useCedrosLogin';\nimport { ApiClient, handleApiError } from '../utils/apiClient';\nimport type {\n  UseDepositReturn,\n  DepositResponse,\n  DepositStatusResponse,\n  DepositConfigResponse,\n  DepositListResponse,\n  DepositQuoteResponse,\n  PublicDepositRequest,\n  MicroDepositRequest,\n  TieredDepositResponse,\n} from '../types/deposit';\n\nexport type { UseDepositReturn } from '../types/deposit';\n\n/**\n * Hook for Privacy Cash deposit operations\n *\n * Deposits go to the user's Privacy Cash account (user's pubkey is owner).\n * Credits are issued immediately, withdrawal to company wallet happens later.\n *\n * Requirements:\n * - User must have SSS wallet enrolled\n * - Wallet must be unlocked (call POST /wallet/unlock first)\n * - Wallet must be in \"no recovery\" mode\n *\n * Safe to call outside CedrosLoginProvider - returns no-op functions that throw.\n */\nexport function useDeposit(): UseDepositReturn {\n  const context = useCedrosLoginOptional();\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const apiClient = useMemo(() => {\n    if (!context) return null;\n    return new ApiClient({\n      baseUrl: context.config.serverUrl,\n      timeoutMs: context.config.requestTimeout,\n      retryAttempts: context.config.retryAttempts,\n      getAccessToken: context._internal?.getAccessToken,\n    });\n  }, [context]);\n\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  const deposit = useCallback(\n    async (amountLamports: number): Promise<DepositResponse> => {\n      if (!apiClient) {\n        throw new Error('useDeposit must be used within a CedrosLoginProvider');\n      }\n      // UI-05: Validate amount client-side before sending to the API.\n      if (!Number.isInteger(amountLamports) || amountLamports <= 0) {\n        const err = new Error(\n          `Invalid deposit amount: ${amountLamports}. Must be a positive integer (lamports).`\n        );\n        setError(err.message);\n        throw err;\n      }\n      setIsLoading(true);\n      setError(null);\n\n      try {\n        const data = await apiClient.post<DepositResponse>('/deposit', {\n          amount_lamports: amountLamports,\n        });\n        return data;\n      } catch (err) {\n        const apiError = handleApiError(err, 'Failed to execute deposit');\n        setError(apiError.message);\n        throw apiError;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [apiClient]\n  );\n\n  const getStatus = useCallback(\n    async (sessionId: string): Promise<DepositStatusResponse> => {\n      if (!apiClient) {\n        throw new Error('useDeposit must be used within a CedrosLoginProvider');\n      }\n      setIsLoading(true);\n      setError(null);\n\n      try {\n        const data = await apiClient.get<DepositStatusResponse>(`/deposit/status/${encodeURIComponent(sessionId)}`);\n        return data;\n      } catch (err) {\n        const apiError = handleApiError(err, 'Failed to get deposit status');\n        setError(apiError.message);\n        throw apiError;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [apiClient]\n  );\n\n  const getConfig = useCallback(async (): Promise<DepositConfigResponse> => {\n    if (!apiClient) {\n      throw new Error('useDeposit must be used within a CedrosLoginProvider');\n    }\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const data = await apiClient.get<DepositConfigResponse>('/deposit/config');\n      return data;\n    } catch (err) {\n      const apiError = handleApiError(err, 'Failed to get deposit config');\n      setError(apiError.message);\n      throw apiError;\n    } finally {\n      setIsLoading(false);\n    }\n  }, [apiClient]);\n\n  const listDeposits = useCallback(\n    async (options?: { limit?: number; offset?: number }): Promise<DepositListResponse> => {\n      if (!apiClient) {\n        throw new Error('useDeposit must be used within a CedrosLoginProvider');\n      }\n      setIsLoading(true);\n      setError(null);\n\n      try {\n        const params = new URLSearchParams();\n        if (options?.limit !== undefined) params.set('limit', String(options.limit));\n        if (options?.offset !== undefined) params.set('offset', String(options.offset));\n        const query = params.toString();\n        const url = query ? `/deposits?${query}` : '/deposits';\n        const data = await apiClient.get<DepositListResponse>(url);\n        return data;\n      } catch (err) {\n        const apiError = handleApiError(err, 'Failed to list deposits');\n        setError(apiError.message);\n        throw apiError;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [apiClient]\n  );\n\n  const getQuote = useCallback(\n    async (params: {\n      inputMint: string;\n      amount: number;\n      taker: string;\n    }): Promise<DepositQuoteResponse> => {\n      if (!apiClient) {\n        throw new Error('useDeposit must be used within a CedrosLoginProvider');\n      }\n      setIsLoading(true);\n      setError(null);\n\n      try {\n        const queryParams = new URLSearchParams({\n          input_mint: params.inputMint,\n          amount: String(params.amount),\n          taker: params.taker,\n        });\n        const data = await apiClient.get<DepositQuoteResponse>(`/deposit/quote?${queryParams}`);\n        return data;\n      } catch (err) {\n        const apiError = handleApiError(err, 'Failed to get deposit quote');\n        setError(apiError.message);\n        throw apiError;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [apiClient]\n  );\n\n  const publicDeposit = useCallback(\n    async (request: PublicDepositRequest): Promise<TieredDepositResponse> => {\n      if (!apiClient) {\n        throw new Error('useDeposit must be used within a CedrosLoginProvider');\n      }\n      setIsLoading(true);\n      setError(null);\n\n      try {\n        const data = await apiClient.post<TieredDepositResponse>('/deposit/public', request);\n        return data;\n      } catch (err) {\n        const apiError = handleApiError(err, 'Failed to execute public deposit');\n        setError(apiError.message);\n        throw apiError;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [apiClient]\n  );\n\n  const microDeposit = useCallback(\n    async (request: MicroDepositRequest): Promise<TieredDepositResponse> => {\n      if (!apiClient) {\n        throw new Error('useDeposit must be used within a CedrosLoginProvider');\n      }\n      setIsLoading(true);\n      setError(null);\n\n      try {\n        const data = await apiClient.post<TieredDepositResponse>('/deposit/micro', request);\n        return data;\n      } catch (err) {\n        const apiError = handleApiError(err, 'Failed to execute micro deposit');\n        setError(apiError.message);\n        throw apiError;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [apiClient]\n  );\n\n  return {\n    deposit,\n    getQuote,\n    publicDeposit,\n    microDeposit,\n    getStatus,\n    getConfig,\n    listDeposits,\n    isLoading,\n    error,\n    clearError,\n  };\n}\n","/**\n * Token selector component for deposit currency selection\n *\n * Allows users to select which token to deposit.\n * Supports search and displays token icons.\n */\n\nimport { useState, useCallback, useMemo, useRef, useEffect } from 'react';\nimport type { Token } from './tokens';\n\nexport interface TokenSelectorProps {\n  /** List of available tokens */\n  tokens: Token[];\n  /** Currently selected token */\n  selectedToken?: Token;\n  /** Callback when token is selected */\n  onSelect: (token: Token) => void;\n  /** Signal to force-open the dropdown */\n  openSignal?: number;\n  /** Placeholder text when no token selected */\n  placeholder?: string;\n  /** Disable the selector */\n  disabled?: boolean;\n  /** Additional CSS classes */\n  className?: string;\n  /** Show search input */\n  searchable?: boolean;\n}\n\n/**\n * Token selector dropdown component\n */\nexport function TokenSelector({\n  tokens,\n  selectedToken,\n  onSelect,\n  openSignal,\n  placeholder = 'Select token',\n  disabled = false,\n  className = '',\n  searchable = true,\n}: TokenSelectorProps) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [search, setSearch] = useState('');\n  const containerRef = useRef<HTMLDivElement>(null);\n  const searchInputRef = useRef<HTMLInputElement>(null);\n\n  // Filter tokens by search\n  const filteredTokens = useMemo(() => {\n    if (!search.trim()) return tokens;\n    const searchLower = search.toLowerCase();\n    return tokens.filter(\n      (token) =>\n        token.symbol.toLowerCase().includes(searchLower) ||\n        token.name.toLowerCase().includes(searchLower) ||\n        token.mint.toLowerCase().includes(searchLower)\n    );\n  }, [tokens, search]);\n\n  // Close on outside click\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n        setSearch('');\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('mousedown', handleClickOutside);\n      return () => document.removeEventListener('mousedown', handleClickOutside);\n    }\n  }, [isOpen]);\n\n  // Focus search input when opening\n  useEffect(() => {\n    if (isOpen && searchable && searchInputRef.current) {\n      searchInputRef.current.focus();\n    }\n  }, [isOpen, searchable]);\n\n  useEffect(() => {\n    if (openSignal === undefined || disabled) return;\n    setIsOpen(true);\n    setSearch('');\n  }, [openSignal, disabled]);\n\n  const handleToggle = useCallback(() => {\n    if (!disabled) {\n      setIsOpen((prev) => !prev);\n      if (isOpen) {\n        setSearch('');\n      }\n    }\n  }, [disabled, isOpen]);\n\n  const handleSelect = useCallback(\n    (token: Token) => {\n      onSelect(token);\n      setIsOpen(false);\n      setSearch('');\n    },\n    [onSelect]\n  );\n\n  const handleKeyDown = useCallback(\n    (event: React.KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        setIsOpen(false);\n        setSearch('');\n      } else if (event.key === 'Enter' && filteredTokens.length === 1) {\n        handleSelect(filteredTokens[0]);\n      }\n    },\n    [filteredTokens, handleSelect]\n  );\n\n  return (\n    <div\n      ref={containerRef}\n      className={`cedros-token-selector ${isOpen ? 'cedros-token-selector-open' : ''} ${disabled ? 'cedros-token-selector-disabled' : ''} ${className}`}\n      onKeyDown={handleKeyDown}\n    >\n      {/* Trigger button */}\n      <button\n        type=\"button\"\n        className=\"cedros-token-selector-trigger\"\n        onClick={handleToggle}\n        disabled={disabled}\n        aria-haspopup=\"listbox\"\n        aria-expanded={isOpen}\n      >\n        {selectedToken ? (\n          <span className=\"cedros-token-selector-selected\">\n            {selectedToken.logoUrl && (\n              <img\n                src={selectedToken.logoUrl}\n                alt={selectedToken.symbol}\n                className=\"cedros-token-icon\"\n                onError={(e) => {\n                  (e.target as HTMLImageElement).style.display = 'none';\n                }}\n              />\n            )}\n            <span className=\"cedros-token-symbol\">{selectedToken.symbol}</span>\n          </span>\n        ) : (\n          <span className=\"cedros-token-selector-placeholder\">{placeholder}</span>\n        )}\n        <span className=\"cedros-token-selector-arrow\">{isOpen ? '' : ''}</span>\n      </button>\n\n      {/* Dropdown */}\n      {isOpen && (\n        <div className=\"cedros-token-selector-dropdown\" role=\"listbox\">\n          {/* Search input */}\n          {searchable && (\n            <div className=\"cedros-token-search\">\n              <input\n                ref={searchInputRef}\n                type=\"text\"\n                value={search}\n                onChange={(e) => setSearch(e.target.value)}\n                placeholder=\"Search tokens...\"\n                className=\"cedros-token-search-input\"\n              />\n            </div>\n          )}\n\n          {/* Token list */}\n          <div className=\"cedros-token-list\">\n            {filteredTokens.length === 0 ? (\n              <div className=\"cedros-token-empty\">No tokens found</div>\n            ) : (\n              <>\n                {filteredTokens.map((token) => (\n                  <button\n                    key={token.mint}\n                    type=\"button\"\n                    className={`cedros-token-option ${selectedToken?.mint === token.mint ? 'cedros-token-option-selected' : ''}`}\n                    onClick={() => handleSelect(token)}\n                    role=\"option\"\n                    aria-selected={selectedToken?.mint === token.mint}\n                  >\n                    {token.logoUrl && (\n                      <img\n                        src={token.logoUrl}\n                        alt={token.symbol}\n                        className=\"cedros-token-icon\"\n                        onError={(e) => {\n                          (e.target as HTMLImageElement).style.display = 'none';\n                        }}\n                      />\n                    )}\n                    <span className=\"cedros-token-info\">\n                      <span className=\"cedros-token-symbol\">{token.symbol}</span>\n                      <span className=\"cedros-token-name\">{token.name}</span>\n                    </span>\n                    {selectedToken?.mint === token.mint && (\n                      <span className=\"cedros-token-check\"></span>\n                    )}\n                  </button>\n                ))}\n              </>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","import type { DepositConfigResponse, DepositTier } from '../../types/deposit';\n\n/**\n * Determine which tier an amount falls into\n *\n * When private deposits are disabled (recovery mode enabled), the 'private'\n * tier is not available and amounts that would qualify for it fall back to 'public'.\n */\nexport function getTierForAmount(usd: number, config: DepositConfigResponse): DepositTier {\n  // Skip private tier if recovery mode is enabled (privateDepositsEnabled is false)\n  if (config.privateDepositsEnabled && usd >= config.privateMinUsd) return 'private';\n  if (usd >= config.publicMinUsd) return 'public';\n  return 'sol_micro';\n}\n","export default \"data:image/webp;base64,UklGRkACAABXRUJQVlA4IDQCAACQDQCdASo8ADwAPjEWiUMiISEUBFQgAwSgB4Z/TeLt3XMAoQH23eph0gPMB+sn+M9tvngOsA9ADwgPg3/cH9sfZciikEBuA1AB+nf+84CUkAVvA2x4xvyobR+mBaYhjUv/ewHb4hTqOnP38rzsxZX2inOSciAA/v7uqvqGdpWcjjrfMDFaNHumTog38t3yor0kbjn631VsX61cAC749wWuAX74u/f/hpeDFqS/ci8E1g94wk9UVs7BHqtv7f/M9iT1u5ITJV0Gv6tE/CW5j/nVR6yExJ6JoDRDOWQ8zVpWH92r3Lnbnc4WJpOchbRT3H5rv//6PP+F//4ehLUlR/4tkRUKZu/yOa26+sywmY+Xc1X2lXMcUv7+eQ7+FBE7bhKc7htieBfH4eR134AVaILL7PWA2FjzAjfaP1Lgirqoq/ZooE8jVD/b4g3J3O3/TG/4ajHe6clnAI/4NdwrnHX0P/quBU03HqSsQ0qsEMAuhrH/jn+YtDzmjm8q/cGJ44qvi24Hn+G1kxz2XP2S/Gp7ri5cMlo+muuwBjyNJnnEcTt/5cRdYS2cbEBZtpINWj3PuC1EOsd/8cTepSpxODcJHLzktfC1PHW3Pgoh3J5PHjW3TCQ1Wlu/wP8e8OPfNm48BODGChioj3ezblqrOBV+cI+hLi7ReJdvBF/4jY+/Un0asuWnrA6kRNpgOeO8wyl4Ryhkrff+9R1SpyPYP+5T3EuWWLZaCn0bGzyk97S3VAAAAAA=\"","/**\n * Tiered amount input with deposit tier indicator\n *\n * Shows which deposit tier (private, public, sol_micro) applies\n * based on the entered USD amount. Displays tier-specific guidance\n * for privacy and processing expectations.\n */\n\nimport { useMemo } from 'react';\nimport type { DepositTier, DepositConfigResponse } from '../../types/deposit';\nimport { getTierForAmount } from './tierUtils';\nimport solLogo from '../../assets/tokens/sol.webp';\n\nexport interface TieredAmountSliderProps {\n  /** Deposit configuration with tier thresholds */\n  config: DepositConfigResponse;\n  /** Current amount in USD */\n  valueUsd: number;\n  /** Amount change handler */\n  onChange: (valueUsd: number) => void;\n  /** Cap in USD (default: 10000) */\n  maxUsd?: number;\n  /** Disabled state */\n  disabled?: boolean;\n  /** Additional CSS classes */\n  className?: string;\n}\n\nconst DEFAULT_MAX_USD = 10_000;\nconst SLIDER_STEPS = 1000;\nconst CURVE_POWER = 3;\n\nfunction formatUsd(value: number): string {\n  if (!Number.isFinite(value)) return '$0';\n  return `$${Math.round(value)}`;\n}\n\nfunction getTierInfo(tier: DepositTier, config: DepositConfigResponse) {\n  switch (tier) {\n    case 'private':\n      return {\n        label: 'Private',\n        detail: 'Private transaction, instant credit',\n        note: null,\n      };\n    case 'public':\n      return {\n        label: 'Public',\n        detail: 'Visible on-chain, instant credit',\n        note: null,\n      };\n    case 'sol_micro':\n      return {\n        label: 'SOL Only',\n        detail: `SOL only under ${formatUsd(config.solMicroMaxUsd)}`,\n        note: 'Small deposits must be sent in SOL and are visible on-chain. Increase the amount to use tokens.',\n      };\n  }\n}\n\nfunction clamp(value: number, min: number, max: number): number {\n  return Math.min(Math.max(value, min), max);\n}\n\nfunction usdToSlider(usd: number, maxUsd: number): number {\n  if (maxUsd <= 0) return 0;\n  const normalized = clamp(usd / maxUsd, 0, 1);\n  return Math.round(Math.pow(normalized, 1 / CURVE_POWER) * SLIDER_STEPS);\n}\n\nfunction sliderToUsd(position: number, maxUsd: number): number {\n  const normalized = clamp(position / SLIDER_STEPS, 0, 1);\n  return maxUsd * Math.pow(normalized, CURVE_POWER);\n}\n\nfunction getUsdStep(value: number): number {\n  if (value < 10) return 0.01;\n  if (value < 100) return 1;\n  if (value < 500) return 5;\n  if (value < 1000) return 10;\n  if (value < 5000) return 25;\n  return 50;\n}\n\nfunction getStepDecimals(step: number): number {\n  if (step < 1) return 2;\n  return 0;\n}\n\nfunction roundUsd(value: number): number {\n  const step = getUsdStep(value);\n  const rounded = Math.round(value / step) * step;\n  const decimals = getStepDecimals(step);\n  return Number(rounded.toFixed(decimals));\n}\n\n/**\n * Tiered amount input with deposit tier indicator\n */\nexport function TieredAmountSlider({\n  config,\n  valueUsd,\n  onChange,\n  maxUsd = DEFAULT_MAX_USD,\n  disabled = false,\n  className = '',\n}: TieredAmountSliderProps) {\n  const normalizedValue = clamp(Number.isFinite(valueUsd) ? valueUsd : 0, 0, maxUsd);\n  const tier = useMemo(() => getTierForAmount(normalizedValue, config), [normalizedValue, config]);\n  const tierInfo = getTierInfo(tier, config);\n  const sliderValue = usdToSlider(normalizedValue, maxUsd);\n  const sliderPercent = (sliderValue / SLIDER_STEPS) * 100;\n\n  return (\n    <div className={`cedros-tiered-slider ${className}`}>\n      <div className=\"cedros-tiered-slider-input-row\">\n        <div className=\"cedros-tiered-slider-input\">\n          <span className=\"cedros-tiered-slider-currency\">$</span>\n          <input\n            type=\"number\"\n            value={normalizedValue || ''}\n            onChange={(e) => onChange(roundUsd(parseFloat(e.target.value) || 0))}\n            placeholder=\"Enter amount\"\n            disabled={disabled}\n            min={0}\n            step={getUsdStep(normalizedValue)}\n            className=\"cedros-deposit-flow-input cedros-tiered-slider-input-field\"\n            aria-label=\"Deposit amount\"\n          />\n        </div>\n        <div className=\"cedros-tiered-slider-tier\">\n          <span className={`cedros-tiered-slider-badge cedros-tiered-slider-badge-${tier}`}>\n            {tier === 'sol_micro' && (\n              <img src={solLogo} alt=\"SOL\" className=\"cedros-tiered-slider-badge-icon\" />\n            )}\n            {tierInfo.label}\n          </span>\n          <span className=\"cedros-tiered-slider-tier-detail\">{tierInfo.detail}</span>\n        </div>\n      </div>\n\n      <input\n        type=\"range\"\n        min={0}\n        max={SLIDER_STEPS}\n        step={1}\n        value={sliderValue}\n        onChange={(e) => onChange(roundUsd(sliderToUsd(parseFloat(e.target.value), maxUsd)))}\n        className=\"cedros-tiered-slider-range\"\n        style={{\n          background: `linear-gradient(to right, var(--cedros-primary) 0%, var(--cedros-primary) ${sliderPercent}%, var(--cedros-border) ${sliderPercent}%, var(--cedros-border) 100%)`,\n        }}\n        disabled={disabled}\n        aria-label=\"Deposit amount slider\"\n      />\n\n      {tierInfo.note && <div className=\"cedros-tiered-slider-note\">{tierInfo.note}</div>}\n    </div>\n  );\n}\n","/**\n * Multi-step deposit flow component\n *\n * Provides a complete deposit wizard with configurable currency support:\n * - SOL only mode\n * - Single token mode (admin-configured token)\n * - Multi-token mode (user selects from allowed tokens)\n */\n\nimport { useState, useCallback, useEffect, useMemo } from 'react';\nimport { useDeposit } from '../../hooks/useDeposit';\nimport { useWallet } from '../../hooks/useWallet';\nimport { TokenSelector } from './TokenSelector';\nimport { TieredAmountSlider } from './TieredAmountSlider';\nimport { getTierForAmount } from './tierUtils';\nimport solLogo from '../../assets/tokens/sol.webp';\nimport { sanitizeExternalUrl } from '../../utils/sanitization';\nimport type { Token } from './tokens';\nimport type { DepositResponse, DepositConfigResponse } from '../../types/deposit';\n\n/** Check if any user-facing fee is enabled */\nfunction hasUserFee(config: DepositConfigResponse): boolean {\n  return (\n    config.companyFeePercent > 0 ||\n    config.feePolicy === 'user_pays_all' ||\n    config.feePolicy === 'user_pays_swap' ||\n    config.feePolicy === 'user_pays_privacy'\n  );\n}\n\n/** Calculate effective fee percentage based on config and deposit type */\nfunction getEffectiveFeePercent(\n  config: DepositConfigResponse,\n  isPrivate: boolean,\n  isMicro: boolean\n): number {\n  const { feePolicy, privacyFeePercent, swapFeePercent, companyFeePercent } = config;\n  let userFee = companyFeePercent;\n  if (isMicro) return userFee;\n  if (feePolicy === 'user_pays_all') {\n    userFee += swapFeePercent;\n    if (isPrivate) {\n      userFee += privacyFeePercent;\n    }\n  } else if (feePolicy === 'user_pays_privacy' && isPrivate) {\n    userFee += privacyFeePercent;\n  } else if (feePolicy === 'user_pays_swap') {\n    userFee += swapFeePercent;\n  }\n  return userFee;\n}\n\n/** Currency configuration mode */\nexport type CurrencyMode = 'sol' | 'single-token' | 'multi-token';\n\n/** Deposit method - how the user will deposit funds */\nexport type DepositMethod = 'sign' | 'receive';\n\n/** Flow step */\nexport type DepositFlowStep =\n  | 'explainer'\n  | 'unlock'\n  | 'confirm' // Sign mode: select token + enter amount + sign\n  | 'signing'\n  | 'show-address' // Receive mode: select token + show address, auto-detect amount\n  | 'waiting'\n  | 'success'\n  | 'error';\n\n/** Configuration for the optional explainer step */\nexport interface ExplainerConfig {\n  /** Custom title (default: \"How Deposits Work\") */\n  title?: string;\n  /** Custom body text (default explains Solana and suggests exchange) */\n  body?: string;\n  /** Exchange URL (default: \"https://www.coinbase.com\") */\n  exchangeUrl?: string;\n  /** Exchange name (default: \"Coinbase\") */\n  exchangeName?: string;\n  /** Whether to show the exchange suggestion (default: true) */\n  showExchangeSuggestion?: boolean;\n}\n\nexport interface DepositFlowProps {\n  /** Deposit configuration (required) */\n  config: DepositConfigResponse;\n  /**\n   * Currency mode determines what tokens users can deposit:\n   * - 'sol': SOL only (no token selection step)\n   * - 'single-token': Single admin-configured token (shows token info, no selection)\n   * - 'multi-token': User selects from available tokens\n   */\n  currencyMode: CurrencyMode;\n  /**\n   * Deposit method determines how the user deposits:\n   * - 'sign': User has a connected wallet and signs transactions (default for browser wallets)\n   * - 'receive': User sends from external source (exchange) to deposit address (embedded wallet)\n   *\n   * If not specified, auto-detects based on wallet status:\n   * - If user has external wallet connected  'sign'\n   * - If user has embedded wallet only  'receive'\n   */\n  depositMethod?: DepositMethod;\n  /**\n   * Available tokens for single-token or multi-token modes.\n   * For single-token mode, only the first token is used.\n   * Ignored in 'sol' mode.\n   */\n  tokens?: Token[];\n  /** Pre-selected token (for multi-token mode) */\n  defaultToken?: Token;\n  /** Minimum deposit amount (overrides server config) */\n  minAmount?: number;\n  /** Maximum deposit amount */\n  maxAmount?: number;\n  /** Callback on successful deposit */\n  onSuccess?: (result: DepositFlowResult) => void;\n  /** Callback on error */\n  onError?: (error: Error) => void;\n  /** Callback when user cancels */\n  onCancel?: () => void;\n  /** Callback to request wallet unlock */\n  onUnlockRequired?: () => void;\n  /**\n   * Callback to authorize deposit with password/PIN.\n   * This sends the password to the server to decrypt Share B for withdrawal signing.\n   * Returns the session ID for tracking the deposit.\n   *\n   * For sign mode: amount is the user-entered deposit amount\n   * For receive mode: amount is 0 (auto-detected when deposit arrives)\n   */\n  onAuthorize?: (\n    password: string,\n    amount: number | null,\n    token: Token\n  ) => Promise<{ sessionId: string; depositAddress: string }>;\n  /** Additional CSS classes */\n  className?: string;\n  /** Show step indicator */\n  showStepIndicator?: boolean;\n  /** Polling interval for checking deposit status in receive mode (ms, default: 5000) */\n  pollInterval?: number;\n  /** Demo mode - skips wallet checks for Storybook/testing (default: false) */\n  demoMode?: boolean;\n  /** Demo mode auto-confirm delay in ms (storybook only) */\n  demoAutoConfirmMs?: number;\n  /** USD price overrides for non-USD tokens (by symbol) */\n  tokenPriceUsd?: Record<string, number>;\n  /**\n   * Show an optional explainer step for non-crypto-native users.\n   * This explains Solana and suggests an exchange for purchasing.\n   * Admin-controlled setting (default: false)\n   */\n  showExplainer?: boolean;\n  /** Site name to display in explainer (e.g., \"Acme Inc\") */\n  siteName?: string;\n  /** Configuration for the explainer step content */\n  explainerConfig?: ExplainerConfig;\n}\n\nexport interface DepositFlowResult {\n  /** Selected token (null for SOL) */\n  token: Token | null;\n  /** Amount in token units */\n  amount: number;\n  /** Amount in lamports (for SOL) or smallest unit */\n  amountSmallestUnit: number;\n  /** Transaction signature (for sign mode) */\n  txSignature: string;\n  /** Session ID for tracking */\n  sessionId: string;\n  /** Deposit response from server */\n  response: DepositResponse;\n  /** Deposit method used */\n  method: DepositMethod;\n  /** Deposit address (for receive mode) */\n  depositAddress?: string;\n}\n\nconst LAMPORTS_PER_SOL = 1_000_000_000;\n\n/**\n * SOL token definition for SOL-only mode\n */\nconst SOL_TOKEN: Token = {\n  mint: 'So11111111111111111111111111111111111111112',\n  symbol: 'SOL',\n  name: 'Solana',\n  decimals: 9,\n  logoUrl: solLogo,\n};\n\nconst OTHER_TOKEN: Token = {\n  mint: 'other',\n  symbol: 'OTHER',\n  name: 'Other',\n  decimals: 6,\n};\n\nconst MAX_DEPOSIT_USD = 10_000;\n\ninterface FeeLineItem {\n  label: string;\n  solAmount: number;\n  percent: number;\n  usdAmount: number;\n}\n\nfunction calculateFeeLines(config: DepositConfigResponse, amountUsd: number): FeeLineItem[] {\n  const isMicro = amountUsd < config.publicMinUsd;\n  const isPrivate = amountUsd >= config.privateMinUsd;\n  const lines: FeeLineItem[] = [];\n\n  const privacyActive =\n    !isMicro &&\n    isPrivate &&\n    (config.feePolicy === 'user_pays_all' || config.feePolicy === 'user_pays_privacy') &&\n    (config.privacyFeeFixedLamports > 0 || config.privacyFeePercent > 0);\n  const swapActive =\n    !isMicro &&\n    (config.feePolicy === 'user_pays_all' || config.feePolicy === 'user_pays_swap') &&\n    (config.swapFeeFixedLamports > 0 || config.swapFeePercent > 0);\n  const companyActive = config.companyFeeFixedLamports > 0 || config.companyFeePercent > 0;\n\n  if (privacyActive) {\n    const solAmount = config.privacyFeeFixedLamports / LAMPORTS_PER_SOL;\n    const percent = config.privacyFeePercent;\n    const fixedUsd = solAmount * config.solPriceUsd;\n    const percentUsd = amountUsd * (percent / 100);\n    lines.push({ label: 'Privacy', solAmount, percent, usdAmount: fixedUsd + percentUsd });\n  }\n  if (swapActive) {\n    const solAmount = config.swapFeeFixedLamports / LAMPORTS_PER_SOL;\n    const percent = config.swapFeePercent;\n    const fixedUsd = solAmount * config.solPriceUsd;\n    const percentUsd = amountUsd * (percent / 100);\n    lines.push({ label: 'Swap', solAmount, percent, usdAmount: fixedUsd + percentUsd });\n  }\n  if (companyActive) {\n    const solAmount = config.companyFeeFixedLamports / LAMPORTS_PER_SOL;\n    const percent = config.companyFeePercent;\n    const fixedUsd = solAmount * config.solPriceUsd;\n    const percentUsd = amountUsd * (percent / 100);\n    lines.push({ label: 'Service', solAmount, percent, usdAmount: fixedUsd + percentUsd });\n  }\n\n  return lines;\n}\n\nfunction formatFeeTooltip(\n  config: DepositConfigResponse,\n  amountUsd: number,\n  totalFeeUsd: number\n): string {\n  const feeLines = calculateFeeLines(config, amountUsd);\n  const feeTotalDisplay = totalFeeUsd < 0.01 ? 0.01 : totalFeeUsd;\n\n  if (feeLines.length === 0) {\n    return `Total: $${feeTotalDisplay.toFixed(2)}`;\n  }\n\n  // Calculate totals\n  const totalSol = feeLines.reduce((sum, line) => sum + line.solAmount, 0);\n  const totalPercent = feeLines.reduce((sum, line) => sum + line.percent, 0);\n\n  // Format as a table with column dividers\n  // Fixed column widths for alignment (with padding space on each side)\n  const COL = { fee: 7, sol: 8, rate: 7, usd: 8 };\n\n  const formatLine = (item: FeeLineItem): string => {\n    const label = item.label.padEnd(COL.fee);\n    const sol = item.solAmount.toFixed(4).padStart(6).padEnd(COL.sol);\n    const pct = (item.percent.toFixed(2) + '%').padStart(5).padEnd(COL.rate);\n    const usd = ('$' + Math.max(item.usdAmount, 0.01).toFixed(2)).padEnd(COL.usd);\n    return `${label}  ${sol}  ${pct}  ${usd}`;\n  };\n\n  const header = `${'Fee'.padEnd(COL.fee)}  ${'SOL'.padEnd(COL.sol)}  ${'+ Rate'.padEnd(COL.rate)}  ${'= Total'.padEnd(COL.usd)}`;\n  const divider = `${''.repeat(COL.fee)}${''.repeat(COL.sol)}${''.repeat(COL.rate)}${''.repeat(COL.usd)}`;\n\n  const totalUsdStr = ('$' + feeTotalDisplay.toFixed(2)).padEnd(COL.usd);\n  const totalLine = `${'TOTAL'.padEnd(COL.fee)}  ${totalSol.toFixed(4).padStart(6).padEnd(COL.sol)}  ${(totalPercent.toFixed(2) + '%').padStart(5).padEnd(COL.rate)}  ${totalUsdStr}`;\n\n  const lines = [header, divider, ...feeLines.map(formatLine), divider, totalLine];\n  return lines.join('\\n');\n}\n\nfunction formatExplainerFeeSummary(config: DepositConfigResponse): string {\n  const feeLabels: string[] = [];\n  const hasPrivacyFee = config.privacyFeeFixedLamports > 0 || config.privacyFeePercent > 0;\n  const hasSwapFee = config.swapFeeFixedLamports > 0 || config.swapFeePercent > 0;\n  const hasCompanyFee = config.companyFeeFixedLamports > 0 || config.companyFeePercent > 0;\n\n  if (hasPrivacyFee) feeLabels.push('Privacy Cash fee');\n  if (hasSwapFee) feeLabels.push('swap fee');\n  if (hasCompanyFee) feeLabels.push('company service fee');\n\n  if (feeLabels.length === 0) {\n    return 'No processing fees apply to deposits.';\n  }\n\n  return \"A small fee may apply. We'll show exact totals before you confirm.\";\n}\n\nfunction getTotalFeeUsd(config: DepositConfigResponse, amountUsd: number): number {\n  if (amountUsd <= 0) return 0;\n  const isMicro = amountUsd < config.publicMinUsd;\n  const isPrivate = amountUsd >= config.privateMinUsd;\n  const feePercent = getEffectiveFeePercent(config, isPrivate, isMicro);\n  let userFixedLamports = config.companyFeeFixedLamports;\n  if (!isMicro) {\n    if (\n      isPrivate &&\n      (config.feePolicy === 'user_pays_all' || config.feePolicy === 'user_pays_privacy')\n    ) {\n      userFixedLamports += config.privacyFeeFixedLamports;\n    }\n    if (config.feePolicy === 'user_pays_all' || config.feePolicy === 'user_pays_swap') {\n      userFixedLamports += config.swapFeeFixedLamports;\n    }\n  }\n  const fixedFeeUsd = (userFixedLamports / LAMPORTS_PER_SOL) * config.solPriceUsd;\n  const percentFeeUsd = amountUsd * (feePercent / 100);\n  return fixedFeeUsd + percentFeeUsd;\n}\n\nfunction getPurchaseCurrencyLabel(\n  currencyMode: CurrencyMode,\n  token: Token,\n  tokens: Token[]\n): string {\n  if (currencyMode === 'sol') {\n    return 'SOL';\n  }\n  if (currencyMode === 'single-token') {\n    return token.symbol;\n  }\n  const hasUsdc = tokens.some((supported) => supported.symbol === 'USDC');\n  return hasUsdc ? 'SOL or USDC' : 'SOL or supported tokens';\n}\n\nfunction normalizeTokenSymbols(symbols: string[]): string[] {\n  return symbols.map((symbol) => symbol.trim()).filter(Boolean);\n}\n\nconst USD_STABLE_TOKENS = new Set(['USDC', 'USDT', 'USD1', 'PYUSD', 'USDH', 'CASH']);\n\nfunction getTokenUsdPrice(\n  token: Token,\n  config: DepositConfigResponse,\n  priceOverrides?: Record<string, number>\n): number | null {\n  // USD stablecoins are always $1\n  if (USD_STABLE_TOKENS.has(token.symbol)) return 1;\n\n  // Check server-provided token prices first (includes SOL, BONK, ORE, EURC)\n  const serverPrice = config.tokenPrices?.[token.symbol];\n  if (serverPrice && serverPrice > 0) return serverPrice;\n\n  // Fallback to SOL price for backwards compatibility\n  if (token.symbol === 'SOL') return config.solPriceUsd || null;\n\n  // Check prop overrides for custom tokens\n  const override = priceOverrides?.[token.symbol];\n  if (override && override > 0) return override;\n\n  return null;\n}\n\nfunction formatTokenAmount(amount: number, symbol: string): string {\n  const decimals = USD_STABLE_TOKENS.has(symbol) ? 2 : 4;\n  return amount.toFixed(decimals);\n}\n\n/**\n * Multi-step deposit flow component\n */\nexport function DepositFlow({\n  config,\n  currencyMode,\n  depositMethod: depositMethodProp,\n  tokens = [],\n  defaultToken,\n  minAmount,\n  maxAmount = 10000,\n  onSuccess,\n  onError,\n  onCancel,\n  onUnlockRequired,\n  onAuthorize,\n  className = '',\n  showStepIndicator = true,\n  pollInterval = 5000,\n  demoMode = false,\n  demoAutoConfirmMs,\n  tokenPriceUsd,\n  showExplainer = false,\n  siteName,\n  explainerConfig,\n}: DepositFlowProps) {\n  const { deposit, getStatus, error: depositError, clearError } = useDeposit();\n  const wallet = useWallet();\n  const quickActionSymbols = normalizeTokenSymbols(config.quickActionTokens);\n  const customTokenSymbols = normalizeTokenSymbols(config.customTokenSymbols);\n  // Merge preset tokens with admin-configured custom tokens\n  const mergedTokens = useMemo(() => {\n    const customDefs = config.customTokens ?? [];\n    if (customDefs.length === 0) return tokens;\n\n    // Build set of existing symbols for deduplication\n    const seen = new Set(tokens.map((t) => t.symbol));\n    const merged = [...tokens];\n\n    // Add custom tokens that don't conflict with presets\n    for (const def of customDefs) {\n      if (!seen.has(def.symbol)) {\n        merged.push({\n          mint: def.mint,\n          symbol: def.symbol,\n          name: def.symbol, // Use symbol as name for custom tokens\n          decimals: def.decimals,\n          logoUrl: def.logoUrl,\n        });\n        seen.add(def.symbol);\n      }\n    }\n    return merged;\n  }, [tokens, config.customTokens]);\n\n  // Filter merged tokens based on customTokenSymbols setting\n  const customListTokens = useMemo(() => {\n    if (customTokenSymbols.length === 0) return mergedTokens;\n    const filtered = mergedTokens.filter((token) => customTokenSymbols.includes(token.symbol));\n    return filtered.length > 0 ? filtered : mergedTokens;\n  }, [mergedTokens, customTokenSymbols]);\n\n  // Auto-detect deposit method if not specified\n  // - Sign mode requires private deposits enabled (server-side signing via SSS)\n  // - If private deposits disabled (recovery mode enabled), force receive mode\n  // - If user has external wallet (browser extension)  sign mode (if allowed)\n  // - If user has embedded wallet only  receive mode\n  const canUseSignMode = config.privateDepositsEnabled;\n  const depositMethod: DepositMethod = depositMethodProp\n    ? depositMethodProp === 'sign' && !canUseSignMode\n      ? 'receive'\n      : depositMethodProp\n    : canUseSignMode && wallet.hasExternalWallet\n      ? 'sign'\n      : 'receive';\n\n  // Determine effective token based on mode\n  // Priority: defaultToken > first quick action token > USDC > first non-SOL > first token > SOL\n  const firstQuickActionToken = quickActionSymbols[0]\n    ? mergedTokens.find((t) => t.symbol === quickActionSymbols[0])\n    : undefined;\n  const effectiveToken =\n    currencyMode === 'sol'\n      ? SOL_TOKEN\n      : currencyMode === 'single-token'\n        ? (firstQuickActionToken ??\n          mergedTokens.find((t) => t.symbol === 'USDC') ??\n          mergedTokens[0] ??\n          SOL_TOKEN)\n        : (defaultToken ??\n          firstQuickActionToken ??\n          mergedTokens.find((candidate) => candidate.symbol === 'USDC') ??\n          mergedTokens.find((candidate) => candidate.symbol !== 'SOL') ??\n          mergedTokens[0] ??\n          SOL_TOKEN);\n\n  // Determine the first step based on configuration\n  const getFirstStep = useCallback((): DepositFlowStep => {\n    if (showExplainer) return 'explainer';\n    return 'unlock';\n  }, [showExplainer]);\n\n  // State\n  const [step, setStep] = useState<DepositFlowStep>(getFirstStep);\n  const [selectedToken, setSelectedToken] = useState<Token>(effectiveToken);\n  const [amount, setAmount] = useState<string>('');\n  const [result, setResult] = useState<DepositFlowResult | null>(null);\n  const [flowError, setFlowError] = useState<string | null>(null);\n  const [sessionId, setSessionId] = useState<string | null>(null);\n  const [depositAddress, setDepositAddress] = useState<string | null>(null);\n  const [copied, setCopied] = useState(false);\n  const [isAuthorizing, setIsAuthorizing] = useState(false);\n  const [receiveAmountUsd, setReceiveAmountUsd] = useState<number | null>(null);\n\n  // Reset flow when currencyMode or depositMethod changes\n  useEffect(() => {\n    setStep(getFirstStep());\n    setSelectedToken(effectiveToken);\n    setAmount('');\n    setResult(null);\n    setFlowError(null);\n    setSessionId(null);\n    setDepositAddress(null);\n    setCopied(false);\n    setIsAuthorizing(false);\n    setReceiveAmountUsd(null);\n    clearError();\n  }, [currencyMode, depositMethod, effectiveToken, clearError, getFirstStep]);\n\n  const effectiveMin = minAmount ?? config.privateMinSol;\n  const effectiveMax = maxAmount;\n\n  // Parse amount (used by handleDeposit for sign mode)\n  const parsedAmount = parseFloat(amount);\n\n  // Wallet status\n  const isEnrolled =\n    wallet.status === 'enrolled_locked' ||\n    wallet.status === 'enrolled_unlocked' ||\n    wallet.status === 'unlocked';\n  const walletReady = isEnrolled && wallet.isUnlocked;\n  const needsUnlock = isEnrolled && !wallet.isUnlocked;\n\n  // Get steps based on mode and deposit method\n  const getSteps = useCallback((): { key: DepositFlowStep; label: string }[] => {\n    // Sign mode: authorize  select token + enter amount & sign  complete\n    const signSteps = [\n      { key: 'unlock' as const, label: 'Authorize' },\n      { key: 'confirm' as const, label: 'Send' },\n      { key: 'signing' as const, label: 'Signing' },\n      { key: 'success' as const, label: 'Complete' },\n    ];\n\n    // Receive mode: authorize  select token + show address  auto-detect deposit  complete\n    const receiveSteps = [\n      { key: 'unlock' as const, label: 'Authorize' },\n      { key: 'show-address' as const, label: 'Send' },\n      { key: 'waiting' as const, label: 'Confirming' },\n      { key: 'success' as const, label: 'Complete' },\n    ];\n\n    let steps: { key: DepositFlowStep; label: string }[] =\n      depositMethod === 'sign' ? signSteps : receiveSteps;\n\n    if (showExplainer) {\n      steps = [{ key: 'explainer', label: 'Info' }, ...steps];\n    }\n\n    return steps;\n  }, [depositMethod, showExplainer]);\n\n  const steps = getSteps();\n  const currentStepIndex = steps.findIndex((s) => s.key === step);\n\n  // Handle token selection\n  const handleTokenSelect = useCallback((token: Token) => {\n    setSelectedToken(token);\n  }, []);\n\n  // Handle authorization (password submission to decrypt Share B on server)\n  const handleAuthorize = useCallback(\n    async (password: string) => {\n      if (!onAuthorize) {\n        // If no onAuthorize callback, skip to next step\n        setStep(depositMethod === 'sign' ? 'confirm' : 'show-address');\n        return;\n      }\n\n      setIsAuthorizing(true);\n      setFlowError(null);\n\n      try {\n        // For receive mode, amount is null (auto-detected when deposit arrives)\n        const authorizeAmount = depositMethod === 'sign' ? parsedAmount : null;\n        const result = await onAuthorize(password, authorizeAmount, selectedToken);\n        setSessionId(result.sessionId);\n        setDepositAddress(result.depositAddress);\n        setStep(depositMethod === 'sign' ? 'confirm' : 'show-address');\n      } catch (err) {\n        const error = err instanceof Error ? err : new Error('Authorization failed');\n        setFlowError(error.message);\n      } finally {\n        setIsAuthorizing(false);\n      }\n    },\n    [onAuthorize, depositMethod, parsedAmount, selectedToken]\n  );\n\n  // Handle deposit submission (sign mode)\n  const handleDeposit = useCallback(\n    async (depositAmount?: number, depositToken?: Token) => {\n      clearError();\n      setFlowError(null);\n      setStep('signing');\n\n      const finalAmount = depositAmount ?? parsedAmount;\n      const finalToken = depositToken ?? selectedToken;\n\n      // Skip wallet checks in demo mode\n      if (!demoMode) {\n        if (needsUnlock && onUnlockRequired) {\n          onUnlockRequired();\n          setStep('confirm');\n          return;\n        }\n\n        if (!walletReady) {\n          setFlowError('Wallet not ready');\n          setStep('error');\n          return;\n        }\n      }\n\n      try {\n        // Convert amount to smallest unit\n        const smallestUnit = Math.floor(finalAmount * Math.pow(10, finalToken.decimals));\n\n        // Demo mode: simulate signing delay and success\n        if (demoMode) {\n          await new Promise((resolve) => setTimeout(resolve, 1500));\n          const flowResult: DepositFlowResult = {\n            token: currencyMode === 'sol' ? null : finalToken,\n            amount: finalAmount,\n            amountSmallestUnit: smallestUnit,\n            txSignature: `demo-tx-${Date.now()}`,\n            sessionId: sessionId || `demo-session-${Date.now()}`,\n            response: {\n              sessionId: sessionId || `demo-session-${Date.now()}`,\n              txSignature: `demo-tx-${Date.now()}`,\n              amountLamports: smallestUnit,\n              message: 'Demo deposit successful',\n              withdrawalAvailableAt: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(),\n            },\n            method: 'sign',\n          };\n          setResult(flowResult);\n          setStep('success');\n          onSuccess?.(flowResult);\n          return;\n        }\n\n        // For now, deposit API only supports SOL (lamports)\n        // Token deposits would need Jupiter swap integration\n        const response = await deposit(smallestUnit);\n\n        const flowResult: DepositFlowResult = {\n          token: currencyMode === 'sol' ? null : finalToken,\n          amount: finalAmount,\n          amountSmallestUnit: smallestUnit,\n          txSignature: response.txSignature,\n          sessionId: response.sessionId,\n          response,\n          method: 'sign',\n        };\n\n        setResult(flowResult);\n        setStep('success');\n        onSuccess?.(flowResult);\n      } catch (err) {\n        const error = err instanceof Error ? err : new Error('Deposit failed');\n        setFlowError(error.message);\n        setStep('error');\n        onError?.(error);\n      }\n    },\n    [\n      deposit,\n      parsedAmount,\n      selectedToken,\n      currencyMode,\n      demoMode,\n      sessionId,\n      walletReady,\n      needsUnlock,\n      onUnlockRequired,\n      onSuccess,\n      onError,\n      clearError,\n    ]\n  );\n\n  // Handle \"I've sent it\" button - start polling\n  const handleSentDeposit = useCallback(() => {\n    setStep('waiting');\n  }, []);\n\n  // Copy address to clipboard\n  const handleCopyAddress = useCallback(async () => {\n    const address = depositAddress || wallet.solanaPubkey;\n    if (address) {\n      try {\n        await navigator.clipboard.writeText(address);\n        setCopied(true);\n        setTimeout(() => setCopied(false), 2000);\n      } catch {\n        // Fallback for older browsers\n        const textArea = document.createElement('textarea');\n        textArea.value = address;\n        document.body.appendChild(textArea);\n        textArea.select();\n        document.execCommand('copy');\n        document.body.removeChild(textArea);\n        setCopied(true);\n        setTimeout(() => setCopied(false), 2000);\n      }\n    }\n  }, [depositAddress, wallet.solanaPubkey]);\n\n  // Poll for deposit status as soon as we show the address (don't wait for \"I've sent it\")\n  // This enables auto-detection: if user sends deposit, we detect it and skip to success\n  useEffect(() => {\n    // Start polling when showing deposit address (confirm step in sign mode, show-address/waiting in receive mode)\n    // Skip in demo mode - user must click \"I've sent it\" to proceed\n    const isListeningStep = step === 'confirm' || step === 'show-address' || step === 'waiting';\n    if (!isListeningStep || !sessionId || demoMode) return;\n\n    let cancelled = false;\n    let pollCount = 0;\n    const maxPolls = 360; // 30 minutes at 5s interval (user may take time to send from exchange)\n\n    const poll = async () => {\n      if (cancelled || pollCount >= maxPolls) return;\n      pollCount++;\n\n      try {\n        // Check for deposit status from server\n        // Server auto-detects incoming deposits and returns the amount\n        const status = await getStatus(sessionId);\n\n        if (status.status === 'completed' || status.status === 'detected') {\n          // Get the actual deposited amount from the server response\n          const detectedAmount = status.amountLamports\n            ? status.amountLamports / Math.pow(10, selectedToken.decimals)\n            : 0;\n          const smallestUnit = status.amountLamports || 0;\n\n          const flowResult: DepositFlowResult = {\n            token: currencyMode === 'sol' ? null : selectedToken,\n            amount: detectedAmount,\n            amountSmallestUnit: smallestUnit,\n            txSignature: status.txSignature || '',\n            sessionId: sessionId,\n            response: status as unknown as DepositResponse,\n            method: 'receive',\n            depositAddress: wallet.solanaPubkey ?? undefined,\n          };\n\n          setResult(flowResult);\n          setStep('success');\n          onSuccess?.(flowResult);\n          return;\n        }\n      } catch {\n        // Continue polling on error\n      }\n\n      if (!cancelled) {\n        setTimeout(poll, pollInterval);\n      }\n    };\n\n    poll();\n\n    return () => {\n      cancelled = true;\n    };\n  }, [\n    step,\n    sessionId,\n    demoMode,\n    getStatus,\n    selectedToken,\n    currencyMode,\n    wallet.solanaPubkey,\n    onSuccess,\n    pollInterval,\n  ]);\n\n  useEffect(() => {\n    if (!demoMode || !demoAutoConfirmMs || step !== 'waiting' || depositMethod !== 'receive')\n      return;\n    if (!depositAddress) return;\n\n    const timeout = window.setTimeout(() => {\n      const amountUsd = receiveAmountUsd ?? config.privateMinUsd;\n      const tokenAmount =\n        selectedToken.symbol === 'SOL' && config.solPriceUsd > 0\n          ? amountUsd / config.solPriceUsd\n          : amountUsd;\n      const smallestUnit = Math.floor(tokenAmount * Math.pow(10, selectedToken.decimals));\n      const flowResult: DepositFlowResult = {\n        token: currencyMode === 'sol' ? null : selectedToken,\n        amount: tokenAmount,\n        amountSmallestUnit: smallestUnit,\n        txSignature: `demo-tx-${Date.now()}`,\n        sessionId: sessionId || `demo-session-${Date.now()}`,\n        response: {\n          sessionId: sessionId || `demo-session-${Date.now()}`,\n          txSignature: `demo-tx-${Date.now()}`,\n          amountLamports: smallestUnit,\n          message: 'Demo deposit detected',\n          withdrawalAvailableAt: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(),\n        },\n        method: 'receive',\n        depositAddress: depositAddress ?? undefined,\n      };\n      setResult(flowResult);\n      setStep('success');\n      onSuccess?.(flowResult);\n    }, demoAutoConfirmMs);\n\n    return () => window.clearTimeout(timeout);\n  }, [\n    demoMode,\n    demoAutoConfirmMs,\n    step,\n    depositMethod,\n    depositAddress,\n    receiveAmountUsd,\n    config,\n    selectedToken,\n    currencyMode,\n    sessionId,\n    onSuccess,\n  ]);\n\n  // Reset flow\n  const handleReset = useCallback(() => {\n    setStep(getFirstStep());\n    setAmount('');\n    setResult(null);\n    setFlowError(null);\n    clearError();\n  }, [getFirstStep, clearError]);\n\n  // Deposits disabled\n  if (!config.enabled) {\n    return (\n      <div className={`cedros-deposit-flow cedros-deposit-flow-disabled ${className}`}>\n        <p>Deposits are not currently available.</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`cedros-deposit-flow ${className}`}>\n      {/* Step Indicator */}\n      {showStepIndicator && step !== 'error' && (\n        <div className=\"cedros-deposit-flow-steps\">\n          {steps.map((s, idx) => {\n            const isActive = currentStepIndex >= idx;\n            const isCurrent = s.key === step;\n            return (\n              <div\n                key={s.key}\n                className={`cedros-deposit-flow-step-item ${isActive ? 'step-active' : ''}`}\n              >\n                <div\n                  className={`cedros-deposit-flow-step-circle ${isActive ? 'active' : ''} ${isCurrent ? 'current' : ''}`}\n                >\n                  {idx + 1}\n                </div>\n                <span className={`cedros-deposit-flow-step-label ${isActive ? 'active' : ''}`}>\n                  {s.label}\n                </span>\n              </div>\n            );\n          })}\n        </div>\n      )}\n\n      {/* Step Content */}\n      <div className=\"cedros-deposit-flow-content\">\n        {step === 'explainer' && (\n          <ExplainerStep\n            siteName={siteName}\n            config={explainerConfig}\n            depositConfig={config}\n            currencyMode={currencyMode}\n            token={selectedToken}\n            tokens={customListTokens}\n            onContinue={() => setStep('unlock')}\n            onCancel={onCancel}\n          />\n        )}\n\n        {step === 'unlock' && (\n          <UnlockStep\n            token={selectedToken}\n            tokens={customListTokens}\n            currencyMode={currencyMode}\n            depositMethod={depositMethod}\n            isAuthorizing={isAuthorizing}\n            error={flowError}\n            onAuthorize={handleAuthorize}\n            onBack={showExplainer ? () => setStep('explainer') : undefined}\n            onCancel={onCancel}\n          />\n        )}\n\n        {/* Sign mode steps */}\n        {step === 'confirm' && depositMethod === 'sign' && (\n          <ConfirmStep\n            token={selectedToken}\n            tokens={mergedTokens}\n            quickActionSymbols={quickActionSymbols}\n            customTokenSymbols={customTokenSymbols}\n            currencyMode={currencyMode}\n            minAmount={effectiveMin}\n            maxAmount={effectiveMax}\n            depositAddress={depositAddress || wallet.solanaPubkey}\n            walletReady={walletReady || demoMode}\n            needsUnlock={needsUnlock && !demoMode}\n            copied={copied}\n            isListening={!!sessionId && !demoMode}\n            config={config}\n            onCopy={handleCopyAddress}\n            onTokenSelect={handleTokenSelect}\n            onUnlockRequired={onUnlockRequired}\n            onConfirm={(amt, tkn) => handleDeposit(amt, tkn)}\n            onBack={() => setStep('unlock')}\n            onCancel={onCancel}\n          />\n        )}\n\n        {step === 'signing' && <SigningStep depositAddress={wallet.solanaPubkey} />}\n\n        {/* Receive mode steps */}\n        {step === 'show-address' && (\n          <ShowAddressStep\n            token={selectedToken}\n            tokens={mergedTokens}\n            quickActionSymbols={quickActionSymbols}\n            customTokenSymbols={customTokenSymbols}\n            tokenPriceUsd={tokenPriceUsd}\n            currencyMode={currencyMode}\n            depositAddress={depositAddress || wallet.solanaPubkey}\n            copied={copied}\n            isListening={!!sessionId && !demoMode}\n            config={config}\n            onCopy={handleCopyAddress}\n            onTokenSelect={handleTokenSelect}\n            onAmountChange={setReceiveAmountUsd}\n            onSent={handleSentDeposit}\n            onBack={() => setStep('unlock')}\n            onCancel={onCancel}\n          />\n        )}\n\n        {step === 'waiting' && (\n          <WaitingStep\n            token={selectedToken}\n            depositAddress={depositAddress || wallet.solanaPubkey}\n            copied={copied}\n            feeLine={\n              receiveAmountUsd\n                ? `Fees: $${Math.max(getTotalFeeUsd(config, receiveAmountUsd), 0.01).toFixed(2)} total`\n                : 'Fees: calculated after deposit'\n            }\n            onCopy={handleCopyAddress}\n          />\n        )}\n\n        {step === 'success' && result && (\n          <SuccessStep result={result} config={config} onNewDeposit={handleReset} />\n        )}\n\n        {step === 'error' && (\n          <ErrorStep\n            error={flowError || depositError || 'An error occurred'}\n            onRetry={() => setStep('confirm')}\n            onCancel={onCancel}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n\n// =============================================================================\n// STEP COMPONENTS\n// =============================================================================\n\ninterface ExplainerStepProps {\n  siteName?: string;\n  config?: ExplainerConfig;\n  depositConfig: DepositConfigResponse;\n  currencyMode: CurrencyMode;\n  token: Token;\n  tokens: Token[];\n  onContinue: () => void;\n  onCancel?: () => void;\n}\n\nfunction ExplainerStep({\n  siteName,\n  config,\n  depositConfig,\n  currencyMode,\n  token,\n  tokens,\n  onContinue,\n  onCancel,\n}: ExplainerStepProps) {\n  const title = config?.title ?? 'How Deposits Work';\n  const exchangeName = config?.exchangeName ?? 'Coinbase';\n  const exchangeUrl = sanitizeExternalUrl(config?.exchangeUrl) ?? 'https://www.coinbase.com';\n  const showExchange = config?.showExchangeSuggestion !== false;\n  const purchaseCurrencyLabel = getPurchaseCurrencyLabel(currencyMode, token, tokens);\n\n  const defaultBody = siteName\n    ? `${siteName} uses the Solana blockchain to process secure, private payments.`\n    : 'This site uses the Solana blockchain to process secure, private payments.';\n\n  const body = config?.body ?? defaultBody;\n\n  // Calculate fee info for display\n  const showUserFee = hasUserFee(depositConfig);\n  const feeDescription = formatExplainerFeeSummary(depositConfig);\n\n  return (\n    <div className=\"cedros-deposit-flow-step\">\n      <h4 className=\"cedros-deposit-flow-step-title\">{title}</h4>\n      <p className=\"cedros-deposit-flow-step-desc\">{body}</p>\n\n      <div className=\"cedros-deposit-flow-explainer-content\">\n        <div className=\"cedros-deposit-flow-explainer-item\">\n          <span className=\"cedros-deposit-flow-explainer-icon cedros-deposit-flow-icon-shield\" />\n          <div>\n            <strong>Private & Secure</strong>\n            <p>Your deposits are protected by cryptographic privacy technology.</p>\n          </div>\n        </div>\n        <div className=\"cedros-deposit-flow-explainer-item\">\n          <span className=\"cedros-deposit-flow-explainer-icon cedros-deposit-flow-icon-bolt\" />\n          <div>\n            <strong>Fast Transactions</strong>\n            <p>Solana transactions confirm in seconds, not minutes.</p>\n          </div>\n        </div>\n        <div className=\"cedros-deposit-flow-explainer-item\">\n          <span className=\"cedros-deposit-flow-explainer-icon cedros-deposit-flow-icon-coin\" />\n          <div>\n            <strong>{showUserFee ? 'Transparent Fees' : 'Low Fees'}</strong>\n            <p>{feeDescription}</p>\n          </div>\n        </div>\n      </div>\n\n      {showExchange && (\n        <div className=\"cedros-deposit-flow-explainer-exchange\">\n          <p className=\"cedros-deposit-flow-explainer-exchange-text\">\n            <strong>New to Solana?</strong> You can purchase {purchaseCurrencyLabel} using your\n            credit card at{' '}\n            <a href={exchangeUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n              {exchangeName}\n            </a>\n            , then send it here to fund your account.\n          </p>\n        </div>\n      )}\n\n      <div className=\"cedros-deposit-flow-actions\">\n        {onCancel && (\n          <button\n            type=\"button\"\n            className=\"cedros-deposit-flow-button cedros-deposit-flow-button-secondary\"\n            onClick={onCancel}\n          >\n            Cancel\n          </button>\n        )}\n        <button\n          type=\"button\"\n          className=\"cedros-deposit-flow-button cedros-deposit-flow-button-primary\"\n          onClick={onContinue}\n        >\n          Continue\n        </button>\n      </div>\n    </div>\n  );\n}\n\ninterface UnlockStepProps {\n  token: Token;\n  tokens: Token[];\n  currencyMode: CurrencyMode;\n  depositMethod: DepositMethod;\n  isAuthorizing: boolean;\n  error: string | null;\n  onAuthorize: (password: string) => void;\n  onBack?: () => void;\n  onCancel?: () => void;\n}\n\nfunction UnlockStep({\n  token,\n  tokens,\n  currencyMode,\n  depositMethod,\n  isAuthorizing,\n  error,\n  onAuthorize,\n  onBack,\n}: UnlockStepProps) {\n  const [password, setPassword] = useState('');\n  const purchaseCurrencyLabel = getPurchaseCurrencyLabel(currencyMode, token, tokens);\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (password.trim()) {\n      onAuthorize(password);\n    }\n  };\n\n  return (\n    <div className=\"cedros-deposit-flow-step\">\n      <h4 className=\"cedros-deposit-flow-step-title\">Authorize Deposit</h4>\n      <p className=\"cedros-deposit-flow-step-desc\">\n        {depositMethod === 'sign'\n          ? currencyMode === 'multi-token'\n            ? 'Enter your password to authorize a deposit. This allows us to process your withdrawal when the privacy period ends.'\n            : `Enter your password to authorize a ${purchaseCurrencyLabel} deposit. This allows us to process your withdrawal when the privacy period ends.`\n          : currencyMode === 'multi-token'\n            ? 'Enter your password to get your deposit address. Any supported token sent to this address will be credited to your account.'\n            : `Enter your password to get your deposit address. Any ${purchaseCurrencyLabel} sent to this address will be credited to your account.`}\n      </p>\n\n      <form onSubmit={handleSubmit}>\n        <div className=\"cedros-deposit-flow-field\">\n          <label className=\"cedros-deposit-flow-label\" htmlFor=\"deposit-password\">\n            Password\n          </label>\n          <input\n            id=\"deposit-password\"\n            type=\"password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            className=\"cedros-deposit-flow-input\"\n            placeholder=\"Enter your password\"\n            disabled={isAuthorizing}\n            autoComplete=\"current-password\"\n          />\n        </div>\n\n        {error && <p className=\"cedros-deposit-flow-error\">{error}</p>}\n\n        <div className=\"cedros-deposit-flow-actions\">\n          <button\n            type=\"button\"\n            className=\"cedros-deposit-flow-button cedros-deposit-flow-button-secondary\"\n            onClick={onBack}\n            disabled={isAuthorizing}\n          >\n            Back\n          </button>\n          <button\n            type=\"submit\"\n            className=\"cedros-deposit-flow-button cedros-deposit-flow-button-primary\"\n            disabled={!password.trim() || isAuthorizing}\n          >\n            {isAuthorizing ? 'Authorizing...' : 'Continue'}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n\ninterface ConfirmStepProps {\n  token: Token;\n  tokens: Token[];\n  quickActionSymbols: string[];\n  customTokenSymbols: string[];\n  currencyMode: CurrencyMode;\n  minAmount: number;\n  maxAmount: number;\n  depositAddress: string | null;\n  walletReady: boolean;\n  needsUnlock: boolean;\n  copied: boolean;\n  isListening: boolean;\n  config: DepositConfigResponse;\n  onCopy: () => void;\n  onTokenSelect: (token: Token) => void;\n  onUnlockRequired?: () => void;\n  onConfirm: (amount: number, token: Token) => void;\n  onBack: () => void;\n  onCancel?: () => void;\n}\n\nfunction ConfirmStep({\n  token,\n  tokens,\n  quickActionSymbols,\n  customTokenSymbols,\n  currencyMode,\n  minAmount,\n  maxAmount,\n  depositAddress,\n  walletReady,\n  needsUnlock,\n  copied,\n  isListening,\n  config,\n  onCopy,\n  onTokenSelect,\n  onUnlockRequired,\n  onConfirm,\n  onBack,\n}: ConfirmStepProps) {\n  const [amountUsd, setAmountUsd] = useState(config.privateMinUsd);\n  const [showCustomToken, setShowCustomToken] = useState(false);\n  const [feeTooltipOpen, setFeeTooltipOpen] = useState(false);\n  const [customOpenSignal, setCustomOpenSignal] = useState(0);\n  // Track the token selected before auto-switching to SOL for micro tier\n  const [preMicroToken, setPreMicroToken] = useState<Token | null>(null);\n  const tier = getTierForAmount(amountUsd, config);\n  const isMicroTier = tier === 'sol_micro';\n  const isOtherToken = token.symbol === OTHER_TOKEN.symbol;\n  const customTokens = useMemo(() => {\n    const baseTokens =\n      customTokenSymbols.length === 0\n        ? tokens\n        : tokens.filter((candidate) => customTokenSymbols.includes(candidate.symbol));\n    const resolved = baseTokens.length > 0 ? baseTokens : tokens;\n    const hasOther = resolved.some((candidate) => candidate.symbol === OTHER_TOKEN.symbol);\n    return hasOther ? resolved : [...resolved, OTHER_TOKEN];\n  }, [tokens, customTokenSymbols]);\n  const totalFeeUsd = getTotalFeeUsd(config, amountUsd);\n  const feeTotalDisplay = totalFeeUsd < 0.01 ? 0.01 : totalFeeUsd;\n  const feeLine = isOtherToken\n    ? 'Fees: calculated after deposit'\n    : `Fees: $${feeTotalDisplay.toFixed(2)} total`;\n  const feeTooltip = isOtherToken ? '' : formatFeeTooltip(config, amountUsd, totalFeeUsd);\n\n  const tokenUsdPrice = getTokenUsdPrice(isMicroTier ? SOL_TOKEN : token, config);\n  const tokenAmount = tokenUsdPrice\n    ? amountUsd / tokenUsdPrice\n    : token.symbol === 'SOL' && config.solPriceUsd > 0\n      ? amountUsd / config.solPriceUsd\n      : amountUsd;\n  const sendAmountLabel = tokenAmount\n    ? formatTokenAmount(tokenAmount, isMicroTier ? 'SOL' : token.symbol)\n    : null;\n\n  // Check if fees exceed the deposit amount (effective minimum)\n  const netAmountUsd = amountUsd - totalFeeUsd;\n  const feesExceedAmount = netAmountUsd <= 0 && amountUsd > 0;\n\n  const isValidAmount =\n    !isOtherToken &&\n    amountUsd > 0 &&\n    !feesExceedAmount &&\n    tokenAmount >= minAmount &&\n    tokenAmount <= maxAmount;\n\n  // Auto-select SOL for micro tier, restore previous token when leaving micro tier\n  useEffect(() => {\n    if (currencyMode !== 'multi-token') return;\n\n    if (isMicroTier && token.symbol !== 'SOL') {\n      // Entering micro tier with non-SOL token: save it and switch to SOL\n      setPreMicroToken(token);\n      const solToken = tokens.find((t) => t.symbol === 'SOL');\n      if (solToken) onTokenSelect(solToken);\n    } else if (!isMicroTier && preMicroToken && token.symbol === 'SOL') {\n      // Leaving micro tier: restore the previously selected token\n      onTokenSelect(preMicroToken);\n      setPreMicroToken(null);\n    }\n  }, [isMicroTier, token.symbol, currencyMode, tokens, onTokenSelect, preMicroToken, token]);\n\n  const handleConfirm = () => {\n    if (isValidAmount) {\n      onConfirm(tokenAmount, token);\n    }\n  };\n\n  return (\n    <div className=\"cedros-deposit-flow-step\">\n      <h4 className=\"cedros-deposit-flow-step-title\">Choose Amount</h4>\n      <p className=\"cedros-deposit-flow-step-desc\">\n        Set how much you want to deposit. Higher tiers unlock privacy.\n      </p>\n\n      {/* Token Selector - only show for non-micro tiers in multi-token mode */}\n      {currencyMode === 'multi-token' && !isMicroTier && (\n        <div className=\"cedros-deposit-flow-field\">\n          <label className=\"cedros-deposit-flow-label\">Token</label>\n          <div className=\"cedros-deposit-flow-token-quick\">\n            {quickActionSymbols.map((symbol) => {\n              const quickToken = tokens.find((candidate) => candidate.symbol === symbol);\n              const isActive = token.symbol === symbol;\n              return (\n                <button\n                  key={symbol}\n                  type=\"button\"\n                  className={`cedros-deposit-flow-token-quick-btn ${isActive ? 'is-active' : ''}`}\n                  onClick={() => {\n                    if (quickToken) {\n                      setShowCustomToken(false);\n                      onTokenSelect(quickToken);\n                    }\n                  }}\n                  disabled={!quickToken}\n                >\n                  {quickToken?.logoUrl && (\n                    <img\n                      className=\"cedros-deposit-flow-token-quick-icon\"\n                      src={quickToken.logoUrl}\n                      alt={`${symbol} logo`}\n                    />\n                  )}\n                  {symbol}\n                </button>\n              );\n            })}\n            <button\n              type=\"button\"\n              className={`cedros-deposit-flow-token-quick-btn ${showCustomToken ? 'is-active' : ''}`}\n              onClick={() => {\n                setShowCustomToken(true);\n                setCustomOpenSignal((current) => current + 1);\n              }}\n            >\n              Custom\n            </button>\n          </div>\n          {showCustomToken && (\n            <div className=\"cedros-deposit-flow-token-custom\">\n              <TokenSelector\n                tokens={customTokens}\n                selectedToken={token}\n                onSelect={onTokenSelect}\n                openSignal={customOpenSignal}\n              />\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Amount Selector with Tier Indicator */}\n      <div className=\"cedros-deposit-flow-field\">\n        <TieredAmountSlider\n          config={config}\n          valueUsd={amountUsd}\n          onChange={setAmountUsd}\n          maxUsd={MAX_DEPOSIT_USD}\n        />\n      </div>\n\n      {/* Deposit Address */}\n      <div className=\"cedros-deposit-flow-field\">\n        <label className=\"cedros-deposit-flow-label\">\n          {isOtherToken\n            ? 'Sign to send tokens to this address'\n            : `Sign to send ${sendAmountLabel ?? '--'} ${isMicroTier ? 'SOL' : token.symbol} to this address`}\n        </label>\n        <div className=\"cedros-deposit-flow-address-box\">\n          <code className=\"cedros-deposit-flow-address\">{depositAddress || 'Loading...'}</code>\n          <div className=\"cedros-deposit-flow-address-actions\">\n            <button\n              type=\"button\"\n              className=\"cedros-deposit-flow-copy-btn cedros-deposit-flow-copy-icon\"\n              onClick={onCopy}\n              title=\"Copy address\"\n              disabled={!depositAddress}\n            >\n              {copied ? '' : ''}\n            </button>\n            {depositAddress && (\n              <a\n                className=\"cedros-deposit-flow-copy-btn cedros-deposit-flow-copy-link cedros-deposit-flow-copy-icon\"\n                href={`https://orbmarkets.io/account/${depositAddress}`}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                title=\"View on Orb Markets\"\n              >\n                \n              </a>\n            )}\n          </div>\n        </div>\n        {copied && <p className=\"cedros-deposit-flow-copied-msg\">Copied!</p>}\n      </div>\n\n      {/* Warning if fees exceed amount */}\n      {feesExceedAmount && (\n        <div className=\"cedros-deposit-flow-warning\">\n          <p>Deposit amount is less than the fees. Increase the amount to proceed.</p>\n        </div>\n      )}\n\n      <div className=\"cedros-deposit-flow-info-stack\">\n        <div className=\"cedros-deposit-flow-info-item\">\n          <span className=\"cedros-deposit-flow-info-dot\" />\n          <span>Send only on the Solana network.</span>\n        </div>\n        <div className=\"cedros-deposit-flow-info-item\">\n          <span className=\"cedros-deposit-flow-info-dot\" />\n          <span>\n            {feeLine}\n            <button\n              type=\"button\"\n              className={`cedros-deposit-flow-fee-info ${feeTooltipOpen ? 'is-open' : ''}`}\n              data-tooltip={feeTooltip}\n              aria-label={`Fee breakdown: ${feeTooltip.replaceAll('\\n', ', ')}`}\n              aria-expanded={feeTooltipOpen}\n              onClick={(event) => {\n                event.stopPropagation();\n                setFeeTooltipOpen((current) => !current);\n              }}\n              onBlur={() => setFeeTooltipOpen(false)}\n              onKeyDown={(event) => {\n                if (event.key === 'Escape') {\n                  setFeeTooltipOpen(false);\n                }\n              }}\n            >\n              i\n            </button>\n          </span>\n        </div>\n        <div className=\"cedros-deposit-flow-info-item\">\n          <span className=\"cedros-deposit-flow-info-dot\" />\n          <span>Credits appear after network confirmation.</span>\n        </div>\n      </div>\n\n      {isListening && (\n        <div className=\"cedros-deposit-flow-info-banner\">\n          Listening for incoming transfers. We will confirm automatically.\n        </div>\n      )}\n\n      {needsUnlock && (\n        <div className=\"cedros-deposit-flow-warning\">\n          <p>Your wallet is locked. Unlock it to continue.</p>\n          {onUnlockRequired && (\n            <button\n              type=\"button\"\n              className=\"cedros-deposit-flow-button cedros-deposit-flow-button-secondary\"\n              onClick={onUnlockRequired}\n            >\n              Unlock Wallet\n            </button>\n          )}\n        </div>\n      )}\n\n      <div className=\"cedros-deposit-flow-actions\">\n        <button\n          type=\"button\"\n          className=\"cedros-deposit-flow-button cedros-deposit-flow-button-secondary\"\n          onClick={onBack}\n        >\n          Back\n        </button>\n        <button\n          type=\"button\"\n          className=\"cedros-deposit-flow-button cedros-deposit-flow-button-primary\"\n          onClick={handleConfirm}\n          disabled={!isValidAmount || !walletReady || !depositAddress}\n        >\n          Deposit\n        </button>\n      </div>\n    </div>\n  );\n}\n\ninterface SigningStepProps {\n  depositAddress: string | null;\n}\n\nfunction SigningStep({ depositAddress }: SigningStepProps) {\n  return (\n    <div className=\"cedros-deposit-flow-step cedros-deposit-flow-step-centered\">\n      <div className=\"cedros-deposit-flow-spinner\" />\n      <h4 className=\"cedros-deposit-flow-step-title\">Signing Transfer</h4>\n      <p className=\"cedros-deposit-flow-step-desc\">\n        Approve the transfer in your wallet extension...\n      </p>\n      {depositAddress && (\n        <p className=\"cedros-deposit-flow-signing-dest\">\n          Sending to:{' '}\n          <code>\n            {depositAddress.slice(0, 6)}...{depositAddress.slice(-4)}\n          </code>\n        </p>\n      )}\n    </div>\n  );\n}\n\n// =============================================================================\n// RECEIVE MODE STEP COMPONENTS\n// =============================================================================\n\ninterface ShowAddressStepProps {\n  token: Token;\n  tokens: Token[];\n  quickActionSymbols: string[];\n  customTokenSymbols: string[];\n  tokenPriceUsd?: Record<string, number>;\n  currencyMode: CurrencyMode;\n  depositAddress: string | null;\n  copied: boolean;\n  isListening: boolean;\n  config: DepositConfigResponse;\n  onCopy: () => void;\n  onTokenSelect: (token: Token) => void;\n  onAmountChange: (amountUsd: number) => void;\n  onSent: () => void;\n  onBack: () => void;\n  onCancel?: () => void;\n}\n\nfunction ShowAddressStep({\n  token,\n  tokens,\n  quickActionSymbols,\n  customTokenSymbols,\n  tokenPriceUsd,\n  currencyMode,\n  depositAddress,\n  copied,\n  isListening,\n  config,\n  onCopy,\n  onTokenSelect,\n  onAmountChange,\n  onSent,\n  onBack,\n}: ShowAddressStepProps) {\n  const [amountUsd, setAmountUsd] = useState(config.privateMinUsd);\n  const [showCustomToken, setShowCustomToken] = useState(false);\n  const [feeTooltipOpen, setFeeTooltipOpen] = useState(false);\n  const [customOpenSignal, setCustomOpenSignal] = useState(0);\n  // Track the token selected before auto-switching to SOL for micro tier\n  const [preMicroToken, setPreMicroToken] = useState<Token | null>(null);\n  const tier = getTierForAmount(amountUsd, config);\n  const isMicroTier = tier === 'sol_micro';\n  const isOtherToken = token.symbol === OTHER_TOKEN.symbol;\n  const customTokens = useMemo(() => {\n    const baseTokens =\n      customTokenSymbols.length === 0\n        ? tokens\n        : tokens.filter((candidate) => customTokenSymbols.includes(candidate.symbol));\n    const resolved = baseTokens.length > 0 ? baseTokens : tokens;\n    const hasOther = resolved.some((candidate) => candidate.symbol === OTHER_TOKEN.symbol);\n    return hasOther ? resolved : [...resolved, OTHER_TOKEN];\n  }, [tokens, customTokenSymbols]);\n  const totalFeeUsd = getTotalFeeUsd(config, amountUsd);\n  const feeTotalDisplay = totalFeeUsd < 0.01 ? 0.01 : totalFeeUsd;\n  const feeLine = isOtherToken\n    ? 'Fees: calculated after deposit'\n    : `Fees: $${feeTotalDisplay.toFixed(2)} total`;\n  const feeTooltip = isOtherToken ? '' : formatFeeTooltip(config, amountUsd, totalFeeUsd);\n  const canSubmit = isOtherToken || amountUsd > 0;\n  const tokenUsdPrice = getTokenUsdPrice(isMicroTier ? SOL_TOKEN : token, config, tokenPriceUsd);\n  const tokenAmount = tokenUsdPrice ? amountUsd / tokenUsdPrice : null;\n  const sendAmountLabel = tokenAmount ? formatTokenAmount(tokenAmount, token.symbol) : null;\n\n  // Auto-select SOL for micro tier, restore previous token when leaving micro tier\n  useEffect(() => {\n    if (currencyMode !== 'multi-token') return;\n\n    if (isMicroTier && token.symbol !== 'SOL') {\n      // Entering micro tier with non-SOL token: save it and switch to SOL\n      setPreMicroToken(token);\n      const solToken = tokens.find((t) => t.symbol === 'SOL');\n      if (solToken) onTokenSelect(solToken);\n    } else if (!isMicroTier && preMicroToken && token.symbol === 'SOL') {\n      // Leaving micro tier: restore the previously selected token\n      onTokenSelect(preMicroToken);\n      setPreMicroToken(null);\n    }\n  }, [isMicroTier, token.symbol, currencyMode, tokens, onTokenSelect, preMicroToken, token]);\n\n  useEffect(() => {\n    onAmountChange(amountUsd);\n  }, [amountUsd, onAmountChange]);\n\n  if (!depositAddress) {\n    return (\n      <div className=\"cedros-deposit-flow-step cedros-deposit-flow-step-centered\">\n        <div className=\"cedros-deposit-flow-error-icon\">!</div>\n        <h4 className=\"cedros-deposit-flow-step-title\">Wallet Not Ready</h4>\n        <p className=\"cedros-deposit-flow-step-desc\">\n          Your embedded wallet is not set up. Please complete wallet enrollment first.\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"cedros-deposit-flow-step\">\n      <h4 className=\"cedros-deposit-flow-step-title\">Send Deposit</h4>\n      <p className=\"cedros-deposit-flow-step-desc\">\n        Send funds to your deposit address. We'll confirm automatically.\n      </p>\n\n      {/* Token Selector - only show for non-micro tiers in multi-token mode */}\n      {currencyMode === 'multi-token' && !isMicroTier && (\n        <div className=\"cedros-deposit-flow-field\">\n          <label className=\"cedros-deposit-flow-label\">Token</label>\n          <div className=\"cedros-deposit-flow-token-quick\">\n            {quickActionSymbols.map((symbol) => {\n              const quickToken = tokens.find((candidate) => candidate.symbol === symbol);\n              const isActive = token.symbol === symbol;\n              return (\n                <button\n                  key={symbol}\n                  type=\"button\"\n                  className={`cedros-deposit-flow-token-quick-btn ${isActive ? 'is-active' : ''}`}\n                  onClick={() => {\n                    if (quickToken) {\n                      setShowCustomToken(false);\n                      onTokenSelect(quickToken);\n                    }\n                  }}\n                  disabled={!quickToken}\n                >\n                  {quickToken?.logoUrl && (\n                    <img\n                      className=\"cedros-deposit-flow-token-quick-icon\"\n                      src={quickToken.logoUrl}\n                      alt={`${symbol} logo`}\n                    />\n                  )}\n                  {symbol}\n                </button>\n              );\n            })}\n            <button\n              type=\"button\"\n              className={`cedros-deposit-flow-token-quick-btn ${showCustomToken ? 'is-active' : ''}`}\n              onClick={() => {\n                setShowCustomToken(true);\n                setCustomOpenSignal((current) => current + 1);\n              }}\n            >\n              Custom\n            </button>\n          </div>\n          {showCustomToken && (\n            <div className=\"cedros-deposit-flow-token-custom\">\n              <TokenSelector\n                tokens={customTokens}\n                selectedToken={token}\n                onSelect={onTokenSelect}\n                openSignal={customOpenSignal}\n              />\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Amount Selector with Tier Indicator */}\n      {!isOtherToken && (\n        <div className=\"cedros-deposit-flow-field\">\n          <label className=\"cedros-deposit-flow-label\">Deposit Amount</label>\n          <TieredAmountSlider\n            config={config}\n            valueUsd={amountUsd}\n            onChange={setAmountUsd}\n            maxUsd={MAX_DEPOSIT_USD}\n          />\n        </div>\n      )}\n\n      {isOtherToken && (\n        <div className=\"cedros-deposit-flow-note\">\n          Send any token you want. We'll detect the deposit, swap it, and credit your balance\n          automatically.\n        </div>\n      )}\n\n      {/* Deposit Address */}\n      <div className=\"cedros-deposit-flow-field\">\n        <label className=\"cedros-deposit-flow-label\">\n          {isOtherToken\n            ? 'Send any token to this address'\n            : `Send ${sendAmountLabel ?? '--'} ${isMicroTier ? 'SOL' : token.symbol} to this address`}\n        </label>\n        <div className=\"cedros-deposit-flow-address-box\">\n          <code className=\"cedros-deposit-flow-address\">{depositAddress}</code>\n          <button\n            type=\"button\"\n            className=\"cedros-deposit-flow-copy-btn\"\n            onClick={onCopy}\n            title=\"Copy address\"\n          >\n            {copied ? '' : ''}\n          </button>\n        </div>\n        {copied && <p className=\"cedros-deposit-flow-copied-msg\">Copied!</p>}\n      </div>\n\n      <div className=\"cedros-deposit-flow-info-stack\">\n        <div className=\"cedros-deposit-flow-info-item\">\n          <span className=\"cedros-deposit-flow-info-dot\" />\n          <span>Send only on the Solana network.</span>\n        </div>\n        <div className=\"cedros-deposit-flow-info-item\">\n          <span className=\"cedros-deposit-flow-info-dot\" />\n          <span>\n            {feeLine}\n            {!isOtherToken && (\n              <button\n                type=\"button\"\n                className={`cedros-deposit-flow-fee-info ${feeTooltipOpen ? 'is-open' : ''}`}\n                data-tooltip={feeTooltip}\n                aria-label={`Fee breakdown: ${feeTooltip.replaceAll('\\n', ', ')}`}\n                aria-expanded={feeTooltipOpen}\n                onClick={(event) => {\n                  event.stopPropagation();\n                  setFeeTooltipOpen((current) => !current);\n                }}\n                onBlur={() => setFeeTooltipOpen(false)}\n                onKeyDown={(event) => {\n                  if (event.key === 'Escape') {\n                    setFeeTooltipOpen(false);\n                  }\n                }}\n              >\n                i\n              </button>\n            )}\n          </span>\n        </div>\n        <div className=\"cedros-deposit-flow-info-item\">\n          <span className=\"cedros-deposit-flow-info-dot\" />\n          <span>Credits appear after confirmation (typically ~30s).</span>\n        </div>\n      </div>\n\n      {isListening && (\n        <div className=\"cedros-deposit-flow-info-banner\">\n          Listening for your deposit. We'll notify you when it arrives.\n        </div>\n      )}\n\n      <div className=\"cedros-deposit-flow-actions\">\n        <button\n          type=\"button\"\n          className=\"cedros-deposit-flow-button cedros-deposit-flow-button-secondary\"\n          onClick={onBack}\n        >\n          Back\n        </button>\n        <button\n          type=\"button\"\n          className=\"cedros-deposit-flow-button cedros-deposit-flow-button-primary\"\n          onClick={onSent}\n          disabled={!canSubmit}\n        >\n          I've Sent It\n        </button>\n      </div>\n    </div>\n  );\n}\n\ninterface WaitingStepProps {\n  token: Token;\n  depositAddress: string | null;\n  copied: boolean;\n  feeLine: string;\n  onCopy: () => void;\n}\n\nfunction WaitingStep({ token, depositAddress, copied, feeLine, onCopy }: WaitingStepProps) {\n  return (\n    <div className=\"cedros-deposit-flow-step cedros-deposit-flow-step-centered\">\n      <div className=\"cedros-deposit-flow-spinner\" />\n      <h4 className=\"cedros-deposit-flow-step-title\">Waiting for Deposit</h4>\n      <p className=\"cedros-deposit-flow-step-desc\">\n        Looking for incoming <strong>{token.symbol}</strong> deposits...\n      </p>\n\n      <div className=\"cedros-deposit-flow-waiting-info\">\n        <p className=\"cedros-deposit-flow-waiting-text\">\n          Once your transaction is confirmed on the Solana network, your account will be credited\n          automatically. This usually takes 20-30 seconds.\n        </p>\n        {depositAddress && (\n          <div className=\"cedros-deposit-flow-field\">\n            <label className=\"cedros-deposit-flow-label\">Deposit address</label>\n            <div className=\"cedros-deposit-flow-address-box\">\n              <code className=\"cedros-deposit-flow-address\">\n                {depositAddress.slice(0, 6)}...{depositAddress.slice(-6)}\n              </code>\n              <div className=\"cedros-deposit-flow-address-actions\">\n                <button\n                  type=\"button\"\n                  className=\"cedros-deposit-flow-copy-btn cedros-deposit-flow-copy-icon\"\n                  onClick={onCopy}\n                  title=\"Copy address\"\n                >\n                  {copied ? '' : ''}\n                </button>\n                <a\n                  className=\"cedros-deposit-flow-copy-btn cedros-deposit-flow-copy-link cedros-deposit-flow-copy-icon\"\n                  href={`https://orbmarkets.io/account/${depositAddress}`}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  title=\"View on Orb Markets\"\n                >\n                  \n                </a>\n              </div>\n            </div>\n          </div>\n        )}\n        <div className=\"cedros-deposit-flow-info-stack\">\n          <div className=\"cedros-deposit-flow-info-item\">\n            <span className=\"cedros-deposit-flow-info-dot\" />\n            <span>Send only on the Solana network.</span>\n          </div>\n          <div className=\"cedros-deposit-flow-info-item\">\n            <span className=\"cedros-deposit-flow-info-dot\" />\n            <span>{feeLine}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\ninterface SuccessStepProps {\n  result: DepositFlowResult;\n  config: DepositConfigResponse;\n  onNewDeposit: () => void;\n}\n\nfunction SuccessStep({ result, config, onNewDeposit }: SuccessStepProps) {\n  const token = result.token ?? SOL_TOKEN;\n  const amountUsd =\n    token.symbol === 'SOL' && config.solPriceUsd > 0\n      ? result.amount * config.solPriceUsd\n      : result.amount;\n  const totalFeeUsd = getTotalFeeUsd(config, amountUsd);\n  const creditsUsd = Math.max(amountUsd - totalFeeUsd, 0);\n  const totalFeeDisplay = totalFeeUsd < 0.01 ? 0.01 : totalFeeUsd;\n\n  return (\n    <div className=\"cedros-deposit-flow-step cedros-deposit-flow-step-centered\">\n      <div className=\"cedros-deposit-flow-success-icon\"></div>\n      <h4 className=\"cedros-deposit-flow-step-title\">Deposit Successful!</h4>\n      <p className=\"cedros-deposit-flow-step-desc\">\n        Your deposit of {result.amount.toLocaleString()} {token.symbol} has been received.\n      </p>\n\n      <div className=\"cedros-deposit-flow-summary\">\n        <div className=\"cedros-deposit-flow-summary-row\">\n          <span className=\"cedros-deposit-flow-summary-label\">Transaction</span>\n          <span className=\"cedros-deposit-flow-summary-value cedros-deposit-flow-tx\">\n            <a\n              href={`https://orbmarkets.io/tx/${result.txSignature}`}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              {result.txSignature.slice(0, 8)}...{result.txSignature.slice(-8)}\n            </a>\n            <a\n              className=\"cedros-deposit-flow-tx-action\"\n              href={`https://orbmarkets.io/tx/${result.txSignature}`}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              aria-label=\"View transaction on Orb Markets\"\n              title=\"View transaction\"\n            >\n              \n            </a>\n          </span>\n        </div>\n        <div className=\"cedros-deposit-flow-summary-row\">\n          <span className=\"cedros-deposit-flow-summary-label\">Deposit Amount</span>\n          <span className=\"cedros-deposit-flow-summary-value\">${amountUsd.toFixed(2)}</span>\n        </div>\n        <div className=\"cedros-deposit-flow-summary-row\">\n          <span className=\"cedros-deposit-flow-summary-label\">Total Fees</span>\n          <span className=\"cedros-deposit-flow-summary-value cedros-deposit-flow-fee\">\n            -${totalFeeDisplay.toFixed(2)}\n          </span>\n        </div>\n        <div className=\"cedros-deposit-flow-summary-row\">\n          <span className=\"cedros-deposit-flow-summary-label\">Credits Added</span>\n          <span className=\"cedros-deposit-flow-summary-value cedros-deposit-flow-credit\">\n            +${creditsUsd.toFixed(2)}\n          </span>\n        </div>\n        <div className=\"cedros-deposit-flow-summary-row\">\n          <span className=\"cedros-deposit-flow-summary-label\">Available</span>\n          <span className=\"cedros-deposit-flow-summary-value\">Immediately</span>\n        </div>\n      </div>\n\n      <div className=\"cedros-deposit-flow-actions\">\n        <button\n          type=\"button\"\n          className=\"cedros-deposit-flow-button cedros-deposit-flow-button-primary\"\n          onClick={onNewDeposit}\n        >\n          Make Another Deposit\n        </button>\n      </div>\n    </div>\n  );\n}\n\ninterface ErrorStepProps {\n  error: string;\n  onRetry: () => void;\n  onCancel?: () => void;\n}\n\nfunction ErrorStep({ error, onRetry, onCancel }: ErrorStepProps) {\n  return (\n    <div className=\"cedros-deposit-flow-step cedros-deposit-flow-step-centered\">\n      <div className=\"cedros-deposit-flow-error-icon\"></div>\n      <h4 className=\"cedros-deposit-flow-step-title\">Deposit Failed</h4>\n      <p className=\"cedros-deposit-flow-error-message\">{error}</p>\n\n      <div className=\"cedros-deposit-flow-actions\">\n        {onCancel && (\n          <button\n            type=\"button\"\n            className=\"cedros-deposit-flow-button cedros-deposit-flow-button-secondary\"\n            onClick={onCancel}\n          >\n            Cancel\n          </button>\n        )}\n        <button\n          type=\"button\"\n          className=\"cedros-deposit-flow-button cedros-deposit-flow-button-primary\"\n          onClick={onRetry}\n        >\n          Try Again\n        </button>\n      </div>\n    </div>\n  );\n}\n","export default \"data:image/webp;base64,UklGRmIEAABXRUJQVlA4WAoAAAAIAAAAOwAAOwAAVlA4IIIDAADwDwCdASo8ADwAPm0qkUWkIqGWDVeYQAbEtgBOmZMBu+H816ov3b8R8R2g2FXtxdyh5s3+A60v0APLi9ktgGB/LZjWNAXqgpE6jfW0NF+P4xEhH2L7M+26iGwrTjjcQegyCZqxs+ifvZANjWd279diqZNKUrgOTVtjJGtW4IVtRhMECd5aWVgAAP7nDv3UY/8f1l//xTP/FM/8NU8c9g//sC3+bX/1HZXsNsM57VKG2LVf1a0KdncWO8uPo/Oh79m9ZqjJZwXfPXuvwkK+WDOl6+N8C2Ux6no/V/zkoucKK/JZek7MR5sS8TknXB+6BuVDXou9Rx4aUea2q2IzvLvFIujjKsVYLMab7j9zo48fhgm9YOtjmWuS0WZ4c+6ta0mr3xF4fcdAIFf6oXRSlqovOX0HUiMV//hXwSX1cfP5cLj8c7OTyT/4ce4olJARV95GoY8oF+2uU0blGul3ItlG7c2Hl2/uC6s2WZc7Zukwojx6ed8t97bZ68N1uzCLzPlG7BuYS17F19e0wXnc6vEl3q7ft0K7OEl7r8mY6Kh+Nt/5V/Lp68mFBjLem1JjvC371+lKwez4KCdXwNo2Z04FqyzGpFutY6YQ/r5Tfu7Oi+oNfN0R/W+D4aj1nqHhlqYJzpx2NK4mj0gJIXmX8EArelSQI8mV4Ux9MRPwC2PuZhLTjQZv+Vl4p0D8bSB+Z0rek3hS6G1r80fW3cn767Pz/bXanjVmm34wt1nQPqdJObrZ7vv2NWcEuQKj9d+V6DzeDrq0CtGNcanEB5MY9agi1E6BprEScTdfPXjBeMnPbpD+QO6P7IW4UZ9etCCHtX++S/fl5Iz5RzUr10ojRMw//35C0yTjSEhbe884dPwor64n//KByjUFEGsCPAAXPJp1+O+SiKfUaODq6ncjKayTHXjoXgM7XP1z4sBhIKJZJRiM7vGC/+v/Sk8/jbgZLZDAVz1vLou93y7Yd8hxcWM/BesxgWgeKvl8fjE/Ud8tQKp4425hWh66lzzwxa4J3ctA4/E50wX/eoBOgq0B7+7S6FK4wvPHSNgfh+vwSWIJsJLt/3yjBeb41RRyMDMZqFQTZPEdFpXp48ExEyDayZ6objbjTHoS5WQDnDQpRyqMNKfvd41nhEPdb/hxpzXeTIjWmfHHCT+CQYWXDqLehCh1cRyeYOBwsSlSw5PiquAbsgAARVhJRroAAABFeGlmAABJSSoACAAAAAYAEgEDAAEAAAABAAAAGgEFAAEAAABWAAAAGwEFAAEAAABeAAAAKAEDAAEAAAACAAAAEwIDAAEAAAABAAAAaYcEAAEAAABmAAAAAAAAAEgAAAABAAAASAAAAAEAAAAGAACQBwAEAAAAMDIxMAGRBwAEAAAAAQIDAACgBwAEAAAAMDEwMAGgAwABAAAA//8AAAKgBAABAAAAPAAAAAOgBAABAAAAPAAAAAAAAAA=\"","export default \"data:image/webp;base64,UklGRtgCAABXRUJQVlA4WAoAAAAIAAAAOwAAOwAAVlA4IPgBAABQCwCdASo8ADwAPm0wk0ekIqGhKBQMqIANiWkADPF3uV2D8VcQGk1mg+P36i9SLnZvYAQxszEWYzEwX1RVkqG/4BGbJgMSHqhKDFsjWsGfPPrvfef11goNmCDDlBJHVVD+8gAA/vu4q03kl+E7FpjtZ2gc8pQ619Hjv9NywoRZ6az43C1wcrRr/lWzJlJhLWMHN0MkVl1ueAf6Hn8StVzeUfMBXOKkgfe2msx7QWR5PnHW/5c6/35yrtWnrURc2q6UYlGin+v8C2dQqexkW6rX2EEijTI9eEQ46PWH3/59fM2AlMvvR2abaRk5XX7V1triQncRxvMfz5YmYDN+PY/ikcZUNaiFucKoUq5riv0eKCezuFNHecE11ojwJqWRSTWpalkz5autXp6vFS+FT1tWUsB/fs1CCOZxaA1vR1grOEaiuKe1RYm7e05psWtqbXLVmm1bA8Ly9PFkVdCbc6hR3UuBBsFGnVeGOUeMn2onnfvYhBMcM9YPxGdQkwZLXOk1VuQSTk01Shf3fZrFyRlFauftFdPYhKXwqrr+meav1P+KLKBVosqmHnFFfgExsQ/rOf3TSd+mOqQfJA+cF+HojNU7nmM3uDkoCBi+//Gqp+gPNNW8M4LFrol8rxE+7WsjqMgfwv1f+Nr25RtG1Wa/KkniRCAAAABFWElGugAAAEV4aWYAAElJKgAIAAAABgASAQMAAQAAAAEAAAAaAQUAAQAAAFYAAAAbAQUAAQAAAF4AAAAoAQMAAQAAAAIAAAATAgMAAQAAAAEAAABphwQAAQAAAGYAAAAAAAAASAAAAAEAAABIAAAAAQAAAAYAAJAHAAQAAAAwMjEwAZEHAAQAAAABAgMAAKAHAAQAAAAwMTAwAaADAAEAAAD//wAAAqAEAAEAAAA8AAAAA6AEAAEAAAA8AAAAAAAAAA==\"","export default \"data:image/webp;base64,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\"","export default \"data:image/webp;base64,UklGRo4EAABXRUJQVlA4WAoAAAAYAAAAOwAAOwAAQUxQSA4CAAABkGXb2to2V9/v6D1Jmd5CQ5GXPYXAJMrtPOJMoMzMzDgIPYY5+vVds6T/m0BEOGzAtm1IBlR2d8kXUMyaADjeuHr9V7qj3E5/XrvaOA5AHCqzFgHTFz9tUTmEyq1PF6cBqVWDOLjkwS6VPsu8KqnaewRU7j5KIjipgFiQfCf1IGch8wMlv9QhcWk4nLlL9Z4l6b3y7hmUvGQkmF1nnrMC85zrc5CozDUQtwamisNSDCmxjL5jpqxMzfhutFCCY3+5110CaI9/jhVIcPg/DxiIB/x/eKgijLxkRobTyxFEw7zVm0NqcYg5LNAzKD3n4QbmyRVqWCiXJyD9uN7z0Ha9Dw4N5gzOnHU4IMJ7egt8HuYWasIJnlg46fkYgul9qgWU+9PA2Z7b2FngnR3e49Qm1QbKzVPNnltZ8wozK2S8et0SN34wt0LOnynVCsp02xI7tKSqqXYsV7ZtD/lpeaEfNyw/k9evWuKK7XfQ9ruP9/RW/s74t872N1bw2MY8n0Acmlb/KQ04AJ8t5PkeEbpDnbmR2/5392FiOfRFlCuTkIGsMh/aPBeGZFLBYuiM1IIUZLOD0NnMNBMWZdE/4bLo32MQ0wxcJnsvhcnerRhSLvPPhcj8s5DIsmtU6Tj1L1U6zvcEElfrVlHyqGy3epC4om5Vsg3OlO50UQ2V6Qa65LWf6TZ1J/11faBLlpgAVlA4IJgBAADwCQCdASo8ADwAPm0ylEckIyIhKAoAgA2JaQATzh4OcBkEByVmbl5z9gD9U/+J2APQgLaX4twLu19/UVxAWN1IKXE4cIqJBhoyQ0yDYn61m3zk6T7FMg0AAP78+EMvGgC8jLXmcbbmqvufKjG8Tv1M9Krl47vOW74O/Rapv2DgXbg9iK6PrRQG/9d9+rF/ESxzbszVFn3GThrMBmsklj/LPWDQ0pKzG7EyjQL6p6gfUwMze+wPhzJpn8tMqlUVgq6/QSUVcgG+ztsi73rA3vl3n4baeF1INsbuosTXtnsotVYuTii6rscx9OUTvevYcPNvcL9MPhyWeCQw0qynnGtzCIw+oFRN0+TN1mqXkFyk/rFBcH+FHiI6s9XX5EWCKn5vTRt/0RbS687PiXPFC5Zk/Gk4+538IYi+HZDjvlQQWOH/vddfYTerQ5QqWJt1YuaZNThQ2u+/DtXfZPRy1iWWLR9SKFFtlGrqBKWF5nPRPWWMNA3OssvUtvCNBLBA4cn1whzy+SpbgLvnaepxiykjKsU/MhzgAABFWElGugAAAEV4aWYAAElJKgAIAAAABgASAQMAAQAAAAEAAAAaAQUAAQAAAFYAAAAbAQUAAQAAAF4AAAAoAQMAAQAAAAIAAAATAgMAAQAAAAEAAABphwQAAQAAAGYAAAAAAAAASAAAAAEAAABIAAAAAQAAAAYAAJAHAAQAAAAwMjEwAZEHAAQAAAABAgMAAKAHAAQAAAAwMTAwAaADAAEAAAD//wAAAqAEAAEAAAA8AAAAA6AEAAEAAAA8AAAAAAAAAA==\"","export default \"data:image/webp;base64,UklGRqwEAABXRUJQVlA4WAoAAAAYAAAAOwAAOwAAQUxQSL8BAAABkGvbtmlLc5997yvbmW19gBnbDm2kjF5UmW3bthXZVZFdZ+81r+87Z1XlEaHIbSNlMstwos4XUBSTLAFQo/u01Zdf/yLDDze3zB/YwADJEoOoJAKg7oTdH4SF+XxiZlMgSESzwAJdVn2iUJzzOUMiLhQKf+/va2FtBLMBuu1zpHcsincUXhtoTKLsCTVX/KF3wrLhPLm/OWzZtjQWfZ7RhYyAC/lxMowpSzJYJAyFkZDQc21FBMUT7BqGjpHxf3m+XlEPUHE/f3vGgPzmw4awRUaTexkyJhwfNShctVgZXyJDXq4CUyjNy6Y4fVOBIkAPR2GcOE7Jm2NQ/RE9YzXht3a5VYvlOX0xF0fy+tp/ozBuQg6DzZYb6Bi7ed4rB5Mp/1Co4cNhLUo1StLxDIDqrynUoRswiF6nFnIxsDpnZ5WBW0GFZ1qZ8HfLDk5txHHsGDpSa6B0cXZEa+DsTr1M+P4qPdXwjynU4+1/a7oN3Sm6G+meSd27oHsHde++7puj+tYpv7G6b7vun6L7l6n+oZp/t7JmUNUqqhpJV5upakJVLaqqgVW1t6rmV401NGMc1djqH4rpIseSfyPFkgAAVlA4IAQCAABQDACdASo8ADwAPm0yk0akIyGhJgzogA2JaQAThroHvLxu+aPf5G2BYxv+B6XHzx6GPon/o+qz/tOAA/TM82gR0vnExWoiQRM36jlg2UIvwCSqySErzuguz9EP2x/7hsNazr91aIworWI7AAD+/TZ+6Ipl444OdT+2wU0Ov+T8oJuVP/vUbT/w1Jsv6Awnl6rvF/xetfOPt3gTQZZi0Y/AOx563J7CJkqTR/fc/n34zyeKzR80fhfv4ef+Hjhz/CX5aQo+58zg/FdE+7bLoophGfG0szI513EH+q+Gc73H1PFdJYf7CF8v5dhr3tMwEVX5Ji2ZxejK8xrf/E6nVXqlA4DrYNRP09InHc+fEqO/fH8xr+rMf4y1F9TOnwVffZblLoTP6lot0m/sh7sTiDQr0mIA8TiHoOffGDG6KzV+B3239udfhzD740gkRi/m53abX0Ku3vAgadgFFqL0vk8M/4aI+cI+0fbLW17mWGeMu21wSRRQiv5iNgGKR3vEGXAItcLDft1uUzWAfbe1X3zK/ymT7bA/76PB6UUknm+Y5MM4osurUXU/k7P38pN/3slnGfpFzjl4c3USY4mH9ZCJYUuC/kGEnq/yRPalPdODNFvW6s8MiQeQejYNRY0LsJ0WXkK8vXiDmihCivYAOPoSovesL7on+WAArDNM/BcQSQvCYABFWElGugAAAEV4aWYAAElJKgAIAAAABgASAQMAAQAAAAEAAAAaAQUAAQAAAFYAAAAbAQUAAQAAAF4AAAAoAQMAAQAAAAIAAAATAgMAAQAAAAEAAABphwQAAQAAAGYAAAAAAAAASAAAAAEAAABIAAAAAQAAAAYAAJAHAAQAAAAwMjEwAZEHAAQAAAABAgMAAKAHAAQAAAAwMTAwAaADAAEAAAD//wAAAqAEAAEAAAA8AAAAA6AEAAEAAAA8AAAAAAAAAA==\"","export default \"data:image/webp;base64,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\"","export default \"data:image/svg+xml,%3csvg%20width='88'%20height='88'%20viewBox='0%200%2088%2088'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='88'%20height='88'%20fill='url(%23paint0_linear_170_79)'/%3e%3crect%20x='25.6665'%20y='25.6667'%20width='11'%20height='36.6667'%20rx='1.83333'%20fill='white'/%3e%3crect%20x='51.3335'%20y='25.6667'%20width='11'%20height='36.6667'%20rx='1.83333'%20fill='white'/%3e%3crect%20x='29.3335'%20y='40.3333'%20width='29.3333'%20height='7.33333'%20fill='white'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_170_79'%20x1='-75.3077'%20y1='-55'%20x2='146.302'%20y2='148.167'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23FF00FF'/%3e%3cstop%20offset='0.531673'%20stop-color='%237A84FF'/%3e%3cstop%20offset='1'%20stop-color='%2305FAFF'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e\"","export default \"data:image/webp;base64,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\"","export default \"data:image/svg+xml,%3csvg%20width='868'%20height='868'%20viewBox='0%200%20868%20868'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='434'%20cy='434'%20r='434'%20fill='%231B262D'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M234.563%20184H640.697C650.387%20184%20659.339%20189.164%20664.172%20197.542L782.495%20402.657C788.631%20413.294%20786.808%20426.72%20778.056%20435.346L452.368%20756.327C441.818%20766.724%20424.846%20766.724%20414.296%20756.327L89.0484%20435.78C80.0927%20426.954%2078.4157%20413.136%2085.0013%20402.433L211.48%20196.884C216.405%20188.879%20225.146%20184%20234.563%20184ZM588.257%20275.577V333.129H472.567V373.032C553.82%20377.296%20614.782%20394.81%20615.234%20415.802L615.231%20459.563C614.779%20480.556%20553.82%20498.069%20472.567%20502.333V600.259H395.746V502.333C314.492%20498.069%20253.531%20480.555%20253.078%20459.563L253.081%20415.802C253.533%20394.81%20314.492%20377.296%20395.746%20373.032V333.129H280.055V275.577H588.257ZM434.156%20472.268C520.868%20472.268%20593.345%20457.459%20611.082%20437.683C596.041%20420.912%20541.636%20407.713%20472.567%20404.089V445.867C460.187%20446.516%20447.336%20446.858%20434.156%20446.858C420.976%20446.858%20408.125%20446.516%20395.746%20445.867V404.089C326.676%20407.713%20272.271%20420.912%20257.23%20437.683C274.968%20457.459%20347.444%20472.268%20434.156%20472.268Z'%20fill='%23009393'/%3e%3c/svg%3e\"","/**\n * Token types and constants for deposit currency selection\n */\n\nimport bonkLogo from '../../assets/tokens/bonk.webp';\nimport cashLogo from '../../assets/tokens/cash.webp';\nimport eurcLogo from '../../assets/tokens/eurc.webp';\nimport oreLogo from '../../assets/tokens/ore.webp';\nimport pyusdLogo from '../../assets/tokens/pyusd.webp';\nimport solLogo from '../../assets/tokens/sol.webp';\nimport usdcLogo from '../../assets/tokens/usdc.webp';\nimport usdhLogo from '../../assets/tokens/usdh.svg';\nimport usd1Logo from '../../assets/tokens/usd1.webp';\nimport usdtLogo from '../../assets/tokens/usdt.svg';\n\nexport interface Token {\n  /** Token mint address */\n  mint: string;\n  /** Token symbol (e.g., SOL, USDC) */\n  symbol: string;\n  /** Token name (e.g., Solana, USD Coin) */\n  name: string;\n  /** Token decimals */\n  decimals: number;\n  /** Token logo URL */\n  logoUrl?: string;\n}\n\n/**\n * Supported stablecoins for deposits\n */\nexport const SUPPORTED_TOKENS: Token[] = [\n  {\n    mint: 'So11111111111111111111111111111111111111112',\n    symbol: 'SOL',\n    name: 'Solana',\n    decimals: 9,\n    logoUrl: solLogo,\n  },\n  {\n    mint: 'EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v',\n    symbol: 'USDC',\n    name: 'Circle USD',\n    decimals: 6,\n    logoUrl: usdcLogo,\n  },\n  {\n    mint: 'Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB',\n    symbol: 'USDT',\n    name: 'Tether USD',\n    decimals: 6,\n    logoUrl: usdtLogo,\n  },\n  {\n    mint: 'HzwqbKZw8HxMN6bF2yFZNrht3c2iXXzpKcFu7uBEDKtr',\n    symbol: 'EURC',\n    name: 'Circle Euro',\n    decimals: 6,\n    logoUrl: eurcLogo,\n  },\n  {\n    mint: 'USD1ttGY1N17NEEHLmELoaybftRBUSErhqYiQzvEmuB',\n    symbol: 'USD1',\n    name: 'WLFI USD',\n    decimals: 6,\n    logoUrl: usd1Logo,\n  },\n  {\n    mint: '2b1kV6DkPAnxd5ixfnxCpjxmKwqjjaYmCZfHsFu24GXo',\n    symbol: 'PYUSD',\n    name: 'PayPal USD',\n    decimals: 6,\n    logoUrl: pyusdLogo,\n  },\n  {\n    mint: 'USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX',\n    symbol: 'USDH',\n    name: 'Hubble USD',\n    decimals: 6,\n    logoUrl: usdhLogo,\n  },\n  {\n    mint: 'CASHVDm2wsJXfhj6VWxb7GiMdoLc17Du7paH4bNr5woT',\n    symbol: 'CASH',\n    name: 'Stripe USD',\n    decimals: 6,\n    logoUrl: cashLogo,\n  },\n  {\n    mint: 'DezXAZ8z7PnrnRJjz3wXBoRgixCa6xjnB7YaB1pPB263',\n    symbol: 'BONK',\n    name: 'Bonk',\n    decimals: 5,\n    logoUrl: bonkLogo,\n  },\n  {\n    mint: 'oreoU2P8bN6jkk3jbaiVxYnG1dCXcYxwhwyK9jSybcp',\n    symbol: 'ORE',\n    name: 'Ore',\n    decimals: 11,\n    logoUrl: oreLogo,\n  },\n];\n","/**\n * Hook for credit balance and transaction history\n *\n * Provides access to the user's credit balance and transaction history.\n * Credits are earned through Privacy Cash deposits.\n *\n * Safe to call outside CedrosLoginProvider (returns no-op functions).\n */\n\nimport { useState, useCallback, useMemo } from 'react';\nimport { useCedrosLoginOptional } from '../context/useCedrosLogin';\nimport { ApiClient, handleApiError } from '../utils/apiClient';\nimport type {\n  UseCreditsReturn,\n  CreditBalanceResponse,\n  CreditHistoryResponse,\n  BalancesResponse,\n} from '../types/deposit';\n\nexport type { UseCreditsReturn } from '../types/deposit';\n\n/**\n * Hook for credit balance and transaction history\n *\n * Credits represent the user's balance from Privacy Cash deposits.\n * The balance can be used for services within the application.\n *\n * Safe to call outside CedrosLoginProvider - returns no-op functions that throw.\n */\nexport function useCredits(): UseCreditsReturn {\n  const context = useCedrosLoginOptional();\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const apiClient = useMemo(() => {\n    if (!context) return null;\n    return new ApiClient({\n      baseUrl: context.config.serverUrl,\n      timeoutMs: context.config.requestTimeout,\n      retryAttempts: context.config.retryAttempts,\n      getAccessToken: context._internal?.getAccessToken,\n    });\n  }, [context]);\n\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  const getBalance = useCallback(async (): Promise<CreditBalanceResponse> => {\n    if (!apiClient) {\n      throw new Error('useCredits must be used within a CedrosLoginProvider');\n    }\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const data = await apiClient.get<CreditBalanceResponse>('/credits/balance/sol');\n      return data;\n    } catch (err) {\n      const apiError = handleApiError(err, 'Failed to fetch credit balance');\n      setError(apiError.message);\n      throw apiError;\n    } finally {\n      setIsLoading(false);\n    }\n  }, [apiClient]);\n\n  const getAllBalances = useCallback(async (): Promise<CreditBalanceResponse[]> => {\n    if (!apiClient) {\n      throw new Error('useCredits must be used within a CedrosLoginProvider');\n    }\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const data = await apiClient.get<BalancesResponse>('/credits/balance');\n      return data.balances;\n    } catch (err) {\n      const apiError = handleApiError(err, 'Failed to fetch credit balances');\n      setError(apiError.message);\n      throw apiError;\n    } finally {\n      setIsLoading(false);\n    }\n  }, [apiClient]);\n\n  const getHistory = useCallback(\n    async (options?: {\n      currency?: string;\n      limit?: number;\n      offset?: number;\n    }): Promise<CreditHistoryResponse> => {\n      if (!apiClient) {\n        throw new Error('useCredits must be used within a CedrosLoginProvider');\n      }\n      setIsLoading(true);\n      setError(null);\n\n      try {\n        const params = new URLSearchParams();\n        if (options?.currency) params.set('currency', options.currency);\n        if (options?.limit) params.set('limit', options.limit.toString());\n        if (options?.offset) params.set('offset', options.offset.toString());\n\n        const queryString = params.toString();\n        const url = queryString ? `/credits/history?${queryString}` : '/credits/history';\n\n        const data = await apiClient.get<CreditHistoryResponse>(url);\n        return data;\n      } catch (err) {\n        const apiError = handleApiError(err, 'Failed to fetch transaction history');\n        setError(apiError.message);\n        throw apiError;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [apiClient]\n  );\n\n  return {\n    getBalance,\n    getAllBalances,\n    getHistory,\n    isLoading,\n    error,\n    clearError,\n  };\n}\n","/**\n * Credit balance display component\n *\n * Shows the user's current credit balance from Privacy Cash deposits.\n * Can display single currency or all currencies.\n */\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { useCredits } from '../../hooks/useCredits';\nimport type { CreditBalanceResponse } from '../../types/deposit';\n\nexport interface CreditBalanceProps {\n  /** Show only SOL balance (default) or all currencies */\n  showAllCurrencies?: boolean;\n  /** Auto-refresh interval in milliseconds (0 to disable) */\n  refreshInterval?: number;\n  /** Compact display mode */\n  compact?: boolean;\n  /** Additional CSS classes */\n  className?: string;\n  /** Callback when balance is loaded */\n  onLoad?: (balance: CreditBalanceResponse[]) => void;\n}\n\n/**\n * Credit balance display\n *\n * Shows the user's credit balance. Supports auto-refresh.\n */\nexport function CreditBalance({\n  showAllCurrencies = false,\n  refreshInterval = 0,\n  compact = false,\n  className = '',\n  onLoad,\n}: CreditBalanceProps) {\n  const { getBalance, getAllBalances, isLoading, error, clearError } = useCredits();\n\n  const [balances, setBalances] = useState<CreditBalanceResponse[]>([]);\n  const [loadError, setLoadError] = useState<string | null>(null);\n\n  const fetchBalance = useCallback(async () => {\n    try {\n      if (showAllCurrencies) {\n        const result = await getAllBalances();\n        setBalances(result);\n        onLoad?.(result);\n      } else {\n        const result = await getBalance();\n        setBalances([result]);\n        onLoad?.([result]);\n      }\n      setLoadError(null);\n    } catch (err) {\n      setLoadError(err instanceof Error ? err.message : 'Failed to load balance');\n    }\n  }, [showAllCurrencies, getBalance, getAllBalances, onLoad]);\n\n  // Initial load\n  useEffect(() => {\n    fetchBalance();\n  }, [fetchBalance]);\n\n  // Auto-refresh\n  useEffect(() => {\n    if (refreshInterval <= 0) return;\n\n    const interval = setInterval(fetchBalance, refreshInterval);\n    return () => clearInterval(interval);\n  }, [refreshInterval, fetchBalance]);\n\n  // Error state\n  if (loadError || error) {\n    return (\n      <div className={`cedros-credit-balance cedros-credit-balance-error ${className}`}>\n        <p className=\"cedros-credit-error\">{loadError || error}</p>\n        <button\n          type=\"button\"\n          className=\"cedros-credit-retry\"\n          onClick={() => {\n            clearError();\n            setLoadError(null);\n            fetchBalance();\n          }}\n        >\n          Retry\n        </button>\n      </div>\n    );\n  }\n\n  // Loading state\n  if (isLoading && balances.length === 0) {\n    return (\n      <div className={`cedros-credit-balance cedros-credit-balance-loading ${className}`}>\n        <span className=\"cedros-credit-loading-indicator\" />\n        <span className=\"cedros-credit-loading-text\">Loading balance...</span>\n      </div>\n    );\n  }\n\n  // Compact display\n  if (compact) {\n    const primaryBalance = balances[0];\n    return (\n      <div className={`cedros-credit-balance cedros-credit-balance-compact ${className}`}>\n        {primaryBalance ? (\n          <span\n            className=\"cedros-credit-value\"\n            title={`${primaryBalance.balanceLamports} lamports`}\n          >\n            {primaryBalance.display}\n          </span>\n        ) : (\n          <span className=\"cedros-credit-value cedros-credit-value-zero\">0.0000 SOL</span>\n        )}\n        {isLoading && <span className=\"cedros-credit-refresh-indicator\" title=\"Refreshing...\" />}\n      </div>\n    );\n  }\n\n  // Full display\n  return (\n    <div className={`cedros-credit-balance ${className}`}>\n      <div className=\"cedros-credit-header\">\n        <h4 className=\"cedros-credit-title\">Credit Balance</h4>\n        <button\n          type=\"button\"\n          className=\"cedros-credit-refresh\"\n          onClick={fetchBalance}\n          disabled={isLoading}\n          title=\"Refresh balance\"\n        >\n          {isLoading ? '...' : ''}\n        </button>\n      </div>\n\n      {balances.length === 0 ? (\n        <div className=\"cedros-credit-empty\">\n          <p className=\"cedros-credit-empty-message\">No credit balance yet.</p>\n          <p className=\"cedros-credit-empty-hint\">Make a deposit to get started.</p>\n        </div>\n      ) : (\n        <div className=\"cedros-credit-list\">\n          {balances.map((balance) => (\n            <div key={balance.currency} className=\"cedros-credit-item\">\n              <span className=\"cedros-credit-currency\">{balance.currency}</span>\n              <span className=\"cedros-credit-amount\">{balance.display}</span>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","/**\n * History component\n *\n * Shows all account activity in a tabbed interface:\n * - All: Everything in chronological order\n * - Deposits: Incoming deposits with status tracking\n * - Usage: Service charges and spending\n * - Adjustments: Refunds, bonuses, and admin adjustments\n */\n\nimport { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useCredits } from '../../hooks/useCredits';\nimport type { CreditTransactionResponse, CreditHistoryResponse } from '../../types/deposit';\n\n/** History tab category for filtering */\nexport type HistoryCategory = 'all' | 'deposits' | 'usage' | 'adjustments';\n\n/** Tab configuration */\ninterface TabConfig {\n  key: HistoryCategory;\n  label: string;\n  txTypes: string[] | null; // null means show all\n}\n\nconst TABS: TabConfig[] = [\n  { key: 'all', label: 'All', txTypes: null },\n  { key: 'deposits', label: 'Deposits', txTypes: ['deposit'] },\n  { key: 'usage', label: 'Usage', txTypes: ['spend', 'usage', 'charge'] },\n  {\n    key: 'adjustments',\n    label: 'Adjustments',\n    txTypes: ['refund', 'adjustment', 'bonus', 'credit'],\n  },\n];\n\nexport interface HistoryProps {\n  /** Initially selected tab (default: 'all') */\n  defaultTab?: HistoryCategory;\n  /** Number of items per page (default: 10) */\n  pageSize?: number;\n  /** Auto-refresh interval in milliseconds (0 to disable) */\n  refreshInterval?: number;\n  /** Additional CSS classes */\n  className?: string;\n  /** Callback when history is loaded */\n  onLoad?: (history: CreditHistoryResponse) => void;\n  /** Callback when a transaction is clicked */\n  onTransactionClick?: (transaction: CreditTransactionResponse) => void;\n}\n\n/**\n * Format amount for display\n */\nfunction formatAmount(lamports: number, currency: string): string {\n  const isNegative = lamports < 0;\n  const absLamports = Math.abs(lamports);\n\n  // For stablecoins (6 decimals), show as dollars\n  // For SOL (9 decimals), show as SOL\n  const isSol = currency.toUpperCase() === 'SOL';\n  const decimals = isSol ? 9 : 6;\n  const amount = absLamports / Math.pow(10, decimals);\n\n  const prefix = isNegative ? '-' : '+';\n  if (isSol) {\n    return `${prefix}${amount.toFixed(4)} SOL`;\n  }\n  return `${prefix}$${amount.toFixed(2)}`;\n}\n\n/**\n * Format date for display\n */\nfunction formatDate(dateString: string): string {\n  const date = new Date(dateString);\n  const now = new Date();\n  const diffMs = now.getTime() - date.getTime();\n  const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\n\n  // Show relative time for recent transactions\n  if (diffDays === 0) {\n    const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n    if (diffHours === 0) {\n      const diffMins = Math.floor(diffMs / (1000 * 60));\n      if (diffMins < 1) return 'Just now';\n      return `${diffMins}m ago`;\n    }\n    return `${diffHours}h ago`;\n  }\n  if (diffDays === 1) return 'Yesterday';\n  if (diffDays < 7) return `${diffDays}d ago`;\n\n  // Show full date for older transactions\n  return date.toLocaleDateString(undefined, {\n    month: 'short',\n    day: 'numeric',\n    year: date.getFullYear() !== now.getFullYear() ? 'numeric' : undefined,\n  });\n}\n\n/**\n * Get display label for transaction type\n */\nfunction getTypeLabel(txType: string | undefined): string {\n  if (!txType) return 'Transaction';\n  const labels: Record<string, string> = {\n    deposit: 'Deposit',\n    spend: 'Usage',\n    usage: 'Usage',\n    charge: 'Charge',\n    refund: 'Refund',\n    adjustment: 'Adjustment',\n    bonus: 'Bonus',\n    credit: 'Credit',\n  };\n  return labels[txType.toLowerCase()] || txType;\n}\n\n/**\n * Get icon for transaction type\n */\nfunction getTypeIcon(txType: string | undefined, isPositive: boolean): string {\n  const type = (txType || '').toLowerCase();\n  if (type === 'deposit') return '';\n  if (type === 'spend' || type === 'usage' || type === 'charge') return '';\n  if (type === 'refund') return '';\n  if (type === 'bonus' || type === 'credit') return '';\n  if (type === 'adjustment') return isPositive ? '+' : '';\n  return isPositive ? '+' : '';\n}\n\n/**\n * History component with tabs\n */\nexport function History({\n  defaultTab = 'all',\n  pageSize = 10,\n  refreshInterval = 0,\n  className = '',\n  onLoad,\n  onTransactionClick,\n}: HistoryProps) {\n  const { getHistory, isLoading, error, clearError } = useCredits();\n\n  const [activeTab, setActiveTab] = useState<HistoryCategory>(defaultTab);\n  const [transactions, setTransactions] = useState<CreditTransactionResponse[]>([]);\n  const [total, setTotal] = useState(0);\n  const [offset, setOffset] = useState(0);\n  const [loadError, setLoadError] = useState<string | null>(null);\n\n  // Get current tab config\n  const currentTab = TABS.find((t) => t.key === activeTab) || TABS[0];\n\n  // Filter transactions based on active tab (useMemo to avoid extra renders)\n  const filteredTransactions = useMemo(() => {\n    if (currentTab.txTypes === null) {\n      return transactions;\n    }\n    return transactions.filter((tx) => {\n      const txType = tx.txType || '';\n      return currentTab.txTypes!.some((type) => txType.toLowerCase().includes(type.toLowerCase()));\n    });\n  }, [transactions, currentTab.txTypes]);\n\n  const fetchHistory = useCallback(async () => {\n    try {\n      // Fetch more than pageSize to allow client-side filtering\n      const result = await getHistory({ limit: pageSize * 3, offset });\n      setTransactions(result.transactions);\n      setTotal(result.total);\n      onLoad?.(result);\n      setLoadError(null);\n    } catch (err) {\n      setLoadError(err instanceof Error ? err.message : 'Failed to load history');\n    }\n  }, [pageSize, offset, getHistory, onLoad]);\n\n  // Reset offset when tab changes\n  useEffect(() => {\n    setOffset(0);\n  }, [activeTab]);\n\n  // Fetch on mount and when dependencies change\n  useEffect(() => {\n    fetchHistory();\n  }, [fetchHistory]);\n\n  // Auto-refresh\n  useEffect(() => {\n    if (refreshInterval <= 0) return;\n    const interval = setInterval(fetchHistory, refreshInterval);\n    return () => clearInterval(interval);\n  }, [refreshInterval, fetchHistory]);\n\n  const totalPages = Math.ceil(total / pageSize);\n  const currentPage = Math.floor(offset / pageSize) + 1;\n\n  const goToPage = (page: number) => {\n    const newOffset = (page - 1) * pageSize;\n    setOffset(Math.max(0, Math.min(newOffset, Math.max(0, total - 1))));\n  };\n\n  // Handle tab change\n  const handleTabChange = (tab: HistoryCategory) => {\n    setActiveTab(tab);\n  };\n\n  // Error state\n  if (loadError || error) {\n    return (\n      <div className={`cedros-tx-history cedros-tx-history-error ${className}`}>\n        <p className=\"cedros-tx-error\">{loadError || error}</p>\n        <button\n          type=\"button\"\n          className=\"cedros-tx-retry\"\n          onClick={() => {\n            clearError();\n            setLoadError(null);\n            fetchHistory();\n          }}\n        >\n          Retry\n        </button>\n      </div>\n    );\n  }\n\n  // Loading state (initial load only)\n  if (isLoading && transactions.length === 0) {\n    return (\n      <div className={`cedros-tx-history cedros-tx-history-loading ${className}`}>\n        <span className=\"cedros-tx-loading-indicator\" />\n        <span className=\"cedros-tx-loading-text\">Loading transactions...</span>\n      </div>\n    );\n  }\n\n  // Get count for each tab\n  const getTabCount = (tab: TabConfig): number => {\n    if (tab.txTypes === null) return transactions.length;\n    return transactions.filter((tx) => {\n      const txType = tx.txType || '';\n      return tab.txTypes!.some((type) => txType.toLowerCase().includes(type.toLowerCase()));\n    }).length;\n  };\n\n  return (\n    <div className={`cedros-tx-history ${className}`}>\n      {/* Header */}\n      <div className=\"cedros-tx-header\">\n        <h4 className=\"cedros-tx-title\">Transaction History</h4>\n        <button\n          type=\"button\"\n          className=\"cedros-tx-refresh\"\n          onClick={fetchHistory}\n          disabled={isLoading}\n          title=\"Refresh\"\n        >\n          {isLoading ? '...' : ''}\n        </button>\n      </div>\n\n      {/* Tabs */}\n      <div className=\"cedros-tx-tabs\">\n        {TABS.map((tab) => {\n          const count = getTabCount(tab);\n          const isActive = activeTab === tab.key;\n          return (\n            <button\n              key={tab.key}\n              type=\"button\"\n              className={`cedros-tx-tab ${isActive ? 'cedros-tx-tab-active' : ''}`}\n              onClick={() => handleTabChange(tab.key)}\n            >\n              {tab.label}\n              {count > 0 && <span className=\"cedros-tx-tab-count\">{count}</span>}\n            </button>\n          );\n        })}\n      </div>\n\n      {/* Transaction List */}\n      {filteredTransactions.length === 0 ? (\n        <div className=\"cedros-tx-empty\">\n          <p className=\"cedros-tx-empty-message\">\n            {activeTab === 'all'\n              ? 'No transactions yet.'\n              : `No ${currentTab.label.toLowerCase()} found.`}\n          </p>\n          {activeTab === 'all' && (\n            <p className=\"cedros-tx-empty-hint\">Make a deposit to get started.</p>\n          )}\n        </div>\n      ) : (\n        <>\n          <div className=\"cedros-tx-list\">\n            {filteredTransactions.slice(0, pageSize).map((tx) => {\n              const isPositive = tx.amountLamports >= 0;\n              return (\n                <div\n                  key={tx.id}\n                  className={`cedros-tx-item ${isPositive ? 'cedros-tx-item-positive' : 'cedros-tx-item-negative'}`}\n                  onClick={() => onTransactionClick?.(tx)}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter' || e.key === ' ') {\n                      e.preventDefault();\n                      onTransactionClick?.(tx);\n                    }\n                  }}\n                  role={onTransactionClick ? 'button' : undefined}\n                  tabIndex={onTransactionClick ? 0 : undefined}\n                >\n                  {/* Icon */}\n                  <div\n                    className={`cedros-tx-icon ${isPositive ? 'cedros-tx-icon-positive' : 'cedros-tx-icon-negative'}`}\n                  >\n                    {getTypeIcon(tx.txType, isPositive)}\n                  </div>\n\n                  {/* Main content */}\n                  <div className=\"cedros-tx-content\">\n                    <div className=\"cedros-tx-row-main\">\n                      <span className=\"cedros-tx-type\">{getTypeLabel(tx.txType)}</span>\n                      <span\n                        className={`cedros-tx-amount ${isPositive ? 'cedros-tx-amount-positive' : 'cedros-tx-amount-negative'}`}\n                      >\n                        {formatAmount(tx.amountLamports, tx.currency)}\n                      </span>\n                    </div>\n                    <div className=\"cedros-tx-row-details\">\n                      <span className=\"cedros-tx-description\">{tx.description}</span>\n                      <span className=\"cedros-tx-date\">{formatDate(tx.createdAt)}</span>\n                    </div>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n\n          {/* Pagination */}\n          {totalPages > 1 && (\n            <div className=\"cedros-tx-pagination\">\n              <button\n                type=\"button\"\n                className=\"cedros-tx-page-btn\"\n                onClick={() => goToPage(currentPage - 1)}\n                disabled={currentPage <= 1}\n              >\n                Previous\n              </button>\n              <span className=\"cedros-tx-page-info\">\n                Page {currentPage} of {totalPages}\n              </span>\n              <button\n                type=\"button\"\n                className=\"cedros-tx-page-btn\"\n                onClick={() => goToPage(currentPage + 1)}\n                disabled={currentPage >= totalPages}\n              >\n                Next\n              </button>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n","/**\n * Hook for user withdrawal operations\n *\n * Handles withdrawing SOL or SPL tokens from the user's embedded wallet\n * to an external Solana address. Also fetches wallet token balances.\n *\n * Requires an unlocked SSS wallet and feature_user_withdrawals enabled.\n *\n * Safe to call outside CedrosLoginProvider (returns no-op functions).\n */\n\nimport { useState, useCallback, useMemo } from 'react';\nimport { useCedrosLoginOptional } from '../context/useCedrosLogin';\nimport { ApiClient, handleApiError } from '../utils/apiClient';\nimport type {\n  UseWithdrawalReturn,\n  WithdrawalResponse,\n  WalletBalancesResponse,\n  UserWithdrawalHistoryResponse,\n} from '../types/withdrawal';\n\nexport type { UseWithdrawalReturn } from '../types/withdrawal';\n\nexport function useWithdrawal(): UseWithdrawalReturn {\n  const context = useCedrosLoginOptional();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [lastResult, setLastResult] = useState<WithdrawalResponse | null>(null);\n\n  const apiClient = useMemo(() => {\n    if (!context) return null;\n    return new ApiClient({\n      baseUrl: context.config.serverUrl,\n      timeoutMs: context.config.requestTimeout,\n      retryAttempts: context.config.retryAttempts,\n      getAccessToken: context._internal?.getAccessToken,\n    });\n  }, [context]);\n\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n\n  const getBalances = useCallback(async (): Promise<WalletBalancesResponse> => {\n    if (!apiClient) {\n      throw new Error('useWithdrawal must be used within a CedrosLoginProvider');\n    }\n\n    try {\n      return await apiClient.get<WalletBalancesResponse>('/wallet/withdraw/balances');\n    } catch (err) {\n      const apiError = handleApiError(err, 'Failed to fetch wallet balances');\n      setError(apiError.message);\n      throw apiError;\n    }\n  }, [apiClient]);\n\n  const withdrawSol = useCallback(\n    async (destination: string, amountLamports: number): Promise<WithdrawalResponse> => {\n      if (!apiClient) {\n        throw new Error('useWithdrawal must be used within a CedrosLoginProvider');\n      }\n      setIsSubmitting(true);\n      setError(null);\n\n      try {\n        const data = await apiClient.post<WithdrawalResponse>('/wallet/withdraw/sol', {\n          destination,\n          amount_lamports: amountLamports,\n        });\n        setLastResult(data);\n        return data;\n      } catch (err) {\n        const apiError = handleApiError(err, 'Failed to withdraw SOL');\n        setError(apiError.message);\n        throw apiError;\n      } finally {\n        setIsSubmitting(false);\n      }\n    },\n    [apiClient]\n  );\n\n  const withdrawSpl = useCallback(\n    async (destination: string, tokenMint: string, amount: string): Promise<WithdrawalResponse> => {\n      if (!apiClient) {\n        throw new Error('useWithdrawal must be used within a CedrosLoginProvider');\n      }\n      setIsSubmitting(true);\n      setError(null);\n\n      try {\n        const data = await apiClient.post<WithdrawalResponse>('/wallet/withdraw/spl', {\n          destination,\n          token_mint: tokenMint,\n          amount,\n        });\n        setLastResult(data);\n        return data;\n      } catch (err) {\n        const apiError = handleApiError(err, 'Failed to withdraw token');\n        setError(apiError.message);\n        throw apiError;\n      } finally {\n        setIsSubmitting(false);\n      }\n    },\n    [apiClient]\n  );\n\n  const getHistory = useCallback(\n    async (limit = 10, offset = 0): Promise<UserWithdrawalHistoryResponse> => {\n      if (!apiClient) {\n        throw new Error('useWithdrawal must be used within a CedrosLoginProvider');\n      }\n\n      try {\n        const clampedLimit = Math.max(1, Math.min(100, Math.trunc(limit)));\n        const clampedOffset = Math.max(0, Math.trunc(offset));\n        const params = new URLSearchParams({\n          limit: String(clampedLimit),\n          offset: String(clampedOffset),\n        });\n        return await apiClient.get<UserWithdrawalHistoryResponse>(\n          `/wallet/withdraw/history?${params}`\n        );\n      } catch (err) {\n        const apiError = handleApiError(err, 'Failed to fetch withdrawal history');\n        setError(apiError.message);\n        throw apiError;\n      }\n    },\n    [apiClient]\n  );\n\n  return {\n    withdrawSol,\n    withdrawSpl,\n    getBalances,\n    getHistory,\n    isSubmitting,\n    error,\n    clearError,\n    lastResult,\n  };\n}\n","/**\n * WithdrawalFlow  multi-step flow for withdrawing SOL/SPL tokens\n * from the user's embedded wallet to an external Solana address.\n *\n * Fetches actual token balances from the wallet on mount.\n * Steps: Token Select  Form  Confirm  Processing  Success\n */\n\nimport { useState, useCallback, useMemo, useEffect } from 'react';\nimport { useCedrosLoginOptional } from '../../context/useCedrosLogin';\nimport { useWithdrawal } from '../../hooks/useWithdrawal';\nimport { ErrorMessage } from '../shared/ErrorMessage';\nimport { LoadingSpinner } from '../shared/LoadingSpinner';\nimport type { WithdrawalResponse } from '../../types/withdrawal';\n\n/** A token the user holds, derived from balance fetch */\ninterface HeldToken {\n  symbol: string;\n  mint: string;\n  decimals: number;\n  /** Raw amount in smallest units */\n  rawBalance: string;\n  /** Human-readable balance */\n  displayBalance: string;\n}\n\n/** Native SOL mint (used as sentinel) */\nconst SOL_MINT = 'So11111111111111111111111111111111111111112';\n\n/** Well-known mint  symbol mapping for display */\nconst KNOWN_MINTS: Record<string, string> = {\n  EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v: 'USDC',\n  Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB: 'USDT',\n  HzwqbKZw8HxMN6bF2yFZNrht3c2iXXzpKcFu7uBEDKtr: 'EURC',\n  USD1ttGY1N17NEEHLmELoaybftRBUSErhqYiQzvEmuB: 'USD1',\n  '2b1kV6DkPAnxd5ixfnxCpjxmKwqjjaYmCZfHsFu24GXo': 'PYUSD',\n  USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX: 'USDH',\n  CASHVDm2wsJXfhj6VWxb7GiMdoLc17Du7paH4bNr5woT: 'CASH',\n  DezXAZ8z7PnrnRJjz3wXBoRgixCa6xjnB7YaB1pPB263: 'BONK',\n  oreoU2P8bN6jkk3jbaiVxYnG1dCXcYxwhwyK9jSybcp: 'ORE',\n};\n\ntype FlowStep = 'loading' | 'select' | 'form' | 'confirm' | 'processing' | 'success';\n\nexport interface WithdrawalFlowProps {\n  onSuccess?: (result: WithdrawalResponse) => void;\n  onError?: (error: Error) => void;\n  onCancel?: () => void;\n  className?: string;\n}\n\nfunction isValidSolanaAddress(address: string): boolean {\n  if (address.length < 32 || address.length > 50) return false;\n  return /^[1-9A-HJ-NP-Za-km-z]+$/.test(address);\n}\n\nfunction truncateAddress(address: string): string {\n  if (address.length <= 16) return address;\n  return `${address.slice(0, 6)}...${address.slice(-6)}`;\n}\n\nfunction formatTokenAmount(raw: string, decimals: number): string {\n  const num = Number(raw) / Math.pow(10, decimals);\n  return num.toLocaleString(undefined, {\n    minimumFractionDigits: 2,\n    maximumFractionDigits: Math.min(decimals, 6),\n  });\n}\n\nexport function WithdrawalFlow({\n  onSuccess,\n  onError,\n  onCancel,\n  className = '',\n}: WithdrawalFlowProps) {\n  const context = useCedrosLoginOptional();\n  const { withdrawSol, withdrawSpl, getBalances, isSubmitting, error, clearError } =\n    useWithdrawal();\n\n  const [step, setStep] = useState<FlowStep>('loading');\n  const [heldTokens, setHeldTokens] = useState<HeldToken[]>([]);\n  const [selectedToken, setSelectedToken] = useState<HeldToken | null>(null);\n  const [destination, setDestination] = useState('');\n  const [amount, setAmount] = useState('');\n  const [result, setResult] = useState<WithdrawalResponse | null>(null);\n  const [validationError, setValidationError] = useState<string | null>(null);\n  const [loadError, setLoadError] = useState<string | null>(null);\n\n  const network = context?.config.solana?.network ?? 'mainnet-beta';\n\n  const explorerTxUrl = useMemo(() => {\n    if (!result?.txSignature) return '';\n    const base = `https://explorer.solana.com/tx/${result.txSignature}`;\n    if (network === 'mainnet-beta') return base;\n    return `${base}?cluster=${encodeURIComponent(network)}`;\n  }, [result, network]);\n\n  // Convert human-readable amount to raw token units\n  const rawAmount = useMemo(() => {\n    if (!selectedToken || !amount) return '0';\n    const num = parseFloat(amount);\n    if (isNaN(num) || num <= 0) return '0';\n    return Math.floor(num * Math.pow(10, selectedToken.decimals)).toString();\n  }, [amount, selectedToken]);\n\n  // Fetch balances on mount\n  useEffect(() => {\n    if (!context) return;\n\n    let cancelled = false;\n    (async () => {\n      try {\n        const balances = await getBalances();\n        if (cancelled) return;\n\n        const tokens: HeldToken[] = [];\n\n        // SOL (always show if > 0)\n        if (balances.solLamports > 0) {\n          tokens.push({\n            symbol: 'SOL',\n            mint: SOL_MINT,\n            decimals: 9,\n            rawBalance: String(balances.solLamports),\n            displayBalance: formatTokenAmount(String(balances.solLamports), 9),\n          });\n        }\n\n        // SPL tokens\n        for (const t of balances.tokens) {\n          const symbol = KNOWN_MINTS[t.mint] ?? truncateAddress(t.mint);\n          tokens.push({\n            symbol,\n            mint: t.mint,\n            decimals: t.decimals,\n            rawBalance: t.amount,\n            displayBalance: formatTokenAmount(t.amount, t.decimals),\n          });\n        }\n\n        setHeldTokens(tokens);\n        setStep(tokens.length > 0 ? 'select' : 'select');\n      } catch {\n        if (!cancelled) {\n          setLoadError('Failed to load wallet balances');\n          setStep('select');\n        }\n      }\n    })();\n\n    return () => {\n      cancelled = true;\n    };\n  }, [context, getBalances]);\n\n  const handleSelectToken = useCallback(\n    (token: HeldToken) => {\n      setSelectedToken(token);\n      setStep('form');\n      clearError();\n      setValidationError(null);\n      setAmount('');\n    },\n    [clearError]\n  );\n\n  const handleMax = useCallback(() => {\n    if (!selectedToken) return;\n    const maxHuman = Number(selectedToken.rawBalance) / Math.pow(10, selectedToken.decimals);\n    // For SOL, leave some for fees\n    if (selectedToken.mint === SOL_MINT) {\n      const reserved = 0.01; // ~10k lamports buffer for fees + rent\n      setAmount(String(Math.max(0, maxHuman - reserved)));\n    } else {\n      setAmount(String(maxHuman));\n    }\n  }, [selectedToken]);\n\n  const handleFormSubmit = useCallback(() => {\n    setValidationError(null);\n\n    if (!destination.trim()) {\n      setValidationError('Destination address is required');\n      return;\n    }\n    if (!isValidSolanaAddress(destination.trim())) {\n      setValidationError('Invalid Solana address');\n      return;\n    }\n    if (!amount || parseFloat(amount) <= 0 || isNaN(parseFloat(amount))) {\n      setValidationError('Please enter a valid amount');\n      return;\n    }\n    if (rawAmount === '0') {\n      setValidationError('Amount is too small');\n      return;\n    }\n\n    setStep('confirm');\n  }, [destination, amount, rawAmount]);\n\n  const handleConfirm = useCallback(async () => {\n    if (!selectedToken) return;\n    setStep('processing');\n    clearError();\n\n    try {\n      let txResult: WithdrawalResponse;\n\n      if (selectedToken.mint === SOL_MINT) {\n        txResult = await withdrawSol(destination.trim(), Number(rawAmount));\n      } else {\n        txResult = await withdrawSpl(destination.trim(), selectedToken.mint, rawAmount);\n      }\n\n      setResult(txResult);\n      setStep('success');\n      onSuccess?.(txResult);\n    } catch (err) {\n      setStep('confirm');\n      onError?.(err instanceof Error ? err : new Error(String(err)));\n    }\n  }, [\n    selectedToken,\n    destination,\n    rawAmount,\n    withdrawSol,\n    withdrawSpl,\n    clearError,\n    onSuccess,\n    onError,\n  ]);\n\n  const handleBack = useCallback(() => {\n    clearError();\n    setValidationError(null);\n    if (step === 'form') {\n      setStep('select');\n      setSelectedToken(null);\n      setAmount('');\n      setDestination('');\n    } else if (step === 'confirm') {\n      setStep('form');\n    }\n  }, [step, clearError]);\n\n  const handleReset = useCallback(() => {\n    setStep('select');\n    setSelectedToken(null);\n    setDestination('');\n    setAmount('');\n    setResult(null);\n    clearError();\n    setValidationError(null);\n  }, [clearError]);\n\n  if (!context) return null;\n\n  return (\n    <div className={`cedros-withdrawal ${className}`}>\n      {/* Loading */}\n      {step === 'loading' && (\n        <div className=\"cedros-withdrawal-processing\">\n          <LoadingSpinner />\n          <p className=\"cedros-withdrawal-processing-text\">Loading wallet balances...</p>\n        </div>\n      )}\n\n      {/* Token Select */}\n      {step === 'select' && (\n        <div className=\"cedros-withdrawal-select\">\n          <div className=\"cedros-withdrawal-header\">\n            <h3 className=\"cedros-withdrawal-title\">Withdraw</h3>\n            <p className=\"cedros-withdrawal-subtitle\">Select a token to withdraw</p>\n          </div>\n\n          {loadError && <ErrorMessage error={loadError} />}\n\n          {heldTokens.length === 0 && !loadError && (\n            <p className=\"cedros-withdrawal-empty\">No tokens found in your wallet.</p>\n          )}\n\n          <div className=\"cedros-withdrawal-tokens\">\n            {heldTokens.map((token) => (\n              <button\n                key={token.mint}\n                type=\"button\"\n                className=\"cedros-withdrawal-token-pill\"\n                onClick={() => handleSelectToken(token)}\n              >\n                <span className=\"cedros-withdrawal-token-symbol\">{token.symbol}</span>\n                <span className=\"cedros-withdrawal-token-balance\">{token.displayBalance}</span>\n              </button>\n            ))}\n          </div>\n\n          {onCancel && (\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-ghost cedros-withdrawal-cancel\"\n              onClick={onCancel}\n            >\n              Cancel\n            </button>\n          )}\n        </div>\n      )}\n\n      {/* Form */}\n      {step === 'form' && selectedToken && (\n        <div className=\"cedros-withdrawal-form\">\n          <div className=\"cedros-withdrawal-header\">\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-ghost cedros-button-sm\"\n              onClick={handleBack}\n            >\n              Back\n            </button>\n            <h3 className=\"cedros-withdrawal-title\">Withdraw {selectedToken.symbol}</h3>\n          </div>\n\n          <div className=\"cedros-withdrawal-balance-hint\">\n            Balance: {selectedToken.displayBalance} {selectedToken.symbol}\n          </div>\n\n          <div className=\"cedros-withdrawal-field\">\n            <label className=\"cedros-label\" htmlFor=\"cedros-withdrawal-destination\">\n              Destination Address\n            </label>\n            <input\n              id=\"cedros-withdrawal-destination\"\n              type=\"text\"\n              className=\"cedros-input\"\n              placeholder=\"Solana address (base58)\"\n              value={destination}\n              onChange={(e) => setDestination(e.target.value)}\n              autoComplete=\"off\"\n              spellCheck={false}\n            />\n          </div>\n\n          <div className=\"cedros-withdrawal-field\">\n            <label className=\"cedros-label\" htmlFor=\"cedros-withdrawal-amount\">\n              Amount ({selectedToken.symbol})\n            </label>\n            <div className=\"cedros-withdrawal-amount-row\">\n              <input\n                id=\"cedros-withdrawal-amount\"\n                type=\"number\"\n                className=\"cedros-input\"\n                placeholder=\"0.00\"\n                value={amount}\n                onChange={(e) => setAmount(e.target.value)}\n                min=\"0\"\n                step=\"any\"\n              />\n              <button\n                type=\"button\"\n                className=\"cedros-button cedros-button-ghost cedros-button-sm\"\n                onClick={handleMax}\n              >\n                Max\n              </button>\n            </div>\n          </div>\n\n          {(validationError || error) && <ErrorMessage error={validationError || error || ''} />}\n\n          <button\n            type=\"button\"\n            className=\"cedros-button cedros-button-primary cedros-withdrawal-submit\"\n            onClick={handleFormSubmit}\n          >\n            Review Withdrawal\n          </button>\n        </div>\n      )}\n\n      {/* Confirm */}\n      {step === 'confirm' && selectedToken && (\n        <div className=\"cedros-withdrawal-confirm\">\n          <div className=\"cedros-withdrawal-header\">\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-ghost cedros-button-sm\"\n              onClick={handleBack}\n              disabled={isSubmitting}\n            >\n              Back\n            </button>\n            <h3 className=\"cedros-withdrawal-title\">Confirm Withdrawal</h3>\n          </div>\n\n          <div className=\"cedros-withdrawal-summary\">\n            <div className=\"cedros-withdrawal-summary-row\">\n              <span className=\"cedros-withdrawal-summary-label\">Token</span>\n              <span className=\"cedros-withdrawal-summary-value\">{selectedToken.symbol}</span>\n            </div>\n            <div className=\"cedros-withdrawal-summary-row\">\n              <span className=\"cedros-withdrawal-summary-label\">Amount</span>\n              <span className=\"cedros-withdrawal-summary-value\">\n                {formatTokenAmount(rawAmount, selectedToken.decimals)} {selectedToken.symbol}\n              </span>\n            </div>\n            <div className=\"cedros-withdrawal-summary-row\">\n              <span className=\"cedros-withdrawal-summary-label\">Destination</span>\n              <span className=\"cedros-withdrawal-summary-value\" title={destination}>\n                {truncateAddress(destination)}\n              </span>\n            </div>\n            <div className=\"cedros-withdrawal-summary-row\">\n              <span className=\"cedros-withdrawal-summary-label\">Est. Fee</span>\n              <span className=\"cedros-withdrawal-summary-value\">~0.000005 SOL</span>\n            </div>\n          </div>\n\n          {error && <ErrorMessage error={error} />}\n\n          <div className=\"cedros-withdrawal-actions\">\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-outline\"\n              onClick={handleBack}\n              disabled={isSubmitting}\n            >\n              Cancel\n            </button>\n            <button\n              type=\"button\"\n              className=\"cedros-button cedros-button-primary\"\n              onClick={handleConfirm}\n              disabled={isSubmitting}\n            >\n              {isSubmitting ? 'Sending...' : 'Confirm & Send'}\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Processing */}\n      {step === 'processing' && (\n        <div className=\"cedros-withdrawal-processing\">\n          <LoadingSpinner />\n          <p className=\"cedros-withdrawal-processing-text\">Sending {selectedToken?.symbol}...</p>\n        </div>\n      )}\n\n      {/* Success */}\n      {step === 'success' && result && (\n        <div className=\"cedros-withdrawal-success\">\n          <div className=\"cedros-withdrawal-success-icon\">&#10003;</div>\n          <h3 className=\"cedros-withdrawal-title\">Withdrawal Complete</h3>\n          <p className=\"cedros-withdrawal-subtitle\">\n            {formatTokenAmount(rawAmount, selectedToken?.decimals ?? 9)} {selectedToken?.symbol}{' '}\n            sent\n          </p>\n\n          <div className=\"cedros-withdrawal-tx\">\n            <span className=\"cedros-withdrawal-tx-label\">Transaction</span>\n            <a\n              className=\"cedros-withdrawal-tx-link\"\n              href={explorerTxUrl}\n              target=\"_blank\"\n              rel=\"noreferrer\"\n            >\n              {truncateAddress(result.txSignature)}\n            </a>\n          </div>\n\n          <button\n            type=\"button\"\n            className=\"cedros-button cedros-button-outline cedros-withdrawal-done\"\n            onClick={handleReset}\n          >\n            Done\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n","/**\n * WithdrawalHistory component\n *\n * Shows a paginated list of user-initiated withdrawals (SOL/SPL to external addresses).\n * Each row shows token, amount, destination, date, and links to Solana explorer.\n */\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { useWithdrawal } from '../../hooks/useWithdrawal';\nimport { SUPPORTED_TOKENS } from '../deposit/tokens';\nimport type {\n  UserWithdrawalHistoryItem,\n  UserWithdrawalHistoryResponse,\n} from '../../types/withdrawal';\n\nexport interface WithdrawalHistoryProps {\n  /** Number of items per page (default: 10) */\n  pageSize?: number;\n  /** Additional CSS classes */\n  className?: string;\n  /** Callback when a transaction row is clicked */\n  onTransactionClick?: (item: UserWithdrawalHistoryItem) => void;\n  /** Solana explorer base URL (default: https://solscan.io) */\n  explorerUrl?: string;\n}\n\n/** Resolve a mint address to a symbol, falling back to truncated address */\nfunction resolveTokenSymbol(tokenType: string, tokenMint: string | null): string {\n  if (tokenType === 'sol') return 'SOL';\n  if (!tokenMint) return 'SPL';\n  const known = SUPPORTED_TOKENS.find((t) => t.mint === tokenMint);\n  if (known) return known.symbol;\n  return `${tokenMint.slice(0, 4)}...${tokenMint.slice(-4)}`;\n}\n\n/** Truncate a Solana address for display */\nfunction truncateAddress(addr: string): string {\n  if (addr.length <= 12) return addr;\n  return `${addr.slice(0, 4)}...${addr.slice(-4)}`;\n}\n\n/** Format date for display */\nfunction formatDate(dateString: string): string {\n  const date = new Date(dateString);\n  const now = new Date();\n  const diffMs = now.getTime() - date.getTime();\n  const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\n\n  if (diffDays === 0) {\n    const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n    if (diffHours === 0) {\n      const diffMins = Math.floor(diffMs / (1000 * 60));\n      if (diffMins < 1) return 'Just now';\n      return `${diffMins}m ago`;\n    }\n    return `${diffHours}h ago`;\n  }\n  if (diffDays === 1) return 'Yesterday';\n  if (diffDays < 7) return `${diffDays}d ago`;\n\n  return date.toLocaleDateString(undefined, {\n    month: 'short',\n    day: 'numeric',\n    year: date.getFullYear() !== now.getFullYear() ? 'numeric' : undefined,\n  });\n}\n\nexport function WithdrawalHistory({\n  pageSize = 10,\n  className = '',\n  onTransactionClick,\n  explorerUrl = 'https://solscan.io',\n}: WithdrawalHistoryProps) {\n  const { getHistory, error, clearError } = useWithdrawal();\n\n  const [items, setItems] = useState<UserWithdrawalHistoryItem[]>([]);\n  const [total, setTotal] = useState(0);\n  const [offset, setOffset] = useState(0);\n  const [isLoading, setIsLoading] = useState(false);\n  const [loadError, setLoadError] = useState<string | null>(null);\n\n  const fetchHistory = useCallback(async () => {\n    setIsLoading(true);\n    try {\n      const result: UserWithdrawalHistoryResponse = await getHistory(pageSize, offset);\n      setItems(result.items);\n      setTotal(result.total);\n      setLoadError(null);\n    } catch (err) {\n      setLoadError(err instanceof Error ? err.message : 'Failed to load withdrawal history');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [pageSize, offset, getHistory]);\n\n  useEffect(() => {\n    fetchHistory();\n  }, [fetchHistory]);\n\n  const totalPages = Math.ceil(total / pageSize);\n  const currentPage = Math.floor(offset / pageSize) + 1;\n\n  const goToPage = (page: number) => {\n    const newOffset = (page - 1) * pageSize;\n    setOffset(Math.max(0, Math.min(newOffset, Math.max(0, total - 1))));\n  };\n\n  // Error state\n  if (loadError || error) {\n    return (\n      <div className={`cedros-withdrawal-history cedros-withdrawal-history-error ${className}`}>\n        <p className=\"cedros-withdrawal-error\">{loadError || error}</p>\n        <button\n          type=\"button\"\n          className=\"cedros-withdrawal-retry\"\n          onClick={() => {\n            clearError();\n            setLoadError(null);\n            fetchHistory();\n          }}\n        >\n          Retry\n        </button>\n      </div>\n    );\n  }\n\n  // Loading state (initial)\n  if (isLoading && items.length === 0) {\n    return (\n      <div className={`cedros-withdrawal-history cedros-withdrawal-history-loading ${className}`}>\n        <span className=\"cedros-tx-loading-indicator\" />\n        <span className=\"cedros-tx-loading-text\">Loading withdrawal history...</span>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`cedros-withdrawal-history ${className}`}>\n      {/* Header */}\n      <div className=\"cedros-tx-header\">\n        <h4 className=\"cedros-tx-title\">Withdrawal History</h4>\n        <button\n          type=\"button\"\n          className=\"cedros-tx-refresh\"\n          onClick={fetchHistory}\n          disabled={isLoading}\n          title=\"Refresh\"\n        >\n          {isLoading ? '...' : '\\u21BB'}\n        </button>\n      </div>\n\n      {/* List */}\n      {items.length === 0 ? (\n        <div className=\"cedros-tx-empty\">\n          <p className=\"cedros-tx-empty-message\">No withdrawal history yet.</p>\n        </div>\n      ) : (\n        <>\n          <div className=\"cedros-tx-list\">\n            {items.map((item) => {\n              const symbol = resolveTokenSymbol(item.tokenType, item.tokenMint);\n              return (\n                <div\n                  key={item.id}\n                  className=\"cedros-tx-item cedros-tx-item-negative\"\n                  onClick={() => onTransactionClick?.(item)}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter' || e.key === ' ') {\n                      e.preventDefault();\n                      onTransactionClick?.(item);\n                    }\n                  }}\n                  role={onTransactionClick ? 'button' : undefined}\n                  tabIndex={onTransactionClick ? 0 : undefined}\n                >\n                  <div className=\"cedros-tx-icon cedros-tx-icon-negative\">{'\\u2191'}</div>\n                  <div className=\"cedros-tx-content\">\n                    <div className=\"cedros-tx-row-main\">\n                      <span className=\"cedros-tx-type\">{symbol} Withdrawal</span>\n                      <span className=\"cedros-tx-amount cedros-tx-amount-negative\">\n                        {item.amount} {symbol === 'SOL' ? 'lamports' : ''}\n                      </span>\n                    </div>\n                    <div className=\"cedros-tx-row-details\">\n                      <span className=\"cedros-tx-description\">\n                        To{' '}\n                        <a\n                          href={`${explorerUrl}/account/${item.destination}`}\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                          onClick={(e) => e.stopPropagation()}\n                        >\n                          {truncateAddress(item.destination)}\n                        </a>\n                        {' \\u00B7 '}\n                        <a\n                          href={`${explorerUrl}/tx/${item.txSignature}`}\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                          onClick={(e) => e.stopPropagation()}\n                        >\n                          tx\n                        </a>\n                      </span>\n                      <span className=\"cedros-tx-date\">{formatDate(item.createdAt)}</span>\n                    </div>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n\n          {/* Pagination */}\n          {totalPages > 1 && (\n            <div className=\"cedros-tx-pagination\">\n              <button\n                type=\"button\"\n                className=\"cedros-tx-page-btn\"\n                onClick={() => goToPage(currentPage - 1)}\n                disabled={currentPage <= 1}\n              >\n                Previous\n              </button>\n              <span className=\"cedros-tx-page-info\">\n                Page {currentPage} of {totalPages}\n              </span>\n              <button\n                type=\"button\"\n                className=\"cedros-tx-page-btn\"\n                onClick={() => goToPage(currentPage + 1)}\n                disabled={currentPage >= totalPages}\n              >\n                Next\n              </button>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n","import type { ReactNode } from 'react';\nimport { LoginForm } from '../LoginForm';\n\nexport interface FullPageLayoutProps {\n  /** Brand logo element (e.g., an img or svg) */\n  brandLogo?: ReactNode;\n  /** Brand name displayed next to the logo */\n  brandName?: string;\n  /** Title displayed above the form. @default \"Welcome back\" */\n  title?: string;\n  /** Subtitle displayed below the title. @default \"Login with your Apple or Google account\" */\n  subtitle?: string;\n  /** Terms/legal text displayed below the card */\n  termsText?: ReactNode;\n  /** Called when login/register succeeds */\n  onSuccess?: () => void;\n  /** Default tab for the form. @default \"login\" */\n  defaultTab?: 'login' | 'register';\n  /** Custom content to render instead of LoginForm */\n  children?: ReactNode;\n  /** Additional CSS class for the outer container */\n  className?: string;\n}\n\n/**\n * Full page login layout with centered card on gradient background.\n * Follows shadcn/ui login block pattern.\n *\n * @example\n * ```tsx\n * // Basic usage\n * <FullPageLayout onSuccess={() => navigate('/dashboard')} />\n *\n * // With branding and terms\n * <FullPageLayout\n *   brandLogo={<img src=\"/logo.svg\" alt=\"\" />}\n *   brandName=\"Acme Inc.\"\n *   termsText={<>By clicking continue, you agree to our <a href=\"/terms\">Terms</a>.</>}\n *   onSuccess={handleSuccess}\n * />\n * ```\n */\nexport function FullPageLayout({\n  brandLogo,\n  brandName,\n  title = 'Welcome back',\n  subtitle = 'Login with your Apple or Google account',\n  termsText,\n  onSuccess,\n  defaultTab = 'login',\n  children,\n  className = '',\n}: FullPageLayoutProps) {\n  return (\n    <div className={`cedros-full-page-layout ${className}`}>\n      {/* Brand header */}\n      {(brandLogo || brandName) && (\n        <div className=\"cedros-brand-header\">\n          {brandLogo}\n          {brandName && <span className=\"cedros-brand-name\">{brandName}</span>}\n        </div>\n      )}\n\n      <div className=\"cedros-full-page-card\">\n        <div className=\"cedros-full-page-header\">\n          <h1 className=\"cedros-full-page-title\">{title}</h1>\n          {subtitle && <p className=\"cedros-full-page-subtitle\">{subtitle}</p>}\n        </div>\n        {children ?? <LoginForm defaultTab={defaultTab} onSuccess={onSuccess} />}\n      </div>\n\n      {/* Terms footer */}\n      {termsText && <p className=\"cedros-terms-footer\">{termsText}</p>}\n    </div>\n  );\n}\n","import type { ReactNode } from 'react';\nimport { LoginForm } from '../LoginForm';\n\nexport interface SplitPageLayoutProps {\n  /** Brand name or logo text displayed on the left panel */\n  brandName?: string;\n  /** Brand logo element (replaces default logo) */\n  brandLogo?: ReactNode;\n  /** Tagline displayed below the brand name */\n  tagline?: string;\n  /** Title displayed above the form. @default \"Sign in\" */\n  title?: string;\n  /** Subtitle displayed below the title */\n  subtitle?: string;\n  /** Called when login/register succeeds */\n  onSuccess?: () => void;\n  /** Default tab for the form. @default \"login\" */\n  defaultTab?: 'login' | 'register';\n  /** Custom content to render instead of LoginForm */\n  children?: ReactNode;\n  /** Additional CSS class for the outer container */\n  className?: string;\n}\n\n/**\n * Split page login layout with branding on the left and form on the right.\n *\n * @example\n * ```tsx\n * // Basic usage\n * <SplitPageLayout\n *   brandName=\"MyApp\"\n *   tagline=\"The best app for everything\"\n *   onSuccess={() => navigate('/dashboard')}\n * />\n *\n * // With custom logo\n * <SplitPageLayout\n *   brandLogo={<img src=\"/logo.svg\" alt=\"MyApp\" />}\n *   brandName=\"MyApp\"\n *   tagline=\"Enterprise-grade solutions\"\n *   title=\"Welcome back\"\n *   subtitle=\"Sign in to continue\"\n * />\n * ```\n */\nexport function SplitPageLayout({\n  brandName = 'Your Brand',\n  brandLogo,\n  tagline = 'Your tagline goes here. Make it compelling.',\n  title = 'Sign in',\n  subtitle = 'Enter your credentials to access your account',\n  onSuccess,\n  defaultTab = 'login',\n  children,\n  className = '',\n}: SplitPageLayoutProps) {\n  return (\n    <div className={`cedros-split-page-layout ${className}`}>\n      {/* Left side - Branding */}\n      <div className=\"cedros-split-page-brand\">\n        <div className=\"cedros-split-page-brand-content\">\n          {brandLogo ?? (\n            <div className=\"cedros-split-page-logo\">{brandName.charAt(0).toUpperCase()}</div>\n          )}\n          <h1 className=\"cedros-split-page-brand-name\">{brandName}</h1>\n          {tagline && <p className=\"cedros-split-page-tagline\">{tagline}</p>}\n        </div>\n      </div>\n\n      {/* Right side - Login form */}\n      <div className=\"cedros-split-page-form\">\n        <div className=\"cedros-split-page-form-content\">\n          <h2 className=\"cedros-split-page-title\">{title}</h2>\n          {subtitle && <p className=\"cedros-split-page-subtitle\">{subtitle}</p>}\n          {children ?? <LoginForm defaultTab={defaultTab} onSuccess={onSuccess} />}\n        </div>\n      </div>\n    </div>\n  );\n}\n","import type { Session, ListSessionsResponse, RevokeAllSessionsResponse } from '../types';\nimport { ApiClient, handleApiError } from './apiClient';\n\n/**\n * API client for session management operations\n */\nexport class SessionApiClient {\n  private client: ApiClient;\n\n  constructor(\n    baseUrl: string,\n    timeoutMs?: number,\n    retryAttempts?: number,\n    getAccessToken?: () => string | null\n  ) {\n    this.client = new ApiClient({ baseUrl, timeoutMs, retryAttempts, getAccessToken });\n  }\n\n  /**\n   * List all active sessions for the current user\n   */\n  async listSessions(): Promise<Session[]> {\n    try {\n      const response = await this.client.get<ListSessionsResponse>('/sessions');\n      return response.sessions;\n    } catch (error) {\n      throw handleApiError(error, 'Failed to list sessions');\n    }\n  }\n\n  /**\n   * Revoke all sessions (logout from all devices)\n   */\n  async revokeAllSessions(): Promise<RevokeAllSessionsResponse> {\n    try {\n      return await this.client.delete<RevokeAllSessionsResponse>('/sessions');\n    } catch (error) {\n      throw handleApiError(error, 'Failed to revoke sessions');\n    }\n  }\n}\n","import { useState, useCallback, useMemo, useEffect } from 'react';\nimport type { Session, AuthError, RevokeAllSessionsResponse } from '../types';\nimport { useCedrosLogin } from '../context/useCedrosLogin';\nimport { SessionApiClient } from '../utils/sessionApi';\n\nexport interface UseSessionsReturn {\n  /** List of active sessions */\n  sessions: Session[];\n  /** Loading state */\n  isLoading: boolean;\n  /** Error state */\n  error: AuthError | null;\n  /** Fetch/refresh sessions list */\n  fetchSessions: () => Promise<void>;\n  /** Revoke all sessions (logout everywhere) */\n  revokeAllSessions: () => Promise<RevokeAllSessionsResponse>;\n  /** Number of other active sessions (excluding current) */\n  otherSessionCount: number;\n}\n\n/**\n * Hook for managing user sessions across devices.\n *\n * @example\n * ```tsx\n * function SessionManager() {\n *   const { sessions, isLoading, revokeAllSessions, otherSessionCount } = useSessions();\n *\n *   return (\n *     <div>\n *       <h3>Active Sessions ({sessions.length})</h3>\n *       <ul>\n *         {sessions.map(session => (\n *           <li key={session.id}>\n *             {session.userAgent}\n *             {session.isCurrent && ' (current)'}\n *           </li>\n *         ))}\n *       </ul>\n *       {otherSessionCount > 0 && (\n *         <button onClick={revokeAllSessions}>\n *           Sign out of {otherSessionCount} other device(s)\n *         </button>\n *       )}\n *     </div>\n *   );\n * }\n * ```\n */\nexport function useSessions(): UseSessionsReturn {\n  const { config, authState, _internal } = useCedrosLogin();\n\n  const [sessions, setSessions] = useState<Session[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<AuthError | null>(null);\n\n  const apiClient = useMemo(\n    () =>\n      new SessionApiClient(\n        config.serverUrl,\n        config.requestTimeout,\n        config.retryAttempts,\n        _internal?.getAccessToken\n      ),\n    [config.serverUrl, config.requestTimeout, config.retryAttempts, _internal]\n  );\n\n  const fetchSessions = useCallback(async () => {\n    if (authState !== 'authenticated') {\n      setSessions([]);\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const fetchedSessions = await apiClient.listSessions();\n      setSessions(fetchedSessions);\n    } catch (err) {\n      setError(err as AuthError);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [authState, apiClient]);\n\n  // Auto-fetch when authenticated\n  useEffect(() => {\n    if (authState === 'authenticated') {\n      fetchSessions();\n    } else {\n      setSessions([]);\n    }\n  }, [authState, fetchSessions]);\n\n  const revokeAllSessions = useCallback(async (): Promise<RevokeAllSessionsResponse> => {\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const result = await apiClient.revokeAllSessions();\n      // Refresh sessions list after revoking\n      await fetchSessions();\n      return result;\n    } catch (err) {\n      setError(err as AuthError);\n      throw err;\n    } finally {\n      setIsLoading(false);\n    }\n  }, [apiClient, fetchSessions]);\n\n  const otherSessionCount = useMemo(() => {\n    return sessions.filter((s) => !s.isCurrent).length;\n  }, [sessions]);\n\n  return {\n    sessions,\n    isLoading,\n    error,\n    fetchSessions,\n    revokeAllSessions,\n    otherSessionCount,\n  };\n}\n","import { useState, useCallback, useMemo } from 'react';\nimport type { AuthorizeRequest, AuthError } from '../types';\nimport { useCedrosLogin } from '../context/useCedrosLogin';\nimport { OrgApiClient } from '../utils/orgApi';\n\nexport interface AuthorizationCheck {\n  allowed: boolean;\n  reason?: string;\n  isLoading: boolean;\n  error: AuthError | null;\n}\n\nexport interface UseAuthorizeReturn {\n  /**\n   * Check if an action is authorized server-side.\n   * Use this for dynamic authorization checks.\n   */\n  authorize: (request: AuthorizeRequest) => Promise<boolean>;\n  /**\n   * Authorization state for the last check\n   */\n  lastCheck: AuthorizationCheck;\n  /**\n   * Clear the last authorization check\n   */\n  clearCheck: () => void;\n  /**\n   * Check authorization and return detailed result\n   */\n  checkAuthorization: (request: AuthorizeRequest) => Promise<AuthorizationCheck>;\n}\n\n/**\n * Hook for server-side authorization checks.\n *\n * This hook allows you to check if a specific action is authorized\n * by making a request to the server's /authorize endpoint.\n *\n * For simple permission checks based on the user's role, use `useOrgs().hasPermission()` instead.\n *\n * @example\n * ```tsx\n * function DeleteButton({ resourceId }: { resourceId: string }) {\n *   const { authorize, lastCheck } = useAuthorize();\n *   const { activeOrg } = useOrgs();\n *\n *   const handleDelete = async () => {\n *     const allowed = await authorize({\n *       orgId: activeOrg?.id!,\n *       action: 'delete',\n *       resource: 'document',\n *       resourceId,\n *     });\n *\n *     if (allowed) {\n *       // Proceed with delete\n *     }\n *   };\n *\n *   return (\n *     <button onClick={handleDelete} disabled={lastCheck.isLoading}>\n *       Delete\n *     </button>\n *   );\n * }\n * ```\n */\nexport function useAuthorize(): UseAuthorizeReturn {\n  const { config, _internal } = useCedrosLogin();\n\n  const [lastCheck, setLastCheck] = useState<AuthorizationCheck>({\n    allowed: false,\n    reason: undefined,\n    isLoading: false,\n    error: null,\n  });\n\n  const apiClient = useMemo(\n    () =>\n      new OrgApiClient(\n        config.serverUrl,\n        config.requestTimeout,\n        config.retryAttempts,\n        _internal?.getAccessToken\n      ),\n    [config.serverUrl, config.requestTimeout, config.retryAttempts, _internal]\n  );\n\n  const checkAuthorization = useCallback(\n    async (request: AuthorizeRequest): Promise<AuthorizationCheck> => {\n      setLastCheck((prev) => ({ ...prev, isLoading: true, error: null }));\n\n      try {\n        const response = await apiClient.authorize(request);\n        const result: AuthorizationCheck = {\n          allowed: response.allowed,\n          reason: response.reason,\n          isLoading: false,\n          error: null,\n        };\n        setLastCheck(result);\n        return result;\n      } catch (err) {\n        const result: AuthorizationCheck = {\n          allowed: false,\n          reason: undefined,\n          isLoading: false,\n          error: err as AuthError,\n        };\n        setLastCheck(result);\n        return result;\n      }\n    },\n    [apiClient]\n  );\n\n  const authorize = useCallback(\n    async (request: AuthorizeRequest): Promise<boolean> => {\n      const result = await checkAuthorization(request);\n      return result.allowed;\n    },\n    [checkAuthorization]\n  );\n\n  const clearCheck = useCallback(() => {\n    setLastCheck({\n      allowed: false,\n      reason: undefined,\n      isLoading: false,\n      error: null,\n    });\n  }, []);\n\n  return {\n    authorize,\n    lastCheck,\n    clearCheck,\n    checkAuthorization,\n  };\n}\n","/**\n * High-level hook for multi-wallet management.\n *\n * Wraps useWalletMaterial to provide a simpler API for listing,\n * creating, and deleting derived wallets.\n */\n\nimport { useState, useCallback } from 'react';\nimport { useWalletMaterial } from './useWalletMaterial';\nimport type {\n  UseWalletsReturn,\n  DerivedWalletSummary,\n  DerivedWalletResponse,\n} from '../types/wallet';\n\n/**\n * Hook for multi-wallet management (default + derived wallets).\n *\n * Usage:\n * ```tsx\n * const { wallets, createWallet, deleteWallet, refresh } = useWallets();\n * ```\n */\nexport function useWallets(): UseWalletsReturn {\n  const { listAllWallets, createDerivedWallet, deleteDerivedWallet } = useWalletMaterial();\n  const [wallets, setWallets] = useState<DerivedWalletSummary[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const refresh = useCallback(async (): Promise<void> => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const response = await listAllWallets();\n      setWallets(response.wallets);\n    } catch (err) {\n      const message = err instanceof Error ? err.message : 'Failed to list wallets';\n      setError(message);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [listAllWallets]);\n\n  const createWallet = useCallback(\n    async (label: string): Promise<DerivedWalletResponse> => {\n      setIsLoading(true);\n      setError(null);\n      try {\n        const result = await createDerivedWallet({ label });\n        // Refresh the list after creation\n        await refresh();\n        return result;\n      } catch (err) {\n        const message = err instanceof Error ? err.message : 'Failed to create wallet';\n        setError(message);\n        throw err;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [createDerivedWallet, refresh]\n  );\n\n  const deleteWallet = useCallback(\n    async (walletId: string): Promise<void> => {\n      setIsLoading(true);\n      setError(null);\n      try {\n        await deleteDerivedWallet(walletId);\n        // Refresh the list after deletion\n        await refresh();\n      } catch (err) {\n        const message = err instanceof Error ? err.message : 'Failed to delete wallet';\n        setError(message);\n        throw err;\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [deleteDerivedWallet, refresh]\n  );\n\n  const clearError = useCallback(() => setError(null), []);\n\n  return {\n    wallets,\n    isLoading,\n    createWallet,\n    deleteWallet,\n    refresh,\n    error,\n    clearError,\n  };\n}\n","/**\n * Hook for pending wallet recovery management\n *\n * After wallet enrollment, if recovery mode is enabled, the server stores\n * recovery data temporarily. This hook fetches that data and allows the\n * user to acknowledge receipt (after which the data is deleted from server).\n */\n\nimport { useState, useCallback, useMemo, useEffect } from 'react';\nimport { useCedrosLoginOptional } from '../context/useCedrosLogin';\nimport { ApiClient, handleApiError } from '../utils/apiClient';\nimport type {\n  PendingWalletRecoveryResponse,\n  AcknowledgeRecoveryRequest,\n  MessageResponse,\n} from '../types/wallet';\n\nexport interface UsePendingRecoveryReturn {\n  /** Whether there is pending recovery data */\n  hasPendingRecovery: boolean;\n  /** Recovery type: 'share_c' or 'full_seed' */\n  recoveryType: string | null;\n  /** Recovery phrase (base64-encoded seed) */\n  recoveryPhrase: string | null;\n  /** When the recovery data expires */\n  expiresAt: Date | null;\n  /** Fetch pending recovery data from server */\n  fetchPendingRecovery: () => Promise<void>;\n  /** Acknowledge that user has saved the recovery phrase (deletes from server) */\n  acknowledgeRecovery: () => Promise<void>;\n  /** Whether request is in progress */\n  isLoading: boolean;\n  /** Error from last request */\n  error: string | null;\n  /** Clear error */\n  clearError: () => void;\n}\n\n/**\n * Hook for managing pending wallet recovery data\n *\n * Use this after wallet enrollment to show the user their recovery phrase\n * and allow them to acknowledge receipt.\n */\nexport function usePendingRecovery(): UsePendingRecoveryReturn {\n  const context = useCedrosLoginOptional();\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [pendingData, setPendingData] = useState<PendingWalletRecoveryResponse | null>(null);\n\n  const apiClient = useMemo(() => {\n    if (!context) return null;\n    return new ApiClient({\n      baseUrl: context.config.serverUrl,\n      timeoutMs: context.config.requestTimeout,\n      retryAttempts: context.config.retryAttempts,\n      getAccessToken: context._internal?.getAccessToken,\n    });\n  }, [context]);\n\n  const fetchPendingRecovery = useCallback(async (): Promise<void> => {\n    if (!apiClient) {\n      throw new Error('usePendingRecovery must be used within a CedrosLoginProvider');\n    }\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const data = await apiClient.get<PendingWalletRecoveryResponse>('/wallet/pending-recovery');\n      setPendingData(data);\n    } catch (err) {\n      const apiError = handleApiError(err, 'Failed to fetch pending recovery');\n      setError(apiError.message);\n      throw apiError;\n    } finally {\n      setIsLoading(false);\n    }\n  }, [apiClient]);\n\n  const acknowledgeRecovery = useCallback(async (): Promise<void> => {\n    if (!apiClient) {\n      throw new Error('usePendingRecovery must be used within a CedrosLoginProvider');\n    }\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      const request: AcknowledgeRecoveryRequest = { confirmed: true };\n      await apiClient.post<MessageResponse>('/wallet/acknowledge-recovery', request);\n      // Clear pending data after successful acknowledgment\n      setPendingData(null);\n    } catch (err) {\n      const apiError = handleApiError(err, 'Failed to acknowledge recovery');\n      setError(apiError.message);\n      throw apiError;\n    } finally {\n      setIsLoading(false);\n    }\n  }, [apiClient]);\n\n  const clearError = useCallback(() => setError(null), []);\n\n  // Auto-fetch on mount if authenticated\n  useEffect(() => {\n    if (apiClient && context?.authState === 'authenticated') {\n      fetchPendingRecovery().catch(() => {\n        // Silently ignore errors on auto-fetch\n      });\n    }\n  }, [apiClient, context?.authState, fetchPendingRecovery]);\n\n  return {\n    hasPendingRecovery: pendingData?.hasPendingRecovery ?? false,\n    recoveryType: pendingData?.recoveryType ?? null,\n    recoveryPhrase: pendingData?.recoveryPhrase ?? null,\n    expiresAt: pendingData?.expiresAt ? new Date(pendingData.expiresAt) : null,\n    fetchPendingRecovery,\n    acknowledgeRecovery,\n    isLoading,\n    error,\n    clearError,\n  };\n}\n","/**\n * Unified transaction signing hook\n *\n * Handles signing for both wallet types:\n * - External Solana wallet: Delegates to wallet adapter (app-provided callback)\n * - SSS embedded wallet: Uses server-side signing\n *\n * Usage:\n * ```tsx\n * const { signTransaction, signingMethod, canSign } = useTransactionSigning({\n *   // For external wallet users, provide your wallet adapter's signTransaction\n *   onExternalSign: async (tx) => walletAdapter.signTransaction(tx),\n * });\n *\n * // Sign a transaction (automatically routes to correct method)\n * const signature = await signTransaction(txBytes, credential);\n * ```\n */\n\nimport { useCallback, useMemo } from 'react';\nimport { useWallet } from './useWallet';\nimport { useWalletSigning } from './useWalletSigning';\nimport type { UnlockCredential } from '../types/wallet';\n\n/** Signing method in use */\nexport type SigningMethod = 'external' | 'sss' | 'none';\n\n/** Options for external wallet signing */\nexport interface ExternalSignOptions {\n  /**\n   * Callback to sign transaction with external wallet adapter.\n   * Only called when user has external Solana wallet.\n   *\n   * @param transaction - Transaction bytes to sign\n   * @returns Signature bytes (64 bytes Ed25519)\n   */\n  onExternalSign?: (transaction: Uint8Array) => Promise<Uint8Array>;\n}\n\n/** Return type for useTransactionSigning hook */\nexport interface UseTransactionSigningReturn {\n  /** Sign a transaction (routes to appropriate method) */\n  signTransaction: (transaction: Uint8Array, credential?: UnlockCredential) => Promise<Uint8Array>;\n  /** Which signing method is available */\n  signingMethod: SigningMethod;\n  /** Whether user can sign transactions */\n  canSign: boolean;\n  /** Whether signing is in progress */\n  isSigning: boolean;\n  /** Solana public key (from either wallet type) */\n  publicKey: string | null;\n  /** Whether user has external Solana wallet */\n  hasExternalWallet: boolean;\n  /** Whether SSS wallet is enrolled */\n  hasSssWallet: boolean;\n  /** Whether SSS wallet is unlocked (for session-based signing) */\n  isSssUnlocked: boolean;\n  /** Error from last signing attempt */\n  error: string | null;\n  /** Clear error */\n  clearError: () => void;\n}\n\n/**\n * Unified transaction signing hook\n *\n * Automatically routes signing requests to the appropriate method:\n * - External wallet: Uses provided callback\n * - SSS wallet: Uses server-side signing\n */\nexport function useTransactionSigning(\n  options: ExternalSignOptions = {}\n): UseTransactionSigningReturn {\n  const { onExternalSign } = options;\n\n  const { solanaPubkey, hasExternalWallet, status, isUnlocked: isSssUnlocked } = useWallet();\n\n  const {\n    signTransaction: sssSignTransaction,\n    isSigning: isSssSigning,\n    error: sssError,\n    clearError: clearSssError,\n  } = useWalletSigning();\n\n  // Determine which signing method is available\n  const signingMethod = useMemo((): SigningMethod => {\n    if (hasExternalWallet && onExternalSign) {\n      return 'external';\n    }\n    if (status === 'enrolled_locked' || status === 'enrolled_unlocked') {\n      return 'sss';\n    }\n    return 'none';\n  }, [hasExternalWallet, onExternalSign, status]);\n\n  // Whether user can sign\n  const canSign = signingMethod !== 'none';\n  const hasSssWallet = status === 'enrolled_locked' || status === 'enrolled_unlocked';\n\n  // Unified sign function\n  const signTransaction = useCallback(\n    async (transaction: Uint8Array, credential?: UnlockCredential): Promise<Uint8Array> => {\n      if (signingMethod === 'external') {\n        if (!onExternalSign) {\n          throw new Error('External wallet signing callback not provided');\n        }\n        return onExternalSign(transaction);\n      }\n\n      if (signingMethod === 'sss') {\n        if (!credential && !isSssUnlocked) {\n          throw new Error(\n            'Credential required for signing. Unlock wallet first or provide credential.'\n          );\n        }\n        if (credential) {\n          return sssSignTransaction(transaction, credential);\n        }\n        // If unlocked, credential is optional (server uses cached key)\n        return sssSignTransaction(transaction);\n      }\n\n      throw new Error('No signing method available. Enroll a wallet first.');\n    },\n    [signingMethod, onExternalSign, isSssUnlocked, sssSignTransaction]\n  );\n\n  return {\n    signTransaction,\n    signingMethod,\n    canSign,\n    isSigning: isSssSigning,\n    publicKey: solanaPubkey,\n    hasExternalWallet,\n    hasSssWallet,\n    isSssUnlocked,\n    error: sssError,\n    clearError: clearSssError,\n  };\n}\n","import { createContext } from 'react';\nimport type { Translations } from './translations';\n\nexport interface I18nContextValue {\n  t: Translations;\n  locale: string;\n}\n\nexport const I18nContext = createContext<I18nContextValue | null>(null);\n","//! Default English translations for the Cedros Login UI\n\nexport interface Translations {\n  // Auth forms\n  auth: {\n    email: string;\n    password: string;\n    confirmPassword: string;\n    name: string;\n    optional: string;\n    createPassword: string;\n    confirmYourPassword: string;\n    emailPlaceholder: string;\n    namePlaceholder: string;\n  };\n  // Buttons\n  buttons: {\n    signIn: string;\n    signUp: string;\n    signOut: string;\n    createAccount: string;\n    continueWithGoogle: string;\n    continueWithSolana: string;\n    forgotPassword: string;\n    resetPassword: string;\n    sendVerification: string;\n  };\n  // Messages\n  messages: {\n    signingIn: string;\n    signingUp: string;\n    creatingAccount: string;\n    connectingWallet: string;\n    verifyingSignature: string;\n    passwordsDoNotMatch: string;\n    alreadyHaveAccount: string;\n    dontHaveAccount: string;\n    orContinueWith: string;\n  };\n  // Errors\n  errors: {\n    invalidCredentials: string;\n    emailExists: string;\n    invalidEmail: string;\n    weakPassword: string;\n    networkError: string;\n    unknownError: string;\n    walletNotFound: string;\n    signatureRejected: string;\n    challengeExpired: string;\n  };\n  // Password validation\n  passwordValidation: {\n    minLength: string;\n    uppercase: string;\n    lowercase: string;\n    number: string;\n    special: string;\n    weak: string;\n    fair: string;\n    good: string;\n    strong: string;\n  };\n}\n\nexport const defaultTranslations: Translations = {\n  auth: {\n    email: 'Email',\n    password: 'Password',\n    confirmPassword: 'Confirm Password',\n    name: 'Name',\n    optional: '(optional)',\n    createPassword: 'Create a password',\n    confirmYourPassword: 'Confirm your password',\n    emailPlaceholder: 'you@example.com',\n    namePlaceholder: 'Your name',\n  },\n  buttons: {\n    signIn: 'Sign in',\n    signUp: 'Sign up',\n    signOut: 'Sign out',\n    createAccount: 'Create account',\n    continueWithGoogle: 'Continue with Google',\n    continueWithSolana: 'Connect Wallet',\n    forgotPassword: 'Forgot password?',\n    resetPassword: 'Reset password',\n    sendVerification: 'Send verification email',\n  },\n  messages: {\n    signingIn: 'Signing in...',\n    signingUp: 'Signing up...',\n    creatingAccount: 'Creating account...',\n    connectingWallet: 'Connecting wallet...',\n    verifyingSignature: 'Verifying signature...',\n    passwordsDoNotMatch: 'Passwords do not match',\n    alreadyHaveAccount: 'Already have an account?',\n    dontHaveAccount: \"Don't have an account?\",\n    orContinueWith: 'Or continue with',\n  },\n  errors: {\n    invalidCredentials: 'Invalid email or password',\n    emailExists: 'An account with this email already exists',\n    invalidEmail: 'Please enter a valid email address',\n    weakPassword: 'Password does not meet requirements',\n    networkError: 'Network error. Please try again.',\n    unknownError: 'An error occurred. Please try again.',\n    walletNotFound: 'No wallet found. Please install a Solana wallet.',\n    signatureRejected: 'Signature request was rejected',\n    challengeExpired: 'Challenge expired. Please try again.',\n  },\n  passwordValidation: {\n    minLength: 'At least 10 characters',\n    uppercase: 'At least 1 uppercase letter',\n    lowercase: 'At least 1 lowercase letter',\n    number: 'At least 1 number',\n    special: 'At least 1 special character',\n    weak: 'Weak',\n    fair: 'Fair',\n    good: 'Good',\n    strong: 'Strong',\n  },\n};\n\n/**\n * Deep merge translations, allowing partial overrides\n */\nexport function mergeTranslations(\n  base: Translations,\n  overrides: DeepPartial<Translations>\n): Translations {\n  return deepMerge(base, overrides) as Translations;\n}\n\ntype DeepPartial<T> = {\n  [P in keyof T]?: T[P] extends object ? DeepPartial<T[P]> : T[P];\n};\n\nfunction deepMerge<T extends object>(base: T, overrides: DeepPartial<T>): T {\n  const result = { ...base };\n\n  for (const key in overrides) {\n    if (Object.prototype.hasOwnProperty.call(overrides, key)) {\n      const baseValue = base[key as keyof T];\n      const overrideValue = overrides[key as keyof typeof overrides];\n\n      if (\n        typeof baseValue === 'object' &&\n        baseValue !== null &&\n        typeof overrideValue === 'object' &&\n        overrideValue !== null\n      ) {\n        (result as Record<string, unknown>)[key] = deepMerge(\n          baseValue as object,\n          overrideValue as DeepPartial<object>\n        );\n      } else if (overrideValue !== undefined) {\n        (result as Record<string, unknown>)[key] = overrideValue;\n      }\n    }\n  }\n\n  return result;\n}\n","import { useMemo, type ReactNode } from 'react';\nimport { I18nContext } from './context';\nimport { defaultTranslations, mergeTranslations, type Translations } from './translations';\n\ntype DeepPartial<T> = {\n  [P in keyof T]?: T[P] extends object ? DeepPartial<T[P]> : T[P];\n};\n\nexport interface I18nProviderProps {\n  children: ReactNode;\n  locale?: string;\n  translations?: DeepPartial<Translations>;\n}\n\n/**\n * Provider for internationalization support.\n * Allows overriding default English translations with custom strings.\n */\nexport function I18nProvider({\n  children,\n  locale = 'en',\n  translations: customTranslations,\n}: I18nProviderProps) {\n  const value = useMemo(() => {\n    const t = customTranslations\n      ? mergeTranslations(defaultTranslations, customTranslations)\n      : defaultTranslations;\n\n    return { t, locale };\n  }, [customTranslations, locale]);\n\n  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;\n}\n","import { useContext } from 'react';\nimport { I18nContext } from './context';\nimport { defaultTranslations, type Translations } from './translations';\n\n/**\n * Hook to access translations\n */\nexport function useTranslations(): Translations {\n  const context = useContext(I18nContext);\n  return context?.t ?? defaultTranslations;\n}\n\n/**\n * Hook to access current locale\n */\nexport function useLocale(): string {\n  const context = useContext(I18nContext);\n  return context?.locale ?? 'en';\n}\n"],"names":["isBytes","a","isArrayOf","isString","arr","item","afn","input","astr","label","anumber","n","aArr","astrArr","anumArr","chain","args","id","wrap","b","encode","x","decode","alphabet","letters","lettersA","len","indexes","l","i","digits","letter","join","separator","from","to","padding","bits","chr","data","end","convertRadix","pos","res","d","dlen","carry","done","digit","fromCarry","digitBase","div","rounded","gcd","radix2carry","powers","convertRadix2","max","mask","pow","radix","num","_256","bytes","radix2","revPadding","checksum","fn","sum","payload","oldChecksum","newChecksum","utils","isJapanese","wordlist","nfkd","str","normalize","norm","words","aentropy","ent","abytes","calcChecksum","entropy","bitsLeft","sha256","getCoder","baseUtils","mnemonicToEntropy","mnemonic","entropyToMnemonic","validateMnemonic","MNEMONIC_WORD_COUNT","shareToMnemonic","share","mnemonicToShare","toShamirShare","seedToMnemonic","seed","mnemonicToSeed","toSeed","isValidMnemonic","isValidWord","word","getWordSuggestions","prefix","limit","normalizedPrefix","formatMnemonicForDisplay","groups","parseMnemonicInput","w","LoginButton","className","variant","size","children","menuItems","hideSignOut","user","isAuthenticated","isLoading","openLoginModal","logout","useAuth","isMenuOpen","setIsMenuOpen","useState","focusedIndex","setFocusedIndex","menuRef","useRef","buttonRef","allMenuItems","useMemo","useEffect","handleClickOutside","e","handleEscape","handleMenuKeyDown","useCallback","toggleMenu","open","sizeClasses","variantClasses","jsx","LoadingSpinner","displayName","sanitizedPicture","sanitizeImageUrl","jsxs","index","usePasswordReset","config","useCedrosLogin","setIsLoading","isSuccess","setIsSuccess","error","setError","apiClient","ApiClient","checkLimit","getRemainingAttempts","useRateLimiter","forgotPassword","email","validateEmail","validationError","err","rateLimitError","authError","handleApiError","resetPassword","token","newPassword","clearError","reset","ForgotPasswordForm","onSuccess","onCancel","setEmail","emailId","useId","handleSubmit","ErrorMessage","Fragment","scriptLoader","resolve","reject","existingScript","cb","script","useAppleAuth","_internal","isInitialized","setIsInitialized","configRef","isMounted","initializeAppleSignIn","signIn","response","idToken","userName","isAppleDevice","userAgent","platform","AppleLoginButton","onError","disabled","hideOnNonApple","isApple","handleClick","assert","condition","message","normalizeBase64Url","base64UrlToArrayBuffer","b64url","base64","padded","binary","arrayBufferToBase64Url","buffer","mapCredentialDescriptor","desc","parseCreationOptionsFromServer","options","publicKey","rp","exclude","pubKeyCredParams","p","parseRequestOptionsFromServer","allow","credentialToServerJson","cred","rawId","responseJson","att","asr","isWebAuthnAvailable","hostname","isLocalhost","mapWebAuthnDomError","name","useWebAuthn","isSupported","authenticatePasskey","params","optionsResponse","assertion","registerPasskey","created","result","PasskeyLoginButton","isDisabled","PasskeyIcon","TABS","LoginForm","defaultTab","activeTab","setActiveTab","viewState","setViewState","hasWallets","setHasWallets","detectSolanaWallets","updateWallets","forgotPasswordMode","handleTabKeyDown","currentIndex","newIndex","newTab","features","showEmail","showGoogle","showApple","showSolana","showPasskey","showDivider","GoogleLoginButton","SolanaLoginButton","EmailLoginForm","EmailRegisterForm","ErrorBoundary","Component","props","errorInfo","hasError","fallback","showDetails","LoginModal","title","isModalOpen","closeModal","modalRef","previousActiveElement","closeModalRef","handleKeyDown","focusableElements","firstElement","lastElement","previousOverflow","handleBackdropClick","ResetPasswordForm","onLoginClick","password","setPassword","confirmPassword","setConfirmPassword","validation","setValidation","passwordsMatch","isValid","PasswordInput","validatePassword","OrgAvatar","org","sanitizedLogoUrl","sizeClass","imageClassName","placeholderClassName","OrgSelector","orgs","activeOrg","onSelect","onCreateClick","placeholder","isOpen","setIsOpen","dropdownRef","event","handleSelect","orgId","handleCreateClick","toggleDropdown","prev","RoleBadge","ChevronIcon","CheckIcon","PlusIcon","role","CloseIcon","OrgListView","CreateOrgForm","onSubmit","setName","slug","setSlug","formError","setFormError","handleNameChange","value","generatedSlug","OrgSwitcher","onClose","onCreate","OrgSwitcherModal","viewMode","setViewMode","previousFocusRef","handleCreate","SessionList","sessions","onRevokeAll","isRevoking","setIsRevoking","revokeSuccess","setRevokeSuccess","revokeTimerRef","otherSessionCount","s","handleRevokeAll","currentOtherCount","session","SessionItem","browserInfo","parseUserAgent","isExpiringSoon","isSessionExpiringSoon","DeviceIcon","formatRelativeTime","browser","os","dateString","date","diffMs","diffMins","diffHours","diffDays","expiresAt","expires","now","hourInMs","RecoveryPhraseDisplay","onConfirm","copied","setCopied","confirmed","setConfirmed","copyTimerRef","wordGroups","handleCopy","handleConfirm","group","groupIndex","wordIndex","number","RecoveryPhraseInput","isSubmitting","setWords","activeIndex","setActiveIndex","suggestions","setSuggestions","setValidationError","inputId","suggestionsTimerRef","handleWordChange","newWords","newSuggestions","handleWordFocus","handleWordBlur","handleSuggestionClick","suggestion","handlePaste","pastedText","parsedWords","invalidWords","displayError","_","CapabilityWarning","capabilities","getMissingCapabilitiesMessage","getBrowserSupportInfo","VALID_RECOVERY_MODES","normalizeRecoveryMode","mode","DEFAULT_RETURN","useWalletDiscovery","context","useCedrosLoginOptional","walletConfig","setWalletConfig","fetchConfig","useWalletEnrollment","enroll","useWalletMaterial","recoveryMode","state","setState","isEnrolling","setIsEnrolling","sensitiveData","cleanup","wipeAll","doEnrollment","authMethod","encryptionKey","kdfSalt","prfSalt","generateSeed","shareA","shareB","shareC","splitSecret","encryptedA","aesGcmEncryptToBase64","toEncryptionKey","getPublicKeyFromSeed","solanaPubkey","publicKeyToBase58","request","uint8ArrayToBase64","DEFAULT_KDF_PARAMS","recoveryPhrase","startEnrollmentWithPassword","salt","generateArgon2Salt","key","argon2DeriveInWorker","startEnrollmentWithPasskey","generatePrfSalt","prfSaltBase64","prfOutput","userIdBytes","registerPasskeyWithPrf","authenticateWithDiscoverablePrf","deriveKeyFromPrf","confirmRecoveryPhrase","cancel","WalletEnrollment","onComplete","forceAuthMethod","getDefaultAuthMethod","setAuthMethod","passwordError","setPasswordError","handlePasswordSubmit","passwordValidation","firstError","handlePasskeySubmit","handleRecoveryConfirm","handleCancel","useWalletSigning","apiSignTransaction","isSigning","setIsSigning","signTransaction","transaction","credential","msg","toCredentialRequest","base64ToUint8Array","usePasskeySigning","getMaterial","isAuthenticating","setIsAuthenticating","getPasskeyCredential","material","PasskeyPrompt","onPrompt","onRetry","description","handlePrompt","handleRetry","defaultTitle","defaultDescription","ErrorIcon","WalletUnlock","onUnlock","showCancel","propAuthMethod","unlock","phase","setPhase","setCredential","isPasswordAuth","isPasskeyAuth","startUnlock","unlockCredential","handlePasskeyUnlock","passkeyCredential","isProcessing","renderContent","LockIcon","SuccessIcon","useWalletRecovery","recover","getShareBForRecovery","isRecovering","setIsRecovering","startRecovery","method","shareCBase64","combineShares","prfResult","WalletRecovery","defaultAuthMethod","phraseValidated","setPhraseValidated","confirmCredential","setConfirmCredential","credentialError","setCredentialError","handlePhraseSubmit","submittedWords","handleCredentialSubmit","handleBack","handleComplete","WalletAddressRow","address","showCopy","showExplorerLink","allowReveal","copyError","setCopyError","revealFull","setRevealFull","network","explorerHref","base","isTruncatable","displayAddress","v","WalletStatus","controlledStatus","controlledPubkey","_onLock","onEnroll","onRecover","showActions","compact","isControlled","wallet","useWallet","status","refresh","statusConfig","getStatusConfig","truncatePubkey","StatusIcon","pubkey","WalletManager","view","setView","header","handleBackToStatus","handleEnrollComplete","handleUnlockComplete","handleRecoverComplete","SystemSettings","showDescriptions","onSave","settings","isUpdating","fetchSettings","updateSettings","useSystemSettings","edits","setEdits","saveError","setSaveError","saveSuccess","setSaveSuccess","timer","handleChange","handleSave","updates","handleReset","hasChanges","changeCount","categories","category","CategorySection","METADATA_KEY_ORDER","SETTING_METADATA","showDescription","onChange","meta","CATEGORY_METADATA","orderedSettings","ai","bi","SettingsGrid","SetupApiClient","baseUrl","timeoutMs","retryAttempts","useSetup","setStatus","isCreating","setIsCreating","requestIdRef","apiClientRef","checkStatus","requestId","createAdmin","EMAIL_REGEX","MIN_PASSWORD_LENGTH","validateForm","form","errors","SetupWizard","setForm","validationErrors","setValidationErrors","success","setSuccess","field","CATEGORIES","SecuritySettings","SettingsPageLayout","MessagingSettings","autosaveStatus","autosaveError","getEffectiveValue","useSettingsAutosave","currentTab","t","currentCategory","isCustomProvider","smtpHost","isSmtpConfigured","currentSettings","categorySettings","fieldsToShow","ALL_EMAIL_FIELDS","SIMPLIFIED_EMAIL_FIELDS","handleProviderAwareChange","PROVIDER_SMTP_HOSTS","AutosaveStatus","tab","SettingsSection","Icons","ALL_SECTIONS","CedrosAdminDashboard","sections","defaultSection","refreshInterval","pageSize","onSectionChange","onSettingsClick","onLogoutClick","activeSection","setActiveSection","configExpanded","setConfigExpanded","orgsLoading","fetchOrgs","hasPermission","useOrgs","setupLoading","featuresLoading","useServerFeatures","canAccess","useDashboardPermissions","handleSectionChange","section","enabledSections","currentSection","activeSectionDisabled","ProfileDropdown","UsersSection","TeamSection","DepositsSection","WithdrawalsSection","AuthenticationSettings","EmbeddedWalletSettings","CreditSystemSettings","ServerSettings","currentUserId","selectedUser","setSelectedUser","statsItems","statsLoading","statsError","useUsersStatsSummary","AdminUserDetail","StatsBar","AdminUserList","members","membersLoading","membersError","fetchMembers","updateMemberRole","removeMember","useMembers","invites","invitesLoading","invitesError","fetchInvites","createInvite","cancelInvite","resendInvite","useInvites","canInvite","canCancel","pendingCount","roleCounts","acc","member","ownerCount","adminCount","memberCount","MemberList","InviteForm","InviteList","PermissionsSection","statusFilter","setStatusFilter","AdminDepositStats","AdminDepositList","AdminWithdrawalStats","AdminPrivacyPeriodDeposits","AdminWithdrawalQueue","AdminWithdrawalHistory","canPromise","toSJISFunction","CODEWORDS_COUNT","version","f","kanji","exports","fromString","string","level","defaultValue","BitBuffer","bufIndex","length","bit","bitBuffer","BitMatrix","row","col","reserved","bitMatrix","getSymbolSize","require$$0","posCount","intervals","positions","coords","posLength","j","FINDER_PATTERN_SIZE","finderPattern","PenaltyScores","points","sameCountCol","sameCountRow","lastCol","lastRow","module","last","bitsCol","bitsRow","darkCount","modulesCount","getMaskAt","maskPattern","pattern","setupFormatFunc","numPatterns","bestPattern","lowerPenalty","penalty","ECLevel","EC_BLOCKS_TABLE","EC_CODEWORDS_TABLE","errorCorrectionCode","errorCorrectionLevel","EXP_TABLE","LOG_TABLE","galoisField","y","GF","p1","p2","coeff","divident","divisor","offset","degree","poly","Polynomial","ReedSolomonEncoder","paddedData","remainder","start","buff","reedSolomonEncoder","versionCheck","numeric","alphanumeric","byte","regex","TEST_KANJI","TEST_NUMERIC","TEST_ALPHANUMERIC","VersionCheck","Regex","require$$1","dataStr","Utils","ECCode","require$$2","Mode","require$$3","require$$4","G18","G18_BCH","getBestVersionForDataLength","currentVersion","getReservedBitsCount","getTotalBitsFromDataArray","segments","totalBits","reservedBits","getBestVersionForMixedData","totalCodewords","ecTotalCodewords","dataTotalCodewordsBits","usableBits","seg","ecl","G15","G15_MASK","G15_BCH","formatInfo","NumericData","remainingNum","numericData","ALPHA_NUM_CHARS","AlphanumericData","alphanumericData","ByteData","byteData","KanjiData","kanjiData","dijkstra","graph","predecessors","costs","closest","u","cost_of_s_to_u","adjacent_nodes","cost_of_e","cost_of_s_to_u_plus_cost_of_e","cost_of_s_to_v","first_visit","nodes","opts","T","cost","require$$5","require$$6","require$$7","getStringByteLength","getSegments","getSegmentsFromString","numSegs","alphaNumSegs","byteSegs","kanjiSegs","s1","s2","obj","getSegmentBitsLength","mergeSegments","segs","curr","prevSeg","buildNodes","buildGraph","table","prevNodeIds","nodeGroup","currentNodeIds","node","prevNodeId","buildSingleSegment","modesHint","bestMode","array","path","optimizedSegs","AlignmentPattern","FinderPattern","MaskPattern","require$$8","Version","require$$9","FormatInfo","require$$10","require$$11","Segments","require$$12","setupFinderPattern","matrix","r","c","setupTimingPattern","setupAlignmentPattern","setupVersionInfo","mod","setupFormatInfo","setupData","inc","bitIndex","byteIndex","dark","createData","remainingByte","createCodewords","dataTotalCodewords","ecTotalBlocks","blocksInGroup2","blocksInGroup1","totalCodewordsInGroup1","dataCodewordsInGroup1","dataCodewordsInGroup2","ecCount","rs","dcData","ecData","maxDataSize","dataSize","createSymbol","estimatedVersion","rawSegments","bestVersion","dataBits","moduleCount","modules","qrcode","hex2rgba","hex","hexCode","hexValue","margin","width","scale","qrSize","imgData","qr","symbolSize","scaledMargin","palette","posDst","pxColor","iSrc","jSrc","clearCanvas","ctx","canvas","getCanvasElement","qrData","canvasEl","image","type","rendererOpts","getColorAttrib","color","attrib","alpha","svgCmd","cmd","qrToPath","moveBy","newRow","lineLength","svgTag","qrcodesize","bg","viewBox","QRCode","CanvasRenderer","SvgRenderer","renderCanvas","renderFunc","text","argsNum","isLastArgCb","QrCode","alt","canvasRef","useTotp","setupState","setSetupState","setSetupData","getStatus","beginSetup","enableTotp","code","freshStatus","disableTotp","regenerateBackupCodes","TotpSetup","step","setStep","verifyCode","setVerifyCode","copiedSecret","setCopiedSecret","savedBackupCodes","setSavedBackupCodes","handleCopySecret","handleCopyBackupCodes","codes","handleVerify","OtpInput","TotpSettings","onStatusChange","disablePassword","setDisablePassword","regenerateCode","setRegenerateCode","newRecoveryCodes","setNewRecoveryCodes","actionLoading","setActionLoading","actionError","setActionError","handleSetupComplete","handleDisable","handleRegenerate","ProfileApiClient","getAccessToken","useProfile","authState","updateProfile","changePassword","UserProfileSettings","onPasswordChange","currentPassword","setCurrentPassword","setNewPassword","successMessage","setSuccessMessage","canSubmitPassword","handlePasswordChange","handleCancelPasswordChange","getInitials","useDeposit","deposit","amountLamports","apiError","sessionId","getConfig","listDeposits","query","url","getQuote","queryParams","publicDeposit","microDeposit","TokenSelector","tokens","selectedToken","openSignal","searchable","search","setSearch","containerRef","searchInputRef","filteredTokens","searchLower","handleToggle","getTierForAmount","usd","solLogo","DEFAULT_MAX_USD","SLIDER_STEPS","CURVE_POWER","formatUsd","getTierInfo","tier","clamp","min","usdToSlider","maxUsd","normalized","sliderToUsd","position","getUsdStep","getStepDecimals","roundUsd","decimals","TieredAmountSlider","valueUsd","normalizedValue","tierInfo","sliderValue","sliderPercent","hasUserFee","getEffectiveFeePercent","isPrivate","isMicro","feePolicy","privacyFeePercent","swapFeePercent","companyFeePercent","userFee","LAMPORTS_PER_SOL","SOL_TOKEN","OTHER_TOKEN","MAX_DEPOSIT_USD","calculateFeeLines","amountUsd","lines","privacyActive","swapActive","companyActive","solAmount","percent","fixedUsd","percentUsd","formatFeeTooltip","totalFeeUsd","feeLines","feeTotalDisplay","totalSol","line","totalPercent","COL","formatLine","sol","pct","divider","totalUsdStr","totalLine","formatExplainerFeeSummary","feeLabels","hasPrivacyFee","hasSwapFee","hasCompanyFee","getTotalFeeUsd","feePercent","userFixedLamports","fixedFeeUsd","percentFeeUsd","getPurchaseCurrencyLabel","currencyMode","supported","normalizeTokenSymbols","symbols","symbol","USD_STABLE_TOKENS","getTokenUsdPrice","priceOverrides","serverPrice","override","formatTokenAmount","amount","DepositFlow","depositMethodProp","defaultToken","minAmount","maxAmount","onUnlockRequired","onAuthorize","showStepIndicator","pollInterval","demoMode","demoAutoConfirmMs","tokenPriceUsd","showExplainer","siteName","explainerConfig","depositError","quickActionSymbols","customTokenSymbols","mergedTokens","customDefs","seen","merged","def","customListTokens","filtered","canUseSignMode","depositMethod","firstQuickActionToken","effectiveToken","candidate","getFirstStep","setSelectedToken","setAmount","setResult","flowError","setFlowError","setSessionId","depositAddress","setDepositAddress","isAuthorizing","setIsAuthorizing","receiveAmountUsd","setReceiveAmountUsd","effectiveMin","effectiveMax","parsedAmount","isEnrolled","walletReady","needsUnlock","steps","currentStepIndex","handleTokenSelect","handleAuthorize","handleDeposit","depositAmount","depositToken","finalAmount","finalToken","smallestUnit","flowResult","handleSentDeposit","handleCopyAddress","textArea","cancelled","pollCount","maxPolls","poll","detectedAmount","timeout","tokenAmount","idx","isActive","isCurrent","ExplainerStep","UnlockStep","ConfirmStep","amt","tkn","SigningStep","ShowAddressStep","WaitingStep","SuccessStep","ErrorStep","depositConfig","onContinue","exchangeName","exchangeUrl","sanitizeExternalUrl","showExchange","purchaseCurrencyLabel","defaultBody","body","showUserFee","feeDescription","onBack","isListening","onCopy","onTokenSelect","setAmountUsd","showCustomToken","setShowCustomToken","feeTooltipOpen","setFeeTooltipOpen","customOpenSignal","setCustomOpenSignal","preMicroToken","setPreMicroToken","isMicroTier","isOtherToken","customTokens","baseTokens","resolved","feeLine","feeTooltip","tokenUsdPrice","sendAmountLabel","feesExceedAmount","isValidAmount","solToken","quickToken","current","onAmountChange","onSent","canSubmit","onNewDeposit","creditsUsd","totalFeeDisplay","bonkLogo","cashLogo","eurcLogo","oreLogo","pyusdLogo","usdcLogo","usdhLogo","usd1Logo","usdtLogo","SUPPORTED_TOKENS","useCredits","getBalance","getAllBalances","getHistory","queryString","CreditBalance","showAllCurrencies","onLoad","balances","setBalances","loadError","setLoadError","fetchBalance","interval","primaryBalance","balance","formatAmount","lamports","currency","isNegative","absLamports","isSol","formatDate","getTypeLabel","txType","getTypeIcon","isPositive","History","onTransactionClick","transactions","setTransactions","total","setTotal","setOffset","filteredTransactions","tx","fetchHistory","totalPages","currentPage","goToPage","page","newOffset","handleTabChange","getTabCount","count","useWithdrawal","setIsSubmitting","lastResult","setLastResult","getBalances","withdrawSol","destination","withdrawSpl","tokenMint","clampedLimit","clampedOffset","SOL_MINT","KNOWN_MINTS","isValidSolanaAddress","truncateAddress","raw","WithdrawalFlow","heldTokens","setHeldTokens","setDestination","explorerTxUrl","rawAmount","handleSelectToken","handleMax","maxHuman","handleFormSubmit","txResult","resolveTokenSymbol","tokenType","known","addr","WithdrawalHistory","explorerUrl","items","setItems","FullPageLayout","brandLogo","brandName","subtitle","termsText","SplitPageLayout","tagline","SessionApiClient","useSessions","setSessions","fetchSessions","fetchedSessions","revokeAllSessions","useAuthorize","lastCheck","setLastCheck","OrgApiClient","checkAuthorization","authorize","clearCheck","useWallets","listAllWallets","createDerivedWallet","deleteDerivedWallet","wallets","setWallets","createWallet","deleteWallet","walletId","usePendingRecovery","pendingData","setPendingData","fetchPendingRecovery","acknowledgeRecovery","useTransactionSigning","onExternalSign","hasExternalWallet","isSssUnlocked","sssSignTransaction","isSssSigning","sssError","clearSssError","signingMethod","canSign","hasSssWallet","I18nContext","createContext","defaultTranslations","mergeTranslations","overrides","deepMerge","baseValue","overrideValue","I18nProvider","locale","customTranslations","useTranslations","useContext","useLocale"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,SAASA,GAAQC,GAAG;AAChB,SAAOA,aAAa,cAAe,YAAY,OAAOA,CAAC,KAAKA,EAAE,YAAY,SAAS;AACvF;AAQA,SAASC,GAAUC,GAAUC,GAAK;AAC9B,SAAK,MAAM,QAAQA,CAAG,IAElBA,EAAI,WAAW,IACR,KACPD,IACOC,EAAI,MAAM,CAACC,MAAS,OAAOA,KAAS,QAAQ,IAG5CD,EAAI,MAAM,CAACC,MAAS,OAAO,cAAcA,CAAI,CAAC,IAP9C;AASf;AAEA,SAASC,GAAIC,GAAO;AAChB,MAAI,OAAOA,KAAU;AACjB,UAAM,IAAI,MAAM,mBAAmB;AACvC,SAAO;AACX;AACA,SAASC,GAAKC,GAAOF,GAAO;AACxB,MAAI,OAAOA,KAAU;AACjB,UAAM,IAAI,MAAM,GAAGE,CAAK,mBAAmB;AAC/C,SAAO;AACX;AACA,SAASC,GAAQC,GAAG;AAChB,MAAI,CAAC,OAAO,cAAcA,CAAC;AACvB,UAAM,IAAI,MAAM,oBAAoBA,CAAC,EAAE;AAC/C;AACA,SAASC,GAAKL,GAAO;AACjB,MAAI,CAAC,MAAM,QAAQA,CAAK;AACpB,UAAM,IAAI,MAAM,gBAAgB;AACxC;AACA,SAASM,GAAQJ,GAAOF,GAAO;AAC3B,MAAI,CAACL,GAAU,IAAMK,CAAK;AACtB,UAAM,IAAI,MAAM,GAAGE,CAAK,6BAA6B;AAC7D;AACA,SAASK,GAAQL,GAAOF,GAAO;AAC3B,MAAI,CAACL,GAAU,IAAOK,CAAK;AACvB,UAAM,IAAI,MAAM,GAAGE,CAAK,6BAA6B;AAC7D;AAAA;AAIA,SAASM,MAASC,GAAM;AACpB,QAAMC,IAAK,CAAChB,MAAMA,GAEZiB,IAAO,CAACjB,GAAGkB,MAAM,CAAC,MAAMlB,EAAEkB,EAAE,CAAC,CAAC,GAE9BC,IAASJ,EAAK,IAAI,CAACK,MAAMA,EAAE,MAAM,EAAE,YAAYH,GAAMD,CAAE,GAEvDK,IAASN,EAAK,IAAI,CAACK,MAAMA,EAAE,MAAM,EAAE,OAAOH,GAAMD,CAAE;AACxD,SAAO,EAAE,QAAAG,GAAQ,QAAAE,EAAM;AAC3B;AAAA;AAMA,SAASC,GAASC,GAAS;AAEvB,QAAMC,IAAW,OAAOD,KAAY,WAAWA,EAAQ,MAAM,EAAE,IAAIA,GAC7DE,IAAMD,EAAS;AACrB,EAAAZ,GAAQ,YAAYY,CAAQ;AAE5B,QAAME,IAAU,IAAI,IAAIF,EAAS,IAAI,CAACG,GAAGC,MAAM,CAACD,GAAGC,CAAC,CAAC,CAAC;AACtD,SAAO;AAAA,IACH,QAAQ,CAACC,OACLlB,GAAKkB,CAAM,GACJA,EAAO,IAAI,CAACD,MAAM;AACrB,UAAI,CAAC,OAAO,cAAcA,CAAC,KAAKA,IAAI,KAAKA,KAAKH;AAC1C,cAAM,IAAI,MAAM,kDAAkDG,CAAC,eAAeL,CAAO,EAAE;AAC/F,aAAOC,EAASI,CAAC;AAAA,IACrB,CAAC;AAAA,IAEL,QAAQ,CAACtB,OACLK,GAAKL,CAAK,GACHA,EAAM,IAAI,CAACwB,MAAW;AACzB,MAAAvB,GAAK,mBAAmBuB,CAAM;AAC9B,YAAMF,IAAIF,EAAQ,IAAII,CAAM;AAC5B,UAAIF,MAAM;AACN,cAAM,IAAI,MAAM,oBAAoBE,CAAM,eAAeP,CAAO,EAAE;AACtE,aAAOK;AAAA,IACX,CAAC;AAAA,EAEb;AACA;AAAA;AAIA,SAASG,GAAKC,IAAY,IAAI;AAC1B,SAAAzB,GAAK,QAAQyB,CAAS,GACf;AAAA,IACH,QAAQ,CAACC,OACLrB,GAAQ,eAAeqB,CAAI,GACpBA,EAAK,KAAKD,CAAS;AAAA,IAE9B,QAAQ,CAACE,OACL3B,GAAK,eAAe2B,CAAE,GACfA,EAAG,MAAMF,CAAS;AAAA,EAErC;AACA;AAAA;AAKA,SAASG,GAAQC,GAAMC,IAAM,KAAK;AAC9B,SAAA5B,GAAQ2B,CAAI,GACZ7B,GAAK,WAAW8B,CAAG,GACZ;AAAA,IACH,OAAOC,GAAM;AAET,WADA1B,GAAQ,kBAAkB0B,CAAI,GACtBA,EAAK,SAASF,IAAQ;AAC1B,QAAAE,EAAK,KAAKD,CAAG;AACjB,aAAOC;AAAA,IACX;AAAA,IACA,OAAOhC,GAAO;AACV,MAAAM,GAAQ,kBAAkBN,CAAK;AAC/B,UAAIiC,IAAMjC,EAAM;AAChB,UAAKiC,IAAMH,IAAQ;AACf,cAAM,IAAI,MAAM,4DAA4D;AAChF,aAAOG,IAAM,KAAKjC,EAAMiC,IAAM,CAAC,MAAMF,GAAKE;AAGtC,aAFaA,IAAM,KACCH,IACT,MAAM;AACb,gBAAM,IAAI,MAAM,+CAA+C;AAEvE,aAAO9B,EAAM,MAAM,GAAGiC,CAAG;AAAA,IAC7B;AAAA,EACR;AACA;AAWA,SAASC,GAAaF,GAAML,GAAMC,GAAI;AAElC,MAAID,IAAO;AACP,UAAM,IAAI,MAAM,8BAA8BA,CAAI,8BAA8B;AACpF,MAAIC,IAAK;AACL,UAAM,IAAI,MAAM,4BAA4BA,CAAE,8BAA8B;AAEhF,MADAvB,GAAK2B,CAAI,GACL,CAACA,EAAK;AACN,WAAO,CAAA;AACX,MAAIG,IAAM;AACV,QAAMC,IAAM,CAAA,GACNb,IAAS,MAAM,KAAKS,GAAM,CAACK,MAAM;AAEnC,QADAlC,GAAQkC,CAAC,GACLA,IAAI,KAAKA,KAAKV;AACd,YAAM,IAAI,MAAM,oBAAoBU,CAAC,EAAE;AAC3C,WAAOA;AAAA,EACX,CAAC,GACKC,IAAOf,EAAO;AACpB,aAAa;AACT,QAAIgB,IAAQ,GACRC,IAAO;AACX,aAASlB,IAAIa,GAAKb,IAAIgB,GAAMhB,KAAK;AAC7B,YAAMmB,IAAQlB,EAAOD,CAAC,GAChBoB,IAAYf,IAAOY,GACnBI,IAAYD,IAAYD;AAC9B,UAAI,CAAC,OAAO,cAAcE,CAAS,KAC/BD,IAAYf,MAASY,KACrBI,IAAYF,MAAUC;AACtB,cAAM,IAAI,MAAM,8BAA8B;AAElD,YAAME,IAAMD,IAAYf;AACxB,MAAAW,IAAQI,IAAYf;AACpB,YAAMiB,IAAU,KAAK,MAAMD,CAAG;AAE9B,UADArB,EAAOD,CAAC,IAAIuB,GACR,CAAC,OAAO,cAAcA,CAAO,KAAKA,IAAUjB,IAAKW,MAAUI;AAC3D,cAAM,IAAI,MAAM,8BAA8B;AAClD,UAAKH;AAEA,QAAKK,IAGNL,IAAO,KAFPL,IAAMb;AAAA,UAFN;AAAA,IAKR;AAEA,QADAc,EAAI,KAAKG,CAAK,GACVC;AACA;AAAA,EACR;AACA,WAASlB,IAAI,GAAGA,IAAIU,EAAK,SAAS,KAAKA,EAAKV,CAAC,MAAM,GAAGA;AAClD,IAAAc,EAAI,KAAK,CAAC;AACd,SAAOA,EAAI,QAAO;AACtB;AACA,MAAMU,KAAM,CAACpD,GAAGkB,MAAOA,MAAM,IAAIlB,IAAIoD,GAAIlC,GAAGlB,IAAIkB,CAAC,GAC3CmC,gCAAyC,CAACpB,GAAMC,MAAOD,KAAQC,IAAKkB,GAAInB,GAAMC,CAAE,IAChFoB,KAA0B,uBAAM;AAClC,MAAIZ,IAAM,CAAA;AACV,WAASd,IAAI,GAAGA,IAAI,IAAIA;AACpB,IAAAc,EAAI,KAAK,KAAKd,CAAC;AACnB,SAAOc;AACX,GAAC;AAID,SAASa,GAAcjB,GAAML,GAAMC,GAAIC,GAAS;AAE5C,MADAxB,GAAK2B,CAAI,GACLL,KAAQ,KAAKA,IAAO;AACpB,UAAM,IAAI,MAAM,6BAA6BA,CAAI,EAAE;AACvD,MAAIC,KAAM,KAAKA,IAAK;AAChB,UAAM,IAAI,MAAM,2BAA2BA,CAAE,EAAE;AACnD,MAAI,gBAAAmB,GAAYpB,GAAMC,CAAE,IAAI;AACxB,UAAM,IAAI,MAAM,sCAAsCD,CAAI,OAAOC,CAAE,cAAc,gBAAAmB,GAAYpB,GAAMC,CAAE,CAAC,EAAE;AAE5G,MAAIW,IAAQ,GACRJ,IAAM;AACV,QAAMe,IAAMF,GAAOrB,CAAI,GACjBwB,IAAOH,GAAOpB,CAAE,IAAI,GACpBQ,IAAM,CAAA;AACZ,aAAWhC,KAAK4B,GAAM;AAElB,QADA7B,GAAQC,CAAC,GACLA,KAAK8C;AACL,YAAM,IAAI,MAAM,oCAAoC9C,CAAC,SAASuB,CAAI,EAAE;AAExE,QADAY,IAASA,KAASZ,IAAQvB,GACtB+B,IAAMR,IAAO;AACb,YAAM,IAAI,MAAM,qCAAqCQ,CAAG,SAASR,CAAI,EAAE;AAE3E,SADAQ,KAAOR,GACAQ,KAAOP,GAAIO,KAAOP;AACrB,MAAAQ,EAAI,MAAOG,KAAUJ,IAAMP,IAAOuB,OAAU,CAAC;AACjD,UAAMC,IAAMJ,GAAOb,CAAG;AACtB,QAAIiB,MAAQ;AACR,YAAM,IAAI,MAAM,eAAe;AACnC,IAAAb,KAASa,IAAM;AAAA,EACnB;AAEA,MADAb,IAASA,KAAUX,IAAKO,IAAQgB,GAC5B,CAACtB,KAAWM,KAAOR;AACnB,UAAM,IAAI,MAAM,gBAAgB;AACpC,MAAI,CAACE,KAAWU,IAAQ;AACpB,UAAM,IAAI,MAAM,qBAAqBA,CAAK,EAAE;AAChD,SAAIV,KAAWM,IAAM,KACjBC,EAAI,KAAKG,MAAU,CAAC,GACjBH;AACX;AAAA;AAIA,SAASiB,GAAMC,GAAK;AAChB,EAAAnD,GAAQmD,CAAG;AACX,QAAMC,IAAO,KAAK;AAClB,SAAO;AAAA,IACH,QAAQ,CAACC,MAAU;AACf,UAAI,CAAC/D,GAAQ+D,CAAK;AACd,cAAM,IAAI,MAAM,yCAAyC;AAC7D,aAAOtB,GAAa,MAAM,KAAKsB,CAAK,GAAGD,GAAMD,CAAG;AAAA,IACpD;AAAA,IACA,QAAQ,CAAC/B,OACLhB,GAAQ,gBAAgBgB,CAAM,GACvB,WAAW,KAAKW,GAAaX,GAAQ+B,GAAKC,CAAI,CAAC;AAAA,EAElE;AACA;AAAA;AAMA,SAASE,GAAO3B,GAAM4B,IAAa,IAAO;AAEtC,MADAvD,GAAQ2B,CAAI,GACRA,KAAQ,KAAKA,IAAO;AACpB,UAAM,IAAI,MAAM,mCAAmC;AACvD,MAAI,gBAAAiB,GAAY,GAAGjB,CAAI,IAAI,MAAM,gBAAAiB,GAAYjB,GAAM,CAAC,IAAI;AACpD,UAAM,IAAI,MAAM,wBAAwB;AAC5C,SAAO;AAAA,IACH,QAAQ,CAAC0B,MAAU;AACf,UAAI,CAAC/D,GAAQ+D,CAAK;AACd,cAAM,IAAI,MAAM,0CAA0C;AAC9D,aAAOP,GAAc,MAAM,KAAKO,CAAK,GAAG,GAAG1B,GAAM,CAAC4B,CAAU;AAAA,IAChE;AAAA,IACA,QAAQ,CAACnC,OACLhB,GAAQ,iBAAiBgB,CAAM,GACxB,WAAW,KAAK0B,GAAc1B,GAAQO,GAAM,GAAG4B,CAAU,CAAC;AAAA,EAE7E;AACA;AAUA,SAASC,GAASxC,GAAKyC,GAAI;AACvB,SAAAzD,GAAQgB,CAAG,GACXpB,GAAI6D,CAAE,GACC;AAAA,IACH,OAAO5B,GAAM;AACT,UAAI,CAACvC,GAAQuC,CAAI;AACb,cAAM,IAAI,MAAM,6CAA6C;AACjE,YAAM6B,IAAMD,EAAG5B,CAAI,EAAE,MAAM,GAAGb,CAAG,GAC3BiB,IAAM,IAAI,WAAWJ,EAAK,SAASb,CAAG;AAC5C,aAAAiB,EAAI,IAAIJ,CAAI,GACZI,EAAI,IAAIyB,GAAK7B,EAAK,MAAM,GACjBI;AAAA,IACX;AAAA,IACA,OAAOJ,GAAM;AACT,UAAI,CAACvC,GAAQuC,CAAI;AACb,cAAM,IAAI,MAAM,6CAA6C;AACjE,YAAM8B,IAAU9B,EAAK,MAAM,GAAG,CAACb,CAAG,GAC5B4C,IAAc/B,EAAK,MAAM,CAACb,CAAG,GAC7B6C,IAAcJ,EAAGE,CAAO,EAAE,MAAM,GAAG3C,CAAG;AAC5C,eAASG,IAAI,GAAGA,IAAIH,GAAKG;AACrB,YAAI0C,EAAY1C,CAAC,MAAMyC,EAAYzC,CAAC;AAChC,gBAAM,IAAI,MAAM,kBAAkB;AAC1C,aAAOwC;AAAA,IACX;AAAA,EACR;AACA;AAEO,MAAMG,KAAQ;AAAA,EACjB,UAAAjD;AAAA,EAAU,OAAAR;AAAA,EAAO,UAAAmD;AAAA,EAAU,cAAAzB;AAAA,EAAc,eAAAe;AAAA,EAAe,OAAAI;AAAA,EAAO,QAAAI;AAAA,EAAQ,MAAAhC;AAAA,EAAM,SAAAI;AACjF;ACvSA,MAAMqC,KAAa,CAACC,MAAaA,EAAS,CAAC,MAAM;AAKjD,SAASC,GAAKC,GAAK;AACf,MAAI,OAAOA,KAAQ;AACf,UAAM,IAAI,UAAU,4BAA4B,OAAOA,CAAG;AAC9D,SAAOA,EAAI,UAAU,MAAM;AAC/B;AACA,SAASC,GAAUD,GAAK;AACpB,QAAME,IAAOH,GAAKC,CAAG,GACfG,IAAQD,EAAK,MAAM,GAAG;AAC5B,MAAI,CAAC,CAAC,IAAI,IAAI,IAAI,IAAI,EAAE,EAAE,SAASC,EAAM,MAAM;AAC3C,UAAM,IAAI,MAAM,kBAAkB;AACtC,SAAO,EAAE,MAAMD,GAAM,OAAAC,EAAK;AAC9B;AACA,SAASC,GAASC,GAAK;AACnB,EAAAC,GAAOD,GAAK,IAAI,IAAI,IAAI,IAAI,EAAE;AAClC;AAeA,MAAME,KAAe,CAACC,MAAY;AAE9B,QAAMC,IAAW,IAAID,EAAQ,SAAS;AAGtC,SAAO,IAAI,WAAW,CAAEE,GAAOF,CAAO,EAAE,CAAC,KAAKC,KAAaA,CAAQ,CAAC;AACxE;AACA,SAASE,GAASb,GAAU;AACxB,MAAI,CAAC,MAAM,QAAQA,CAAQ,KAAKA,EAAS,WAAW,QAAQ,OAAOA,EAAS,CAAC,KAAM;AAC/E,UAAM,IAAI,MAAM,0CAA0C;AAC9D,SAAAA,EAAS,QAAQ,CAAC7C,MAAM;AACpB,QAAI,OAAOA,KAAM;AACb,YAAM,IAAI,MAAM,mCAAmCA,CAAC;AAAA,EAC5D,CAAC,GACM2D,GAAU,MAAMA,GAAU,SAAS,GAAGL,EAAY,GAAGK,GAAU,OAAO,IAAI,EAAI,GAAGA,GAAU,SAASd,CAAQ,CAAC;AACxH;AAcO,SAASe,GAAkBC,GAAUhB,GAAU;AAClD,QAAM,EAAE,OAAAK,EAAK,IAAKF,GAAUa,CAAQ,GAC9BN,IAAUG,GAASb,CAAQ,EAAE,OAAOK,CAAK;AAC/C,SAAAC,GAASI,CAAO,GACTA;AACX;AAcO,SAASO,GAAkBP,GAASV,GAAU;AACjD,SAAAM,GAASI,CAAO,GACFG,GAASb,CAAQ,EAAE,OAAOU,CAAO,EAClC,KAAKX,GAAWC,CAAQ,IAAI,MAAW,GAAG;AAC3D;AAIO,SAASkB,GAAiBF,GAAUhB,GAAU;AACjD,MAAI;AACA,IAAAe,GAAkBC,GAAUhB,CAAQ;AAAA,EACxC,QACU;AACN,WAAO;AAAA,EACX;AACA,SAAO;AACX;ACrIO,MAAMA,KAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA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AA,IAAI;AAAA,IAAK;AAAA,IAAK;AAAA,IACd;AAAA,IAAI;AAAA,IAAK;AAAA,IAAK;AAAA,IACd;AAAA,IAAI;AAAA,IAAK;AAAA,IAAK;AAAA,IACd;AAAA,IAAK;AAAA,IAAK;AAAA,IAAK;AAAA,IACf;AAAA,IAAK;AAAA,IAAK;AAAA,IAAK;AAAA,IACf;AAAA,IAAK;AAAA,IAAK;AAAA,IAAK;AAAA,IACf;AAAA,IAAK;AAAA,IAAK;AAAA,IAAK;AAAA,IACf;AAAA,IAAK;AAAA,IAAK;AAAA,IAAK;AAAA,IACf;AAAA,IAAK;AAAA,IAAK;AAAA,IAAK;AAAA,IACf;AAAA,IAAK;AAAA,IAAK;AAAA,IAAK;AAAA,IACf;AAAA,IAAK;AAAA,IAAK;AAAA,IAAK;AAAA,IACf;AAAA,IAAK;AAAA,IAAK;AAAA,IAAK;AAAA,IACf;AAAA,IAAK;AAAA,IAAK;AAAA,IAAK;AAAA,IACf;AAAA,IAAK;AAAA,IAAK;AAAA,IAAK;AAAA,IACf;AAAA,IAAK;AAAA,IAAK;AAAA,IAAK;AAAA,IACf;AAAA,IAAK;AAAA,IAAK;AAAA,IAAK;AAAA,IACf;AAAA,IAAK;AAAA,IAAK;AAAA,IAAK;AAAA,IACf;AAAA,IAAK;AAAA,IAAK;AAAA,IAAM;AAAA,IAChB;AAAA,IAAK;AAAA,IAAK;AAAA,IAAM;AAAA,IAChB;AAAA,IAAK;AAAA,IAAK;AAAA,IAAM;AAAA,IAChB;AAAA,IAAK;AAAA,IAAK;AAAA,IAAM;AAAA,IAChB;AAAA,IAAK;AAAA,IAAK;AAAA,IAAM;AAAA,IAChB;AAAA,IAAK;AAAA,IAAK;AAAA,IAAM;AAAA,IAChB;AAAA,IAAK;AAAA,IAAK;AAAA,IAAM;AAAA,IAChB;AAAA,IAAK;AAAA,IAAM;AAAA,IAAM;AAAA,IACjB;AAAA,IAAK;AAAA,IAAM;AAAA,IAAM;AAAA,IACjB;AAAA,IAAK;AAAA,IAAM;AAAA,IAAM;AAAA,IACjB;AAAA,IAAK;AAAA,IAAM;AAAA,IAAM;AAAA,IACjB;AAAA,IAAK;AAAA,IAAM;AAAA,IAAM;AAAA,IACjB;AAAA,IAAK;AAAA,IAAM;AAAA,IAAM;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","x_google_ignoreList":[0,1,2,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72]}