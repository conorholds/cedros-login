{"version":3,"file":"ServerSettings-DZUKo6By.cjs","sources":["../src/components/admin/settings/ServerSettings.tsx"],"sourcesContent":["/**\n * Server settings page - infrastructure configuration with tabs\n */\nimport { useState, useEffect, useMemo } from 'react';\nimport { LoadingSpinner } from '../../shared/LoadingSpinner';\nimport { ErrorMessage } from '../../shared/ErrorMessage';\nimport { useSettingsAutosave } from '../../../hooks/useSettingsAutosave';\nimport { SettingsSection } from './settingsInputs';\nimport { AutosaveStatus } from './AutosaveStatus';\n\ntype ServerTab = 'general' | 'logging' | 'metrics' | 'security';\n\ninterface TabConfig {\n  id: ServerTab;\n  label: string;\n  /** Categories to pull settings from (defaults to ['server']) */\n  categories?: string[];\n  keys: string[];\n}\n\nconst TABS: TabConfig[] = [\n  {\n    id: 'general',\n    label: 'Integrations',\n    keys: ['server_cedros_pay_api_key'],\n  },\n  {\n    id: 'logging',\n    label: 'Logging',\n    keys: ['server_log_level'],\n  },\n  {\n    id: 'metrics',\n    label: 'Metrics',\n    keys: ['server_metrics_api_key'],\n  },\n  {\n    id: 'security',\n    label: 'Security',\n    categories: ['security', 'features'],\n    keys: ['feature_mfa', 'security_cors_origins', 'security_session_timeout'],\n  },\n];\n\nexport interface ServerSettingsProps {\n  className?: string;\n}\n\nexport function ServerSettings({ className }: ServerSettingsProps) {\n  const {\n    settings,\n    edits,\n    isLoading,\n    autosaveStatus,\n    autosaveError,\n    error,\n    fetchSettings,\n    handleChange,\n  } = useSettingsAutosave();\n\n  const [activeTab, setActiveTab] = useState<ServerTab>('general');\n\n  useEffect(() => {\n    fetchSettings();\n  }, [fetchSettings]);\n\n  // Get current tab config\n  const currentTab = TABS.find((t) => t.id === activeTab);\n\n  // Collect settings from all categories for the current tab\n  const currentSettings = useMemo(() => {\n    if (!currentTab) return [];\n    const categories = currentTab.categories ?? ['server'];\n    const allSettings: (typeof settings)[string] = [];\n    for (const category of categories) {\n      const categorySettings = settings[category] ?? [];\n      allSettings.push(...categorySettings);\n    }\n    // Filter by keys and sort by keys order\n    return allSettings\n      .filter((s) => currentTab.keys.includes(s.key))\n      .sort((a, b) => currentTab.keys.indexOf(a.key) - currentTab.keys.indexOf(b.key));\n  }, [settings, currentTab]);\n\n  if (isLoading && Object.keys(settings).length === 0) {\n    return (\n      <div className={`cedros-system-settings cedros-system-settings-loading ${className ?? ''}`}>\n        <LoadingSpinner />\n        <span>Loading settings...</span>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={`cedros-system-settings ${className ?? ''}`}>\n        <ErrorMessage error={error.message} />\n      </div>\n    );\n  }\n\n  return (\n    <div className={`cedros-system-settings ${className ?? ''}`}>\n      <div className=\"cedros-settings-page-header\">\n        <div className=\"cedros-settings-page-header-content\">\n          <h2 className=\"cedros-settings-page-title\">Auth Server</h2>\n          <p className=\"cedros-settings-page-description\">\n            Server infrastructure settings. Some may be overridden by environment variables.\n          </p>\n        </div>\n        <AutosaveStatus status={autosaveStatus} error={autosaveError} />\n      </div>\n\n      {/* Tabs */}\n      <div className=\"cedros-admin-tabs cedros-admin-tabs--line\">\n        {TABS.map((tab) => (\n          <button\n            key={tab.id}\n            type=\"button\"\n            className={`cedros-admin-tab ${activeTab === tab.id ? 'cedros-admin-tab-active' : ''}`}\n            onClick={() => setActiveTab(tab.id)}\n            aria-selected={activeTab === tab.id}\n            role=\"tab\"\n          >\n            {tab.label}\n          </button>\n        ))}\n      </div>\n\n      {/* Tab content */}\n      <div className=\"cedros-admin-tab-content\" role=\"tabpanel\">\n        {currentSettings.length === 0 ? (\n          <div className=\"cedros-system-settings-empty\">\n            <p>No settings found for {currentTab?.label ?? 'this section'}.</p>\n          </div>\n        ) : (\n          <SettingsSection settings={currentSettings} edits={edits} onChange={handleChange} />\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["TABS","ServerSettings","className","settings","edits","isLoading","autosaveStatus","autosaveError","error","fetchSettings","handleChange","useSettingsAutosave","activeTab","setActiveTab","useState","useEffect","currentTab","t","currentSettings","useMemo","categories","allSettings","category","categorySettings","s","a","b","jsx","LoadingSpinner","ErrorMessage","jsxs","AutosaveStatus","tab","SettingsSection"],"mappings":"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"}