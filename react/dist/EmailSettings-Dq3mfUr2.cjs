"use strict";const s=require("react/jsx-runtime"),p=require("react"),M=require("./LoadingSpinner-d6sSxgQN.cjs"),P=require("./ErrorMessage-CHbYbVi2.cjs"),m=require("./AutosaveStatus-BjLMt52a.cjs"),u={mailgun:"smtp.mailgun.org",sendgrid:"smtp.sendgrid.net",postmark:"smtp.postmarkapp.com",ses:"email-smtp.us-east-1.amazonaws.com",resend:"smtp.resend.com"},S=["email_provider","email_smtp_password","email_from_address","email_from_name"],h=["email_provider","email_smtp_host","email_smtp_port","email_smtp_user","email_smtp_password","email_smtp_tls","email_from_address","email_from_name"];function y({className:n}){const{settings:a,edits:f,isLoading:v,autosaveStatus:E,autosaveError:x,error:d,fetchSettings:c,handleChange:i,getEffectiveValue:l}=m.useSettingsAutosave();p.useEffect(()=>{c()},[c]);const o=(l("email_provider")||"custom")==="custom",g=l("email_smtp_host"),L=!o||g!=null&&g!=="",_=p.useMemo(()=>{const r=a.email??[],e=o?h:S;return r.filter(t=>e.includes(t.key)).sort((t,I)=>e.indexOf(t.key)-e.indexOf(I.key))},[a,o]),j=(r,e)=>{if(i(r,e),r==="email_provider"&&e!=="custom"){const t=u[e];t&&(i("email_smtp_host",t),i("email_smtp_port","587"),i("email_smtp_tls","true"))}};return v&&Object.keys(a).length===0?s.jsxs("div",{className:`cedros-system-settings cedros-system-settings-loading ${n??""}`,children:[s.jsx(M.LoadingSpinner,{}),s.jsx("span",{children:"Loading settings..."})]}):d?s.jsx("div",{className:`cedros-system-settings ${n??""}`,children:s.jsx(P.ErrorMessage,{error:d.message})}):s.jsxs("div",{className:`cedros-system-settings ${n??""}`,children:[s.jsxs("div",{className:"cedros-settings-page-header",children:[s.jsxs("div",{className:"cedros-settings-page-header-content",children:[s.jsx("h2",{className:"cedros-settings-page-title",children:"Email & SMTP"}),s.jsx("p",{className:"cedros-settings-page-description",children:"Configure email delivery for verification emails, password resets, and instant link login."})]}),s.jsx(m.AutosaveStatus,{status:E,error:x})]}),!L&&s.jsx("div",{className:"cedros-settings-warning-banner",children:"Email features (verification, password reset, instant link) are disabled until SMTP is configured. Select a provider or enter custom SMTP settings below."}),_.length===0?s.jsx("div",{className:"cedros-system-settings-empty",children:s.jsx("p",{children:"No settings found for this section."})}):s.jsx(m.SettingsSection,{settings:_,edits:f,onChange:j})]})}exports.ALL_EMAIL_FIELDS=h;exports.EmailSettings=y;exports.PROVIDER_SMTP_HOSTS=u;exports.SIMPLIFIED_EMAIL_FIELDS=S;
