"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const S=require("./apiClient-CTTKhsYb.cjs"),e=require("./useAuth-DhIDTLRd.cjs"),r=require("./shamir-AeLLfw0p.cjs");async function T(A){const{password:p,serverUrl:h,accessToken:n,timeoutMs:y=3e4}=A,t=[];try{const s=e.generateSeed();t.push(s);const{shareA:a,shareB:o}=r.splitSecret(s);t.push(a,o);const c=e.generateArgon2Salt(),l=await r.argon2DeriveInWorker(p,c,e.DEFAULT_KDF_PARAMS);t.push(l);const i=await e.aesGcmEncryptToBase64(a,e.toEncryptionKey(l)),d=r.getPublicKeyFromSeed(s),u=r.publicKeyToBase58(d),g={solanaPubkey:u,shareAAuthMethod:"password",shareACiphertext:i.ciphertext,shareANonce:i.nonce,shareB:e.uint8ArrayToBase64(o),shareAKdfSalt:e.uint8ArrayToBase64(c),shareAKdfParams:e.DEFAULT_KDF_PARAMS};return await new S.ApiClient({baseUrl:h,timeoutMs:y,getAccessToken:n?()=>n:void 0}).post("/wallet/enroll",g),{success:!0,solanaPubkey:u}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Wallet enrollment failed"}}finally{e.wipeAll(...t)}}exports.silentWalletEnroll=T;
