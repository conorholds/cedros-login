{"version":3,"file":"plugin-8_dpq7tC.cjs","sources":["../src/components/admin/ProfileDropdown.tsx","../src/admin/AdminShell.tsx","../src/admin/icons.tsx","../src/admin/plugin.tsx"],"sourcesContent":["/**\n * Profile Dropdown Component\n *\n * Displays user avatar/name with a dropdown menu for settings and logout.\n */\n\nimport { useState, useRef, useEffect, useCallback } from 'react';\n\nexport interface ProfileDropdownProps {\n  /** User's display name */\n  name?: string;\n  /** User's email */\n  email?: string;\n  /** User's profile picture URL */\n  picture?: string;\n  /** Callback when Settings is clicked */\n  onSettings?: () => void;\n  /** Callback when Logout is clicked */\n  onLogout?: () => void;\n  /** Additional CSS class */\n  className?: string;\n}\n\n/**\n * Profile dropdown button with settings and logout options.\n *\n * @example\n * ```tsx\n * <ProfileDropdown\n *   name={user.name}\n *   email={user.email}\n *   picture={user.picture}\n *   onSettings={() => navigate('/settings')}\n *   onLogout={logout}\n * />\n * ```\n */\nexport function ProfileDropdown({\n  name,\n  email,\n  picture,\n  onSettings,\n  onLogout,\n  className = '',\n}: ProfileDropdownProps) {\n  const [isOpen, setIsOpen] = useState(false);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    function handleClickOutside(event: MouseEvent) {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    }\n\n    if (isOpen) {\n      document.addEventListener('mousedown', handleClickOutside);\n      return () => document.removeEventListener('mousedown', handleClickOutside);\n    }\n  }, [isOpen]);\n\n  // Close dropdown on escape key\n  useEffect(() => {\n    function handleEscape(event: KeyboardEvent) {\n      if (event.key === 'Escape') {\n        setIsOpen(false);\n      }\n    }\n\n    if (isOpen) {\n      document.addEventListener('keydown', handleEscape);\n      return () => document.removeEventListener('keydown', handleEscape);\n    }\n  }, [isOpen]);\n\n  const handleSettings = useCallback(() => {\n    setIsOpen(false);\n    onSettings?.();\n  }, [onSettings]);\n\n  const handleLogout = useCallback(() => {\n    setIsOpen(false);\n    onLogout?.();\n  }, [onLogout]);\n\n  const displayName = name || 'User';\n  const initial = (name?.[0] || email?.[0] || '?').toUpperCase();\n\n  return (\n    <div className={`cedros-profile-dropdown ${className}`} ref={dropdownRef}>\n      <button\n        type=\"button\"\n        className=\"cedros-profile-dropdown__trigger\"\n        onClick={() => setIsOpen(!isOpen)}\n        aria-expanded={isOpen}\n        aria-haspopup=\"menu\"\n      >\n        <div className=\"cedros-profile-dropdown__avatar\">\n          {picture ? (\n            <img\n              src={picture}\n              alt={displayName}\n              className=\"cedros-profile-dropdown__avatar-img\"\n              referrerPolicy=\"no-referrer\"\n            />\n          ) : (\n            <span className=\"cedros-profile-dropdown__avatar-placeholder\">{initial}</span>\n          )}\n        </div>\n        <div className=\"cedros-profile-dropdown__info\">\n          <span className=\"cedros-profile-dropdown__name\">{displayName}</span>\n          {email && <span className=\"cedros-profile-dropdown__email\">{email}</span>}\n        </div>\n        <svg\n          className={`cedros-profile-dropdown__chevron ${isOpen ? 'cedros-profile-dropdown__chevron--open' : ''}`}\n          width=\"16\"\n          height=\"16\"\n          viewBox=\"0 0 24 24\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          strokeWidth=\"2\"\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n        >\n          <path d=\"m6 9 6 6 6-6\" />\n        </svg>\n      </button>\n\n      {isOpen && (\n        <div className=\"cedros-profile-dropdown__menu\" role=\"menu\">\n          {onSettings && (\n            <button\n              type=\"button\"\n              className=\"cedros-profile-dropdown__item\"\n              onClick={handleSettings}\n              role=\"menuitem\"\n            >\n              <svg\n                width=\"16\"\n                height=\"16\"\n                viewBox=\"0 0 24 24\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                strokeWidth=\"2\"\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n              >\n                <path d=\"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z\" />\n                <circle cx=\"12\" cy=\"12\" r=\"3\" />\n              </svg>\n              Settings\n            </button>\n          )}\n          {onLogout && (\n            <button\n              type=\"button\"\n              className=\"cedros-profile-dropdown__item cedros-profile-dropdown__item--danger\"\n              onClick={handleLogout}\n              role=\"menuitem\"\n            >\n              <svg\n                width=\"16\"\n                height=\"16\"\n                viewBox=\"0 0 24 24\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                strokeWidth=\"2\"\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n              >\n                <path d=\"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4\" />\n                <polyline points=\"16 17 21 12 16 7\" />\n                <line x1=\"21\" x2=\"9\" y1=\"12\" y2=\"12\" />\n              </svg>\n              Log out\n            </button>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n","/**\n * AdminShell - Unified Admin Dashboard Host\n *\n * A shell component that hosts admin plugins from cedros-login, cedros-pay,\n * or any compatible plugin. Provides unified sidebar navigation and content area.\n *\n * @example\n * ```tsx\n * import { AdminShell } from '@cedros/login-react';\n * import { cedrosLoginPlugin } from '@cedros/login-react';\n * import { cedrosPayPlugin } from '@cedros/pay-react';\n *\n * function AdminPage() {\n *   const hostContext = useBuildHostContext();\n *   return (\n *     <AdminShell\n *       plugins={[cedrosLoginPlugin, cedrosPayPlugin]}\n *       hostContext={hostContext}\n *     />\n *   );\n * }\n * ```\n */\n\nimport React, {\n  createContext,\n  useContext,\n  useState,\n  useCallback,\n  useMemo,\n  useEffect,\n  Suspense,\n  type ReactNode,\n} from 'react';\nimport type {\n  AdminPlugin,\n  PluginRegistry,\n  HostContext,\n  QualifiedSectionId,\n  PluginContext,\n  ResolvedSection,\n} from './types';\nimport { LoadingSpinner } from '../components/shared/LoadingSpinner';\nimport { ProfileDropdown } from '../components/admin/ProfileDropdown';\nimport { CedrosLoginContext, type CedrosLoginContextValue } from '../context/CedrosLoginContext';\nimport type { AuthUser } from '../types';\n\n// ============================================================================\n// Plugin Registry Implementation\n// ============================================================================\n\nclass PluginRegistryImpl implements PluginRegistry {\n  private plugins = new Map<string, AdminPlugin>();\n  private listeners = new Set<(plugins: AdminPlugin[]) => void>();\n\n  register(plugin: AdminPlugin): void {\n    if (this.plugins.has(plugin.id)) {\n      console.warn(`Plugin ${plugin.id} already registered, replacing...`);\n    }\n    this.plugins.set(plugin.id, plugin);\n    plugin.onRegister?.(this);\n    this.notify();\n  }\n\n  unregister(pluginId: string): void {\n    const plugin = this.plugins.get(pluginId);\n    if (plugin) {\n      plugin.onUnregister?.();\n      this.plugins.delete(pluginId);\n      this.notify();\n    }\n  }\n\n  get(pluginId: string): AdminPlugin | undefined {\n    return this.plugins.get(pluginId);\n  }\n\n  getAll(): AdminPlugin[] {\n    return Array.from(this.plugins.values());\n  }\n\n  subscribe(listener: (plugins: AdminPlugin[]) => void): () => void {\n    this.listeners.add(listener);\n    return () => this.listeners.delete(listener);\n  }\n\n  private notify(): void {\n    const plugins = this.getAll();\n    this.listeners.forEach((listener) => listener(plugins));\n  }\n}\n\n// ============================================================================\n// Context\n// ============================================================================\n\ninterface AdminShellContextValue {\n  registry: PluginRegistry;\n  hostContext: HostContext;\n  activeSection: QualifiedSectionId | null;\n  setActiveSection: (section: QualifiedSectionId) => void;\n  getPluginContext: (pluginId: string) => PluginContext | null;\n}\n\nconst AdminShellContext = createContext<AdminShellContextValue | null>(null);\n\n// eslint-disable-next-line react-refresh/only-export-components\nexport function useAdminShell(): AdminShellContextValue {\n  const ctx = useContext(AdminShellContext);\n  if (!ctx) throw new Error('useAdminShell must be used within AdminShell');\n  return ctx;\n}\n\n// ============================================================================\n// Props\n// ============================================================================\n\nexport interface AdminShellProps {\n  /** Dashboard title */\n  title?: string;\n  /** Plugins to load */\n  plugins?: AdminPlugin[];\n  /** Host context from parent providers */\n  hostContext: HostContext;\n  /** Default active section (qualified ID) */\n  defaultSection?: QualifiedSectionId;\n  /** Page size for lists */\n  pageSize?: number;\n  /** Refresh interval in ms (0 to disable) */\n  refreshInterval?: number;\n  /** Callback when section changes */\n  onSectionChange?: (section: QualifiedSectionId) => void;\n  /** Custom logo/header content */\n  logo?: ReactNode;\n  /** Additional sidebar footer content */\n  sidebarFooter?: ReactNode;\n  /** Callback when user clicks Settings in profile dropdown */\n  onSettingsClick?: () => void;\n  /** Callback when user clicks Logout in profile dropdown */\n  onLogoutClick?: () => void;\n  /** Additional CSS class */\n  className?: string;\n}\n\n// ============================================================================\n// Group Order Helpers\n// ============================================================================\n\n/** Build a group-label â†’ order map from all registered plugins' groups[] config. */\nfunction buildGroupOrder(plugins: AdminPlugin[]): Map<string, number> {\n  const order = new Map<string, number>();\n  for (const plugin of plugins) {\n    for (const group of plugin.groups ?? []) {\n      // Key by label (sections reference groups by display name via section.group).\n      // First plugin to declare a group wins; later plugins don't override.\n      if (!order.has(group.label)) {\n        order.set(group.label, group.order);\n      }\n    }\n  }\n  return order;\n}\n\n// ============================================================================\n// AdminShell Component\n// ============================================================================\n\nexport function AdminShell({\n  title = 'Admin',\n  plugins: initialPlugins = [],\n  hostContext,\n  defaultSection,\n  pageSize = 20,\n  refreshInterval = 0,\n  onSectionChange,\n  logo,\n  sidebarFooter,\n  onSettingsClick,\n  onLogoutClick,\n  className = '',\n}: AdminShellProps): React.JSX.Element {\n  // Plugin registry\n  const [registry] = useState(() => {\n    const reg = new PluginRegistryImpl();\n    initialPlugins.forEach((p) => reg.register(p));\n    return reg;\n  });\n\n  // Track registered plugins for re-renders\n  const [registeredPlugins, setRegisteredPlugins] = useState<AdminPlugin[]>(() =>\n    registry.getAll()\n  );\n\n  useEffect(() => {\n    return registry.subscribe(setRegisteredPlugins);\n  }, [registry]);\n\n  // Aggregate sections from all plugins\n  const allSections = useMemo(() => {\n    return registeredPlugins.flatMap((plugin) =>\n      plugin.sections\n        .filter((section) => {\n          // Check RBAC permissions (role-based)\n          if (section.requiredPermission) {\n            if (!plugin.checkPermission(section.requiredPermission, hostContext)) {\n              return false;\n            }\n          }\n          // Check dashboard section permissions (owner-configured per role)\n          if (hostContext.dashboardPermissions) {\n            if (!hostContext.dashboardPermissions.canAccess(section.id)) {\n              return false;\n            }\n          }\n          return true;\n        })\n        .map(\n          (section): ResolvedSection => ({\n            ...section,\n            qualifiedId: `${plugin.id}:${section.id}` as QualifiedSectionId,\n            pluginId: plugin.id,\n            cssNamespace: plugin.cssNamespace,\n          })\n        )\n    );\n  }, [registeredPlugins, hostContext]);\n\n  // Active section state\n  const [activeSection, setActiveSectionInternal] = useState<QualifiedSectionId | null>(\n    () => defaultSection ?? allSections[0]?.qualifiedId ?? null\n  );\n\n  // Collapsible groups state\n  const [collapsedGroups, setCollapsedGroups] = useState<Set<string>>(new Set());\n\n  const toggleGroup = useCallback((groupName: string) => {\n    setCollapsedGroups((prev) => {\n      const next = new Set(prev);\n      if (next.has(groupName)) {\n        next.delete(groupName);\n      } else {\n        next.add(groupName);\n      }\n      return next;\n    });\n  }, []);\n\n  // Update active section when sections change and current is invalid\n  useEffect(() => {\n    if (activeSection && !allSections.find((s) => s.qualifiedId === activeSection)) {\n      setActiveSectionInternal(allSections[0]?.qualifiedId ?? null);\n    }\n  }, [allSections, activeSection]);\n\n  const setActiveSection = useCallback(\n    (section: QualifiedSectionId) => {\n      setActiveSectionInternal(section);\n      onSectionChange?.(section);\n    },\n    [onSectionChange]\n  );\n\n  // Plugin context factory\n  const getPluginContext = useCallback(\n    (pluginId: string): PluginContext | null => {\n      const plugin = registry.get(pluginId);\n      if (!plugin) return null;\n      return plugin.createPluginContext(hostContext);\n    },\n    [registry, hostContext]\n  );\n\n  // Group sections by group name, sorted by plugin-defined group order\n  const groupedSections = useMemo(() => {\n    const groupOrder = buildGroupOrder(registeredPlugins);\n    const groups = new Map<string, ResolvedSection[]>();\n\n    allSections.forEach((section) => {\n      const groupName = section.group ?? 'Menu';\n      const existing = groups.get(groupName) ?? [];\n      groups.set(groupName, [...existing, section]);\n    });\n\n    // Sort groups by plugin-defined order (undeclared groups sink to bottom)\n    const sortedGroups = Array.from(groups.entries()).sort(([a], [b]) => {\n      const orderA = groupOrder.get(a) ?? 99;\n      const orderB = groupOrder.get(b) ?? 99;\n      return orderA - orderB;\n    });\n\n    return sortedGroups;\n  }, [allSections, registeredPlugins]);\n\n  // Get current section's component\n  const currentSection = useMemo(() => {\n    if (!activeSection) return null;\n    const [pluginId, sectionId] = activeSection.split(':') as [string, string];\n    const plugin = registry.get(pluginId);\n    if (!plugin) return null;\n    const Component = plugin.components[sectionId];\n    if (!Component) return null;\n    const pluginContext = plugin.createPluginContext(hostContext);\n    return { Component, pluginContext, plugin };\n  }, [activeSection, registry, hostContext]);\n\n  // Context value\n  const contextValue = useMemo<AdminShellContextValue>(\n    () => ({\n      registry,\n      hostContext,\n      activeSection,\n      setActiveSection,\n      getPluginContext,\n    }),\n    [registry, hostContext, activeSection, setActiveSection, getPluginContext]\n  );\n\n  // Bridge hostContext.cedrosLogin into CedrosLoginContext so hooks\n  // (useOrgs, useAdminDeposits, etc.) work inside AdminShell sections.\n  const cedrosLoginContextValue = useMemo<CedrosLoginContextValue | null>(() => {\n    const cl = hostContext.cedrosLogin;\n    if (!cl) return null;\n    const user: AuthUser | null = cl.user\n      ? { authMethods: [], emailVerified: false, createdAt: '', updatedAt: '', ...cl.user }\n      : null;\n    return {\n      config: { serverUrl: cl.serverUrl },\n      user,\n      authState: cl.user ? 'authenticated' : 'unauthenticated',\n      error: null,\n      logout: async () => {},\n      refreshUser: async () => {},\n      isModalOpen: false,\n      openModal: () => {},\n      closeModal: () => {},\n      _internal: {\n        handleLoginSuccess: () => {},\n        getAccessToken: cl.getAccessToken,\n      },\n    };\n  }, [hostContext.cedrosLogin]);\n\n  return (\n    <AdminShellContext.Provider value={contextValue}>\n      <CedrosLoginContext.Provider value={cedrosLoginContextValue}>\n        <div className={`cedros-admin cedros-admin-shell ${className || ''}`}>\n          {/* Sidebar */}\n          <aside className=\"cedros-admin-shell__sidebar\">\n            <div className=\"cedros-admin-shell__sidebar-header\">\n              {logo ?? (\n                <div className=\"cedros-admin-shell__logo\">\n                  <span className=\"cedros-admin-shell__logo-text\">{title}</span>\n                </div>\n              )}\n            </div>\n\n            <nav className=\"cedros-admin-shell__nav\">\n              {groupedSections.map(([groupName, sections]) => {\n                const isCollapsible = groupName === 'Configuration';\n                const isCollapsed = collapsedGroups.has(groupName);\n\n                return (\n                  <div key={groupName} className=\"cedros-admin-shell__nav-group\">\n                    {isCollapsible ? (\n                      <button\n                        type=\"button\"\n                        className=\"cedros-admin-shell__nav-label cedros-admin-shell__nav-label--collapsible\"\n                        onClick={() => toggleGroup(groupName)}\n                        aria-expanded={!isCollapsed}\n                      >\n                        <span>{groupName}</span>\n                        <span\n                          className={`cedros-admin-shell__nav-chevron ${!isCollapsed ? 'cedros-admin-shell__nav-chevron--expanded' : ''}`}\n                        >\n                          <svg\n                            width=\"16\"\n                            height=\"16\"\n                            viewBox=\"0 0 24 24\"\n                            fill=\"none\"\n                            stroke=\"currentColor\"\n                            strokeWidth=\"2\"\n                            strokeLinecap=\"round\"\n                            strokeLinejoin=\"round\"\n                          >\n                            <path d=\"m9 18 6-6-6-6\" />\n                          </svg>\n                        </span>\n                      </button>\n                    ) : (\n                      <span className=\"cedros-admin-shell__nav-label\">{groupName}</span>\n                    )}\n                    {(!isCollapsible || !isCollapsed) &&\n                      sections\n                        .sort((a, b) => (a.order ?? 0) - (b.order ?? 0))\n                        .map((section) => (\n                          <button\n                            key={section.qualifiedId}\n                            type=\"button\"\n                            className={`cedros-admin-shell__nav-item ${\n                              activeSection === section.qualifiedId\n                                ? 'cedros-admin-shell__nav-item--active'\n                                : ''\n                            }`}\n                            onClick={() => setActiveSection(section.qualifiedId)}\n                            aria-current={\n                              activeSection === section.qualifiedId ? 'page' : undefined\n                            }\n                          >\n                            <span className=\"cedros-admin-shell__nav-icon\">{section.icon}</span>\n                            <span className=\"cedros-admin-shell__nav-text\">{section.label}</span>\n                            {section.badge && (\n                              <span className=\"cedros-admin-shell__nav-badge\">{section.badge}</span>\n                            )}\n                          </button>\n                        ))}\n                  </div>\n                );\n              })}\n            </nav>\n\n            {/* User profile dropdown + optional custom footer */}\n            {(hostContext.cedrosLogin?.user || sidebarFooter) && (\n              <div className=\"cedros-admin-shell__sidebar-footer\">\n                {hostContext.cedrosLogin?.user && (\n                  <ProfileDropdown\n                    name={hostContext.cedrosLogin.user.name}\n                    email={hostContext.cedrosLogin.user.email}\n                    picture={hostContext.cedrosLogin.user.picture}\n                    onSettings={onSettingsClick}\n                    onLogout={onLogoutClick}\n                  />\n                )}\n                {sidebarFooter}\n              </div>\n            )}\n          </aside>\n\n          {/* Main Content */}\n          <main className=\"cedros-admin-shell__main\">\n            {currentSection ? (\n              <Suspense fallback={<LoadingFallback />}>\n                <div\n                  className=\"cedros-admin-shell__section\"\n                  data-plugin-namespace={currentSection.plugin.cssNamespace}\n                >\n                  <currentSection.Component\n                    pluginContext={currentSection.pluginContext}\n                    pageSize={pageSize}\n                    refreshInterval={refreshInterval}\n                  />\n                </div>\n              </Suspense>\n            ) : (\n              <div className=\"cedros-admin-shell__empty\">\n                {allSections.length === 0\n                  ? 'No plugins loaded'\n                  : 'Select a section from the sidebar'}\n              </div>\n            )}\n          </main>\n        </div>\n      </CedrosLoginContext.Provider>\n    </AdminShellContext.Provider>\n  );\n}\n\n// ============================================================================\n// Helper Components\n// ============================================================================\n\nfunction LoadingFallback(): React.JSX.Element {\n  return (\n    <div className=\"cedros-admin-shell__loading\">\n      <LoadingSpinner />\n      <span>Loading...</span>\n    </div>\n  );\n}\n","/**\n * Admin Dashboard Icons\n *\n * SVG icons for the admin dashboard sidebar and sections.\n * Lucide-style, 24x24 viewBox rendered at 16x16.\n */\n\nimport type { ReactNode } from 'react';\n\nconst iconProps = {\n  width: '16',\n  height: '16',\n  viewBox: '0 0 24 24',\n  fill: 'none',\n  stroke: 'currentColor',\n  strokeWidth: '2',\n  strokeLinecap: 'round' as const,\n  strokeLinejoin: 'round' as const,\n};\n\nexport const Icons: Record<string, ReactNode> = {\n  users: (\n    <svg {...iconProps}>\n      <path d=\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\" />\n      <circle cx=\"9\" cy=\"7\" r=\"4\" />\n      <path d=\"M22 21v-2a4 4 0 0 0-3-3.87\" />\n      <path d=\"M16 3.13a4 4 0 0 1 0 7.75\" />\n    </svg>\n  ),\n\n  members: (\n    <svg {...iconProps}>\n      <path d=\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\" />\n      <circle cx=\"9\" cy=\"7\" r=\"4\" />\n      <path d=\"M22 21v-2a4 4 0 0 0-3-3.87\" />\n      <path d=\"M16 3.13a4 4 0 0 1 0 7.75\" />\n    </svg>\n  ),\n\n  invites: (\n    <svg {...iconProps}>\n      <rect width=\"20\" height=\"16\" x=\"2\" y=\"4\" rx=\"2\" />\n      <path d=\"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7\" />\n    </svg>\n  ),\n\n  deposits: (\n    <svg {...iconProps}>\n      <circle cx=\"12\" cy=\"12\" r=\"10\" />\n      <path d=\"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8\" />\n      <path d=\"M12 18V6\" />\n    </svg>\n  ),\n\n  withdrawals: (\n    <svg {...iconProps}>\n      <rect width=\"16\" height=\"20\" x=\"4\" y=\"2\" rx=\"2\" ry=\"2\" />\n      <path d=\"M9 22v-4h6v4\" />\n      <path d=\"M8 6h.01\" />\n      <path d=\"M16 6h.01\" />\n      <path d=\"M12 6h.01\" />\n      <path d=\"M12 10h.01\" />\n      <path d=\"M12 14h.01\" />\n      <path d=\"M16 10h.01\" />\n      <path d=\"M16 14h.01\" />\n      <path d=\"M8 10h.01\" />\n      <path d=\"M8 14h.01\" />\n    </svg>\n  ),\n\n  settings: (\n    <svg {...iconProps}>\n      <path d=\"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z\" />\n      <circle cx=\"12\" cy=\"12\" r=\"3\" />\n    </svg>\n  ),\n\n  wallet: (\n    <svg {...iconProps}>\n      <path d=\"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1\" />\n      <path d=\"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4\" />\n    </svg>\n  ),\n\n  chevronRight: (\n    <svg {...iconProps}>\n      <path d=\"m9 18 6-6-6-6\" />\n    </svg>\n  ),\n\n  // Settings sub-page icons\n  key: (\n    <svg {...iconProps}>\n      <path d=\"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4\" />\n    </svg>\n  ),\n\n  toggles: (\n    <svg {...iconProps}>\n      <rect width=\"20\" height=\"12\" x=\"2\" y=\"6\" rx=\"6\" />\n      <circle cx=\"8\" cy=\"12\" r=\"2\" />\n    </svg>\n  ),\n\n  shield: (\n    <svg {...iconProps}>\n      <path d=\"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z\" />\n    </svg>\n  ),\n\n  mail: (\n    <svg {...iconProps}>\n      <rect width=\"20\" height=\"16\" x=\"2\" y=\"4\" rx=\"2\" />\n      <path d=\"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7\" />\n    </svg>\n  ),\n\n  webhook: (\n    <svg {...iconProps}>\n      <path d=\"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2\" />\n      <path d=\"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06\" />\n      <path d=\"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8\" />\n    </svg>\n  ),\n\n  coins: (\n    <svg {...iconProps}>\n      <circle cx=\"8\" cy=\"8\" r=\"6\" />\n      <path d=\"M18.09 10.37A6 6 0 1 1 10.34 18\" />\n      <path d=\"M7 6h1v4\" />\n      <path d=\"m16.71 13.88.7.71-2.82 2.82\" />\n    </svg>\n  ),\n\n  server: (\n    <svg {...iconProps}>\n      <rect width=\"20\" height=\"8\" x=\"2\" y=\"2\" rx=\"2\" ry=\"2\" />\n      <rect width=\"20\" height=\"8\" x=\"2\" y=\"14\" rx=\"2\" ry=\"2\" />\n      <line x1=\"6\" x2=\"6.01\" y1=\"6\" y2=\"6\" />\n      <line x1=\"6\" x2=\"6.01\" y1=\"18\" y2=\"18\" />\n    </svg>\n  ),\n};\n","/**\n * Cedros Login Admin Plugin\n *\n * Exports the cedrosLoginPlugin for use with AdminShell.\n * Provides user management, deposits, withdrawals, and configuration sections.\n */\n\nimport { lazy } from 'react';\nimport type { AdminPlugin, HostContext, PluginContext, AdminSectionConfig } from './types';\nimport { Icons } from './icons';\n\n// ============================================================================\n// Lazy-loaded Section Components\n// ============================================================================\n\nconst UsersSection = lazy(() => import('./sections/UsersSection'));\nconst TeamSection = lazy(() => import('./sections/TeamSection'));\nconst DepositsSection = lazy(() => import('./sections/DepositsSection'));\nconst WithdrawalsSection = lazy(() => import('./sections/WithdrawalsSection'));\nconst AuthenticationSettings = lazy(() => import('./sections/AuthenticationSettings'));\nconst EmbeddedWalletSettings = lazy(() => import('./sections/EmbeddedWalletSettings'));\nconst EmailSettings = lazy(() => import('./sections/EmailSettings'));\nconst WebhookSettings = lazy(() => import('./sections/WebhookSettings'));\nconst CreditSystemSettings = lazy(() => import('./sections/CreditSystemSettings'));\nconst ServerSettings = lazy(() => import('./sections/ServerSettings'));\n\n// ============================================================================\n// Permission Mapping\n// ============================================================================\n\ntype LoginPermission =\n  | 'login:users:read'\n  | 'login:users:write'\n  | 'login:members:read'\n  | 'login:members:write'\n  | 'login:invites:read'\n  | 'login:invites:write'\n  | 'login:deposits:read'\n  | 'login:deposits:write'\n  | 'login:settings:read'\n  | 'login:settings:write';\n\n/**\n * Maps plugin permissions to org-level permissions/roles.\n */\nconst PERMISSION_MAP: Record<LoginPermission, string[]> = {\n  'login:users:read': ['admin', 'owner'],\n  'login:users:write': ['admin', 'owner'],\n  'login:members:read': ['member:read', 'admin', 'owner'],\n  'login:members:write': ['member:remove', 'member:role_change'],\n  'login:invites:read': ['invite:read', 'admin', 'owner'],\n  'login:invites:write': ['invite:create', 'invite:cancel'],\n  'login:deposits:read': ['admin', 'owner'],\n  'login:deposits:write': ['admin', 'owner'],\n  'login:settings:read': ['admin', 'owner'],\n  'login:settings:write': ['admin', 'owner'],\n};\n\n// ============================================================================\n// Section Configuration\n// ============================================================================\n\nconst SECTIONS: AdminSectionConfig[] = [\n  // Users group (main sections)\n  {\n    id: 'users',\n    label: 'Users',\n    icon: Icons.users,\n    group: 'Users',\n    order: 0,\n    requiredPermission: 'login:users:read',\n  },\n  {\n    id: 'team',\n    label: 'Team',\n    icon: Icons.members,\n    group: 'Users',\n    order: 1,\n    requiredPermission: 'login:members:read',\n  },\n  {\n    id: 'deposits',\n    label: 'Deposits',\n    icon: Icons.deposits,\n    group: 'Users',\n    order: 2,\n    requiredPermission: 'login:deposits:read',\n  },\n  {\n    id: 'withdrawals',\n    label: 'Withdrawals',\n    icon: Icons.withdrawals,\n    group: 'Users',\n    order: 3,\n    requiredPermission: 'login:deposits:read',\n  },\n\n  // Configuration group (settings sections)\n  {\n    id: 'settings-auth',\n    label: 'Authentication',\n    icon: Icons.key,\n    group: 'Configuration',\n    order: 0,\n    requiredPermission: 'login:settings:read',\n  },\n  {\n    id: 'settings-email',\n    label: 'Email & SMTP',\n    icon: Icons.mail,\n    group: 'Configuration',\n    order: 1,\n    requiredPermission: 'login:settings:read',\n  },\n  {\n    id: 'settings-webhooks',\n    label: 'Webhooks',\n    icon: Icons.webhook,\n    group: 'Configuration',\n    order: 2,\n    requiredPermission: 'login:settings:read',\n  },\n  {\n    id: 'settings-wallet',\n    label: 'User Wallets',\n    icon: Icons.wallet,\n    group: 'Configuration',\n    order: 3,\n    requiredPermission: 'login:settings:read',\n  },\n  {\n    id: 'settings-credits',\n    label: 'Credit System',\n    icon: Icons.coins,\n    group: 'Configuration',\n    order: 4,\n    requiredPermission: 'login:settings:read',\n  },\n  {\n    id: 'settings-server',\n    label: 'Auth Server',\n    icon: Icons.server,\n    group: 'Configuration',\n    order: 5,\n    requiredPermission: 'login:settings:read',\n  },\n];\n\n// ============================================================================\n// Plugin Definition\n// ============================================================================\n\nexport const cedrosLoginPlugin: AdminPlugin = {\n  id: 'cedros-login',\n  name: 'Cedros Login',\n  version: '1.0.0',\n\n  sections: SECTIONS,\n\n  groups: [\n    { id: 'users', label: 'Users', order: 0 },\n    { id: 'configuration', label: 'Configuration', order: 2 },\n  ],\n\n  components: {\n    users: UsersSection,\n    team: TeamSection,\n    deposits: DepositsSection,\n    withdrawals: WithdrawalsSection,\n    'settings-auth': AuthenticationSettings,\n    'settings-wallet': EmbeddedWalletSettings,\n    'settings-email': EmailSettings,\n    'settings-webhooks': WebhookSettings,\n    'settings-credits': CreditSystemSettings,\n    'settings-server': ServerSettings,\n  },\n\n  createPluginContext(hostContext: HostContext): PluginContext {\n    const cedrosLogin = hostContext.cedrosLogin;\n    if (!cedrosLogin) {\n      throw new Error('cedros-login plugin requires cedrosLogin in hostContext');\n    }\n\n    return {\n      serverUrl: cedrosLogin.serverUrl,\n      userId: cedrosLogin.user?.id,\n      getAccessToken: cedrosLogin.getAccessToken,\n      hasPermission: (permission) => this.checkPermission(permission, hostContext),\n      orgId: hostContext.org?.orgId,\n      pluginData: {\n        user: cedrosLogin.user,\n        orgRole: hostContext.org?.role,\n      },\n    };\n  },\n\n  checkPermission(permission: string, hostContext: HostContext): boolean {\n    const org = hostContext.org;\n\n    // No org context = admin-level access (for global admins)\n    if (!org) {\n      // Check if user is in cedrosLogin context - assume admin if present\n      return Boolean(hostContext.cedrosLogin?.user);\n    }\n\n    const requiredPerms = PERMISSION_MAP[permission as LoginPermission];\n    if (!requiredPerms) {\n      // Unknown permission - default deny\n      return false;\n    }\n\n    // Check if user has any of the required permissions\n    return requiredPerms.some(\n      (p) =>\n        org.permissions.includes(p) ||\n        p === org.role ||\n        (p === 'admin' && ['admin', 'owner'].includes(org.role)) ||\n        (p === 'owner' && org.role === 'owner')\n    );\n  },\n\n  cssNamespace: 'cedros-dashboard',\n};\n\n// Named export for convenience\nexport { cedrosLoginPlugin as loginPlugin };\n"],"names":["ProfileDropdown","name","email","picture","onSettings","onLogout","className","isOpen","setIsOpen","useState","dropdownRef","useRef","useEffect","handleClickOutside","event","handleEscape","handleSettings","useCallback","handleLogout","displayName","initial","jsxs","jsx","PluginRegistryImpl","plugin","pluginId","listener","plugins","AdminShellContext","createContext","useAdminShell","ctx","useContext","buildGroupOrder","order","group","AdminShell","title","initialPlugins","hostContext","defaultSection","pageSize","refreshInterval","onSectionChange","logo","sidebarFooter","onSettingsClick","onLogoutClick","registry","reg","p","registeredPlugins","setRegisteredPlugins","allSections","useMemo","section","activeSection","setActiveSectionInternal","collapsedGroups","setCollapsedGroups","toggleGroup","groupName","prev","next","setActiveSection","getPluginContext","groupedSections","groupOrder","groups","existing","a","b","orderA","orderB","currentSection","sectionId","Component","pluginContext","contextValue","cedrosLoginContextValue","cl","user","CedrosLoginContext","sections","isCollapsible","isCollapsed","Suspense","LoadingFallback","LoadingSpinner","iconProps","Icons","UsersSection","lazy","TeamSection","DepositsSection","WithdrawalsSection","AuthenticationSettings","EmbeddedWalletSettings","EmailSettings","WebhookSettings","CreditSystemSettings","ServerSettings","PERMISSION_MAP","SECTIONS","cedrosLoginPlugin","cedrosLogin","permission","org","requiredPerms"],"mappings":"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"}