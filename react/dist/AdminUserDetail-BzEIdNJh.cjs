"use strict";const e=require("react/jsx-runtime"),o=require("react"),w=require("./apiClient-CTTKhsYb.cjs");class pe{client;constructor(t,r,a,b){this.client=new w.ApiClient({baseUrl:t,timeoutMs:r,retryAttempts:a,getAccessToken:b})}async listUsers(t){try{const r=new URLSearchParams;t?.limit&&r.set("limit",String(t.limit)),t?.offset&&r.set("offset",String(t.offset));const a=r.toString(),b=`/admin/users${a?`?${a}`:""}`;return await this.client.get(b)}catch(r){throw w.handleApiError(r,"Failed to list users")}}async getUser(t){try{return await this.client.get(`/admin/users/${t}`)}catch(r){throw w.handleApiError(r,"Failed to get user")}}async setSystemAdmin(t,r){try{await this.client.patch(`/admin/users/${t}/system-admin`,{isAdmin:r})}catch(a){throw w.handleApiError(a,"Failed to update system admin status")}}async updateUser(t,r){try{return await this.client.patch(`/admin/users/${t}`,r)}catch(a){throw w.handleApiError(a,"Failed to update user")}}async deleteUser(t){try{await this.client.delete(`/admin/users/${t}`)}catch(r){throw w.handleApiError(r,"Failed to delete user")}}async forcePasswordReset(t){try{await this.client.post(`/admin/users/${t}/force-password-reset`,{})}catch(r){throw w.handleApiError(r,"Failed to send password reset email")}}async adjustCredits(t,r){try{await this.client.post(`/admin/users/${t}/credits`,r)}catch(a){throw w.handleApiError(a,"Failed to adjust credits")}}async getUserDeposits(t,r){try{const a=new URLSearchParams;r?.limit&&a.set("limit",String(r.limit)),r?.offset&&a.set("offset",String(r.offset));const b=a.toString(),x=`/admin/users/${t}/deposits${b?`?${b}`:""}`;return await this.client.get(x)}catch(a){throw w.handleApiError(a,"Failed to get user deposits")}}async getUserCredits(t,r){try{const a=new URLSearchParams;r?.limit&&a.set("limit",String(r.limit)),r?.offset&&a.set("offset",String(r.offset));const b=a.toString(),x=`/admin/users/${t}/credits${b?`?${b}`:""}`;return await this.client.get(x)}catch(a){throw w.handleApiError(a,"Failed to get user credits")}}async getUserWithdrawalHistory(t,r){try{const a=new URLSearchParams;r?.limit&&a.set("limit",String(r.limit)),r?.offset&&a.set("offset",String(r.offset));const b=a.toString(),x=`/admin/users/${t}/withdrawal-history${b?`?${b}`:""}`;return await this.client.get(x)}catch(a){throw w.handleApiError(a,"Failed to get user withdrawal history")}}async getUserChats(t,r){try{const a=new URLSearchParams;r?.limit&&a.set("limit",String(r.limit)),r?.offset&&a.set("offset",String(r.offset));const b=a.toString(),x=`/admin/users/${t}/chats${b?`?${b}`:""}`;return await this.client.get(x)}catch(a){throw w.handleApiError(a,"Failed to get user chat history")}}async getStats(){try{return await this.client.get("/admin/users/stats")}catch(t){throw w.handleApiError(t,"Failed to get user stats")}}}function Q(){const{config:s,_internal:t}=w.useCedrosLogin(),[r,a]=o.useState([]),[b,x]=o.useState(0),[g,l]=o.useState(!1),[u,h]=o.useState(null),[L,P]=o.useState({}),f=o.useMemo(()=>new pe(s.serverUrl,s.requestTimeout,s.retryAttempts,t?.getAccessToken),[s.serverUrl,s.requestTimeout,s.retryAttempts,t]),D=o.useCallback(async c=>{l(!0),h(null),P(c||{});try{const n=await f.listUsers(c);return a(n.users),x(n.total),n}catch(n){const i=n instanceof Error?n:new Error("Failed to list users");throw h(i),i}finally{l(!1)}},[f]),R=o.useCallback(async c=>{l(!0),h(null);try{return await f.getUser(c)}catch(n){const i=n instanceof Error?n:new Error("Failed to get user");throw h(i),i}finally{l(!1)}},[f]),m=o.useCallback(async(c,n)=>{l(!0),h(null);try{await f.setSystemAdmin(c,n),a(i=>i.map(p=>p.id===c?{...p,isSystemAdmin:n}:p))}catch(i){const p=i instanceof Error?i:new Error("Failed to update admin status");throw h(p),p}finally{l(!1)}},[f]),y=o.useCallback(async(c,n)=>{l(!0),h(null);try{const i=await f.updateUser(c,n);return a(p=>p.map(F=>F.id===c?i:F)),i}catch(i){const p=i instanceof Error?i:new Error("Failed to update user");throw h(p),p}finally{l(!1)}},[f]),N=o.useCallback(async c=>{l(!0),h(null);try{await f.deleteUser(c),a(n=>n.filter(i=>i.id!==c)),x(n=>n-1)}catch(n){const i=n instanceof Error?n:new Error("Failed to delete user");throw h(i),i}finally{l(!1)}},[f]),v=o.useCallback(async c=>{l(!0),h(null);try{await f.forcePasswordReset(c)}catch(n){const i=n instanceof Error?n:new Error("Failed to send password reset");throw h(i),i}finally{l(!1)}},[f]),U=o.useCallback(async(c,n,i)=>{l(!0),h(null);try{await f.adjustCredits(c,{amount:n,reason:i})}catch(p){const F=p instanceof Error?p:new Error("Failed to adjust credits");throw h(F),F}finally{l(!1)}},[f]),$=o.useCallback(async(c,n)=>{l(!0),h(null);try{return await f.getUserDeposits(c,n)}catch(i){const p=i instanceof Error?i:new Error("Failed to get user deposits");throw h(p),p}finally{l(!1)}},[f]),k=o.useCallback(async(c,n)=>{l(!0),h(null);try{return await f.getUserCredits(c,n)}catch(i){const p=i instanceof Error?i:new Error("Failed to get user credits");throw h(p),p}finally{l(!1)}},[f]),E=o.useCallback(async(c,n)=>{l(!0),h(null);try{return await f.getUserWithdrawalHistory(c,n)}catch(i){const p=i instanceof Error?i:new Error("Failed to get user withdrawal history");throw h(p),p}finally{l(!1)}},[f]),C=o.useCallback(async(c,n)=>{l(!0),h(null);try{return await f.getUserChats(c,n)}catch(i){const p=i instanceof Error?i:new Error("Failed to get user chat history");throw h(p),p}finally{l(!1)}},[f]),A=o.useCallback(async()=>{l(!0),h(null);try{return await f.getStats()}catch(c){const n=c instanceof Error?c:new Error("Failed to get user stats");throw h(n),n}finally{l(!1)}},[f]),T=o.useCallback(async()=>{await D(L)},[D,L]),d=o.useCallback(()=>{h(null)},[]);return{users:r,total:b,isLoading:g,error:u,listUsers:D,getUser:R,setSystemAdmin:m,updateUser:y,deleteUser:N,forcePasswordReset:v,adjustCredits:U,getUserDeposits:$,getUserCredits:k,getUserWithdrawalHistory:E,getUserChats:C,getStats:A,refresh:T,clearError:d}}function z(s){return new Date(s).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function be(s){return s.length<=12?s:`${s.slice(0,6)}...${s.slice(-4)}`}function xe(s){return s==null?"-":(s/1e9).toFixed(4)}function je({pageSize:s=20,refreshInterval:t=0,currentUserId:r,className:a="",onLoad:b,onUserClick:x}){const{users:g,total:l,isLoading:u,error:h,listUsers:L,clearError:P}=Q(),[f,D]=o.useState(0),[R,m]=o.useState(null),[y,N]=o.useState("createdAt"),[v,U]=o.useState("desc"),$=d=>{y===d?U(v==="asc"?"desc":"asc"):(N(d),U("desc"))},k=o.useMemo(()=>[...g].sort((d,c)=>{let n,i;switch(y){case"name":n=(d.name||d.email||"").toLowerCase(),i=(c.name||c.email||"").toLowerCase();break;case"createdAt":n=new Date(d.createdAt).getTime(),i=new Date(c.createdAt).getTime();break;case"lastLoginAt":n=d.lastLoginAt?new Date(d.lastLoginAt).getTime():0,i=c.lastLoginAt?new Date(c.lastLoginAt).getTime():0;break;case"balanceLamports":n=d.balanceLamports??0,i=c.balanceLamports??0;break;default:return 0}return n<i?v==="asc"?-1:1:n>i?v==="asc"?1:-1:0}),[g,y,v]),E=o.useCallback(async()=>{try{const d=await L({limit:s,offset:f});b?.(d),m(null)}catch(d){m(d instanceof Error?d.message:"Failed to load users")}},[s,f,L,b]);o.useEffect(()=>{D(0)},[s]),o.useEffect(()=>{E()},[E]),o.useEffect(()=>{if(t<=0)return;const d=setInterval(E,t);return()=>clearInterval(d)},[t,E]);const C=Math.ceil(l/s),A=Math.floor(f/s)+1,T=d=>{const c=(d-1)*s;D(Math.max(0,Math.min(c,Math.max(0,l-1))))};return R||h?e.jsxs("div",{className:`cedros-admin-user-list cedros-admin-user-list-error ${a}`,children:[e.jsx("p",{className:"cedros-admin-error",children:R||h?.message}),e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline",onClick:()=>{P(),m(null),E()},children:"Retry"})]}):u&&g.length===0?e.jsxs("div",{className:`cedros-admin-user-list cedros-admin-user-list-loading ${a}`,children:[e.jsx("span",{className:"cedros-admin-loading-indicator"}),e.jsx("span",{className:"cedros-admin-loading-text",children:"Loading users..."})]}):e.jsxs("div",{className:`cedros-admin-user-list ${a}`,children:[e.jsxs("div",{className:"cedros-admin-user-list-header",children:[e.jsx("h4",{className:"cedros-admin-user-list-title",children:"All Users"}),e.jsxs("div",{className:"cedros-admin-user-list-actions",children:[e.jsxs("span",{className:"cedros-admin-queue-count",children:[l," user",l!==1?"s":""]}),e.jsx("button",{type:"button",className:"cedros-admin__stats-bar-refresh",onClick:E,disabled:u,title:"Refresh list","aria-label":"Refresh list",children:u?"...":"↻"})]})]}),g.length===0?e.jsx("div",{className:"cedros-admin-empty",children:e.jsx("p",{className:"cedros-admin-empty-message",children:"No users found."})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"cedros-admin-user-table",children:[e.jsxs("div",{className:"cedros-admin-user-thead",children:[e.jsx("div",{className:"cedros-admin-user-th",children:e.jsxs("button",{type:"button",className:`cedros-admin-sort-button ${y==="name"?"cedros-admin-sort-active":""}`,onClick:()=>$("name"),"aria-label":"Sort by user",children:["User"," ",e.jsx("span",{className:"cedros-admin-sort-icon",children:y==="name"?v==="asc"?"↑":"↓":"↕"})]})}),e.jsx("div",{className:"cedros-admin-user-th",children:e.jsxs("button",{type:"button",className:`cedros-admin-sort-button ${y==="createdAt"?"cedros-admin-sort-active":""}`,onClick:()=>$("createdAt"),"aria-label":"Sort by registered date",children:["Registered"," ",e.jsx("span",{className:"cedros-admin-sort-icon",children:y==="createdAt"?v==="asc"?"↑":"↓":"↕"})]})}),e.jsx("div",{className:"cedros-admin-user-th",children:e.jsxs("button",{type:"button",className:`cedros-admin-sort-button ${y==="lastLoginAt"?"cedros-admin-sort-active":""}`,onClick:()=>$("lastLoginAt"),"aria-label":"Sort by last login",children:["Last Login"," ",e.jsx("span",{className:"cedros-admin-sort-icon",children:y==="lastLoginAt"?v==="asc"?"↑":"↓":"↕"})]})}),e.jsx("div",{className:"cedros-admin-user-th",children:e.jsxs("button",{type:"button",className:`cedros-admin-sort-button ${y==="balanceLamports"?"cedros-admin-sort-active":""}`,onClick:()=>$("balanceLamports"),"aria-label":"Sort by balance",children:["Balance"," ",e.jsx("span",{className:"cedros-admin-sort-icon",children:y==="balanceLamports"?v==="asc"?"↑":"↓":"↕"})]})})]}),k.map(d=>{const c=d.id===r;return e.jsxs("div",{className:`cedros-admin-user-row ${c?"cedros-admin-user-row-current":""}`,onClick:()=>x?.(d),onKeyDown:n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),x?.(d))},role:x?"button":void 0,tabIndex:x?0:void 0,children:[e.jsxs("div",{className:"cedros-admin-user-td cedros-admin-user-info",children:[e.jsx("div",{className:"cedros-admin-user-avatar",children:d.picture?e.jsx("img",{src:d.picture,alt:d.name||d.email||"User",className:"cedros-admin-user-avatar-img",referrerPolicy:"no-referrer"}):e.jsx("span",{className:"cedros-admin-user-avatar-placeholder",children:(d.name?.[0]||d.email?.[0]||"?").toUpperCase()})}),e.jsxs("div",{className:"cedros-admin-user-details",children:[e.jsxs("span",{className:"cedros-admin-user-name",children:[d.name||"Unknown",c&&e.jsx("span",{className:"cedros-admin-user-you",children:"(you)"})]}),e.jsx("span",{className:"cedros-admin-user-email",title:d.email,children:d.email||be(d.id)})]})]}),e.jsx("div",{className:"cedros-admin-user-td",children:z(d.createdAt)}),e.jsx("div",{className:"cedros-admin-user-td",children:d.lastLoginAt?z(d.lastLoginAt):"-"}),e.jsx("div",{className:"cedros-admin-user-td",children:xe(d.balanceLamports)})]},d.id)})]}),C>1&&e.jsxs("div",{className:"cedros-admin-pagination",children:[e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline cedros-button-sm",onClick:()=>T(A-1),disabled:A<=1,children:"Previous"}),e.jsxs("span",{className:"cedros-admin-page-info",children:["Page ",A," of ",C," (",l," total)"]}),e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline cedros-button-sm",onClick:()=>T(A+1),disabled:A>=C,children:"Next"})]})]})]})}function ee(s){return new Date(s).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function X(s){return new Date(s).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function ge(s){return s==null?"—":`${(s/1e9).toFixed(4)} SOL`}function V(s){return s==null?"—":(s/1e9).toFixed(4)}function ye(s){return{DEPOSIT:"Deposit",SPEND:"Spend",ADJUSTMENT:"Adjustment",REFUND:"Refund"}[s.toUpperCase()]||s}function Ne(s,t){return t?{deposit:"Credit deposit",purchase:"Purchase",api_call:"API usage",subscription:"Subscription",refund:"Refund",bonus:"Bonus credit",promo:"Promotional credit",correction:"Balance correction"}[t.toLowerCase()]||t:{DEPOSIT:"Credit added",SPEND:"Credit used",ADJUSTMENT:"Manual adjustment",REFUND:"Credit refunded"}[s.toUpperCase()]||"—"}function we({userId:s,onBack:t,currentUserId:r,onEditUser:a,onAdjustCredits:b,cedrosPayEnabled:x=!1,className:g=""}){const{isLoading:l,getUser:u,getUserDeposits:h,getUserCredits:L,getUserChats:P,deleteUser:f,forcePasswordReset:D,clearError:R}=Q(),[m,y]=o.useState(null),[N,v]=o.useState(null),[U,$]=o.useState(null),[k,E]=o.useState(null),[C,A]=o.useState("deposits"),[T,d]=o.useState(null),[c,n]=o.useState(null),[i,p]=o.useState(null),[F,_]=o.useState(null),[q,O]=o.useState(!1),[H,se]=o.useState(0),[W,te]=o.useState(0),[J,ae]=o.useState(0),S=10,K=o.useCallback(async()=>{try{const j=await u(s);y(j),d(null)}catch(j){d(j instanceof Error?j.message:"Failed to load user")}},[s,u]),Y=o.useCallback(async()=>{try{const M=await h(s,{limit:S,offset:H});$(M),p(null)}catch(j){p(j instanceof Error?j.message:"Failed to load deposits")}},[s,h,H]),B=o.useCallback(async()=>{try{const M=await L(s,{limit:S,offset:W});v(M),n(null)}catch(j){n(j instanceof Error?j.message:"Failed to load credits")}},[s,L,W]),G=o.useCallback(async()=>{if(x)try{const M=await P(s,{limit:S,offset:J});E(M),_(null)}catch(j){_(j instanceof Error?j.message:"Failed to load chat history")}},[s,P,J,x]);o.useEffect(()=>{K(),Y(),B(),x&&G()},[K,Y,B,G,x]);const re=async()=>{if(!m)return;if(m.id===r){alert("You cannot delete your own account");return}if(m.isSystemAdmin){alert("Cannot delete a system admin. Remove admin status first.");return}if(window.confirm(`Are you sure you want to delete ${m.name||m.email||"this user"}? This action cannot be undone.`)){O(!0);try{await f(m.id),t()}catch{}finally{O(!1)}}},ne=async()=>{if(!m?.email){alert("User has no email address");return}if(window.confirm(`Send a password reset email to ${m.email}?`)){O(!0);try{await D(m.id),alert("Password reset email sent")}catch{}finally{O(!1)}}},ie=U?Math.ceil(U.total/S):0,oe=Math.floor(H/S)+1,ce=N?Math.ceil(N.totalTransactions/S):0,de=Math.floor(W/S)+1,le=j=>{se((j-1)*S)},me=j=>{te((j-1)*S)},ue=k?Math.ceil(k.total/S):0,he=Math.floor(J/S)+1,fe=j=>{ae((j-1)*S)};if(T)return e.jsxs("div",{className:`cedros-admin-user-detail cedros-admin-user-detail-error ${g}`,children:[e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline cedros-button-sm",onClick:t,children:"Back"}),e.jsx("p",{className:"cedros-admin-error",children:T}),e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline",onClick:()=>{R(),d(null),K()},children:"Retry"})]});if(l&&!m)return e.jsxs("div",{className:`cedros-admin-user-detail cedros-admin-user-detail-loading ${g}`,children:[e.jsx("span",{className:"cedros-admin-loading-indicator"}),e.jsx("span",{className:"cedros-admin-loading-text",children:"Loading user..."})]});if(!m)return e.jsxs("div",{className:`cedros-admin-user-detail ${g}`,children:[e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline cedros-button-sm",onClick:t,children:"Back"}),e.jsx("p",{className:"cedros-admin-empty-message",children:"User not found."})]});const I=m.id===r;return e.jsxs("div",{className:`cedros-admin-user-detail ${g}`,children:[e.jsxs("div",{className:"cedros-admin-user-detail-header",children:[e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline cedros-button-sm cedros-admin-back-btn",onClick:t,children:"Back to Users"}),e.jsxs("div",{className:"cedros-admin-user-detail-actions",children:[a&&e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline cedros-button-sm",onClick:()=>a(m),disabled:q,children:"Edit"}),m.email&&e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline cedros-button-sm",onClick:ne,disabled:q,children:"Reset Password"}),b&&e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline cedros-button-sm",onClick:()=>b(m),disabled:q,children:"Adjust Credits"}),!I&&!m.isSystemAdmin&&e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline cedros-button-sm cedros-admin-btn-danger",onClick:re,disabled:q,children:"Delete"})]})]}),e.jsxs("div",{className:"cedros-admin-user-detail-info",children:[e.jsx("div",{className:"cedros-admin-user-detail-avatar",children:m.picture?e.jsx("img",{src:m.picture,alt:m.name||m.email||"User",className:"cedros-admin-user-detail-avatar-img",referrerPolicy:"no-referrer"}):e.jsx("span",{className:"cedros-admin-user-detail-avatar-placeholder",children:(m.name?.[0]||m.email?.[0]||"?").toUpperCase()})}),e.jsxs("div",{className:"cedros-admin-user-detail-meta",children:[e.jsxs("h2",{className:"cedros-admin-user-detail-name",children:[m.name||"Unknown",I&&e.jsx("span",{className:"cedros-admin-user-you",children:"(you)"})]}),e.jsxs("p",{className:"cedros-admin-user-detail-email",children:[m.email||"No email",m.emailVerified&&e.jsx("span",{className:"cedros-admin-verified-badge",title:"Email verified",children:"Verified"})]}),m.isSystemAdmin&&e.jsx("div",{className:"cedros-admin-user-detail-badges",children:e.jsx("span",{className:"cedros-admin-admin-badge cedros-admin-admin-badge-yes",children:"System Admin"})}),e.jsxs("div",{className:"cedros-admin-user-detail-methods",children:[e.jsx("span",{className:"cedros-admin-user-detail-methods-label",children:"Auth Methods:"}),m.authMethods.length>0?m.authMethods.map(j=>e.jsx("span",{className:`cedros-admin-auth-badge cedros-admin-auth-badge-${j}`,children:j},j)):e.jsx("span",{className:"cedros-admin-auth-badge cedros-admin-auth-badge-none",children:"none"})]}),e.jsxs("p",{className:"cedros-admin-user-detail-dates",children:["Registered: ",ee(m.createdAt)," | Updated: ",ee(m.updatedAt)]})]})]}),c?e.jsxs("div",{className:"cedros-admin-stats-error",children:[e.jsx("p",{className:"cedros-admin-error-inline",children:c}),e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline cedros-button-sm",onClick:()=>{n(null),B()},children:"Retry"})]}):N?e.jsxs("div",{className:"cedros-admin-user-detail-stats",children:[e.jsxs("div",{className:"cedros-admin-stat-card",children:[e.jsx("span",{className:"cedros-admin-stat-label",children:"Credit Balance"}),e.jsx("span",{className:"cedros-admin-stat-value",children:V(N.stats.currentBalanceLamports)})]}),e.jsxs("div",{className:"cedros-admin-stat-card",children:[e.jsx("span",{className:"cedros-admin-stat-label",children:"Total Credited"}),e.jsx("span",{className:"cedros-admin-stat-value",children:V(N.stats.totalDepositedLamports)})]}),e.jsxs("div",{className:"cedros-admin-stat-card",children:[e.jsx("span",{className:"cedros-admin-stat-label",children:"Total Spent"}),e.jsx("span",{className:"cedros-admin-stat-value",children:V(N.stats.totalSpentLamports)})]}),e.jsxs("div",{className:"cedros-admin-stat-card",children:[e.jsx("span",{className:"cedros-admin-stat-label",children:"Deposits"}),e.jsx("span",{className:"cedros-admin-stat-value",children:N.stats.depositCount})]}),e.jsxs("div",{className:"cedros-admin-stat-card",children:[e.jsx("span",{className:"cedros-admin-stat-label",children:"Transactions"}),e.jsx("span",{className:"cedros-admin-stat-value",children:N.stats.spendCount})]})]}):e.jsxs("div",{className:"cedros-admin-stats-loading",children:[e.jsx("span",{className:"cedros-admin-loading-indicator"}),e.jsx("span",{children:"Loading credit stats..."})]}),e.jsxs("div",{className:"cedros-admin-user-detail-tabs",children:[e.jsxs("button",{type:"button",className:`cedros-admin-tab ${C==="deposits"?"cedros-admin-tab-active":""}`,onClick:()=>A("deposits"),children:["Deposits (",U?.total??0,")"]}),e.jsxs("button",{type:"button",className:`cedros-admin-tab ${C==="transactions"?"cedros-admin-tab-active":""}`,onClick:()=>A("transactions"),children:["Credits (",N?.totalTransactions??0,")"]}),x&&e.jsxs("button",{type:"button",className:`cedros-admin-tab ${C==="chats"?"cedros-admin-tab-active":""}`,onClick:()=>A("chats"),children:["Chats (",k?.total??0,")"]})]}),e.jsxs("div",{className:"cedros-admin-user-detail-content",children:[C==="deposits"&&e.jsx(ve,{deposits:U?.deposits??[],total:U?.total??0,currentPage:oe,totalPages:ie,onPageChange:le,isLoading:l,error:i,onRetry:()=>{p(null),Y()}}),C==="transactions"&&e.jsx(Ce,{transactions:N?.transactions??[],total:N?.totalTransactions??0,currentPage:de,totalPages:ce,onPageChange:me,error:c,onRetry:()=>{n(null),B()},isLoading:l}),C==="chats"&&x&&e.jsx(Se,{sessions:k?.sessions??[],total:k?.total??0,currentPage:he,totalPages:ue,onPageChange:fe,error:F,onRetry:()=>{_(null),G()},isLoading:l})]})]})}function ve({deposits:s,total:t,currentPage:r,totalPages:a,onPageChange:b,isLoading:x,error:g,onRetry:l}){return g?e.jsxs("div",{className:"cedros-admin-tab-error",children:[e.jsx("p",{className:"cedros-admin-error-inline",children:g}),e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline cedros-button-sm",onClick:l,children:"Retry"})]}):x&&s.length===0?e.jsxs("div",{className:"cedros-admin-tab-loading",children:[e.jsx("span",{className:"cedros-admin-loading-indicator"}),e.jsx("span",{children:"Loading deposits..."})]}):t===0?e.jsx("div",{className:"cedros-admin-empty-message",children:"No deposits found."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"cedros-admin-list-table",children:[e.jsxs("div",{className:"cedros-admin-list-thead",children:[e.jsx("div",{className:"cedros-admin-list-th",children:"Date"}),e.jsx("div",{className:"cedros-admin-list-th",children:"Amount"}),e.jsx("div",{className:"cedros-admin-list-th",children:"Status"}),e.jsx("div",{className:"cedros-admin-list-th",children:"Transaction"})]}),s.map(u=>e.jsxs("div",{className:"cedros-admin-list-row",children:[e.jsx("div",{className:"cedros-admin-list-td",children:X(u.createdAt)}),e.jsx("div",{className:"cedros-admin-list-td",children:ge(u.amountLamports)}),e.jsx("div",{className:"cedros-admin-list-td",children:e.jsx("span",{className:`cedros-admin-status-badge cedros-admin-status-${u.status}`,children:u.status})}),e.jsx("div",{className:"cedros-admin-list-td cedros-admin-list-td-actions",children:u.txSignature?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"cedros-admin-list-td-mono",title:u.txSignature,children:[u.txSignature.slice(0,8),"..."]}),e.jsx("a",{href:`https://orbmarkets.io/tx/${u.txSignature}`,target:"_blank",rel:"noopener noreferrer",className:"cedros-admin-icon-link",title:"View on Orbmarkets","aria-label":"View transaction on Orbmarkets",children:"↗"})]}):e.jsx("span",{className:"cedros-admin-list-td-muted",children:"—"})})]},u.id))]}),a>1&&e.jsx(Z,{currentPage:r,totalPages:a,total:t,onPageChange:b})]})}function Ce({transactions:s,total:t,currentPage:r,totalPages:a,onPageChange:b,isLoading:x,error:g,onRetry:l}){return g?e.jsxs("div",{className:"cedros-admin-tab-error",children:[e.jsx("p",{className:"cedros-admin-error-inline",children:g}),e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline cedros-button-sm",onClick:l,children:"Retry"})]}):x&&s.length===0?e.jsxs("div",{className:"cedros-admin-tab-loading",children:[e.jsx("span",{className:"cedros-admin-loading-indicator"}),e.jsx("span",{children:"Loading transactions..."})]}):t===0?e.jsx("div",{className:"cedros-admin-empty-message",children:"No credit transactions found."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"cedros-admin-list-table",children:[e.jsxs("div",{className:"cedros-admin-list-thead",children:[e.jsx("div",{className:"cedros-admin-list-th",children:"Date"}),e.jsx("div",{className:"cedros-admin-list-th",children:"Type"}),e.jsx("div",{className:"cedros-admin-list-th",children:"Description"}),e.jsx("div",{className:"cedros-admin-list-th",children:"Amount"})]}),s.map(u=>e.jsxs("div",{className:"cedros-admin-list-row",children:[e.jsx("div",{className:"cedros-admin-list-td",children:X(u.createdAt)}),e.jsx("div",{className:"cedros-admin-list-td",children:e.jsx("span",{className:`cedros-admin-tx-type cedros-admin-tx-type-${u.txType.toLowerCase()}`,children:ye(u.txType)})}),e.jsx("div",{className:"cedros-admin-list-td",children:Ne(u.txType,u.referenceType)}),e.jsxs("div",{className:`cedros-admin-list-td ${u.amountLamports>=0?"cedros-admin-amount-positive":"cedros-admin-amount-negative"}`,children:[u.amountLamports>=0?"+":"",V(u.amountLamports)]})]},u.id))]}),a>1&&e.jsx(Z,{currentPage:r,totalPages:a,total:t,onPageChange:b})]})}function Se({sessions:s,total:t,currentPage:r,totalPages:a,onPageChange:b,isLoading:x,error:g,onRetry:l}){return g?e.jsxs("div",{className:"cedros-admin-tab-error",children:[e.jsx("p",{className:"cedros-admin-error-inline",children:g}),e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline cedros-button-sm",onClick:l,children:"Retry"})]}):x&&s.length===0?e.jsxs("div",{className:"cedros-admin-tab-loading",children:[e.jsx("span",{className:"cedros-admin-loading-indicator"}),e.jsx("span",{children:"Loading chat history..."})]}):t===0?e.jsx("div",{className:"cedros-admin-empty-message",children:"No chat sessions found."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"cedros-admin-list-table",children:[e.jsxs("div",{className:"cedros-admin-list-thead",children:[e.jsx("div",{className:"cedros-admin-list-th",children:"Date"}),e.jsx("div",{className:"cedros-admin-list-th",children:"Session"}),e.jsx("div",{className:"cedros-admin-list-th",children:"Messages"})]}),s.map(u=>e.jsxs("div",{className:"cedros-admin-list-row",children:[e.jsx("div",{className:"cedros-admin-list-td",children:X(u.createdAt)}),e.jsx("div",{className:"cedros-admin-list-td",children:u.title||`Chat ${u.id.slice(0,8)}...`}),e.jsx("div",{className:"cedros-admin-list-td",children:u.messageCount})]},u.id))]}),a>1&&e.jsx(Z,{currentPage:r,totalPages:a,total:t,onPageChange:b})]})}function Z({currentPage:s,totalPages:t,total:r,onPageChange:a}){return e.jsxs("div",{className:"cedros-admin-pagination",children:[e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline cedros-button-sm",onClick:()=>a(s-1),disabled:s<=1,children:"Previous"}),e.jsxs("span",{className:"cedros-admin-page-info",children:["Page ",s," of ",t," (",r," total)"]}),e.jsx("button",{type:"button",className:"cedros-button cedros-button-outline cedros-button-sm",onClick:()=>a(s+1),disabled:s>=t,children:"Next"})]})}exports.AdminUserDetail=we;exports.AdminUserList=je;exports.useAdminUsers=Q;
